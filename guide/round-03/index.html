<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Round 3 - Data Engineering + Feature Engineering</title>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@300;400;500&family=Space+Mono:wght@400&family=Inter:wght@300;400&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Inter',sans-serif;background:#fafaf8;color:#1a1a1a;line-height:1.7;overflow-x:hidden}
.sidebar{position:fixed;left:0;top:0;width:260px;height:100vh;background:rgba(255,255,255,.97);border-right:1px solid rgba(0,0,0,.06);padding:32px 24px;z-index:100;overflow-y:auto;display:flex;flex-direction:column}
.sidebar-profile{text-align:center;margin-bottom:28px;padding-bottom:24px;border-bottom:1px solid rgba(0,0,0,.08)}
.profile-icon{font-size:48px;margin-bottom:8px}
.profile-name{font-family:'Cormorant Garamond',serif;font-size:1.3rem;font-weight:500;margin-bottom:4px}
.profile-title{font-size:.68rem;color:#888;letter-spacing:.08em;text-transform:uppercase;margin-bottom:8px}
.profile-bio{font-size:.78rem;color:#666;line-height:1.5}
.sidebar-nav{flex:1;margin-top:16px}
.nav-section{margin-bottom:20px}
.nav-section-title{font-size:.6rem;font-weight:600;color:#aaa;letter-spacing:.15em;text-transform:uppercase;margin-bottom:10px}
.nav-list{list-style:none}
.nav-list li{margin-bottom:5px}
.nav-list a{font-size:.78rem;color:#555;text-decoration:none;transition:all .2s;display:block;padding:3px 0}
.nav-list a:hover{color:#0080c6;padding-left:4px}
.nav-list a.active{color:#0080c6;font-weight:500}
.nav-list a.done{color:#28a745}
.badge{display:inline-block;font-size:.5rem;background:#0080c6;color:#fff;padding:1px 5px;border-radius:8px;margin-left:3px;vertical-align:middle}
.badge-done{background:#28a745}
.sidebar-footer{padding-top:16px;border-top:1px solid rgba(0,0,0,.06);font-size:.65rem;color:#aaa;text-align:center}
.main-wrapper{margin-left:260px;min-height:100vh}
.container{max-width:1100px;margin:0 auto;padding:50px 40px 80px}
.paper-content{font-family:'Times New Roman','Nanum Myeongjo',serif;line-height:1.8;background:#fff;padding:40px;border-radius:8px;box-shadow:0 2px 20px rgba(0,0,0,.05)}
.paper-header{text-align:center;margin-bottom:40px;padding-bottom:30px;border-bottom:2px solid #333}
.paper-category{font-size:14px;color:#666;margin-bottom:10px}
.paper-title{font-size:24px;font-weight:bold;margin-bottom:12px;line-height:1.4}
.paper-subtitle{font-size:14px;color:#555;margin-bottom:8px}
.paper-team{font-size:13px;color:#444}
</style>
<style>
.abstract{background:#f8f9fa;padding:25px;margin:30px 0;border-left:4px solid #2c3e50}
.abstract-title{font-weight:bold;font-size:16px;margin-bottom:15px}
h2{font-size:18px;margin:35px 0 20px;padding-bottom:8px;border-bottom:1px solid #ddd;color:#2c3e50}
h3{font-size:15px;margin:25px 0 15px;color:#34495e}
h4{font-size:14px;margin:20px 0 12px;color:#34495e}
p{text-align:justify;margin-bottom:15px;text-indent:2em}
p.ni{text-indent:0}
table{width:100%;border-collapse:collapse;margin:20px 0;font-size:12px}
th,td{border:1px solid #ddd;padding:10px 8px;text-align:center}
th{background:#2c3e50;color:white;font-weight:bold}
tr:nth-child(even){background:#f8f9fa}
tr:hover{background:#e8f4f8}
.tc{font-size:13px;font-weight:bold;margin:15px 0 10px;text-align:center}
.eq{text-align:center;margin:20px 0;padding:15px;background:#f8f9fa;border-radius:4px;overflow-x:auto}
ul,ol{margin-left:2em;margin-bottom:15px}
li{margin-bottom:6px}
.def{background:#fff9e6;border:1px solid #ffc107;border-radius:4px;padding:20px;margin:20px 0}
.info{background:#e8f4f8;border-left:4px solid #3498db;padding:20px;margin:20px 0}
.warn{background:#fff3cd;border-left:4px solid #f39c12;padding:20px;margin:20px 0}
.ok{background:#d4edda;border-left:4px solid #28a745;padding:20px;margin:20px 0}
pre{background:#1e1e1e;color:#d4d4d4;padding:20px;border-radius:6px;overflow-x:auto;margin:20px 0;font-family:'Space Mono','Consolas',monospace;font-size:13px;line-height:1.6}
code{font-family:'Space Mono','Consolas',monospace;font-size:13px}
p code,li code,td code{background:#f0f0f0;padding:2px 6px;border-radius:3px;color:#c7254e;font-size:12px}
.cc{font-size:12px;font-weight:bold;color:#2c3e50;margin-top:15px;margin-bottom:4px}
.cm{color:#6a9955}.kw{color:#569cd6}.st{color:#ce9178}.fn{color:#dcdcaa}.nb{color:#4ec9b0}.nu{color:#b5cea8}
.progress-bar{width:100%;height:6px;background:#e0e0e0;border-radius:3px;margin-top:16px}
.progress-fill{height:100%;background:linear-gradient(90deg,#0080c6,#00b894);border-radius:3px;width:30%}
.progress-label{font-size:11px;color:#888;margin-top:4px;text-align:center}
@media(max-width:1024px){
.sidebar{width:100%;height:auto;position:relative;border-right:none;border-bottom:1px solid rgba(0,0,0,.08);padding:16px}
.sidebar-profile{margin-bottom:10px;padding-bottom:10px;display:flex;align-items:center;gap:12px;text-align:left}
.profile-icon{font-size:32px;margin-bottom:0}.profile-bio{display:none}
.nav-section{display:inline-block;margin-right:16px;margin-bottom:8px}
.nav-list{display:flex;gap:10px;flex-wrap:wrap}.nav-list li{margin-bottom:0}
.sidebar-footer{display:none}
.main-wrapper{margin-left:0}
.container{padding:0}.paper-content{padding:20px 16px;border-radius:0;box-shadow:none}
.paper-title{font-size:18px}p{font-size:14px;text-indent:1.5em;text-align:left}
pre{font-size:11px;padding:14px}table{font-size:10px;display:block;overflow-x:auto}
}
</style>
</head>
<body>

<div class="sidebar">
<div class="sidebar-profile">
<div class="profile-icon">&#x1F680;</div>
<div class="profile-name">HFT ML Master Plan</div>
<div class="profile-title">Convex Opt + DL + HFT</div>
<div class="profile-bio">10 Rounds: Zero to HFT System Trading</div>
</div>
<div class="sidebar-nav">
<div class="nav-section">
<div class="nav-section-title">Curriculum</div>
<ul class="nav-list">
<li><a class="done" href="../round_01/lecture_01.html">R1. Python + Finance <span class="badge badge-done">DONE</span></a></li>
<li><a class="done" href="../round_02/lecture_02.html">R2. Linear Algebra + Stats <span class="badge badge-done">DONE</span></a></li>
<li><a class="active" href="#">R3. Data / Feature Eng. <span class="badge">NOW</span></a></li>
<li><a href="#">R4. Supervised Learning</a></li>
<li><a href="#">R5. Unsupervised + TS</a></li>
<li><a href="#">R6. NLP + Sentiment</a></li>
<li><a href="#">R7. Deep Learning</a></li>
<li><a href="#">R8. Convex Opt + Transformer</a></li>
<li><a href="#">R9. HFT + RL</a></li>
<li><a href="#">R10. Final Project</a></li>
</ul>
</div>
<div class="nav-section">
<div class="nav-section-title">This Lecture</div>
<ul class="nav-list">
<li><a href="#ch1">1. ë°ì´í„°ê°€ ì „ë¶€ë‹¤</a></li>
<li><a href="#ch2">2. yfinance ë§ˆìŠ¤í„°</a></li>
<li><a href="#ch3">3. FRED &amp; ê±°ì‹œê²½ì œ ë°ì´í„°</a></li>
<li><a href="#ch4">4. ë°ì´í„° ì •ì œì˜ ê¸°ìˆ </a></li>
<li><a href="#ch5">5. ê²°ì¸¡ì¹˜ ì²˜ë¦¬</a></li>
<li><a href="#ch6">6. ì´ìƒì¹˜ íƒì§€</a></li>
<li><a href="#ch7">7. ì •ê·œí™”ì™€ í‘œì¤€í™”</a></li>
<li><a href="#ch8">8. ê¸°ìˆ ì  ì§€í‘œ í”¼ì²˜</a></li>
<li><a href="#ch9">9. ë³€ë™ì„± &amp; ëª¨ë©˜í…€ í”¼ì²˜</a></li>
<li><a href="#ch10">10. ì•ŒíŒŒíŒ©í„° ê¸°ì´ˆ</a></li>
<li><a href="#ch11">11. ì‹¤ì „: í”¼ì²˜ í…Œì´ë¸” êµ¬ì¶•</a></li>
<li><a href="#ch12">12. í”¼ë“œë°± ì„¸ì…˜ + Quiz</a></li>
</ul>
</div>
</div>
<div class="sidebar-footer">Round 3 of 10 Â· ğŸ”„ Feedback Session</div>
</div>

<div class="main-wrapper">
<div class="container">
<div class="paper-content">

<div class="paper-header">
<div class="paper-category">Round 3 / 10 Â· ğŸ”„ ì²« ë²ˆì§¸ í”¼ë“œë°± ì„¸ì…˜</div>
<h1 class="paper-title">Data Engineering + Feature Engineering for Algorithmic Trading</h1>
<div class="paper-subtitle">ê¸ˆìœµ ë°ì´í„°ë¥¼ ìˆ˜ì§‘Â·ì •ì œÂ·ë³€í™˜í•˜ì—¬ MLì´ ë¨¹ì„ ìˆ˜ ìˆëŠ” í”¼ì²˜ë¥¼ ë§Œë“ ë‹¤</div>
<div class="paper-team">Textbooks: MLAT Ch.2~4 / MLDSF Ch.2 / íŒŒë¼í™œ Ch.5~8 / ë‘ì‡ì•Œê³  Ch.6</div>
<div class="progress-bar"><div class="progress-fill"></div></div>
<div class="progress-label">Overall Progress: 30%</div>
</div>

<div class="abstract">
<div class="abstract-title">Learning Objectives</div>
<p class="ni">Round 3ë¥¼ ë§ˆì¹˜ë©´ ë‹¤ìŒì„ í•  ìˆ˜ ìˆë‹¤:</p>
<ul>
<li>yfinance APIë¡œ ì£¼ê°€, ê±°ë˜ëŸ‰, ì¬ë¬´ì œí‘œ ë°ì´í„°ë¥¼ ììœ ìì¬ë¡œ ìˆ˜ì§‘í•  ìˆ˜ ìˆë‹¤</li>
<li>FRED APIë¡œ ê¸ˆë¦¬, í™˜ìœ¨, GDP ë“± ê±°ì‹œê²½ì œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìˆë‹¤</li>
<li>ê²°ì¸¡ì¹˜ë¥¼ íƒì§€í•˜ê³  ìƒí™©ì— ë§ëŠ” ì²˜ë¦¬ ë°©ë²•(ì‚­ì œ/ë³´ê°„/ëŒ€ì²´)ì„ ì„ íƒí•  ìˆ˜ ìˆë‹¤</li>
<li>ì´ìƒì¹˜ë¥¼ Z-score, IQR, Winsorization ë“±ìœ¼ë¡œ íƒì§€Â·ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤</li>
<li>Min-Max ì •ê·œí™”ì™€ Z-score í‘œì¤€í™”ì˜ ì°¨ì´ë¥¼ ì´í•´í•˜ê³  ì ì ˆíˆ ì ìš©í•  ìˆ˜ ìˆë‹¤</li>
<li>RSI, MACD, ë³¼ë¦°ì €ë°´ë“œ ë“± í•µì‹¬ ê¸°ìˆ ì  ì§€í‘œë¥¼ ì§ì ‘ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤</li>
<li>ë³€ë™ì„±, ëª¨ë©˜í…€, ê±°ë˜ëŸ‰ ê¸°ë°˜ í”¼ì²˜ë¥¼ ì„¤ê³„í•  ìˆ˜ ìˆë‹¤</li>
<li>ì•ŒíŒŒíŒ©í„°ì˜ ê°œë…ê³¼ IC(Information Coefficient)ë¥¼ ì´í•´í•œë‹¤</li>
<li>ì‹¤ì œ ì£¼ì‹ ë°ì´í„°ë¡œ 20ê°œ ì´ìƒì˜ í”¼ì²˜ í…Œì´ë¸”ì„ êµ¬ì¶•í•  ìˆ˜ ìˆë‹¤</li>
</ul>
<div style="font-size:13px;color:#555;margin-top:15px;font-style:italic"><strong>Keywords:</strong> Data Pipeline, Feature Engineering, Technical Indicators, RSI, MACD, Bollinger Bands, Alpha Factor, Information Coefficient, Normalization</div>
</div>

<!-- Round 3 ì „ì²´ íŒŒì´í”„ë¼ì¸ ë‹¤ì´ì–´ê·¸ë¨ (CSS) -->
<div style="margin:30px 0;padding:25px;background:linear-gradient(135deg,#f0f8f0,#e8f0e8);border-radius:12px;border:1px solid #ccc">
<p class="ni" style="text-align:center;font-weight:bold;font-size:16px;margin-bottom:8px;color:#2c3e50">ğŸ”§ ë°ì´í„° íŒŒì´í”„ë¼ì¸ ì „ì²´ êµ¬ì¡°</p>
<p class="ni" style="text-align:center;font-size:11px;color:#888;margin-bottom:20px">Raw Data â†’ ML-Ready Feature Table</p>

<!-- íŒŒì´í”„ë¼ì¸ ë©”ì¸ í”Œë¡œìš° -->
<div style="display:flex;align-items:stretch;justify-content:center;gap:4px;flex-wrap:wrap;font-size:12px">

<!-- Step 1: ìˆ˜ì§‘ -->
<div style="background:linear-gradient(180deg,#3498db,#2980b9);color:#fff;padding:16px 14px;border-radius:10px;text-align:center;min-width:105px;box-shadow:0 4px 12px rgba(52,152,219,0.3);display:flex;flex-direction:column;justify-content:space-between">
<div>
<div style="font-size:24px;margin-bottom:6px">ğŸ“¡</div>
<div style="font-weight:bold;font-size:13px;letter-spacing:0.5px">ìˆ˜ì§‘</div>
<div style="font-size:10px;opacity:0.85;margin-top:6px;line-height:1.5">yfinance<br>FRED API<br>CSV</div>
</div>
<div style="font-size:9px;margin-top:8px;background:rgba(255,255,255,0.2);padding:3px 6px;border-radius:4px">Ch.2~3</div>
</div>

<div style="display:flex;align-items:center;font-size:22px;color:#3498db;text-shadow:0 1px 3px rgba(0,0,0,0.1)">â–¸</div>

<!-- Step 2: ì •ì œ -->
<div style="background:linear-gradient(180deg,#e67e22,#d35400);color:#fff;padding:16px 14px;border-radius:10px;text-align:center;min-width:105px;box-shadow:0 4px 12px rgba(230,126,34,0.3);display:flex;flex-direction:column;justify-content:space-between">
<div>
<div style="font-size:24px;margin-bottom:6px">ğŸ§¹</div>
<div style="font-weight:bold;font-size:13px;letter-spacing:0.5px">ì •ì œ</div>
<div style="font-size:10px;opacity:0.85;margin-top:6px;line-height:1.5">ê²°ì¸¡ì¹˜<br>ì´ìƒì¹˜<br>íƒ€ì… ë³€í™˜</div>
</div>
<div style="font-size:9px;margin-top:8px;background:rgba(255,255,255,0.2);padding:3px 6px;border-radius:4px">Ch.4~6</div>
</div>

<div style="display:flex;align-items:center;font-size:22px;color:#e67e22;text-shadow:0 1px 3px rgba(0,0,0,0.1)">â–¸</div>

<!-- Step 3: ìŠ¤ì¼€ì¼ë§ -->
<div style="background:linear-gradient(180deg,#9b59b6,#8e44ad);color:#fff;padding:16px 14px;border-radius:10px;text-align:center;min-width:105px;box-shadow:0 4px 12px rgba(155,89,182,0.3);display:flex;flex-direction:column;justify-content:space-between">
<div>
<div style="font-size:24px;margin-bottom:6px">âš–ï¸</div>
<div style="font-weight:bold;font-size:13px;letter-spacing:0.5px">ìŠ¤ì¼€ì¼ë§</div>
<div style="font-size:10px;opacity:0.85;margin-top:6px;line-height:1.5">Min-Max<br>Z-Score<br>Robust</div>
</div>
<div style="font-size:9px;margin-top:8px;background:rgba(255,255,255,0.2);padding:3px 6px;border-radius:4px">Ch.7</div>
</div>

<div style="display:flex;align-items:center;font-size:22px;color:#9b59b6;text-shadow:0 1px 3px rgba(0,0,0,0.1)">â–¸</div>

<!-- Step 4: í”¼ì²˜ ìƒì„± -->
<div style="background:linear-gradient(180deg,#27ae60,#229954);color:#fff;padding:16px 14px;border-radius:10px;text-align:center;min-width:105px;box-shadow:0 4px 12px rgba(39,174,96,0.3);display:flex;flex-direction:column;justify-content:space-between">
<div>
<div style="font-size:24px;margin-bottom:6px">âš™ï¸</div>
<div style="font-weight:bold;font-size:13px;letter-spacing:0.5px">í”¼ì²˜ ìƒì„±</div>
<div style="font-size:10px;opacity:0.85;margin-top:6px;line-height:1.5">RSI, MACD<br>ë³¼ë¦°ì €ë°´ë“œ<br>ëª¨ë©˜í…€</div>
</div>
<div style="font-size:9px;margin-top:8px;background:rgba(255,255,255,0.2);padding:3px 6px;border-radius:4px">Ch.8~9</div>
</div>

<div style="display:flex;align-items:center;font-size:22px;color:#27ae60;text-shadow:0 1px 3px rgba(0,0,0,0.1)">â–¸</div>

<!-- Step 5: ì•ŒíŒŒíŒ©í„° -->
<div style="background:linear-gradient(180deg,#e74c3c,#c0392b);color:#fff;padding:16px 14px;border-radius:10px;text-align:center;min-width:105px;box-shadow:0 4px 12px rgba(231,76,60,0.3);display:flex;flex-direction:column;justify-content:space-between">
<div>
<div style="font-size:24px;margin-bottom:6px">ğŸ¯</div>
<div style="font-weight:bold;font-size:13px;letter-spacing:0.5px">ì•ŒíŒŒíŒ©í„°</div>
<div style="font-size:10px;opacity:0.85;margin-top:6px;line-height:1.5">IC í‰ê°€<br>íŒ©í„° ìƒê´€<br>ì¤‘ë¦½í™”</div>
</div>
<div style="font-size:9px;margin-top:8px;background:rgba(255,255,255,0.2);padding:3px 6px;border-radius:4px">Ch.10</div>
</div>

<div style="display:flex;align-items:center;font-size:22px;color:#e74c3c;text-shadow:0 1px 3px rgba(0,0,0,0.1)">â–¸</div>

<!-- Step 6: í”¼ì²˜ í…Œì´ë¸” -->
<div style="background:linear-gradient(180deg,#2c3e50,#1a252f);color:#fff;padding:16px 14px;border-radius:10px;text-align:center;min-width:105px;box-shadow:0 4px 12px rgba(44,62,80,0.3);display:flex;flex-direction:column;justify-content:space-between">
<div>
<div style="font-size:24px;margin-bottom:6px">ğŸ“Š</div>
<div style="font-weight:bold;font-size:13px;letter-spacing:0.5px">í”¼ì²˜ í…Œì´ë¸”</div>
<div style="font-size:10px;opacity:0.85;margin-top:6px;line-height:1.5">20+ í”¼ì²˜<br>ML ì…ë ¥ ì™„ì„±<br>â†’ Round 4</div>
</div>
<div style="font-size:9px;margin-top:8px;background:rgba(255,255,255,0.2);padding:3px 6px;border-radius:4px">Ch.11</div>
</div>

</div>

<!-- í•˜ë‹¨ ìš”ì•½ ë°” -->
<div style="margin-top:16px;display:flex;justify-content:center">
<div style="display:inline-flex;align-items:center;gap:4px;background:#fff;padding:8px 20px;border-radius:20px;border:1px dashed #aaa;font-size:10px;color:#555">
<span style="color:#3498db">â—</span> ìˆ˜ì§‘ â†’
<span style="color:#e67e22">â—</span> ì •ì œ â†’
<span style="color:#9b59b6">â—</span> ìŠ¤ì¼€ì¼ë§ â†’
<span style="color:#27ae60">â—</span> í”¼ì²˜ â†’
<span style="color:#e74c3c">â—</span> ì•ŒíŒŒ â†’
<span style="color:#2c3e50">â—</span> <strong>ML Ready!</strong>
</div>
</div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- Ch1: ë°ì´í„°ê°€ ì „ë¶€ë‹¤ -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<h2 id="ch1">1. ë°ì´í„°ê°€ ì „ë¶€ë‹¤ â€” "Garbage In, Garbage Out"</h2>

<h3>1.1 ì™œ ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§ì´ MLì˜ 80%ì¸ê°€</h3>
<p>ML ëª¨ë¸ì„ ë§Œë“œëŠ” ê³¼ì •ì„ ìš”ë¦¬ì— ë¹„ìœ í•´ë³´ì. ì•„ë¬´ë¦¬ ë›°ì–´ë‚œ ì…°í”„(ëª¨ë¸)ë¼ë„ ì¬ë£Œ(ë°ì´í„°)ê°€ ì©ì—ˆìœ¼ë©´ ë§›ìˆëŠ” ìš”ë¦¬ë¥¼ ë§Œë“¤ ìˆ˜ ì—†ë‹¤. ì‹¤ì œë¡œ ë°ì´í„° ì‚¬ì´ì–¸í‹°ìŠ¤íŠ¸ë“¤ì˜ ì—…ë¬´ ì‹œê°„ ì¤‘ ì•½ 80%ê°€ ë°ì´í„° ìˆ˜ì§‘Â·ì •ì œÂ·ë³€í™˜ì— ì“°ì¸ë‹¤. ëª¨ë¸ í•™ìŠµì€ ë‚˜ë¨¸ì§€ 20%ì— ë¶ˆê³¼í•˜ë‹¤.</p>

<p>ê¸ˆìœµì—ì„œëŠ” ì´ ë¹„ìœ¨ì´ ë” ê·¹ë‹¨ì ì´ë‹¤. ì™œëƒí•˜ë©´ ê¸ˆìœµ ë°ì´í„°ì—ëŠ” í•¨ì •ì´ ë§ê¸° ë•Œë¬¸ì´ë‹¤:</p>

<ul>
<li><strong>ìƒì¡´ì í¸í–¥ (Survivorship Bias):</strong> ìƒì¥íì§€ëœ ì¢…ëª©ì´ ë°ì´í„°ì—ì„œ ë¹ ì ¸ ìˆìœ¼ë©´, ê³¼ê±° ìˆ˜ìµë¥ ì´ ì‹¤ì œë³´ë‹¤ ì¢‹ì•„ ë³´ì¸ë‹¤. 2008ë…„ ê¸ˆìœµìœ„ê¸° ë•Œ íŒŒì‚°í•œ ë¦¬ë¨¼ ë¸Œë¼ë”ìŠ¤ê°€ ë°ì´í„°ì— ì—†ìœ¼ë©´? ë°±í…ŒìŠ¤íŠ¸ ê²°ê³¼ê°€ ì™œê³¡ëœë‹¤.</li>
<li><strong>ë¯¸ë˜ ì •ë³´ ëˆ„ì¶œ (Look-Ahead Bias):</strong> "ë‚´ì¼ ë°œí‘œë  ì‹¤ì "ì„ ì˜¤ëŠ˜ì˜ í”¼ì²˜ë¡œ ì‚¬ìš©í•˜ë©´ ë‹¹ì—°íˆ ì˜ˆì¸¡ì´ ì˜ ëœë‹¤. í•˜ì§€ë§Œ ì‹¤ì „ì—ì„œëŠ” ë¶ˆê°€ëŠ¥í•˜ë‹¤. ì´ê²ƒì„ ë°©ì§€í•˜ì§€ ì•Šìœ¼ë©´ ë°±í…ŒìŠ¤íŠ¸ëŠ” í™˜ìƒì´ ëœë‹¤.</li>
<li><strong>ë°ì´í„° ìŠ¤ëˆ„í•‘ (Data Snooping):</strong> ê°™ì€ ë°ì´í„°ë¡œ ìˆ˜ë°± ê°œì˜ ì „ëµì„ í…ŒìŠ¤íŠ¸í•˜ë©´, ìš°ì—°íˆ ì˜ ë§ëŠ” ì „ëµì´ ë‚˜ì˜¨ë‹¤. ì´ê²ƒì€ ì§„ì§œ ì•ŒíŒŒê°€ ì•„ë‹ˆë¼ í†µê³„ì  ìš°ì—°ì´ë‹¤.</li>
<li><strong>ì£¼ê°€ ì¡°ì • ë¬¸ì œ:</strong> ì•¡ë©´ë¶„í• , ë°°ë‹¹, ìœ ìƒì¦ì ë“±ìœ¼ë¡œ ì£¼ê°€ê°€ ë¶ˆì—°ì†ì ìœ¼ë¡œ ë³€í•œë‹¤. ì¡°ì •í•˜ì§€ ì•Šìœ¼ë©´ ìˆ˜ìµë¥  ê³„ì‚°ì´ ì—‰ë§ì´ ëœë‹¤.</li>
</ul>

<!-- â”€â”€ ë³´ì¶© 1.1+ ìƒì¡´ì í¸í–¥ êµ¬ì²´ì  ìˆ˜ì¹˜ ì˜ˆì œ â”€â”€ -->
<div class="def">
<p class="ni"><strong>ğŸ” ë³´ì¶©: ìƒì¡´ì í¸í–¥ì´ ë°±í…ŒìŠ¤íŠ¸ë¥¼ ì–¼ë§ˆë‚˜ ì™œê³¡í•˜ëŠ”ê°€ â€” ìˆ«ìë¡œ ë³´ê¸°</strong></p>
<p class="ni">êµ¬ì²´ì ì¸ ì˜ˆë¥¼ ë“¤ì–´ë³´ì. 2005ë…„ì— KOSPI 200 ì¢…ëª©ìœ¼ë¡œ ëª¨ë©˜í…€ ì „ëµì„ ë°±í…ŒìŠ¤íŠ¸í•œë‹¤ê³  í•˜ì.</p>
<ul>
<li><strong>í˜„ì¬(2025ë…„) ê¸°ì¤€ KOSPI 200:</strong> ì‚´ì•„ë‚¨ì€ ì¢…ëª©ë§Œ í¬í•¨. 2008ë…„ì— ìƒì¥íì§€ëœ ì¢…ëª©, 2015ë…„ì— í•©ë³‘ëœ ì¢…ëª©ì€ ë¹ ì ¸ ìˆë‹¤.</li>
<li><strong>ì‹¤ì œ 2005ë…„ KOSPI 200:</strong> ë‹¹ì‹œì—ëŠ” ì¡´ì¬í–ˆì§€ë§Œ ì§€ê¸ˆì€ ì‚¬ë¼ì§„ ì¢…ëª©ì´ ì•½ 30~50ê°œ í¬í•¨ë˜ì–´ ìˆì—ˆë‹¤.</li>
</ul>
<p class="ni">ì‚¬ë¼ì§„ ì¢…ëª©ë“¤ì€ ëŒ€ë¶€ë¶„ ì‹¤ì ì´ ë‚˜ë¹ ì„œ í‡´ì¶œëœ ê²ƒì´ë‹¤. ì´ ì¢…ëª©ë“¤ì„ ë¹¼ê³  ë°±í…ŒìŠ¤íŠ¸í•˜ë©´:</p>
</div>

<pre><code><span class="cm"># ìƒì¡´ì í¸í–¥ì˜ ì˜í–¥ ì‹œë®¬ë ˆì´ì…˜</span>
np.random.seed(<span class="nu">42</span>)

<span class="cm"># 100ê°œ ì¢…ëª©ì˜ 5ë…„ ìˆ˜ìµë¥  ì‹œë®¬ë ˆì´ì…˜</span>
n_stocks = <span class="nu">100</span>
annual_returns = np.random.normal(<span class="nu">0.05</span>, <span class="nu">0.30</span>, n_stocks)  <span class="cm"># í‰ê·  5%, ë³€ë™ì„± 30%</span>

<span class="cm"># 20ê°œ ì¢…ëª©ì´ ìƒì¥íì§€ (ìˆ˜ìµë¥  -80% ~ -100%)</span>
n_delisted = <span class="nu">20</span>
annual_returns[:<span class="nu">20</span>] = np.random.uniform(-<span class="nu">1.0</span>, -<span class="nu">0.5</span>, n_delisted)

<span class="cm"># ìƒì¡´ìë§Œ í¬í•¨ vs ì „ì²´ í¬í•¨</span>
survivors = annual_returns[annual_returns > -<span class="nu">0.5</span>]  <span class="cm"># ì‚´ì•„ë‚¨ì€ ì¢…ëª©</span>

<span class="fn">print</span>(<span class="st">"=== ìƒì¡´ì í¸í–¥ ì‹œë®¬ë ˆì´ì…˜ ==="</span>)
<span class="fn">print</span>(<span class="st">f"ì „ì²´ 100ì¢…ëª© í‰ê·  ìˆ˜ìµë¥ : </span>{annual_returns.mean()*100:.1f}<span class="st">%"</span>)
<span class="fn">print</span>(<span class="st">f"ìƒì¡´ì </span>{<span class="fn">len</span>(survivors)}<span class="st">ì¢…ëª© í‰ê·  ìˆ˜ìµë¥ : </span>{survivors.mean()*100:.1f}<span class="st">%"</span>)
<span class="fn">print</span>(<span class="st">f"í¸í–¥ í¬ê¸°: </span>{(survivors.mean() - annual_returns.mean())*100:.1f}<span class="st">%p ê³¼ëŒ€í‰ê°€!"</span>)
<span class="fn">print</span>(<span class="st">f"\nâ†’ ìƒì¡´ìë§Œ ë³´ë©´ ìˆ˜ìµë¥ ì´ </span>{(survivors.mean() - annual_returns.mean())*100:.1f}<span class="st">%p ë†’ì•„ ë³´ì¸ë‹¤."</span>)
<span class="fn">print</span>(<span class="st">f"â†’ ì´ í¸í–¥ ìœ„ì—ì„œ ì „ëµì„ ë§Œë“¤ë©´, ì‹¤ì „ì—ì„œ ê¸°ëŒ€ ì´í•˜ì˜ ì„±ê³¼ê°€ ë‚˜ì˜¨ë‹¤."</span>)</code></pre>

<div class="def">
<p class="ni"><strong>ì •ì˜: ë°ì´í„° íŒŒì´í”„ë¼ì¸ (Data Pipeline)</strong></p>
<p class="ni">ì›ì‹œ ë°ì´í„°(raw data)ë¥¼ ìˆ˜ì§‘í•˜ì—¬, ì •ì œ(cleaning)í•˜ê³ , ë³€í™˜(transformation)í•˜ì—¬, ML ëª¨ë¸ì´ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” í”¼ì²˜ í…Œì´ë¸”(feature table)ë¡œ ë§Œë“œëŠ” ì „ì²´ ê³¼ì •ì„ ë°ì´í„° íŒŒì´í”„ë¼ì¸ì´ë¼ í•œë‹¤.</p>
<div class="eq">\[ \text{Raw Data} \xrightarrow{\text{ìˆ˜ì§‘}} \text{DataFrame} \xrightarrow{\text{ì •ì œ}} \text{Clean Data} \xrightarrow{\text{ë³€í™˜}} \text{Feature Table} \xrightarrow{\text{ì…ë ¥}} \text{ML Model} \]</div>
</div>

<h3>1.2 ê¸ˆìœµ ë°ì´í„°ì˜ ì¢…ë¥˜</h3>
<p>ê¸ˆìœµ ë°ì´í„°ëŠ” í¬ê²Œ ì„¸ ê°€ì§€ë¡œ ë‚˜ë‰œë‹¤. ê°ê°ì˜ íŠ¹ì„±ê³¼ ìš©ë„ë¥¼ ì´í•´í•˜ëŠ” ê²ƒì´ ì²«ê±¸ìŒì´ë‹¤.</p>

<div class="tc">Table 1. ê¸ˆìœµ ë°ì´í„° ë¶„ë¥˜</div>
<table>
<tr><th>ë¶„ë¥˜</th><th>ì˜ˆì‹œ</th><th>íŠ¹ì§•</th><th>ì†ŒìŠ¤</th><th>ë¼ìš´ë“œ</th></tr>
<tr><td>ì‹œì¥ ë°ì´í„° (Market Data)</td><td>ì£¼ê°€, ê±°ë˜ëŸ‰, í˜¸ê°€ì°½</td><td>ì‹¤ì‹œê°„, ëŒ€ìš©ëŸ‰, êµ¬ì¡°í™”</td><td>ê±°ë˜ì†Œ, yfinance, Bloomberg</td><td>R1~R3</td></tr>
<tr><td>ê¸°ë³¸ ë°ì´í„° (Fundamental Data)</td><td>ì¬ë¬´ì œí‘œ, ì‹¤ì , ë°°ë‹¹</td><td>ë¶„ê¸°ë³„, ì§€ì—° ë°œí‘œ</td><td>SEC, DART, yfinance</td><td>R3~R4</td></tr>
<tr><td>ëŒ€ì•ˆ ë°ì´í„° (Alternative Data)</td><td>ë‰´ìŠ¤, SNS, ìœ„ì„±ì‚¬ì§„, ì›¹íŠ¸ë˜í”½</td><td>ë¹„êµ¬ì¡°í™”, ì „ì²˜ë¦¬ í•„ìš”</td><td>ë‰´ìŠ¤ API, Twitter, ìœ„ì„±</td><td>R6</td></tr>
</table>

<p>ì´ë²ˆ ë¼ìš´ë“œì—ì„œëŠ” ì‹œì¥ ë°ì´í„°ì™€ ê¸°ë³¸ ë°ì´í„°ë¥¼ ì§‘ì¤‘ì ìœ¼ë¡œ ë‹¤ë£¬ë‹¤. ëŒ€ì•ˆ ë°ì´í„°ëŠ” NLPë¥¼ ë°°ìš°ëŠ” Round 6ì—ì„œ ë³¸ê²©ì ìœ¼ë¡œ ë‹¤ë£° ê²ƒì´ë‹¤.</p>

<div class="info">
<p class="ni"><strong>êµì¬ ì—°ë™:</strong> MLAT Ch.2 "Market & Fundamental Data"ì—ì„œ ì‹œì¥ ë°ì´í„°ì˜ êµ¬ì¡°ì™€ ì†Œì‹± ë°©ë²•ì„, Ch.3 "Alternative Data for Finance"ì—ì„œ ëŒ€ì•ˆ ë°ì´í„°ì˜ ì¢…ë¥˜ì™€ í™œìš©ë²•ì„ ë‹¤ë£¬ë‹¤. MLDSF Ch.2 "Developing a Model in Python"ì—ì„œëŠ” ë°ì´í„° íŒŒì´í”„ë¼ì¸ êµ¬ì¶•ì˜ ì‹¤ì „ ë¸”ë£¨í”„ë¦°íŠ¸ë¥¼ ì œì‹œí•œë‹¤. íŒŒë¼í™œ Ch.5~8ì—ì„œëŠ” Pandasì˜ ê³ ê¸‰ ë°ì´í„° ì¡°ì‘ ê¸°ë²•ì„ ë°°ìš´ë‹¤.</p>
</div>

<h3>1.3 ì´ë²ˆ ë¼ìš´ë“œì˜ ì „ì²´ íë¦„</h3>
<p>ì´ë²ˆ ë¼ìš´ë“œëŠ” ë°ì´í„° íŒŒì´í”„ë¼ì¸ì˜ ì²˜ìŒë¶€í„° ëê¹Œì§€ë¥¼ ë‹¤ë£¬ë‹¤. ì „ì²´ íë¦„ì„ ë¨¼ì € ë¨¸ë¦¿ì†ì— ê·¸ë ¤ë‘ì:</p>

<pre><code><span class="cm"># Round 3 ì „ì²´ íë¦„</span>
<span class="cm"># â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="cm"># â”‚  Ch.2~3     â”‚    â”‚  Ch.4~6     â”‚    â”‚  Ch.7       â”‚    â”‚  Ch.8~10    â”‚</span>
<span class="cm"># â”‚  ë°ì´í„° ìˆ˜ì§‘ â”‚ â†’  â”‚  ë°ì´í„° ì •ì œ â”‚ â†’  â”‚  ìŠ¤ì¼€ì¼ë§   â”‚ â†’  â”‚  í”¼ì²˜ ìƒì„±  â”‚</span>
<span class="cm"># â”‚  yfinance   â”‚    â”‚  ê²°ì¸¡ì¹˜     â”‚    â”‚  ì •ê·œí™”     â”‚    â”‚  RSI, MACD  â”‚</span>
<span class="cm"># â”‚  FRED       â”‚    â”‚  ì´ìƒì¹˜     â”‚    â”‚  í‘œì¤€í™”     â”‚    â”‚  ì•ŒíŒŒíŒ©í„°   â”‚</span>
<span class="cm"># â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
<span class="cm">#                                                              â†“</span>
<span class="cm">#                                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span class="cm">#                                                    â”‚  Ch.11          â”‚</span>
<span class="cm">#                                                    â”‚  í”¼ì²˜ í…Œì´ë¸”    â”‚</span>
<span class="cm">#                                                    â”‚  (ML ì…ë ¥ ì™„ì„±) â”‚</span>
<span class="cm">#                                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span></code></pre>

<p>ê° ë‹¨ê³„ê°€ ì™œ í•„ìš”í•œì§€, ì–´ë–¤ í•¨ì •ì´ ìˆëŠ”ì§€, ê¸ˆìœµì—ì„œ ì–´ë–»ê²Œ ì ìš©ë˜ëŠ”ì§€ë¥¼ í•˜ë‚˜í•˜ë‚˜ ê¹Šì´ íŒŒê³ ë“¤ ê²ƒì´ë‹¤.</p>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- Ch2: yfinance ë§ˆìŠ¤í„° -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<h2 id="ch2">2. yfinance ì™„ì „ ì •ë³µ â€” ì£¼ê°€ ë°ì´í„°ì˜ ëª¨ë“  ê²ƒ</h2>

<h3>2.1 yfinanceë€?</h3>
<p>yfinanceëŠ” Yahoo Financeì˜ ë°ì´í„°ë¥¼ Pythonìœ¼ë¡œ ê°€ì ¸ì˜¤ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ë‹¤. Round 1ì—ì„œ ê°„ë‹¨íˆ ì‚¬ìš©í•´ë´¤ì§€ë§Œ, ì´ë²ˆì—ëŠ” yfinanceê°€ ì œê³µí•˜ëŠ” ëª¨ë“  ê¸°ëŠ¥ì„ ê¹Šì´ íŒŒê³ ë“ ë‹¤. ë¬´ë£Œì´ë©´ì„œë„ ë†€ë¼ìš¸ ì •ë„ë¡œ ë§ì€ ë°ì´í„°ë¥¼ ì œê³µí•œë‹¤.</p>

<pre><code><span class="cm"># yfinance ì„¤ì¹˜ (ì•„ì§ ì•ˆ í–ˆë‹¤ë©´)</span>
<span class="cm"># pip install yfinance</span>

<span class="kw">import</span> yfinance <span class="kw">as</span> yf
<span class="kw">import</span> pandas <span class="kw">as</span> pd
<span class="kw">import</span> numpy <span class="kw">as</span> np
<span class="kw">import</span> matplotlib.pyplot <span class="kw">as</span> plt

<span class="cm"># ì‚¼ì„±ì „ì í‹°ì»¤ ê°ì²´ ìƒì„±</span>
samsung = yf.Ticker(<span class="st">"005930.KS"</span>)  <span class="cm"># .KS = í•œêµ­ê±°ë˜ì†Œ</span>

<span class="cm"># ê¸°ë³¸ ì •ë³´ í™•ì¸</span>
info = samsung.info
<span class="fn">print</span>(<span class="st">f"íšŒì‚¬ëª…: </span>{info.get(<span class="st">'longName'</span>, <span class="st">'N/A'</span>)}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"ì„¹í„°: </span>{info.get(<span class="st">'sector'</span>, <span class="st">'N/A'</span>)}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"ì‹œê°€ì´ì•¡: </span>{info.get(<span class="st">'marketCap'</span>, <span class="st">'N/A'</span>):,}<span class="st"> ì›"</span>)
<span class="fn">print</span>(<span class="st">f"PER: </span>{info.get(<span class="st">'trailingPE'</span>, <span class="st">'N/A'</span>)}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"PBR: </span>{info.get(<span class="st">'priceToBook'</span>, <span class="st">'N/A'</span>)}<span class="st">"</span>)</code></pre>

<div class="warn">
<p class="ni"><strong>í‹°ì»¤ ì½”ë“œ ê·œì¹™:</strong> í•œêµ­ ì£¼ì‹ì€ ì¢…ëª©ì½”ë“œ ë’¤ì— <code>.KS</code>(KOSPI) ë˜ëŠ” <code>.KQ</code>(KOSDAQ)ë¥¼ ë¶™ì¸ë‹¤. ë¯¸êµ­ ì£¼ì‹ì€ ê·¸ëƒ¥ ì‹¬ë³¼ë§Œ ì“´ë‹¤ (ì˜ˆ: <code>"AAPL"</code>, <code>"MSFT"</code>). ì¼ë³¸ì€ <code>.T</code>, í™ì½©ì€ <code>.HK</code>ë¥¼ ë¶™ì¸ë‹¤.</p>
</div>

<h3>2.2 ì£¼ê°€ ë°ì´í„° ë‹¤ìš´ë¡œë“œ â€” ê¸°ë³¸í¸</h3>
<p>yfinanceì˜ í•µì‹¬ ê¸°ëŠ¥ì€ OHLCV(ì‹œê°€Â·ê³ ê°€Â·ì €ê°€Â·ì¢…ê°€Â·ê±°ë˜ëŸ‰) ë°ì´í„° ë‹¤ìš´ë¡œë“œë‹¤. Round 1ì—ì„œ ê°„ë‹¨íˆ í•´ë´¤ì§€ë§Œ, ì´ë²ˆì—ëŠ” ë‹¤ì–‘í•œ ì˜µì…˜ì„ ì‚´í´ë³´ì.</p>

<pre><code><span class="cm"># ê¸°ë³¸ ë‹¤ìš´ë¡œë“œ: ìµœê·¼ 1ë…„ ì¼ë´‰</span>
df = yf.download(<span class="st">"005930.KS"</span>, period=<span class="st">"1y"</span>)
<span class="fn">print</span>(df.head())
<span class="fn">print</span>(<span class="st">f"\nShape: </span>{df.shape}<span class="st">"</span>)  <span class="cm"># (ì•½ 250, 6) â€” ì•½ 250 ê±°ë˜ì¼</span>
<span class="fn">print</span>(<span class="st">f"ì»¬ëŸ¼: </span>{df.columns.tolist()}<span class="st">"</span>)
<span class="cm"># ['Close', 'High', 'Low', 'Open', 'Volume']  (yfinance 1.0+)</span></code></pre>

<p>ê° ì»¬ëŸ¼ì˜ ì˜ë¯¸ë¥¼ ì •í™•íˆ ì´í•´í•˜ì:</p>

<div class="tc">Table 2. OHLCV ì»¬ëŸ¼ ì„¤ëª…</div>
<table>
<tr><th>ì»¬ëŸ¼</th><th>ì˜ì–´</th><th>ì˜ë¯¸</th><th>ìš©ë„</th></tr>
<tr><td>Open</td><td>ì‹œê°€</td><td>ì¥ ì‹œì‘ ì‹œ ì²« ê±°ë˜ ê°€ê²©</td><td>ê°­(gap) ë¶„ì„</td></tr>
<tr><td>High</td><td>ê³ ê°€</td><td>ì¥ì¤‘ ìµœê³  ê°€ê²©</td><td>ì €í•­ì„ , ë³€ë™ì„± ê³„ì‚°</td></tr>
<tr><td>Low</td><td>ì €ê°€</td><td>ì¥ì¤‘ ìµœì € ê°€ê²©</td><td>ì§€ì§€ì„ , ë³€ë™ì„± ê³„ì‚°</td></tr>
<tr><td>Close</td><td>ì¢…ê°€ (ìˆ˜ì •ì¢…ê°€)</td><td>ë°°ë‹¹Â·ë¶„í•  ë“±ì´ ì´ë¯¸ ë°˜ì˜ëœ ì¢…ê°€</td><td>ìˆ˜ìµë¥  ê³„ì‚°ì˜ ê¸°ì¤€ â­</td></tr>
<tr><td>Volume</td><td>ê±°ë˜ëŸ‰</td><td>í•˜ë£¨ ë™ì•ˆ ê±°ë˜ëœ ì£¼ì‹ ìˆ˜</td><td>ìœ ë™ì„±, ê±°ë˜ëŸ‰ ì§€í‘œ</td></tr>
</table>

<div class="def">
<p class="ni"><strong>í•µì‹¬: yfinance 1.0+ ë³€ê²½ì‚¬í•­ â€” Adj Close ì‚­ì œ</strong></p>
<p class="ni">yfinance 1.0 ì´ì „ì—ëŠ” <code>Close</code>(ì›ì‹œ ì¢…ê°€)ì™€ <code>Adj Close</code>(ìˆ˜ì •ì¢…ê°€)ê°€ ë³„ë„ë¡œ ì¡´ì¬í–ˆë‹¤. í•˜ì§€ë§Œ <strong>yfinance 1.0ë¶€í„° <code>Adj Close</code> ì»¬ëŸ¼ì´ ì‚­ì œ</strong>ë˜ì—ˆê³ , <code>Close</code>ì— ë°°ë‹¹Â·ë¶„í•  ë“±ì´ ì´ë¯¸ ë°˜ì˜ëœ ìˆ˜ì •ì¢…ê°€ê°€ ë“¤ì–´ê°„ë‹¤. ë”°ë¼ì„œ <code>Close</code>ë§Œ ì‚¬ìš©í•˜ë©´ ëœë‹¤. ë˜í•œ ë‹¨ì¼ ì¢…ëª©ì„ ë‹¤ìš´ë¡œë“œí•´ë„ MultiIndex(Price, Ticker)ê°€ ë°˜í™˜ë˜ë¯€ë¡œ, <code>.squeeze()</code>ë¡œ Seriesë¡œ ë³€í™˜í•˜ëŠ” ê²ƒì´ í¸ë¦¬í•˜ë‹¤.</p>
</div>

<h3>2.3 ë‹¤ì–‘í•œ ë‹¤ìš´ë¡œë“œ ì˜µì…˜</h3>
<p>yfinanceëŠ” ê¸°ê°„, ê°„ê²©, ì—¬ëŸ¬ ì¢…ëª© ë™ì‹œ ë‹¤ìš´ë¡œë“œ ë“± ë‹¤ì–‘í•œ ì˜µì…˜ì„ ì œê³µí•œë‹¤.</p>

<pre><code><span class="cm"># 1. ê¸°ê°„ ì§€ì •: start/end ë‚ ì§œ</span>
df1 = yf.download(<span class="st">"005930.KS"</span>, start=<span class="st">"2020-01-01"</span>, end=<span class="st">"2024-12-31"</span>)
<span class="fn">print</span>(<span class="st">f"5ë…„ ë°ì´í„°: </span>{<span class="fn">len</span>(df1)}<span class="st">í–‰"</span>)

<span class="cm"># 2. period ì˜µì…˜ (ê°„í¸)</span>
<span class="cm"># "1d", "5d", "1mo", "3mo", "6mo", "1y", "2y", "5y", "10y", "ytd", "max"</span>
df2 = yf.download(<span class="st">"AAPL"</span>, period=<span class="st">"max"</span>)  <span class="cm"># ì „ì²´ ê¸°ê°„</span>
<span class="fn">print</span>(<span class="st">f"AAPL ì „ì²´: </span>{<span class="fn">len</span>(df2)}<span class="st">í–‰, </span>{df2.index[0].date()}<span class="st"> ~ </span>{df2.index[-1].date()}<span class="st">"</span>)

<span class="cm"># 3. ê°„ê²©(interval) ë³€ê²½ â€” ë¶„ë´‰, ì‹œê°„ë´‰</span>
<span class="cm"># "1m", "2m", "5m", "15m", "30m", "60m", "90m", "1h", "1d", "5d", "1wk", "1mo"</span>
df_hourly = yf.download(<span class="st">"AAPL"</span>, period=<span class="st">"5d"</span>, interval=<span class="st">"1h"</span>)
<span class="fn">print</span>(<span class="st">f"ì‹œê°„ë´‰: </span>{<span class="fn">len</span>(df_hourly)}<span class="st">í–‰"</span>)

<span class="cm"># 4. ì—¬ëŸ¬ ì¢…ëª© ë™ì‹œ ë‹¤ìš´ë¡œë“œ â€” ë§¤ìš° ì¤‘ìš”!</span>
tickers = [<span class="st">"005930.KS"</span>, <span class="st">"000660.KS"</span>, <span class="st">"035420.KS"</span>, <span class="st">"035720.KS"</span>, <span class="st">"373220.KS"</span>]
<span class="cm"># ì‚¼ì„±ì „ì, SKí•˜ì´ë‹‰ìŠ¤, NAVER, ì¹´ì¹´ì˜¤, LGì—ë„ˆì§€ì†”ë£¨ì…˜</span>
multi = yf.download(tickers, period=<span class="st">"1y"</span>)
<span class="fn">print</span>(<span class="st">f"ë©€í‹° Shape: </span>{multi.shape}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"ì»¬ëŸ¼ ë ˆë²¨: </span>{multi.columns.names}<span class="st">"</span>)  <span class="cm"># MultiIndex!</span>

<span class="cm"># ì¢…ê°€ë§Œ ì¶”ì¶œ (yfinance 1.0+: Closeê°€ ì´ë¯¸ ìˆ˜ì •ì¢…ê°€)</span>
close = multi[<span class="st">"Close"</span>]
<span class="fn">print</span>(close.head())</code></pre>

<p>ì—¬ëŸ¬ ì¢…ëª©ì„ ë™ì‹œì— ë‹¤ìš´ë¡œë“œí•˜ë©´ MultiIndex DataFrameì´ ë°˜í™˜ëœë‹¤. ì´ê²ƒì€ Pandasì˜ ê³ ê¸‰ ê¸°ëŠ¥ì¸ë°, ì‰½ê²Œ ë§í•˜ë©´ "ì»¬ëŸ¼ì´ 2ë‹¨ê³„"ì¸ í‘œë‹¤. ì²« ë²ˆì§¸ ë‹¨ê³„ê°€ ë°ì´í„° ì¢…ë¥˜(Open, High, ...), ë‘ ë²ˆì§¸ ë‹¨ê³„ê°€ ì¢…ëª© ì½”ë“œë‹¤.</p>

<!-- â”€â”€ ë³´ì¶© 2.3+ MultiIndex DataFrame ë‹¤ë£¨ê¸° â”€â”€ -->
<div class="def">
<p class="ni"><strong>ğŸ” ë³´ì¶©: MultiIndex DataFrame â€” ì´ˆë³´ìê°€ ê°€ì¥ í—·ê°ˆë¦¬ëŠ” ë¶€ë¶„</strong></p>
<p class="ni">ì—¬ëŸ¬ ì¢…ëª©ì„ ë™ì‹œì— ë‹¤ìš´ë¡œë“œí•˜ë©´ ì»¬ëŸ¼ì´ 2ë‹¨ê³„(MultiIndex)ë¡œ ë˜ì–´ ìˆì–´ì„œ ì²˜ìŒì— ë‹¹í™©í•  ìˆ˜ ìˆë‹¤. í•µì‹¬ íŒ¨í„´ì„ ì™¸ì›Œë‘ì:</p>
</div>

<pre><code><span class="cm"># MultiIndex DataFrame ë‹¤ë£¨ê¸° â€” í•µì‹¬ íŒ¨í„´</span>

<span class="cm"># 1. ì „ì²´ êµ¬ì¡° í™•ì¸</span>
<span class="fn">print</span>(<span class="st">"ì»¬ëŸ¼ ë ˆë²¨:"</span>, multi.columns.names)
<span class="cm"># [Price, Ticker] â€” 1ë‹¨ê³„: ê°€ê²©ì¢…ë¥˜, 2ë‹¨ê³„: ì¢…ëª©ì½”ë“œ</span>

<span class="fn">print</span>(<span class="st">"1ë‹¨ê³„ ê°’:"</span>, multi.columns.get_level_values(<span class="nu">0</span>).unique().tolist())
<span class="cm"># ['Close', 'High', 'Low', 'Open', 'Volume']  (yfinance 1.0+)</span>

<span class="cm"># 2. íŠ¹ì • ë°ì´í„° ì¢…ë¥˜ë§Œ ì¶”ì¶œ (ê°€ì¥ ë§ì´ ì“°ëŠ” íŒ¨í„´!)</span>
close = multi[<span class="st">"Close"</span>]  <span class="cm"># â†’ ì¼ë°˜ DataFrame (ë‚ ì§œ Ã— ì¢…ëª©)</span>
volume = multi[<span class="st">"Volume"</span>]        <span class="cm"># â†’ ì¼ë°˜ DataFrame (ë‚ ì§œ Ã— ì¢…ëª©)</span>

<span class="cm"># 3. íŠ¹ì • ì¢…ëª©ë§Œ ì¶”ì¶œ</span>
samsung_all = multi.xs(<span class="st">"005930.KS"</span>, level=<span class="nu">1</span>, axis=<span class="nu">1</span>)  <span class="cm"># ì‚¼ì„±ì „ì OHLCV</span>

<span class="cm"># 4. MultiIndex ì œê±° (ì»¬ëŸ¼ì„ ë‹¨ìˆœí•˜ê²Œ)</span>
close.columns = names  <span class="cm"># ì¢…ëª©ì½”ë“œ â†’ í•œê¸€ ì´ë¦„ìœ¼ë¡œ ë³€ê²½</span>
<span class="fn">print</span>(close.head(<span class="nu">3</span>))
<span class="cm"># ì´ì œ ì¼ë°˜ DataFrameì²˜ëŸ¼ ì‚¬ìš© ê°€ëŠ¥!</span>

<span class="cm"># 5. í”í•œ ì‹¤ìˆ˜: multi["005930.KS"] â†’ KeyError!</span>
<span class="cm"># 1ë‹¨ê³„ê°€ Priceì´ë¯€ë¡œ ì¢…ëª©ì½”ë“œë¡œ ì§ì ‘ ì ‘ê·¼ ë¶ˆê°€</span>
<span class="cm"># ë°˜ë“œì‹œ multi["Close"]["005930.KS"] ë˜ëŠ” xs() ì‚¬ìš©</span></code></pre>

<div class="info">
<p class="ni"><strong>ì‹¤ì „ íŒ: ë°ì´í„° ì €ì¥</strong></p>
<p class="ni">yfinanceëŠ” ë§¤ë²ˆ ì¸í„°ë„·ì—ì„œ ë°ì´í„°ë¥¼ ë‹¤ìš´ë¡œë“œí•œë‹¤. ê°™ì€ ë°ì´í„°ë¥¼ ë°˜ë³µí•´ì„œ ë°›ìœ¼ë©´ ì‹œê°„ë„ ë‚­ë¹„ë˜ê³ , Yahoo ì„œë²„ì— ë¶€ë‹´ì„ ì¤„ ìˆ˜ ìˆë‹¤. í•œ ë²ˆ ë°›ì€ ë°ì´í„°ëŠ” CSVë¡œ ì €ì¥í•´ë‘ì:</p>
</div>

<pre><code><span class="cm"># ë°ì´í„° ì €ì¥</span>
df.to_csv(<span class="st">"samsung_1y.csv"</span>)

<span class="cm"># ë‚˜ì¤‘ì— ë¶ˆëŸ¬ì˜¤ê¸°</span>
df_loaded = pd.read_csv(<span class="st">"samsung_1y.csv"</span>, index_col=<span class="nu">0</span>, parse_dates=<span class="kw">True</span>)
<span class="fn">print</span>(df_loaded.head())</code></pre>

<h3>2.4 ì¬ë¬´ì œí‘œ ë°ì´í„°</h3>
<p>yfinanceëŠ” ì£¼ê°€ë¿ ì•„ë‹ˆë¼ ì¬ë¬´ì œí‘œ ë°ì´í„°ë„ ì œê³µí•œë‹¤. ì´ê²ƒì€ ê¸°ë³¸ì  ë¶„ì„(fundamental analysis)ì˜ í•µì‹¬ ì¬ë£Œë‹¤.</p>

<pre><code>samsung = yf.Ticker(<span class="st">"005930.KS"</span>)

<span class="cm"># 1. ì†ìµê³„ì‚°ì„œ (Income Statement)</span>
income = samsung.financials
<span class="fn">print</span>(<span class="st">"=== ì†ìµê³„ì‚°ì„œ ==="</span>)
<span class="fn">print</span>(income.loc[[<span class="st">"Total Revenue"</span>, <span class="st">"Net Income"</span>]])

<span class="cm"># 2. ëŒ€ì°¨ëŒ€ì¡°í‘œ (Balance Sheet)</span>
balance = samsung.balance_sheet
<span class="fn">print</span>(<span class="st">"\n=== ëŒ€ì°¨ëŒ€ì¡°í‘œ ==="</span>)
<span class="fn">print</span>(balance.loc[[<span class="st">"Total Assets"</span>, <span class="st">"Total Debt"</span>]])

<span class="cm"># 3. í˜„ê¸ˆíë¦„í‘œ (Cash Flow Statement)</span>
cashflow = samsung.cashflow
<span class="fn">print</span>(<span class="st">"\n=== í˜„ê¸ˆíë¦„í‘œ ==="</span>)
<span class="fn">print</span>(cashflow.loc[[<span class="st">"Operating Cash Flow"</span>, <span class="st">"Free Cash Flow"</span>]])

<span class="cm"># 4. ë¶„ê¸°ë³„ ë°ì´í„°ë„ ê°€ëŠ¥</span>
quarterly_income = samsung.quarterly_financials
<span class="fn">print</span>(<span class="st">"\n=== ë¶„ê¸°ë³„ ë§¤ì¶œ ==="</span>)
<span class="fn">print</span>(quarterly_income.loc[<span class="st">"Total Revenue"</span>])</code></pre>

<p>ì¬ë¬´ì œí‘œ ë°ì´í„°ëŠ” MLì—ì„œ "ê¸°ë³¸ì  í”¼ì²˜(fundamental features)"ë¡œ ì‚¬ìš©ëœë‹¤. ì˜ˆë¥¼ ë“¤ì–´ PER(ì£¼ê°€ìˆ˜ìµë¹„ìœ¨), PBR(ì£¼ê°€ìˆœìì‚°ë¹„ìœ¨), ROE(ìê¸°ìë³¸ì´ìµë¥ ) ê°™ì€ ë°¸ë¥˜ì—ì´ì…˜ ì§€í‘œë¥¼ ê³„ì‚°í•  ìˆ˜ ìˆë‹¤. ì´ëŸ° ì§€í‘œë“¤ì€ Round 4ì—ì„œ ì§€ë„í•™ìŠµ ëª¨ë¸ì˜ ì…ë ¥ í”¼ì²˜ë¡œ í™œìš©í•  ê²ƒì´ë‹¤.</p>

<h3>2.5 ë°°ë‹¹ ë°ì´í„°ì™€ ì£¼ì‹ ë¶„í•  ì´ë ¥</h3>
<p>ë°°ë‹¹ê³¼ ì£¼ì‹ ë¶„í•  ë°ì´í„°ëŠ” ìˆ˜ì •ì¢…ê°€ë¥¼ ì´í•´í•˜ëŠ” ë° í•„ìˆ˜ì ì´ë‹¤.</p>

<pre><code><span class="cm"># ë°°ë‹¹ ì´ë ¥</span>
dividends = samsung.dividends
<span class="fn">print</span>(<span class="st">"=== ìµœê·¼ ë°°ë‹¹ ==="</span>)
<span class="fn">print</span>(dividends.tail(<span class="nu">10</span>))

<span class="cm"># ì£¼ì‹ ë¶„í•  ì´ë ¥</span>
splits = samsung.splits
<span class="fn">print</span>(<span class="st">"\n=== ì£¼ì‹ ë¶„í•  ==="</span>)
<span class="fn">print</span>(splits)  <span class="cm"># 2018-05-04: 50.0 (50:1 ë¶„í• )</span>

<span class="cm"># ë°°ë‹¹ìˆ˜ìµë¥  ê³„ì‚°</span>
<span class="kw">if</span> <span class="fn">len</span>(dividends) > <span class="nu">0</span>:
    annual_div = dividends.last(<span class="st">"1Y"</span>).sum()
    current_price = samsung.info.get(<span class="st">"currentPrice"</span>, <span class="nu">0</span>)
    <span class="kw">if</span> current_price > <span class="nu">0</span>:
        div_yield = annual_div / current_price * <span class="nu">100</span>
        <span class="fn">print</span>(<span class="st">f"\në°°ë‹¹ìˆ˜ìµë¥ : </span>{div_yield:.2f}<span class="st">%"</span>)</code></pre>

<h3>2.6 ì—¬ëŸ¬ ì¢…ëª© ìˆ˜ìµë¥  ê³„ì‚° â€” í¬íŠ¸í´ë¦¬ì˜¤ ë¶„ì„ì˜ ì‹œì‘</h3>
<p>Round 2ì—ì„œ ë°°ìš´ ë²¡í„°/í–‰ë ¬ ê°œë…ì´ ì—¬ê¸°ì„œ ì‹¤ì „ìœ¼ë¡œ ì—°ê²°ëœë‹¤. ì—¬ëŸ¬ ì¢…ëª©ì˜ ìˆ˜ìµë¥ ì„ í•œêº¼ë²ˆì— ê³„ì‚°í•˜ê³  ë¶„ì„í•˜ëŠ” ê²ƒì´ í¬íŠ¸í´ë¦¬ì˜¤ ë¶„ì„ì˜ ì¶œë°œì ì´ë‹¤.</p>

<pre><code><span class="cm"># 5ì¢…ëª© ìˆ˜ì •ì¢…ê°€ ë‹¤ìš´ë¡œë“œ</span>
tickers = [<span class="st">"005930.KS"</span>, <span class="st">"000660.KS"</span>, <span class="st">"035420.KS"</span>, <span class="st">"035720.KS"</span>, <span class="st">"373220.KS"</span>]
names = [<span class="st">"ì‚¼ì„±ì „ì"</span>, <span class="st">"SKí•˜ì´ë‹‰ìŠ¤"</span>, <span class="st">"NAVER"</span>, <span class="st">"ì¹´ì¹´ì˜¤"</span>, <span class="st">"LGì—ë„ˆì§€"</span>]

data = yf.download(tickers, period=<span class="st">"2y"</span>)[<span class="st">"Close"</span>]
data.columns = names  <span class="cm"># ì»¬ëŸ¼ëª…ì„ í•œê¸€ë¡œ ë³€ê²½</span>

<span class="cm"># ì¼ê°„ ìˆ˜ìµë¥  ê³„ì‚° (ë¡œê·¸ ìˆ˜ìµë¥ )</span>
log_returns = np.log(data / data.shift(<span class="nu">1</span>)).dropna()
<span class="fn">print</span>(<span class="st">"=== ì¼ê°„ ë¡œê·¸ìˆ˜ìµë¥  (ì²˜ìŒ 5í–‰) ==="</span>)
<span class="fn">print</span>(log_returns.head())

<span class="cm"># ê¸°ì´ˆ í†µê³„</span>
<span class="fn">print</span>(<span class="st">"\n=== ì—°í™˜ì‚° í†µê³„ ==="</span>)
annual_return = log_returns.mean() * <span class="nu">252</span>
annual_vol = log_returns.std() * np.sqrt(<span class="nu">252</span>)
sharpe = annual_return / annual_vol

stats = pd.DataFrame({
    <span class="st">"ì—°ìˆ˜ìµë¥ "</span>: annual_return,
    <span class="st">"ì—°ë³€ë™ì„±"</span>: annual_vol,
    <span class="st">"ìƒ¤í”„ë¹„ìœ¨"</span>: sharpe
})
<span class="fn">print</span>(stats.round(<span class="nu">4</span>))

<span class="cm"># ëˆ„ì ìˆ˜ìµë¥  ì‹œê°í™”</span>
cumulative = (log_returns.cumsum()).apply(np.exp)
cumulative.plot(figsize=(<span class="nu">12</span>, <span class="nu">6</span>), title=<span class="st">"5ì¢…ëª© ëˆ„ì ìˆ˜ìµë¥ "</span>)
plt.ylabel(<span class="st">"ëˆ„ì ìˆ˜ìµë¥  (1 = 100%)"</span>)
plt.legend(loc=<span class="st">"best"</span>)
plt.grid(<span class="kw">True</span>, alpha=<span class="nu">0.3</span>)
plt.tight_layout()
plt.show()</code></pre>

<div class="warn">
<p class="ni"><strong>ë¡œê·¸ ìˆ˜ìµë¥  vs ë‹¨ìˆœ ìˆ˜ìµë¥ :</strong> ê¸ˆìœµ MLì—ì„œëŠ” ë¡œê·¸ ìˆ˜ìµë¥  \(r_t = \ln(P_t / P_{t-1})\)ì„ ì£¼ë¡œ ì‚¬ìš©í•œë‹¤. ì´ìœ ëŠ” ì„¸ ê°€ì§€ë‹¤: (1) ì‹œê°„ ê°€ì‚°ì„± â€” ì—¬ëŸ¬ ê¸°ê°„ì˜ ë¡œê·¸ ìˆ˜ìµë¥ ì„ ë”í•˜ë©´ ì „ì²´ ê¸°ê°„ ìˆ˜ìµë¥ ì´ ëœë‹¤, (2) ì •ê·œë¶„í¬ì— ë” ê°€ê¹Œì›€, (3) ìˆ˜í•™ì ìœ¼ë¡œ ë‹¤ë£¨ê¸° í¸í•¨. ë‹¨ìˆœ ìˆ˜ìµë¥  \(R_t = (P_t - P_{t-1})/P_{t-1}\)ì€ ì§ê´€ì ì´ì§€ë§Œ ì´ëŸ° ì„±ì§ˆì´ ì—†ë‹¤.</p>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- Ch3: FRED & ê±°ì‹œê²½ì œ ë°ì´í„° -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<h2 id="ch3">3. FRED &amp; ê±°ì‹œê²½ì œ ë°ì´í„° â€” ì‹œì¥ì˜ í° ê·¸ë¦¼</h2>

<h3>3.1 ì™œ ê±°ì‹œê²½ì œ ë°ì´í„°ê°€ í•„ìš”í•œê°€</h3>
<p>ì£¼ê°€ëŠ” ì§„ê³µ ì†ì—ì„œ ì›€ì§ì´ì§€ ì•ŠëŠ”ë‹¤. ê¸ˆë¦¬ê°€ ì˜¤ë¥´ë©´ ì„±ì¥ì£¼ê°€ í•˜ë½í•˜ê³ , ì¸í”Œë ˆì´ì…˜ì´ ë†’ì•„ì§€ë©´ ì›ìì¬ ê´€ë ¨ì£¼ê°€ ìƒìŠ¹í•˜ê³ , ì‹¤ì—…ë¥ ì´ ì¹˜ì†Ÿìœ¼ë©´ ì†Œë¹„ì¬ ì£¼ì‹ì´ íƒ€ê²©ì„ ë°›ëŠ”ë‹¤. ì´ëŸ° ê±°ì‹œê²½ì œ ë³€ìˆ˜ë“¤ì€ ê°œë³„ ì¢…ëª©ì˜ ìˆ˜ìµë¥ ì— ê°•ë ¥í•œ ì˜í–¥ì„ ë¯¸ì¹œë‹¤.</p>

<p>ML ëª¨ë¸ì— ê±°ì‹œê²½ì œ ë°ì´í„°ë¥¼ í”¼ì²˜ë¡œ ë„£ìœ¼ë©´, ëª¨ë¸ì´ "ì‹œì¥ì˜ í° ê·¸ë¦¼"ì„ ì´í•´í•  ìˆ˜ ìˆê²Œ ëœë‹¤. ì˜ˆë¥¼ ë“¤ì–´ "ê¸ˆë¦¬ê°€ ê¸‰ë“±í•˜ëŠ” í™˜ê²½ì—ì„œ ì´ ì¢…ëª©ì´ ì–´ë–»ê²Œ ë°˜ì‘í•˜ëŠ”ê°€"ë¥¼ í•™ìŠµí•  ìˆ˜ ìˆë‹¤.</p>

<h3>3.2 FREDë€?</h3>
<p>FRED(Federal Reserve Economic Data)ëŠ” ë¯¸êµ­ ì—°ë°©ì¤€ë¹„ì€í–‰(ì„¸ì¸íŠ¸ë£¨ì´ìŠ¤ ì—°ì€)ì´ ìš´ì˜í•˜ëŠ” ë¬´ë£Œ ê²½ì œ ë°ì´í„°ë² ì´ìŠ¤ë‹¤. 81ë§Œ ê°œ ì´ìƒì˜ ì‹œê³„ì—´ ë°ì´í„°ë¥¼ ì œê³µí•˜ë©°, ë¯¸êµ­ë¿ ì•„ë‹ˆë¼ ì „ ì„¸ê³„ ê²½ì œ ë°ì´í„°ë¥¼ í¬í•¨í•œë‹¤. ê¸ˆìœµ MLì—ì„œ ê°€ì¥ ë§ì´ ì‚¬ìš©ë˜ëŠ” ê±°ì‹œê²½ì œ ë°ì´í„° ì†ŒìŠ¤ë‹¤.</p>

<pre><code><span class="cm"># pandas-datareader ì„¤ì¹˜</span>
<span class="cm"># pip install pandas-datareader</span>

<span class="kw">import</span> pandas_datareader.data <span class="kw">as</span> web
<span class="kw">from</span> datetime <span class="kw">import</span> datetime

start = datetime(<span class="nu">2015</span>, <span class="nu">1</span>, <span class="nu">1</span>)
end = datetime(<span class="nu">2025</span>, <span class="nu">12</span>, <span class="nu">31</span>)

<span class="cm"># 1. ë¯¸êµ­ 10ë…„ êµ­ì±„ ê¸ˆë¦¬ (ê°€ì¥ ì¤‘ìš”í•œ ê±°ì‹œ ë³€ìˆ˜ ì¤‘ í•˜ë‚˜)</span>
us10y = web.DataReader(<span class="st">"DGS10"</span>, <span class="st">"fred"</span>, start, end)
<span class="fn">print</span>(<span class="st">"=== ë¯¸êµ­ 10ë…„ êµ­ì±„ ê¸ˆë¦¬ ==="</span>)
<span class="fn">print</span>(us10y.tail())

<span class="cm"># 2. ë¯¸êµ­ ì—°ë°©ê¸°ê¸ˆê¸ˆë¦¬ (Fed Funds Rate)</span>
fed_rate = web.DataReader(<span class="st">"FEDFUNDS"</span>, <span class="st">"fred"</span>, start, end)

<span class="cm"># 3. ì†Œë¹„ìë¬¼ê°€ì§€ìˆ˜ (CPI) â€” ì¸í”Œë ˆì´ì…˜ ì¸¡ì •</span>
cpi = web.DataReader(<span class="st">"CPIAUCSL"</span>, <span class="st">"fred"</span>, start, end)

<span class="cm"># 4. ì‹¤ì—…ë¥ </span>
unemployment = web.DataReader(<span class="st">"UNRATE"</span>, <span class="st">"fred"</span>, start, end)

<span class="cm"># 5. VIX (ê³µí¬ì§€ìˆ˜) â€” yfinanceë¡œë„ ê°€ëŠ¥</span>
vix = yf.download(<span class="st">"^VIX"</span>, start=<span class="st">"2015-01-01"</span>)[<span class="st">"Close"</span>]

<span class="cm"># ì—¬ëŸ¬ ê±°ì‹œ ë³€ìˆ˜ë¥¼ í•˜ë‚˜ì˜ DataFrameìœ¼ë¡œ í•©ì¹˜ê¸°</span>
macro = pd.DataFrame({
    <span class="st">"US10Y"</span>: us10y[<span class="st">"DGS10"</span>],
    <span class="st">"FedRate"</span>: fed_rate[<span class="st">"FEDFUNDS"</span>],
    <span class="st">"CPI"</span>: cpi[<span class="st">"CPIAUCSL"</span>],
    <span class="st">"Unemployment"</span>: unemployment[<span class="st">"UNRATE"</span>]
})
<span class="fn">print</span>(<span class="st">"\n=== ê±°ì‹œê²½ì œ ë°ì´í„° ==="</span>)
<span class="fn">print</span>(macro.tail())</code></pre>

<div class="tc">Table 3. ê¸ˆìœµ MLì—ì„œ ìì£¼ ì‚¬ìš©í•˜ëŠ” FRED ì‹œë¦¬ì¦ˆ</div>
<table>
<tr><th>FRED ì½”ë“œ</th><th>ë°ì´í„°</th><th>ë¹ˆë„</th><th>ê¸ˆìœµ ML ìš©ë„</th></tr>
<tr><td><code>DGS10</code></td><td>ë¯¸êµ­ 10ë…„ êµ­ì±„ ê¸ˆë¦¬</td><td>ì¼ê°„</td><td>í• ì¸ìœ¨, ì„±ì¥ì£¼ ë°¸ë¥˜ì—ì´ì…˜</td></tr>
<tr><td><code>DGS2</code></td><td>ë¯¸êµ­ 2ë…„ êµ­ì±„ ê¸ˆë¦¬</td><td>ì¼ê°„</td><td>ì¥ë‹¨ê¸° ê¸ˆë¦¬ì°¨ (yield curve)</td></tr>
<tr><td><code>FEDFUNDS</code></td><td>ì—°ë°©ê¸°ê¸ˆê¸ˆë¦¬</td><td>ì›”ê°„</td><td>í†µí™”ì •ì±… ë°©í–¥</td></tr>
<tr><td><code>CPIAUCSL</code></td><td>ì†Œë¹„ìë¬¼ê°€ì§€ìˆ˜</td><td>ì›”ê°„</td><td>ì¸í”Œë ˆì´ì…˜</td></tr>
<tr><td><code>UNRATE</code></td><td>ì‹¤ì—…ë¥ </td><td>ì›”ê°„</td><td>ê²½ê¸° ì‚¬ì´í´</td></tr>
<tr><td><code>GDP</code></td><td>ì‹¤ì§ˆ GDP</td><td>ë¶„ê¸°</td><td>ê²½ì œ ì„±ì¥ë¥ </td></tr>
<tr><td><code>DEXKOUS</code></td><td>ì›/ë‹¬ëŸ¬ í™˜ìœ¨</td><td>ì¼ê°„</td><td>ìˆ˜ì¶œê¸°ì—… ì˜í–¥</td></tr>
<tr><td><code>T10Y2Y</code></td><td>10ë…„-2ë…„ ê¸ˆë¦¬ì°¨</td><td>ì¼ê°„</td><td>ê²½ê¸°ì¹¨ì²´ ì˜ˆì¸¡ (ì—­ì „ ì‹œ ìœ„í—˜)</td></tr>
</table>

<h3>3.3 ì¥ë‹¨ê¸° ê¸ˆë¦¬ì°¨ â€” ê²½ê¸°ì¹¨ì²´ì˜ ì˜ˆì–¸ì</h3>
<p>ì¥ë‹¨ê¸° ê¸ˆë¦¬ì°¨(yield spread)ëŠ” 10ë…„ êµ­ì±„ ê¸ˆë¦¬ì—ì„œ 2ë…„ êµ­ì±„ ê¸ˆë¦¬ë¥¼ ëº€ ê°’ì´ë‹¤. ì´ ê°’ì´ ìŒìˆ˜(ì—­ì „)ê°€ ë˜ë©´ ì—­ì‚¬ì ìœ¼ë¡œ 1~2ë…„ ë‚´ì— ê²½ê¸°ì¹¨ì²´ê°€ ì™”ë‹¤. 1970ë…„ ì´í›„ ë¯¸êµ­ì˜ ëª¨ë“  ê²½ê¸°ì¹¨ì²´ë¥¼ ì˜ˆì¸¡í•œ ë†€ë¼ìš´ ì§€í‘œë‹¤.</p>

<pre><code><span class="cm"># ì¥ë‹¨ê¸° ê¸ˆë¦¬ì°¨ ì§ì ‘ ê³„ì‚°</span>
us10y = web.DataReader(<span class="st">"DGS10"</span>, <span class="st">"fred"</span>, start, end)
us2y = web.DataReader(<span class="st">"DGS2"</span>, <span class="st">"fred"</span>, start, end)

spread = us10y[<span class="st">"DGS10"</span>] - us2y[<span class="st">"DGS2"</span>]
spread = spread.dropna()

<span class="cm"># ë˜ëŠ” FREDì—ì„œ ì§ì ‘ ê°€ì ¸ì˜¤ê¸°</span>
spread_fred = web.DataReader(<span class="st">"T10Y2Y"</span>, <span class="st">"fred"</span>, start, end)

<span class="cm"># ì‹œê°í™”</span>
fig, ax = plt.subplots(figsize=(<span class="nu">14</span>, <span class="nu">5</span>))
ax.plot(spread.index, spread.values, color=<span class="st">"navy"</span>, linewidth=<span class="nu">1</span>)
ax.axhline(y=<span class="nu">0</span>, color=<span class="st">"red"</span>, linestyle=<span class="st">"--"</span>, linewidth=<span class="nu">1.5</span>, label=<span class="st">"ì—­ì „ì„  (0%)"</span>)
ax.fill_between(spread.index, spread.values, <span class="nu">0</span>,
                where=(spread.values < <span class="nu">0</span>), color=<span class="st">"red"</span>, alpha=<span class="nu">0.3</span>, label=<span class="st">"ì—­ì „ êµ¬ê°„"</span>)
ax.set_title(<span class="st">"10Y-2Y Treasury Spread (Yield Curve)"</span>, fontsize=<span class="nu">14</span>)
ax.set_ylabel(<span class="st">"Spread (%)"</span>)
ax.legend()
ax.grid(<span class="kw">True</span>, alpha=<span class="nu">0.3</span>)
plt.tight_layout()
plt.show()</code></pre>

<p>ì´ ì¥ë‹¨ê¸° ê¸ˆë¦¬ì°¨ëŠ” ë‚˜ì¤‘ì— ML ëª¨ë¸ì˜ ê°•ë ¥í•œ í”¼ì²˜ê°€ ëœë‹¤. "ê¸ˆë¦¬ ì—­ì „ì´ ë°œìƒí•œ í›„ ì£¼ì‹ ì‹œì¥ì´ ì–´ë–»ê²Œ ë°˜ì‘í•˜ëŠ”ê°€"ë¥¼ ëª¨ë¸ì´ í•™ìŠµí•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì´ë‹¤.</p>

<h3>3.4 ë¹ˆë„ê°€ ë‹¤ë¥¸ ë°ì´í„° í•©ì¹˜ê¸° â€” ë¦¬ìƒ˜í”Œë§</h3>
<p>ê±°ì‹œê²½ì œ ë°ì´í„°ì˜ ê°€ì¥ í° ë¬¸ì œëŠ” ë¹ˆë„(frequency)ê°€ ë‹¤ë¥´ë‹¤ëŠ” ê²ƒì´ë‹¤. ì£¼ê°€ëŠ” ì¼ê°„(daily), ê¸ˆë¦¬ë„ ì¼ê°„ì´ì§€ë§Œ, CPIëŠ” ì›”ê°„(monthly), GDPëŠ” ë¶„ê¸°(quarterly)ë‹¤. ì´ê²ƒë“¤ì„ í•˜ë‚˜ì˜ í…Œì´ë¸”ë¡œ í•©ì¹˜ë ¤ë©´ ë¦¬ìƒ˜í”Œë§(resampling)ì´ í•„ìš”í•˜ë‹¤.</p>

<pre><code><span class="cm"># ë¬¸ì œ: ì£¼ê°€ëŠ” ì¼ê°„, CPIëŠ” ì›”ê°„ â†’ ì–´ë–»ê²Œ í•©ì¹ ê¹Œ?</span>

<span class="cm"># ë°©ë²• 1: ì›”ê°„ ë°ì´í„°ë¥¼ ì¼ê°„ìœ¼ë¡œ í™•ì¥ (forward fill)</span>
<span class="cm"># "ì´ë²ˆ ë‹¬ CPIê°€ ë°œí‘œë  ë•Œê¹Œì§€ ì§€ë‚œ ë‹¬ ê°’ì„ ì‚¬ìš©í•œë‹¤"</span>
cpi_daily = cpi.resample(<span class="st">"D"</span>).ffill()  <span class="cm"># ì¼ê°„ìœ¼ë¡œ í™•ì¥</span>
<span class="fn">print</span>(<span class="st">"ì›”ê°„ â†’ ì¼ê°„ (ffill):"</span>)
<span class="fn">print</span>(cpi_daily.head(<span class="nu">10</span>))

<span class="cm"># ë°©ë²• 2: ì¼ê°„ ë°ì´í„°ë¥¼ ì›”ê°„ìœ¼ë¡œ ì¶•ì†Œ</span>
<span class="cm"># ì£¼ê°€ì˜ ì›”ë§ ì¢…ê°€ë§Œ ì‚¬ìš©</span>
monthly_close = data.resample(<span class="st">"M"</span>).last()  <span class="cm"># ì›”ë§ ê°’</span>
monthly_return = data.resample(<span class="st">"M"</span>).last().pct_change()  <span class="cm"># ì›”ê°„ ìˆ˜ìµë¥ </span>
<span class="fn">print</span>(<span class="st">"\nì¼ê°„ â†’ ì›”ê°„ (ì›”ë§ ì¢…ê°€):"</span>)
<span class="fn">print</span>(monthly_close.head())

<span class="cm"># ë°©ë²• 3: merge_asof â€” ê°€ì¥ ê°€ê¹Œìš´ ë‚ ì§œë¡œ ë§¤ì¹­</span>
<span class="cm"># ê±°ë˜ì¼ì´ ì•„ë‹Œ ë‚ (ì£¼ë§, ê³µíœ´ì¼)ì˜ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•  ë•Œ ìœ ìš©</span>
stock_daily = data[[<span class="st">"ì‚¼ì„±ì „ì"</span>]].reset_index()
macro_daily = us10y.reset_index()

merged = pd.merge_asof(
    stock_daily.sort_values(<span class="st">"Date"</span>),
    macro_daily.sort_values(<span class="st">"DATE"</span>),
    left_on=<span class="st">"Date"</span>,
    right_on=<span class="st">"DATE"</span>,
    direction=<span class="st">"backward"</span>  <span class="cm"># ê³¼ê±° ê°€ì¥ ê°€ê¹Œìš´ ê°’ ì‚¬ìš©</span>
)
<span class="fn">print</span>(<span class="st">"\nmerge_asof ê²°ê³¼:"</span>)
<span class="fn">print</span>(merged.head())</code></pre>

<div class="warn">
<p class="ni"><strong>Look-Ahead Bias ì£¼ì˜!</strong> ê±°ì‹œê²½ì œ ë°ì´í„°ë¥¼ í•©ì¹  ë•Œ ê°€ì¥ ìœ„í—˜í•œ ì‹¤ìˆ˜ëŠ” ë¯¸ë˜ ì •ë³´ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ë‹¤. ì˜ˆë¥¼ ë“¤ì–´ 1ì›”ì˜ CPIëŠ” 2ì›” ì¤‘ìˆœì— ë°œí‘œëœë‹¤. ë”°ë¼ì„œ 1ì›”ì˜ ì£¼ê°€ ì˜ˆì¸¡ì— 1ì›” CPIë¥¼ ì‚¬ìš©í•˜ë©´ ì•ˆ ëœë‹¤ â€” ê·¸ ì‹œì ì—ëŠ” ì•„ì§ ë°œí‘œë˜ì§€ ì•Šì•˜ìœ¼ë‹ˆê¹Œ. <code>ffill()</code>(forward fill)ì„ ì‚¬ìš©í•˜ë©´ "ê°€ì¥ ìµœê·¼ì— ë°œí‘œëœ ê°’"ì„ ì‚¬ìš©í•˜ê²Œ ë˜ì–´ ì´ ë¬¸ì œë¥¼ ìì—°ìŠ¤ëŸ½ê²Œ í•´ê²°í•œë‹¤.</p>
</div>

<!-- â”€â”€ ë³´ì¶© 3.4+ FRED ë°ì´í„° ì£¼ê¸° ë¶ˆì¼ì¹˜ ë¬¸ì œ â”€â”€ -->
<div class="def">
<p class="ni"><strong>ğŸ” ë³´ì¶©: FRED ë°ì´í„° ì£¼ê¸° ë¶ˆì¼ì¹˜ â€” "ì™œ ì´ê²Œ ë¬¸ì œì¸ê°€" ì™„ì „ ì •ë³µ</strong></p>
<p class="ni">FREDì—ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ë©´ ì£¼ê¸°(frequency)ê°€ ì œê°ê°ì´ë‹¤. ì´ê²ƒì„ ë¬´ì‹œí•˜ê³  ê·¸ëƒ¥ í•©ì¹˜ë©´ NaN í­íƒ„ì´ í„°ì§„ë‹¤. êµ¬ì²´ì ìœ¼ë¡œ ì–´ë–¤ ì¼ì´ ë²Œì–´ì§€ëŠ”ì§€ ë³´ì:</p>
</div>

<pre><code><span class="cm"># === FRED ë°ì´í„° ì£¼ê¸° ë¶ˆì¼ì¹˜ ë¬¸ì œ ì‹œë®¬ë ˆì´ì…˜ ===</span>
<span class="kw">import</span> pandas <span class="kw">as</span> pd
<span class="kw">import</span> numpy <span class="kw">as</span> np

<span class="cm"># 1. ì„¸ ê°€ì§€ ì£¼ê¸°ì˜ ë°ì´í„° ìƒì„± (ì‹¤ì œ FRED ìƒí™© ì¬í˜„)</span>
dates_daily = pd.date_range(<span class="st">"2024-01-01"</span>, <span class="st">"2024-03-31"</span>, freq=<span class="st">"B"</span>)  <span class="cm"># ì˜ì—…ì¼ (ì•½ 63ì¼)</span>
dates_monthly = pd.date_range(<span class="st">"2024-01-01"</span>, <span class="st">"2024-03-31"</span>, freq=<span class="st">"MS"</span>)  <span class="cm"># ì›”ì´ˆ (3ê°œ)</span>
dates_quarterly = pd.date_range(<span class="st">"2024-01-01"</span>, <span class="st">"2024-03-31"</span>, freq=<span class="st">"QS"</span>)  <span class="cm"># ë¶„ê¸°ì´ˆ (1ê°œ)</span>

stock_price = pd.Series(np.random.normal(<span class="nu">70000</span>, <span class="nu">2000</span>, <span class="fn">len</span>(dates_daily)),
                        index=dates_daily, name=<span class="st">"ì£¼ê°€"</span>)
cpi_monthly = pd.Series([<span class="nu">310.1</span>, <span class="nu">311.0</span>, <span class="nu">311.8</span>],
                        index=dates_monthly, name=<span class="st">"CPI"</span>)
gdp_quarterly = pd.Series([<span class="nu">27.9</span>],
                          index=dates_quarterly, name=<span class="st">"GDP(ì¡°ë‹¬ëŸ¬)"</span>)

<span class="fn">print</span>(<span class="st">"ì£¼ê°€: "</span>, <span class="fn">len</span>(stock_price), <span class="st">"í–‰ (ì¼ê°„)"</span>)
<span class="fn">print</span>(<span class="st">"CPI: "</span>, <span class="fn">len</span>(cpi_monthly), <span class="st">"í–‰ (ì›”ê°„)"</span>)
<span class="fn">print</span>(<span class="st">"GDP: "</span>, <span class="fn">len</span>(gdp_quarterly), <span class="st">"í–‰ (ë¶„ê¸°)"</span>)

<span class="cm"># 2. ì˜ëª»ëœ ë°©ë²•: ê·¸ëƒ¥ concat â†’ NaN í­íƒ„!</span>
wrong = pd.concat([stock_price, cpi_monthly, gdp_quarterly], axis=<span class="nu">1</span>)
<span class="fn">print</span>(<span class="st">"\n=== ì˜ëª»ëœ í•©ì¹˜ê¸° (NaN í­íƒ„) ==="</span>)
<span class="fn">print</span>(wrong.head(<span class="nu">10</span>))
<span class="fn">print</span>(<span class="st">f"NaN ë¹„ìœ¨: CPI </span>{wrong[<span class="st">'CPI'</span>].isna().mean():.0%}<span class="st">, GDP </span>{wrong[<span class="st">'GDP(ì¡°ë‹¬ëŸ¬)'</span>].isna().mean():.0%}<span class="st">"</span>)
<span class="cm"># CPI: 95% NaN, GDP: 98% NaN â†’ ì‚¬ì‹¤ìƒ ì‚¬ìš© ë¶ˆê°€!</span></code></pre>

<pre><code><span class="cm"># 3. ì˜¬ë°”ë¥¸ ë°©ë²•: reindex + ffill</span>
<span class="cm"># "ì›”ê°„/ë¶„ê¸° ë°ì´í„°ë¥¼ ì¼ê°„ ì¸ë±ìŠ¤ì— ë§ì¶”ê³ , ë°œí‘œ ì „ê¹Œì§€ ì´ì „ ê°’ ìœ ì§€"</span>

<span class="cm"># Step 1: ì¼ê°„ ì¸ë±ìŠ¤ ê¸°ì¤€ìœ¼ë¡œ reindex</span>
cpi_aligned = cpi_monthly.reindex(dates_daily)
gdp_aligned = gdp_quarterly.reindex(dates_daily)

<span class="fn">print</span>(<span class="st">"=== reindex ì§í›„ (ëŒ€ë¶€ë¶„ NaN) ==="</span>)
<span class="fn">print</span>(cpi_aligned.head(<span class="nu">5</span>))
<span class="cm"># 2024-01-01    310.1  â† ë°œí‘œì¼ë§Œ ê°’ì´ ìˆìŒ</span>
<span class="cm"># 2024-01-02      NaN</span>
<span class="cm"># 2024-01-03      NaN</span>

<span class="cm"># Step 2: ffillë¡œ ë¹ˆ ì¹¸ ì±„ìš°ê¸°</span>
cpi_aligned = cpi_aligned.ffill()
gdp_aligned = gdp_aligned.ffill()

<span class="fn">print</span>(<span class="st">"\n=== ffill í›„ (ê¹”ë”!) ==="</span>)
<span class="fn">print</span>(cpi_aligned.head(<span class="nu">5</span>))
<span class="cm"># 2024-01-01    310.1</span>
<span class="cm"># 2024-01-02    310.1  â† ìƒˆ ë°œí‘œ ì „ê¹Œì§€ ì´ì „ ê°’ ìœ ì§€</span>
<span class="cm"># 2024-01-03    310.1</span>

<span class="cm"># Step 3: ê¹”ë”í•˜ê²Œ í•©ì¹˜ê¸°</span>
correct = pd.DataFrame({
    <span class="st">"ì£¼ê°€"</span>: stock_price,
    <span class="st">"CPI"</span>: cpi_aligned,
    <span class="st">"GDP"</span>: gdp_aligned
})
<span class="fn">print</span>(<span class="st">"\n=== ì˜¬ë°”ë¥¸ í•©ì¹˜ê¸° ==="</span>)
<span class="fn">print</span>(correct.head(<span class="nu">10</span>))
<span class="fn">print</span>(<span class="st">f"NaN ë¹„ìœ¨: CPI </span>{correct[<span class="st">'CPI'</span>].isna().mean():.0%}<span class="st">, GDP </span>{correct[<span class="st">'GDP'</span>].isna().mean():.0%}<span class="st">"</span>)
<span class="cm"># CPI: 0%, GDP: 0% â†’ ì™„ë²½!</span></code></pre>

<pre><code><span class="cm"># 4. ì‹¤ì „ íŒ¨í„´: resampleë¡œ ì£¼ê¸° ë³€í™˜</span>

<span class="cm"># ì¼ê°„ â†’ ì›”ê°„ (ì¶•ì†Œ): ë‹¤ì–‘í•œ ì§‘ê³„ ë°©ë²•</span>
monthly_last = stock_price.resample(<span class="st">"M"</span>).last()    <span class="cm"># ì›”ë§ ì¢…ê°€</span>
monthly_mean = stock_price.resample(<span class="st">"M"</span>).mean()    <span class="cm"># ì›” í‰ê· ê°€</span>
monthly_max = stock_price.resample(<span class="st">"M"</span>).max()      <span class="cm"># ì›” ìµœê³ ê°€</span>
monthly_vol = stock_price.pct_change().resample(<span class="st">"M"</span>).std()  <span class="cm"># ì›”ê°„ ë³€ë™ì„±</span>

<span class="fn">print</span>(<span class="st">"=== ì¼ê°„ â†’ ì›”ê°„ ë³€í™˜ ==="</span>)
summary = pd.DataFrame({
    <span class="st">"ì›”ë§ì¢…ê°€"</span>: monthly_last,
    <span class="st">"ì›”í‰ê· "</span>: monthly_mean,
    <span class="st">"ì›”ìµœê³ "</span>: monthly_max,
    <span class="st">"ì›”ë³€ë™ì„±"</span>: monthly_vol
})
<span class="fn">print</span>(summary.round(<span class="nu">0</span>))

<span class="cm"># ì›”ê°„ â†’ ì¼ê°„ (í™•ì¥): ffillì´ í•µì‹¬</span>
<span class="cm"># "ì´ë²ˆ ë‹¬ CPIê°€ ë‚˜ì˜¬ ë•Œê¹Œì§€ ì§€ë‚œ ë‹¬ ê°’ì„ ì“´ë‹¤"</span>
cpi_expanded = cpi_monthly.resample(<span class="st">"D"</span>).ffill()
<span class="fn">print</span>(<span class="st">f"\nì›”ê°„ CPI â†’ ì¼ê°„ í™•ì¥: </span>{<span class="fn">len</span>(cpi_expanded)}<span class="st">í–‰"</span>)</code></pre>

<div class="warn">
<p class="ni"><strong>í•µì‹¬ ê·œì¹™ 3ê°€ì§€:</strong></p>
<ul>
<li><strong>ì¶•ì†Œ(ì¼ê°„â†’ì›”ê°„):</strong> <code>resample("M").last()</code> ë˜ëŠ” <code>.mean()</code> â€” ì •ë³´ë¥¼ ìš”ì•½í•œë‹¤</li>
<li><strong>í™•ì¥(ì›”ê°„â†’ì¼ê°„):</strong> <code>reindex(daily_index).ffill()</code> â€” ë¹ˆ ì¹¸ì„ ì´ì „ ê°’ìœ¼ë¡œ ì±„ìš´ë‹¤</li>
<li><strong>Look-Ahead Bias ë°©ì§€:</strong> ë°˜ë“œì‹œ <code>ffill()</code>ì„ ì‚¬ìš©. <code>bfill()</code>(ë¯¸ë˜ ê°’ìœ¼ë¡œ ì±„ì›€)ì´ë‚˜ <code>interpolate()</code>(ì•ë’¤ ê°’ í‰ê· )ëŠ” ë¯¸ë˜ ì •ë³´ë¥¼ ì‚¬ìš©í•˜ë¯€ë¡œ ê¸ˆì§€!</li>
</ul>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- Ch4: ë°ì´í„° ì •ì œì˜ ê¸°ìˆ  -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<h2 id="ch4">4. ë°ì´í„° ì •ì œì˜ ê¸°ìˆ  â€” ë”ëŸ¬ìš´ ë°ì´í„°ë¥¼ ê¹¨ë—í•˜ê²Œ</h2>

<!-- ë°ì´í„° ì •ì œ ì˜ì‚¬ê²°ì • í”Œë¡œìš°ì°¨íŠ¸ (CSS) -->
<div style="margin:25px 0;padding:25px;background:linear-gradient(135deg,#f8f9fa,#fdf5e6);border-radius:10px;border:1px solid #ccc">
<p class="ni" style="text-align:center;font-weight:bold;font-size:15px;margin-bottom:18px;color:#2c3e50">ğŸ§¹ ë°ì´í„° ì •ì œ ì˜ì‚¬ê²°ì • íŠ¸ë¦¬</p>
<div style="display:flex;flex-direction:column;gap:10px;font-size:12px;max-width:700px;margin:0 auto">
<div style="text-align:center">
<div style="display:inline-block;background:#2c3e50;color:#fff;padding:10px 20px;border-radius:8px;font-weight:bold">ì›ì‹œ ë°ì´í„° (Raw Data)</div>
</div>
<div style="text-align:center;color:#888">â†“</div>
<div style="display:flex;gap:8px;justify-content:center;flex-wrap:wrap">
<div style="flex:1;min-width:200px;background:#fff;border:2px solid #e74c3c;border-radius:8px;padding:12px;text-align:center">
<div style="font-weight:bold;color:#e74c3c;margin-bottom:6px">â‘  íƒ€ì… í™•ì¸</div>
<div style="color:#555;font-size:11px">ë‚ ì§œê°€ ë¬¸ìì—´? ìˆ«ìì— ì‰¼í‘œ?</div>
<div style="margin-top:6px;background:#fde8e8;padding:4px 8px;border-radius:4px;font-size:11px"><code>pd.to_datetime()</code>, <code>pd.to_numeric()</code></div>
</div>
<div style="flex:1;min-width:200px;background:#fff;border:2px solid #e67e22;border-radius:8px;padding:12px;text-align:center">
<div style="font-weight:bold;color:#e67e22;margin-bottom:6px">â‘¡ ê²°ì¸¡ì¹˜ ì²˜ë¦¬</div>
<div style="color:#555;font-size:11px">ë¹„ìœ¨ < 1%? â†’ ì‚­ì œ<br>ì‹œê³„ì—´? â†’ ffill<br>ìˆ˜ìµë¥ ? â†’ 0 ëŒ€ì²´</div>
<div style="margin-top:6px;background:#fff9e6;padding:4px 8px;border-radius:4px;font-size:11px"><code>ffill()</code>, <code>interpolate()</code></div>
</div>
<div style="flex:1;min-width:200px;background:#fff;border:2px solid #3498db;border-radius:8px;padding:12px;text-align:center">
<div style="font-weight:bold;color:#3498db;margin-bottom:6px">â‘¢ ì´ìƒì¹˜ ì²˜ë¦¬</div>
<div style="color:#555;font-size:11px">ë°ì´í„° ì˜¤ë¥˜? â†’ ì œê±°<br>ê·¹ë‹¨ê°’? â†’ Winsorize<br>ì‹¤ì œ ì‚¬ê±´? â†’ ë³´ì¡´</div>
<div style="margin-top:6px;background:#e8f4f8;padding:4px 8px;border-radius:4px;font-size:11px"><code>clip()</code>, <code>winsorize()</code></div>
</div>
</div>
<div style="text-align:center;color:#888">â†“</div>
<div style="text-align:center">
<div style="display:inline-block;background:#27ae60;color:#fff;padding:10px 20px;border-radius:8px;font-weight:bold">ê¹¨ë—í•œ ë°ì´í„° (Clean Data) â†’ ìŠ¤ì¼€ì¼ë§ â†’ í”¼ì²˜ ìƒì„±</div>
</div>
</div>
</div>

<h3>4.1 ì™œ ë°ì´í„° ì •ì œê°€ í•„ìš”í•œê°€</h3>
<p>í˜„ì‹¤ì˜ ê¸ˆìœµ ë°ì´í„°ëŠ” ê¹¨ë—í•˜ì§€ ì•Šë‹¤. ê±°ë˜ì†Œ ì‹œìŠ¤í…œ ì˜¤ë¥˜ë¡œ ê°€ê²©ì´ 0ì›ìœ¼ë¡œ ì°íˆê¸°ë„ í•˜ê³ , ê³µíœ´ì¼ì—ëŠ” ë°ì´í„°ê°€ ë¹„ì–´ ìˆê³ , ìƒì¥íì§€ëœ ì¢…ëª©ì€ ì¤‘ê°„ì— ë°ì´í„°ê°€ ëŠê¸°ê³ , ë°°ë‹¹ë½ì¼ì—ëŠ” ì£¼ê°€ê°€ ê°‘ìê¸° ë–¨ì–´ì§„ë‹¤. ì´ëŸ° "ë”ëŸ¬ìš´" ë°ì´í„°ë¥¼ ê·¸ëŒ€ë¡œ ML ëª¨ë¸ì— ë„£ìœ¼ë©´ ëª¨ë¸ì´ ì—‰ëš±í•œ íŒ¨í„´ì„ í•™ìŠµí•œë‹¤.</p>

<p>ë°ì´í„° ì •ì œëŠ” í¬ê²Œ ì„¸ ë‹¨ê³„ë¡œ ë‚˜ë‰œë‹¤:</p>
<ol>
<li><strong>ê²°ì¸¡ì¹˜ ì²˜ë¦¬ (Missing Values)</strong> â€” ë¹„ì–´ ìˆëŠ” ì¹¸ì„ ì–´ë–»ê²Œ í•  ê²ƒì¸ê°€?</li>
<li><strong>ì´ìƒì¹˜ ì²˜ë¦¬ (Outliers)</strong> â€” ë¹„ì •ìƒì ìœ¼ë¡œ í¬ê±°ë‚˜ ì‘ì€ ê°’ì„ ì–´ë–»ê²Œ í•  ê²ƒì¸ê°€?</li>
<li><strong>ë°ì´í„° íƒ€ì… ì •ë¦¬</strong> â€” ë‚ ì§œê°€ ë¬¸ìì—´ë¡œ ë˜ì–´ ìˆê±°ë‚˜, ìˆ«ìì— ì‰¼í‘œê°€ ì„ì—¬ ìˆëŠ” ê²½ìš°</li>
</ol>

<h3>4.2 ë°ì´í„° íƒìƒ‰ â€” ë¨¼ì € í˜„í™©ì„ íŒŒì•…í•˜ì</h3>
<p>ì •ì œí•˜ê¸° ì „ì— ë¨¼ì € ë°ì´í„°ì˜ í˜„ì¬ ìƒíƒœë¥¼ íŒŒì•…í•´ì•¼ í•œë‹¤. Pandasì˜ íƒìƒ‰ í•¨ìˆ˜ë“¤ì„ ì´ë™ì›í•˜ì.</p>

<pre><code><span class="cm"># 5ì¢…ëª© 2ë…„ ë°ì´í„° (ì•ì—ì„œ ë‹¤ìš´ë¡œë“œí•œ ê²ƒ)</span>
<span class="fn">print</span>(<span class="st">"=== ê¸°ë³¸ ì •ë³´ ==="</span>)
<span class="fn">print</span>(<span class="st">f"Shape: </span>{data.shape}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"ê¸°ê°„: </span>{data.index[0].date()}<span class="st"> ~ </span>{data.index[-1].date()}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"ë°ì´í„° íƒ€ì…:\n</span>{data.dtypes}<span class="st">"</span>)

<span class="fn">print</span>(<span class="st">"\n=== ê²°ì¸¡ì¹˜ í˜„í™© ==="</span>)
<span class="fn">print</span>(data.isnull().sum())
<span class="fn">print</span>(<span class="st">f"\nê²°ì¸¡ì¹˜ ë¹„ìœ¨:\n</span>{(data.isnull().sum() / <span class="fn">len</span>(data) * <span class="nu">100</span>).round(<span class="nu">2</span>)}<span class="st">%"</span>)

<span class="fn">print</span>(<span class="st">"\n=== ê¸°ìˆ í†µê³„ ==="</span>)
<span class="fn">print</span>(data.describe().round(<span class="nu">2</span>))

<span class="fn">print</span>(<span class="st">"\n=== ì²˜ìŒ 5í–‰ ==="</span>)
<span class="fn">print</span>(data.head())

<span class="fn">print</span>(<span class="st">"\n=== ë§ˆì§€ë§‰ 5í–‰ ==="</span>)
<span class="fn">print</span>(data.tail())</code></pre>

<p><code>describe()</code>ëŠ” ë§¤ìš° ê°•ë ¥í•œ í•¨ìˆ˜ë‹¤. í‰ê· , í‘œì¤€í¸ì°¨, ìµœì†Ÿê°’, ìµœëŒ“ê°’, ì‚¬ë¶„ìœ„ìˆ˜ë¥¼ í•œëˆˆì— ë³´ì—¬ì¤€ë‹¤. ì—¬ê¸°ì„œ ì´ìƒí•œ ê°’ì´ ë³´ì´ë©´ (ì˜ˆ: ìµœì†Ÿê°’ì´ 0ì´ê±°ë‚˜, ìµœëŒ“ê°’ì´ ë¹„ì •ìƒì ìœ¼ë¡œ í¬ë©´) ì´ìƒì¹˜ê°€ ìˆë‹¤ëŠ” ì‹ í˜¸ë‹¤.</p>

<div class="info">
<p class="ni"><strong>êµì¬ ì—°ë™:</strong> íŒŒë¼í™œ Ch.5 "Getting Started with pandas"ì—ì„œ DataFrameì˜ ê¸°ë³¸ íƒìƒ‰ ë°©ë²•ì„, Ch.7 "Data Cleaning and Preparation"ì—ì„œ ê²°ì¸¡ì¹˜Â·ì´ìƒì¹˜ ì²˜ë¦¬ì˜ ìƒì„¸í•œ ê¸°ë²•ì„ ë‹¤ë£¬ë‹¤. MLAT Ch.2ì—ì„œëŠ” ê¸ˆìœµ ë°ì´í„° íŠ¹ìœ ì˜ ì •ì œ ì´ìŠˆ(ìˆ˜ì •ì¢…ê°€, ìƒì¡´ì í¸í–¥ ë“±)ë¥¼ ë‹¤ë£¬ë‹¤.</p>
</div>

<h3>4.3 ë°ì´í„° íƒ€ì… ë¬¸ì œ í•´ê²°</h3>
<p>CSV íŒŒì¼ì—ì„œ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ë©´ ì¢…ì¢… ë°ì´í„° íƒ€ì…ì´ ì˜ëª»ë˜ì–´ ìˆë‹¤. ë‚ ì§œê°€ ë¬¸ìì—´ì´ê±°ë‚˜, ìˆ«ìì— ì‰¼í‘œê°€ ì„ì—¬ ìˆê±°ë‚˜, ë¹ˆ ì¹¸ì´ "N/A" ë¬¸ìì—´ë¡œ ë˜ì–´ ìˆëŠ” ê²½ìš°ê°€ í”í•˜ë‹¤.</p>

<pre><code><span class="cm"># í”í•œ ë°ì´í„° íƒ€ì… ë¬¸ì œì™€ í•´ê²°ë²•</span>

<span class="cm"># ë¬¸ì œ 1: ë‚ ì§œê°€ ë¬¸ìì—´</span>
df_raw = pd.DataFrame({
    <span class="st">"date"</span>: [<span class="st">"2024-01-02"</span>, <span class="st">"2024-01-03"</span>, <span class="st">"2024-01-04"</span>],
    <span class="st">"price"</span>: [<span class="st">"75,300"</span>, <span class="st">"74,800"</span>, <span class="st">"76,100"</span>],  <span class="cm"># ì‰¼í‘œê°€ ìˆëŠ” ë¬¸ìì—´!</span>
    <span class="st">"volume"</span>: [<span class="st">"12345678"</span>, <span class="st">"N/A"</span>, <span class="st">"9876543"</span>]  <span class="cm"># N/A ë¬¸ìì—´!</span>
})

<span class="cm"># í•´ê²°: ë‚ ì§œ ë³€í™˜</span>
df_raw[<span class="st">"date"</span>] = pd.to_datetime(df_raw[<span class="st">"date"</span>])

<span class="cm"># í•´ê²°: ì‰¼í‘œ ì œê±° í›„ ìˆ«ì ë³€í™˜</span>
df_raw[<span class="st">"price"</span>] = df_raw[<span class="st">"price"</span>].str.replace(<span class="st">","</span>, <span class="st">""</span>).astype(<span class="nb">float</span>)

<span class="cm"># í•´ê²°: N/Aë¥¼ NaNìœ¼ë¡œ ë³€í™˜</span>
df_raw[<span class="st">"volume"</span>] = pd.to_numeric(df_raw[<span class="st">"volume"</span>], errors=<span class="st">"coerce"</span>)
<span class="cm"># errors="coerce" â†’ ë³€í™˜ ë¶ˆê°€ëŠ¥í•œ ê°’ì„ NaNìœ¼ë¡œ</span>

<span class="fn">print</span>(df_raw)
<span class="fn">print</span>(<span class="st">f"\në°ì´í„° íƒ€ì…:\n</span>{df_raw.dtypes}<span class="st">"</span>)</code></pre>

<p><code>pd.to_numeric(errors="coerce")</code>ëŠ” ë§¤ìš° ìœ ìš©í•œ í•¨ìˆ˜ë‹¤. ìˆ«ìë¡œ ë³€í™˜í•  ìˆ˜ ì—†ëŠ” ê°’ì„ ìë™ìœ¼ë¡œ NaN(ê²°ì¸¡ì¹˜)ìœ¼ë¡œ ë°”ê¿”ì¤€ë‹¤. "N/A", "ì—†ìŒ", "-" ê°™ì€ ë‹¤ì–‘í•œ í˜•íƒœì˜ ê²°ì¸¡ í‘œí˜„ì„ í•œ ë²ˆì— ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤.</p>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- Ch5: ê²°ì¸¡ì¹˜ ì²˜ë¦¬ -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<h2 id="ch5">5. ê²°ì¸¡ì¹˜ ì²˜ë¦¬ â€” ë¹ˆ ì¹¸ì„ ì–´ë–»ê²Œ í•  ê²ƒì¸ê°€</h2>

<!-- ê²°ì¸¡ì¹˜ ì²˜ë¦¬ ë°©ë²• ë¹„êµ ë‹¤ì´ì–´ê·¸ë¨ (CSS) -->
<div style="margin:25px 0;padding:20px;background:#f8f9fa;border-radius:8px;border:1px solid #ddd">
<p class="ni" style="text-align:center;font-weight:bold;font-size:14px;margin-bottom:15px;color:#2c3e50">ğŸ”§ ê²°ì¸¡ì¹˜ ì²˜ë¦¬ â€” ìƒí™©ë³„ ìµœì  ë°©ë²•</p>
<div style="display:flex;gap:8px;flex-wrap:wrap;font-size:12px;justify-content:center">
<div style="flex:1;min-width:150px;background:#fff;padding:12px;border-radius:6px;border-left:4px solid #e74c3c;text-align:center">
<div style="font-weight:bold;color:#e74c3c;margin-bottom:4px">ê°€ê²© ë°ì´í„°</div>
<div style="font-size:20px;margin:6px 0">ğŸ“ˆ</div>
<div style="background:#fde8e8;padding:4px;border-radius:3px;font-family:monospace;font-size:11px">ffill(limit=5)</div>
<div style="color:#888;font-size:10px;margin-top:4px">"ë§ˆì§€ë§‰ ì•Œë ¤ì§„ ê°€ê²© ì‚¬ìš©"</div>
</div>
<div style="flex:1;min-width:150px;background:#fff;padding:12px;border-radius:6px;border-left:4px solid #3498db;text-align:center">
<div style="font-weight:bold;color:#3498db;margin-bottom:4px">ìˆ˜ìµë¥  ë°ì´í„°</div>
<div style="font-size:20px;margin:6px 0">ğŸ“Š</div>
<div style="background:#e8f4f8;padding:4px;border-radius:3px;font-family:monospace;font-size:11px">fillna(0)</div>
<div style="color:#888;font-size:10px;margin-top:4px">"ê±°ë˜ ì—†ìŒ = ìˆ˜ìµë¥  0"</div>
</div>
<div style="flex:1;min-width:150px;background:#fff;padding:12px;border-radius:6px;border-left:4px solid #e67e22;text-align:center">
<div style="font-weight:bold;color:#e67e22;margin-bottom:4px">ê±°ì‹œê²½ì œ ë°ì´í„°</div>
<div style="font-size:20px;margin:6px 0">ğŸ›ï¸</div>
<div style="background:#fff9e6;padding:4px;border-radius:3px;font-family:monospace;font-size:11px">ffill()</div>
<div style="color:#888;font-size:10px;margin-top:4px">"ë°œí‘œ ì „ê¹Œì§€ ì´ì „ ê°’"</div>
</div>
<div style="flex:1;min-width:150px;background:#fff;padding:12px;border-radius:6px;border-left:4px solid #27ae60;text-align:center">
<div style="font-weight:bold;color:#27ae60;margin-bottom:4px">ê²°ì¸¡ > 30%</div>
<div style="font-size:20px;margin:6px 0">ğŸ—‘ï¸</div>
<div style="background:#e8f8e8;padding:4px;border-radius:3px;font-family:monospace;font-size:11px">drop column</div>
<div style="color:#888;font-size:10px;margin-top:4px">"í•´ë‹¹ ì¢…ëª©/ì»¬ëŸ¼ ì œì™¸"</div>
</div>
</div>
</div>

<h3>5.1 ê¸ˆìœµ ë°ì´í„°ì—ì„œ ê²°ì¸¡ì¹˜ê°€ ìƒê¸°ëŠ” ì´ìœ </h3>
<p>ê¸ˆìœµ ë°ì´í„°ì—ì„œ ê²°ì¸¡ì¹˜(missing value, NaN)ëŠ” í”¼í•  ìˆ˜ ì—†ë‹¤. ì£¼ìš” ì›ì¸ì„ ì•Œì•„ì•¼ ì ì ˆí•œ ì²˜ë¦¬ ë°©ë²•ì„ ì„ íƒí•  ìˆ˜ ìˆë‹¤.</p>

<ul>
<li><strong>ê±°ë˜ì¼ ë¶ˆì¼ì¹˜:</strong> í•œêµ­ ì‹œì¥ì€ ì‰¬ëŠ”ë° ë¯¸êµ­ ì‹œì¥ì€ ì—´ë¦¬ëŠ” ë‚  (ë˜ëŠ” ê·¸ ë°˜ëŒ€). ì—¬ëŸ¬ ë‚˜ë¼ ë°ì´í„°ë¥¼ í•©ì¹˜ë©´ ë¹ˆ ì¹¸ì´ ìƒê¸´ë‹¤.</li>
<li><strong>ì‹ ê·œ ìƒì¥:</strong> 2022ë…„ì— ìƒì¥í•œ ì¢…ëª©ì€ 2020ë…„ ë°ì´í„°ê°€ ì—†ë‹¤.</li>
<li><strong>ê±°ë˜ ì •ì§€:</strong> ê³µì‹œ ì§€ì—°, ê°ì‚¬ì˜ê²¬ ê±°ì ˆ ë“±ìœ¼ë¡œ ê±°ë˜ê°€ ì •ì§€ë˜ë©´ ê·¸ ê¸°ê°„ì˜ ë°ì´í„°ê°€ ì—†ë‹¤.</li>
<li><strong>ë°ì´í„° ì†ŒìŠ¤ ì˜¤ë¥˜:</strong> API ì„œë²„ ì¥ì• , ë„¤íŠ¸ì›Œí¬ ë¬¸ì œ ë“±ìœ¼ë¡œ ì¼ë¶€ ë°ì´í„°ê°€ ëˆ„ë½ëœë‹¤.</li>
<li><strong>ìˆ˜ìµë¥  ê³„ì‚°:</strong> <code>pct_change()</code>ë‚˜ <code>shift()</code>ë¥¼ ì‚¬ìš©í•˜ë©´ ì²« ë²ˆì§¸ í–‰ì´ NaNì´ ëœë‹¤.</li>
</ul>

<h3>5.2 ê²°ì¸¡ì¹˜ íƒì§€</h3>
<pre><code><span class="cm"># ê²°ì¸¡ì¹˜ê°€ ìˆëŠ” ì˜ˆì œ ë°ì´í„° ë§Œë“¤ê¸°</span>
np.random.seed(<span class="nu">42</span>)
dates = pd.date_range(<span class="st">"2024-01-01"</span>, periods=<span class="nu">20</span>, freq=<span class="st">"B"</span>)  <span class="cm"># B = ì˜ì—…ì¼</span>
sample = pd.DataFrame({
    <span class="st">"A"</span>: np.random.normal(<span class="nu">100</span>, <span class="nu">5</span>, <span class="nu">20</span>),
    <span class="st">"B"</span>: np.random.normal(<span class="nu">50</span>, <span class="nu">3</span>, <span class="nu">20</span>),
    <span class="st">"C"</span>: np.random.normal(<span class="nu">200</span>, <span class="nu">10</span>, <span class="nu">20</span>)
}, index=dates)

<span class="cm"># ì¸ìœ„ì ìœ¼ë¡œ ê²°ì¸¡ì¹˜ ì‚½ì…</span>
sample.loc[sample.index[<span class="nu">3</span>], <span class="st">"A"</span>] = np.nan
sample.loc[sample.index[<span class="nu">7</span>:<span class="nu">10</span>], <span class="st">"B"</span>] = np.nan  <span class="cm"># ì—°ì† 3ì¼ ê²°ì¸¡</span>
sample.loc[sample.index[<span class="nu">15</span>], <span class="st">"C"</span>] = np.nan

<span class="cm"># ê²°ì¸¡ì¹˜ íƒì§€</span>
<span class="fn">print</span>(<span class="st">"=== ê²°ì¸¡ì¹˜ ê°œìˆ˜ ==="</span>)
<span class="fn">print</span>(sample.isnull().sum())

<span class="fn">print</span>(<span class="st">"\n=== ê²°ì¸¡ì¹˜ ìœ„ì¹˜ ==="</span>)
<span class="fn">print</span>(sample.isnull())

<span class="fn">print</span>(<span class="st">"\n=== ê²°ì¸¡ì¹˜ê°€ ìˆëŠ” í–‰ë§Œ ==="</span>)
<span class="fn">print</span>(sample[sample.isnull().any(axis=<span class="nu">1</span>)])

<span class="cm"># ì‹œê°í™”: ê²°ì¸¡ì¹˜ íŒ¨í„´</span>
fig, ax = plt.subplots(figsize=(<span class="nu">10</span>, <span class="nu">4</span>))
ax.imshow(sample.isnull().T, cmap=<span class="st">"YlOrRd"</span>, aspect=<span class="st">"auto"</span>)
ax.set_yticks(<span class="fn">range</span>(<span class="fn">len</span>(sample.columns)))
ax.set_yticklabels(sample.columns)
ax.set_xlabel(<span class="st">"ë‚ ì§œ ì¸ë±ìŠ¤"</span>)
ax.set_title(<span class="st">"ê²°ì¸¡ì¹˜ íŒ¨í„´ (ë¹¨ê°„ìƒ‰ = ê²°ì¸¡)"</span>)
plt.tight_layout()
plt.show()</code></pre>

<h3>5.3 ê²°ì¸¡ì¹˜ ì²˜ë¦¬ ë°©ë²• â€” ìƒí™©ë³„ ê°€ì´ë“œ</h3>
<p>ê²°ì¸¡ì¹˜ ì²˜ë¦¬ì—ëŠ” "ì •ë‹µ"ì´ ì—†ë‹¤. ìƒí™©ì— ë”°ë¼ ìµœì„ ì˜ ë°©ë²•ì´ ë‹¤ë¥´ë‹¤. ê¸ˆìœµ ë°ì´í„°ì—ì„œ ìì£¼ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ë“¤ì„ í•˜ë‚˜ì”© ì‚´í´ë³´ì.</p>

<h4>ë°©ë²• 1: ì‚­ì œ (dropna)</h4>
<p>ê°€ì¥ ë‹¨ìˆœí•œ ë°©ë²•ì´ë‹¤. ê²°ì¸¡ì¹˜ê°€ ìˆëŠ” í–‰ì„ í†µì§¸ë¡œ ì‚­ì œí•œë‹¤. ê²°ì¸¡ì¹˜ê°€ ë§¤ìš° ì ì„ ë•Œ(ì „ì²´ì˜ 1~2% ë¯¸ë§Œ) ì í•©í•˜ë‹¤.</p>

<pre><code><span class="cm"># ê²°ì¸¡ì¹˜ê°€ ìˆëŠ” í–‰ ì‚­ì œ</span>
clean1 = sample.dropna()
<span class="fn">print</span>(<span class="st">f"ì›ë³¸: </span>{<span class="fn">len</span>(sample)}<span class="st">í–‰ â†’ ì‚­ì œ í›„: </span>{<span class="fn">len</span>(clean1)}<span class="st">í–‰"</span>)

<span class="cm"># íŠ¹ì • ì»¬ëŸ¼ ê¸°ì¤€ìœ¼ë¡œë§Œ ì‚­ì œ</span>
clean1b = sample.dropna(subset=[<span class="st">"A"</span>])  <span class="cm"># A ì»¬ëŸ¼ì— ê²°ì¸¡ì´ ìˆëŠ” í–‰ë§Œ ì‚­ì œ</span>

<span class="cm"># ëª¨ë“  ì»¬ëŸ¼ì´ ê²°ì¸¡ì¸ í–‰ë§Œ ì‚­ì œ</span>
clean1c = sample.dropna(how=<span class="st">"all"</span>)  <span class="cm"># ì „ë¶€ NaNì¸ í–‰ë§Œ ì‚­ì œ</span></code></pre>

<div class="warn">
<p class="ni"><strong>ì‚­ì œì˜ ìœ„í—˜:</strong> ê¸ˆìœµ ì‹œê³„ì—´ì—ì„œ í–‰ì„ ì‚­ì œí•˜ë©´ ì‹œê°„ì˜ ì—°ì†ì„±ì´ ê¹¨ì§„ë‹¤. ì˜ˆë¥¼ ë“¤ì–´ 3ì¼ ì—°ì† ê²°ì¸¡ì„ ì‚­ì œí•˜ë©´, ì›”ìš”ì¼ ë‹¤ìŒì— ê°‘ìê¸° ëª©ìš”ì¼ì´ ì˜¤ê²Œ ëœë‹¤. ì´ë™í‰ê· ì´ë‚˜ ëª¨ë©˜í…€ ê°™ì€ ì‹œê³„ì—´ í”¼ì²˜ë¥¼ ê³„ì‚°í•  ë•Œ ë¬¸ì œê°€ ëœë‹¤.</p>
</div>

<h4>ë°©ë²• 2: ì „ë°© ì±„ì›€ (Forward Fill)</h4>
<p>ë°”ë¡œ ì´ì „ ê°’ìœ¼ë¡œ ì±„ìš°ëŠ” ë°©ë²•ì´ë‹¤. ê¸ˆìœµ ë°ì´í„°ì—ì„œ ê°€ì¥ ë§ì´ ì‚¬ìš©ë˜ëŠ” ë°©ë²•ì´ë‹¤. "ìƒˆë¡œìš´ ì •ë³´ê°€ ì—†ìœ¼ë©´ ë§ˆì§€ë§‰ìœ¼ë¡œ ì•Œë ¤ì§„ ê°’ì„ ì‚¬ìš©í•œë‹¤"ëŠ” ì§ê´€ì ì¸ ë…¼ë¦¬ë‹¤.</p>

<pre><code><span class="cm"># Forward Fill: ì´ì „ ê°’ìœ¼ë¡œ ì±„ì›€</span>
clean2 = sample.ffill()
<span class="fn">print</span>(<span class="st">"=== Forward Fill ==="</span>)
<span class="fn">print</span>(clean2.loc[sample.isnull().any(axis=<span class="nu">1</span>)])

<span class="cm"># ìµœëŒ€ ì±„ì›€ íšŸìˆ˜ ì œí•œ (ì—°ì† ê²°ì¸¡ì´ ë„ˆë¬´ ê¸¸ë©´ ìœ„í—˜)</span>
clean2b = sample.ffill(limit=<span class="nu">2</span>)  <span class="cm"># ìµœëŒ€ 2ì¼ê¹Œì§€ë§Œ ì±„ì›€</span>
<span class="fn">print</span>(<span class="st">"\n=== Forward Fill (limit=2) ==="</span>)
<span class="fn">print</span>(clean2b.isnull().sum())  <span class="cm"># Bì— 1ê°œ ë‚¨ìŒ (3ì¼ ì—°ì† ì¤‘ 3ë²ˆì§¸)</span></code></pre>

<p>ì™œ <code>limit</code>ì„ ì„¤ì •í•´ì•¼ í• ê¹Œ? ì–´ë–¤ ì¢…ëª©ì´ ê±°ë˜ ì •ì§€ë¡œ 30ì¼ê°„ ë°ì´í„°ê°€ ì—†ë‹¤ê³  í•˜ì. Forward fillë¡œ 30ì¼ì„ ëª¨ë‘ ì±„ìš°ë©´, 30ì¼ ë™ì•ˆ ê°€ê²©ì´ ë³€í•˜ì§€ ì•Šì€ ê²ƒì²˜ëŸ¼ ë³´ì¸ë‹¤. ì´ê²ƒì€ í˜„ì‹¤ê³¼ ë‹¤ë¥´ë‹¤ â€” ê±°ë˜ ì¬ê°œ ì‹œ ê°€ê²©ì´ ê¸‰ë³€í•  ìˆ˜ ìˆë‹¤. <code>limit=5</code> ì •ë„ë¡œ ì„¤ì •í•˜ê³ , ê·¸ ì´ìƒ ì—°ì† ê²°ì¸¡ì€ í•´ë‹¹ ì¢…ëª©ì„ ë¶„ì„ì—ì„œ ì œì™¸í•˜ëŠ” ê²ƒì´ ì•ˆì „í•˜ë‹¤.</p>

<h4>ë°©ë²• 3: ë³´ê°„ (Interpolation)</h4>
<p>ì•ë’¤ ê°’ì„ ì´ìš©í•´ ì¤‘ê°„ê°’ì„ ì¶”ì •í•˜ëŠ” ë°©ë²•ì´ë‹¤. ì„ í˜• ë³´ê°„ì´ ê°€ì¥ ê¸°ë³¸ì´ê³ , ì‹œê³„ì—´ì—ëŠ” ì‹œê°„ ê¸°ë°˜ ë³´ê°„ì´ ë” ì í•©í•˜ë‹¤.</p>

<pre><code><span class="cm"># ì„ í˜• ë³´ê°„: ì•ë’¤ ê°’ì˜ ì§ì„ ìœ¼ë¡œ ì±„ì›€</span>
clean3 = sample.interpolate(method=<span class="st">"linear"</span>)
<span class="fn">print</span>(<span class="st">"=== ì„ í˜• ë³´ê°„ ==="</span>)
<span class="fn">print</span>(clean3.loc[sample.isnull().any(axis=<span class="nu">1</span>)])

<span class="cm"># ì‹œê°„ ê¸°ë°˜ ë³´ê°„ (ë‚ ì§œ ê°„ê²© ê³ ë ¤)</span>
clean3b = sample.interpolate(method=<span class="st">"time"</span>)

<span class="cm"># ë‹¤í•­ì‹ ë³´ê°„ (ê³¡ì„ ìœ¼ë¡œ ì±„ì›€)</span>
clean3c = sample.interpolate(method=<span class="st">"polynomial"</span>, order=<span class="nu">2</span>)

<span class="cm"># ë¹„êµ ì‹œê°í™”</span>
fig, axes = plt.subplots(<span class="nu">1</span>, <span class="nu">3</span>, figsize=(<span class="nu">15</span>, <span class="nu">4</span>))
methods = {<span class="st">"Forward Fill"</span>: sample.ffill(),
           <span class="st">"Linear Interp"</span>: sample.interpolate(method=<span class="st">"linear"</span>),
           <span class="st">"Polynomial(2)"</span>: sample.interpolate(method=<span class="st">"polynomial"</span>, order=<span class="nu">2</span>)}

<span class="kw">for</span> ax, (name, filled) <span class="kw">in</span> <span class="fn">zip</span>(axes, methods.items()):
    ax.plot(sample.index, sample[<span class="st">"B"</span>], <span class="st">"o"</span>, color=<span class="st">"blue"</span>, label=<span class="st">"ì›ë³¸"</span>)
    ax.plot(filled.index, filled[<span class="st">"B"</span>], <span class="st">"--"</span>, color=<span class="st">"red"</span>, alpha=<span class="nu">0.7</span>, label=<span class="st">"ì±„ì›€"</span>)
    <span class="cm"># ê²°ì¸¡ ìœ„ì¹˜ ê°•ì¡°</span>
    mask = sample[<span class="st">"B"</span>].isnull()
    ax.plot(filled.index[mask], filled[<span class="st">"B"</span>][mask], <span class="st">"s"</span>, color=<span class="st">"red"</span>, markersize=<span class="nu">8</span>)
    ax.set_title(name)
    ax.legend(fontsize=<span class="nu">8</span>)
    ax.grid(<span class="kw">True</span>, alpha=<span class="nu">0.3</span>)
    ax.tick_params(axis=<span class="st">"x"</span>, rotation=<span class="nu">45</span>)

plt.tight_layout()
plt.show()</code></pre>

<h4>ë°©ë²• 4: í‰ê· /ì¤‘ì•™ê°’ ëŒ€ì²´</h4>
<p>í•´ë‹¹ ì»¬ëŸ¼ì˜ í‰ê· ì´ë‚˜ ì¤‘ì•™ê°’ìœ¼ë¡œ ì±„ìš°ëŠ” ë°©ë²•ì´ë‹¤. íš¡ë‹¨ë©´(cross-sectional) ë°ì´í„°ì—ëŠ” ì í•©í•˜ì§€ë§Œ, ì‹œê³„ì—´ ë°ì´í„°ì—ëŠ” ë¶€ì í•©í•˜ë‹¤. ì™œ? ì‹œê³„ì—´ì—ëŠ” ì¶”ì„¸(trend)ê°€ ìˆê¸° ë•Œë¬¸ì´ë‹¤. ìƒìŠ¹ ì¶”ì„¸ì—ì„œ í‰ê· ìœ¼ë¡œ ì±„ìš°ë©´ ì‹¤ì œë³´ë‹¤ ë‚®ì€ ê°’ì´ ë“¤ì–´ê°„ë‹¤.</p>

<pre><code><span class="cm"># í‰ê·  ëŒ€ì²´ (ì‹œê³„ì—´ì—ëŠ” ë¹„ì¶”ì²œ)</span>
clean4 = sample.fillna(sample.mean())

<span class="cm"># ì¤‘ì•™ê°’ ëŒ€ì²´ (ì´ìƒì¹˜ì— ëœ ë¯¼ê°)</span>
clean4b = sample.fillna(sample.median())

<span class="cm"># íŠ¹ì • ê°’ìœ¼ë¡œ ëŒ€ì²´</span>
clean4c = sample.fillna(<span class="nu">0</span>)  <span class="cm"># 0ìœ¼ë¡œ ì±„ì›€ (ìˆ˜ìµë¥  ë°ì´í„°ì— ì í•©í•  ìˆ˜ ìˆìŒ)</span></code></pre>

<div class="tc">Table 4. ê²°ì¸¡ì¹˜ ì²˜ë¦¬ ë°©ë²• ë¹„êµ</div>
<table>
<tr><th>ë°©ë²•</th><th>ì½”ë“œ</th><th>ì¥ì </th><th>ë‹¨ì </th><th>ê¸ˆìœµ ì í•©ë„</th></tr>
<tr><td>ì‚­ì œ</td><td><code>dropna()</code></td><td>ë‹¨ìˆœ, í¸í–¥ ì—†ìŒ</td><td>ë°ì´í„° ì†ì‹¤, ì‹œê°„ ë¶ˆì—°ì†</td><td>ê²°ì¸¡ &lt; 1%ì¼ ë•Œ</td></tr>
<tr><td>ì „ë°© ì±„ì›€</td><td><code>ffill()</code></td><td>ì‹œê°„ ì—°ì†ì„± ìœ ì§€</td><td>ì¥ê¸° ê²°ì¸¡ ì‹œ ë¶€ì •í™•</td><td>â­ ê°€ì¥ ë§ì´ ì‚¬ìš©</td></tr>
<tr><td>ì„ í˜• ë³´ê°„</td><td><code>interpolate()</code></td><td>ë¶€ë“œëŸ¬ìš´ ì¶”ì •</td><td>ë¯¸ë˜ ì •ë³´ ì‚¬ìš© ìœ„í—˜</td><td>ê°€ê²© ë°ì´í„°ì— ì í•©</td></tr>
<tr><td>í‰ê·  ëŒ€ì²´</td><td><code>fillna(mean())</code></td><td>ë‹¨ìˆœ</td><td>ì¶”ì„¸ ë¬´ì‹œ, ë¶„ì‚° ì¶•ì†Œ</td><td>íš¡ë‹¨ë©´ì—ë§Œ ì í•©</td></tr>
<tr><td>0 ëŒ€ì²´</td><td><code>fillna(0)</code></td><td>ë‹¨ìˆœ</td><td>ì˜ë¯¸ ì™œê³¡ ê°€ëŠ¥</td><td>ìˆ˜ìµë¥  ë°ì´í„°ì— í•œì •</td></tr>
</table>

<!-- â”€â”€ ë³´ì¶© 5.3+ ffill vs interpolate vs fillna(0) ì‹¤ì œ ìˆ«ì ë¹„êµ â”€â”€ -->
<div class="def">
<p class="ni"><strong>ğŸ” ë³´ì¶©: ffill vs interpolate vs fillna(0) â€” ì‹¤ì œ ìˆ«ìë¡œ ì°¨ì´ë¥¼ ë³´ì</strong></p>
<p class="ni">ìœ„ í‘œë§Œ ë³´ë©´ "ê·¸ë˜ì„œ ë­ê°€ ë‹¤ë¥¸ë°?"ë¼ëŠ” ì˜ë¬¸ì´ ë‚¨ëŠ”ë‹¤. ê°™ì€ ê²°ì¸¡ ë°ì´í„°ì— ì„¸ ê°€ì§€ ë°©ë²•ì„ ì ìš©í•˜ë©´ ìˆ«ìê°€ ì–´ë–»ê²Œ ë‹¬ë¼ì§€ëŠ”ì§€ ì§ì ‘ í™•ì¸í•˜ì. ì´ ì°¨ì´ê°€ ìˆ˜ìµë¥  ê³„ì‚°ê³¼ ML ëª¨ë¸ í•™ìŠµì— ì–´ë–¤ ì˜í–¥ì„ ë¯¸ì¹˜ëŠ”ì§€ê°€ í•µì‹¬ì´ë‹¤.</p>
</div>

<pre><code><span class="cm"># === ffill vs interpolate vs fillna(0) ì‹¤ì „ ë¹„êµ ===</span>
<span class="kw">import</span> pandas <span class="kw">as</span> pd
<span class="kw">import</span> numpy <span class="kw">as</span> np

<span class="cm"># ì‹¤ì œ ì£¼ê°€ì²˜ëŸ¼ ìƒê¸´ ë°ì´í„° (ìƒìŠ¹ ì¶”ì„¸ ì¤‘ 3ì¼ ê²°ì¸¡)</span>
dates = pd.date_range(<span class="st">"2024-01-08"</span>, periods=<span class="nu">10</span>, freq=<span class="st">"B"</span>)
prices = pd.Series(
    [<span class="nu">70000</span>, <span class="nu">71200</span>, <span class="nu">72500</span>, np.nan, np.nan, np.nan, <span class="nu">78000</span>, <span class="nu">77500</span>, <span class="nu">78800</span>, <span class="nu">79200</span>],
    index=dates, name=<span class="st">"ì‚¼ì„±ì „ì"</span>
)
<span class="cm"># ê²°ì¸¡ êµ¬ê°„: 72,500 â†’ ??? â†’ ??? â†’ ??? â†’ 78,000</span>
<span class="cm"># ì‹¤ì œë¡œëŠ” ìƒìŠ¹ ì¤‘ì´ì—ˆë‹¤ (72,500 â†’ 78,000)</span>

<span class="cm"># ì„¸ ê°€ì§€ ë°©ë²• ì ìš©</span>
method_ffill = prices.ffill()
method_interp = prices.interpolate(method=<span class="st">"linear"</span>)
method_zero = prices.fillna(<span class="nu">0</span>)

<span class="cm"># ë¹„êµ í…Œì´ë¸”</span>
comparison = pd.DataFrame({
    <span class="st">"ì›ë³¸"</span>: prices,
    <span class="st">"ffill"</span>: method_ffill,
    <span class="st">"interpolate"</span>: method_interp,
    <span class="st">"fillna(0)"</span>: method_zero
})
<span class="fn">print</span>(<span class="st">"=== ê²°ì¸¡ì¹˜ ì²˜ë¦¬ ë°©ë²•ë³„ ê²°ê³¼ ==="</span>)
<span class="fn">print</span>(comparison.to_string())
<span class="cm">#              ì›ë³¸    ffill  interpolate  fillna(0)</span>
<span class="cm"># 01-08    70000   70000      70000       70000</span>
<span class="cm"># 01-09    71200   71200      71200       71200</span>
<span class="cm"># 01-10    72500   72500      72500       72500</span>
<span class="cm"># 01-11      NaN   72500      73875           0  â† ì—¬ê¸°ì„œ ì°¨ì´ ë°œìƒ!</span>
<span class="cm"># 01-12      NaN   72500      75250           0</span>
<span class="cm"># 01-15      NaN   72500      76625           0</span>
<span class="cm"># 01-16    78000   78000      78000       78000</span>
<span class="cm"># ...</span></code></pre>

<pre><code><span class="cm"># ìˆ˜ìµë¥ ì— ë¯¸ì¹˜ëŠ” ì˜í–¥ ë¹„êµ</span>
<span class="fn">print</span>(<span class="st">"\n=== ì¼ê°„ ìˆ˜ìµë¥  ë¹„êµ (ê²°ì¸¡ êµ¬ê°„ ì „í›„) ==="</span>)
<span class="kw">for</span> name, series <span class="kw">in</span> {<span class="st">"ffill"</span>: method_ffill, <span class="st">"interpolate"</span>: method_interp, <span class="st">"fillna(0)"</span>: method_zero}.items():
    ret = series.pct_change()
    <span class="fn">print</span>(<span class="st">f"\n{name}:"</span>)
    <span class="fn">print</span>(ret.iloc[<span class="nu">2</span>:<span class="nu">7</span>].round(<span class="nu">4</span>))

<span class="cm"># ffill ìˆ˜ìµë¥ :     0.0000, 0.0000, 0.0000, 0.0759  â† 3ì¼ê°„ 0%, ë§ˆì§€ë§‰ì— 7.6% ì í”„</span>
<span class="cm"># interpolate ìˆ˜ìµë¥ : 0.0190, 0.0186, 0.0183, 0.0180  â† ë§¤ì¼ ~1.8% ê· ë“± ìƒìŠ¹</span>
<span class="cm"># fillna(0) ìˆ˜ìµë¥ :  -1.0000, 0.0000, 0.0000, inf    â† ì™„ì „ ì—‰ë§! -100% â†’ inf</span>

<span class="fn">print</span>(<span class="st">"\n=== ê²°ë¡  ==="</span>)
<span class="fn">print</span>(<span class="st">"ffill:       ê°€ê²© ë™ê²° â†’ ì¬ê°œ ì‹œ ì í”„. ë³´ìˆ˜ì ì´ì§€ë§Œ ì•ˆì „"</span>)
<span class="fn">print</span>(<span class="st">"interpolate: ë¶€ë“œëŸ¬ìš´ ì¶”ì •. í•˜ì§€ë§Œ ë¯¸ë˜ ê°’(78000)ì„ ì‚¬ìš©! â†’ Look-Ahead Bias"</span>)
<span class="fn">print</span>(<span class="st">"fillna(0):   ê°€ê²© ë°ì´í„°ì— 0ì„ ë„£ìœ¼ë©´ -100% í­ë½ìœ¼ë¡œ í•´ì„ë¨ â†’ ì ˆëŒ€ ê¸ˆì§€!"</span>)
<span class="fn">print</span>(<span class="st">"\nâ†’ ê°€ê²© ë°ì´í„°: ffillì´ ê°€ì¥ ì•ˆì „ (ë¯¸ë˜ ì •ë³´ ì‚¬ìš© ì•ˆ í•¨)"</span>)
<span class="fn">print</span>(<span class="st">"â†’ ìˆ˜ìµë¥  ë°ì´í„°: fillna(0)ì´ ì í•© (ê±°ë˜ ì—†ìŒ = ìˆ˜ìµë¥  0)"</span>)
<span class="fn">print</span>(<span class="st">"â†’ interpolate: ë°±í…ŒìŠ¤íŠ¸ê°€ ì•„ë‹Œ ì‹œê°í™”/ë¶„ì„ ìš©ë„ë¡œë§Œ ì‚¬ìš©"</span>)</code></pre>

<div class="warn">
<p class="ni"><strong>í•µì‹¬ í¬ì¸íŠ¸:</strong> <code>interpolate()</code>ëŠ” ê²°ì¸¡ ë’¤ì˜ ê°’(78,000)ì„ ì‚¬ìš©í•˜ì—¬ ì¤‘ê°„ê°’ì„ ì¶”ì •í•œë‹¤. ì¦‰ "ë¯¸ë˜ ì •ë³´"ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ë‹¤. ë°±í…ŒìŠ¤íŠ¸ì—ì„œ ì´ê²ƒì„ ì“°ë©´ Look-Ahead Biasê°€ ë°œìƒí•œë‹¤. ì‹œê°í™”ë‚˜ íƒìƒ‰ì  ë¶„ì„ì—ì„œëŠ” ê´œì°®ì§€ë§Œ, ML ëª¨ë¸ í•™ìŠµìš© ë°ì´í„°ì—ëŠ” <code>ffill()</code>ì„ ì“°ì.</p>
</div>

<div class="ok">
<p class="ni"><strong>ì‹¤ì „ ê°€ì´ë“œë¼ì¸:</strong></p>
<ul>
<li>ê°€ê²© ë°ì´í„° â†’ <code>ffill(limit=5)</code> ë˜ëŠ” ì„ í˜• ë³´ê°„</li>
<li>ìˆ˜ìµë¥  ë°ì´í„° â†’ <code>fillna(0)</code> (ê±°ë˜ ì—†ìŒ = ìˆ˜ìµë¥  0)</li>
<li>ê±°ì‹œê²½ì œ ë°ì´í„° â†’ <code>ffill()</code> (ë°œí‘œ ì „ê¹Œì§€ ì´ì „ ê°’ ì‚¬ìš©)</li>
<li>ì¬ë¬´ì œí‘œ ë°ì´í„° â†’ <code>ffill()</code> (ë¶„ê¸° ë°œí‘œ ì „ê¹Œì§€ ì´ì „ ë¶„ê¸° ê°’)</li>
<li>ê²°ì¸¡ ë¹„ìœ¨ > 30% â†’ í•´ë‹¹ ì¢…ëª©/ì»¬ëŸ¼ ì œì™¸ ê³ ë ¤</li>
</ul>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- Ch6: ì´ìƒì¹˜ íƒì§€ -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<h2 id="ch6">6. ì´ìƒì¹˜ íƒì§€ì™€ ì²˜ë¦¬ â€” ë¹„ì •ìƒì ì¸ ê°’ ì¡ì•„ë‚´ê¸°</h2>

<!-- ì´ìƒì¹˜ íŒë³„ ë‹¤ì´ì–´ê·¸ë¨ (CSS) -->
<div style="margin:25px 0;padding:20px;background:#f8f9fa;border-radius:8px;border:1px solid #ddd">
<p class="ni" style="text-align:center;font-weight:bold;font-size:14px;margin-bottom:15px;color:#2c3e50">âš ï¸ ì´ìƒì¹˜ íŒë³„: ì œê±° vs ë³´ì¡´</p>
<div style="display:flex;gap:15px;justify-content:center;flex-wrap:wrap;font-size:12px">
<div style="flex:1;min-width:220px;background:#fde8e8;padding:15px;border-radius:8px;border:2px solid #e74c3c">
<div style="font-weight:bold;color:#e74c3c;font-size:14px;margin-bottom:8px">ğŸš« ì œê±°í•´ì•¼ í•  ì´ìƒì¹˜</div>
<div style="color:#555">
<div style="margin-bottom:4px">â€¢ ê°€ê²©ì´ 0ì›ìœ¼ë¡œ ê¸°ë¡ë¨</div>
<div style="margin-bottom:4px">â€¢ ì†Œìˆ˜ì  ì˜¤ë¥˜ (7ë§Œâ†’70ë§Œ)</div>
<div style="margin-bottom:4px">â€¢ ê±°ë˜ì†Œ ì‹œìŠ¤í…œ ì˜¤ë¥˜</div>
<div>â€¢ ë°ì´í„° ì „ì†¡ ì¤‘ ì†ìƒ</div>
</div>
<div style="margin-top:8px;background:#fff;padding:6px;border-radius:4px;text-align:center;font-size:11px">ì›ì¸: <strong>ë°ì´í„° ì˜¤ë¥˜</strong></div>
</div>
<div style="flex:1;min-width:220px;background:#e8f8e8;padding:15px;border-radius:8px;border:2px solid #27ae60">
<div style="font-weight:bold;color:#27ae60;font-size:14px;margin-bottom:8px">âœ… ë³´ì¡´í•´ì•¼ í•  ê·¹ë‹¨ê°’</div>
<div style="color:#555">
<div style="margin-bottom:4px">â€¢ ì½”ë¡œë‚˜ í­ë½ (-12%/ì¼)</div>
<div style="margin-bottom:4px">â€¢ ë¦¬ë¨¼ ì‚¬íƒœ (-20%/ì¼)</div>
<div style="margin-bottom:4px">â€¢ ì‹¤ì  ì„œí”„ë¼ì´ì¦ˆ ê¸‰ë“±</div>
<div>â€¢ ê¸ˆë¦¬ ì¸ìƒ ì¶©ê²©</div>
</div>
<div style="margin-top:8px;background:#fff;padding:6px;border-radius:4px;text-align:center;font-size:11px">ì›ì¸: <strong>ì‹¤ì œ ì‹œì¥ ì‚¬ê±´</strong></div>
</div>
</div>
<div style="margin-top:12px;text-align:center;font-size:12px;color:#555;background:#fff;padding:8px;border-radius:6px">
ğŸ’¡ <strong>ì‹¤ì „ í•´ë²•:</strong> Winsorization (ìƒí•˜ìœ„ 1~2.5% ê¹ê¸°) â€” ì˜¤ë¥˜ëŠ” ì œê±°í•˜ë˜, ê·¹ë‹¨ê°’ ì •ë³´ëŠ” ì¼ë¶€ ë³´ì¡´
</div>
</div>

<h3>6.1 ê¸ˆìœµì—ì„œ ì´ìƒì¹˜ë€?</h3>
<p>ì´ìƒì¹˜(outlier)ëŠ” ë‹¤ë¥¸ ë°ì´í„°ì™€ í˜„ì €íˆ ë‹¤ë¥¸ ê°’ì´ë‹¤. ê¸ˆìœµì—ì„œ ì´ìƒì¹˜ëŠ” ë‘ ê°€ì§€ ì¢…ë¥˜ê°€ ìˆë‹¤:</p>

<ul>
<li><strong>ì§„ì§œ ì´ìƒì¹˜ (True Outlier):</strong> ë°ì´í„° ì˜¤ë¥˜. ê±°ë˜ì†Œ ì‹œìŠ¤í…œ ì˜¤ë¥˜ë¡œ ê°€ê²©ì´ 0ì›ìœ¼ë¡œ ì°íˆê±°ë‚˜, ì†Œìˆ˜ì  ì˜¤ë¥˜ë¡œ ì£¼ê°€ê°€ 10ë°°ë¡œ ê¸°ë¡ë˜ëŠ” ê²½ìš°. ì´ê²ƒì€ ë°˜ë“œì‹œ ì œê±°í•´ì•¼ í•œë‹¤.</li>
<li><strong>ê·¹ë‹¨ì ì´ì§€ë§Œ ì‹¤ì œ ê°’ (Extreme but Real):</strong> 2020ë…„ 3ì›” ì½”ë¡œë‚˜ í­ë½ ë•Œ í•˜ë£¨ -12% í•˜ë½, 2008ë…„ ë¦¬ë¨¼ ì‚¬íƒœ ë•Œ -20% í­ë½. ì´ê²ƒì€ ì‹¤ì œë¡œ ì¼ì–´ë‚œ ì¼ì´ë‹¤. í•¨ë¶€ë¡œ ì œê±°í•˜ë©´ ëª¨ë¸ì´ ìœ„ê¸° ìƒí™©ì„ í•™ìŠµí•˜ì§€ ëª»í•œë‹¤.</li>
</ul>

<p>ì´ êµ¬ë¶„ì´ ë§¤ìš° ì¤‘ìš”í•˜ë‹¤. ë°ì´í„° ì˜¤ë¥˜ëŠ” ì œê±°í•˜ë˜, ì‹¤ì œ ê·¹ë‹¨ê°’ì€ ë³´ì¡´í•´ì•¼ í•œë‹¤. ì´ê²ƒì´ ê¸ˆìœµ ë°ì´í„° ì •ì œì˜ í•µì‹¬ ë”œë ˆë§ˆë‹¤.</p>

<h3>6.2 Z-Score ë°©ë²•</h3>
<p>Z-scoreëŠ” "ì´ ê°’ì´ í‰ê· ì—ì„œ í‘œì¤€í¸ì°¨ ëª‡ ê°œë§Œí¼ ë–¨ì–´ì ¸ ìˆëŠ”ê°€"ë¥¼ ì¸¡ì •í•œë‹¤. ì¼ë°˜ì ìœ¼ë¡œ |Z| > 3ì´ë©´ ì´ìƒì¹˜ë¡œ íŒë‹¨í•œë‹¤ (ì •ê·œë¶„í¬ì—ì„œ 99.7% ë°–).</p>

<div class="eq">\[ Z_i = \frac{x_i - \mu}{\sigma} \]</div>

<pre><code><span class="cm"># Z-Score ì´ìƒì¹˜ íƒì§€</span>
returns = log_returns[<span class="st">"ì‚¼ì„±ì „ì"</span>]

z_scores = (returns - returns.mean()) / returns.std()

<span class="cm"># |Z| > 3ì¸ ë‚  ì°¾ê¸°</span>
outliers_z = returns[np.abs(z_scores) > <span class="nu">3</span>]
<span class="fn">print</span>(<span class="st">f"Z-Score ì´ìƒì¹˜: </span>{<span class="fn">len</span>(outliers_z)}<span class="st">ê°œ"</span>)
<span class="fn">print</span>(outliers_z)

<span class="cm"># ì‹œê°í™”</span>
fig, axes = plt.subplots(<span class="nu">2</span>, <span class="nu">1</span>, figsize=(<span class="nu">14</span>, <span class="nu">8</span>))

<span class="cm"># ìƒë‹¨: ìˆ˜ìµë¥  ì‹œê³„ì—´ + ì´ìƒì¹˜ í‘œì‹œ</span>
axes[<span class="nu">0</span>].plot(returns.index, returns.values, color=<span class="st">"steelblue"</span>, linewidth=<span class="nu">0.8</span>)
axes[<span class="nu">0</span>].scatter(outliers_z.index, outliers_z.values, color=<span class="st">"red"</span>, s=<span class="nu">50</span>, zorder=<span class="nu">5</span>, label=<span class="st">"ì´ìƒì¹˜ (|Z|>3)"</span>)
axes[<span class="nu">0</span>].set_title(<span class="st">"ì‚¼ì„±ì „ì ì¼ê°„ ìˆ˜ìµë¥  + Z-Score ì´ìƒì¹˜"</span>)
axes[<span class="nu">0</span>].legend()
axes[<span class="nu">0</span>].grid(<span class="kw">True</span>, alpha=<span class="nu">0.3</span>)

<span class="cm"># í•˜ë‹¨: Z-Score ë¶„í¬</span>
axes[<span class="nu">1</span>].hist(z_scores, bins=<span class="nu">50</span>, color=<span class="st">"steelblue"</span>, alpha=<span class="nu">0.7</span>, edgecolor=<span class="st">"white"</span>)
axes[<span class="nu">1</span>].axvline(x=<span class="nu">3</span>, color=<span class="st">"red"</span>, linestyle=<span class="st">"--"</span>, label=<span class="st">"Z = Â±3"</span>)
axes[<span class="nu">1</span>].axvline(x=-<span class="nu">3</span>, color=<span class="st">"red"</span>, linestyle=<span class="st">"--"</span>)
axes[<span class="nu">1</span>].set_title(<span class="st">"Z-Score ë¶„í¬"</span>)
axes[<span class="nu">1</span>].legend()
axes[<span class="nu">1</span>].grid(<span class="kw">True</span>, alpha=<span class="nu">0.3</span>)

plt.tight_layout()
plt.show()</code></pre>

<div class="warn">
<p class="ni"><strong>Z-Scoreì˜ í•œê³„:</strong> Z-scoreëŠ” ë°ì´í„°ê°€ ì •ê·œë¶„í¬ë¥¼ ë”°ë¥¸ë‹¤ê³  ê°€ì •í•œë‹¤. í•˜ì§€ë§Œ ê¸ˆìœµ ìˆ˜ìµë¥ ì€ "íŒ» í…Œì¼(fat tail)"ì„ ê°€ì§„ë‹¤ â€” ê·¹ë‹¨ê°’ì´ ì •ê·œë¶„í¬ë³´ë‹¤ í›¨ì”¬ ìì£¼ ë°œìƒí•œë‹¤. Round 2ì—ì„œ ë°°ìš´ ë‚´ìš©ì´ë‹¤. ë”°ë¼ì„œ Z-scoreë§Œìœ¼ë¡œ ì´ìƒì¹˜ë¥¼ íŒë‹¨í•˜ë©´ ì‹¤ì œ ê·¹ë‹¨ê°’ì„ ë„ˆë¬´ ë§ì´ ì´ìƒì¹˜ë¡œ ë¶„ë¥˜í•  ìˆ˜ ìˆë‹¤.</p>
</div>

<h3>6.3 IQR ë°©ë²•</h3>
<p>IQR(Interquartile Range, ì‚¬ë¶„ìœ„ ë²”ìœ„)ì€ ë¶„í¬ì˜ ê°€ì • ì—†ì´ ì´ìƒì¹˜ë¥¼ íƒì§€í•˜ëŠ” ë°©ë²•ì´ë‹¤. ë°•ìŠ¤í”Œë¡¯(box plot)ì˜ ìˆ˜ì—¼(whisker) ë°”ê¹¥ì— ìˆëŠ” ê°’ì„ ì´ìƒì¹˜ë¡œ íŒë‹¨í•œë‹¤.</p>

<div class="eq">\[ \text{IQR} = Q_3 - Q_1 \]
\[ \text{ì´ìƒì¹˜}: x < Q_1 - 1.5 \times \text{IQR} \quad \text{ë˜ëŠ”} \quad x > Q_3 + 1.5 \times \text{IQR} \]</div>

<pre><code><span class="cm"># IQR ì´ìƒì¹˜ íƒì§€</span>
Q1 = returns.quantile(<span class="nu">0.25</span>)
Q3 = returns.quantile(<span class="nu">0.75</span>)
IQR = Q3 - Q1

lower = Q1 - <span class="nu">1.5</span> * IQR
upper = Q3 + <span class="nu">1.5</span> * IQR

outliers_iqr = returns[(returns < lower) | (returns > upper)]
<span class="fn">print</span>(<span class="st">f"IQR ì´ìƒì¹˜: </span>{<span class="fn">len</span>(outliers_iqr)}<span class="st">ê°œ"</span>)
<span class="fn">print</span>(<span class="st">f"ë²”ìœ„: [{lower:.4f}, {upper:.4f}]"</span>)

<span class="cm"># ë°•ìŠ¤í”Œë¡¯ìœ¼ë¡œ ì‹œê°í™”</span>
fig, ax = plt.subplots(figsize=(<span class="nu">10</span>, <span class="nu">4</span>))
bp = ax.boxplot([log_returns[col].dropna() <span class="kw">for</span> col <span class="kw">in</span> log_returns.columns],
                labels=log_returns.columns, vert=<span class="kw">True</span>, patch_artist=<span class="kw">True</span>)
<span class="kw">for</span> patch <span class="kw">in</span> bp[<span class="st">"boxes"</span>]:
    patch.set_facecolor(<span class="st">"lightblue"</span>)
ax.set_title(<span class="st">"5ì¢…ëª© ìˆ˜ìµë¥  ë°•ìŠ¤í”Œë¡¯ (ë¹¨ê°„ ì  = ì´ìƒì¹˜)"</span>)
ax.set_ylabel(<span class="st">"ì¼ê°„ ë¡œê·¸ìˆ˜ìµë¥ "</span>)
ax.grid(<span class="kw">True</span>, alpha=<span class="nu">0.3</span>)
plt.tight_layout()
plt.show()</code></pre>

<h3>6.4 Winsorization â€” ì´ìƒì¹˜ë¥¼ "ê¹ëŠ”" ë°©ë²•</h3>
<p>ì´ìƒì¹˜ë¥¼ ì™„ì „íˆ ì œê±°í•˜ëŠ” ëŒ€ì‹ , ì¼ì • ë²”ìœ„ë¡œ "ê¹ì•„ë‚´ëŠ”" ë°©ë²•ì´ Winsorizationì´ë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ìƒí•˜ìœ„ 1%ë¥¼ ê¹ìœ¼ë©´, ìƒìœ„ 1%ë³´ë‹¤ í° ê°’ì€ ìƒìœ„ 1% ê°’ìœ¼ë¡œ, í•˜ìœ„ 1%ë³´ë‹¤ ì‘ì€ ê°’ì€ í•˜ìœ„ 1% ê°’ìœ¼ë¡œ ëŒ€ì²´í•œë‹¤.</p>

<p>ì´ ë°©ë²•ì˜ ì¥ì ì€ ê·¹ë‹¨ê°’ì˜ ì˜í–¥ì„ ì¤„ì´ë©´ì„œë„ ë°ì´í„°ë¥¼ ì‚­ì œí•˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ê²ƒì´ë‹¤. ê¸ˆìœµ MLì—ì„œ ë§¤ìš° ìì£¼ ì‚¬ìš©ëœë‹¤.</p>

<pre><code><span class="kw">from</span> scipy.stats <span class="kw">import</span> mstats

<span class="cm"># Winsorization: ìƒí•˜ìœ„ 1% ê¹ê¸°</span>
returns_win = pd.Series(
    mstats.winsorize(returns, limits=[<span class="nu">0.01</span>, <span class="nu">0.01</span>]),
    index=returns.index
)

<span class="cm"># ì§ì ‘ êµ¬í˜„ (scipy ì—†ì´)</span>
<span class="kw">def</span> <span class="fn">winsorize_series</span>(s, lower_pct=<span class="nu">0.01</span>, upper_pct=<span class="nu">0.99</span>):
    <span class="st">"""ì‹œë¦¬ì¦ˆì˜ ìƒí•˜ìœ„ë¥¼ ê¹ëŠ”ë‹¤"""</span>
    lower = s.quantile(lower_pct)
    upper = s.quantile(upper_pct)
    <span class="kw">return</span> s.clip(lower=lower, upper=upper)

returns_win2 = winsorize_series(returns)

<span class="cm"># ë¹„êµ</span>
<span class="fn">print</span>(<span class="st">"=== ì›ë³¸ vs Winsorized ==="</span>)
<span class="fn">print</span>(<span class="st">f"ì›ë³¸ - min: </span>{returns.min():.4f}<span class="st">, max: </span>{returns.max():.4f}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"ê¹ìŒ - min: </span>{returns_win2.min():.4f}<span class="st">, max: </span>{returns_win2.max():.4f}<span class="st">"</span>)

<span class="cm"># ì‹œê°í™”: ì›ë³¸ vs Winsorized ë¶„í¬</span>
fig, axes = plt.subplots(<span class="nu">1</span>, <span class="nu">2</span>, figsize=(<span class="nu">12</span>, <span class="nu">4</span>))
axes[<span class="nu">0</span>].hist(returns, bins=<span class="nu">50</span>, color=<span class="st">"steelblue"</span>, alpha=<span class="nu">0.7</span>, edgecolor=<span class="st">"white"</span>)
axes[<span class="nu">0</span>].set_title(<span class="st">"ì›ë³¸ ìˆ˜ìµë¥  ë¶„í¬"</span>)
axes[<span class="nu">1</span>].hist(returns_win2, bins=<span class="nu">50</span>, color=<span class="st">"coral"</span>, alpha=<span class="nu">0.7</span>, edgecolor=<span class="st">"white"</span>)
axes[<span class="nu">1</span>].set_title(<span class="st">"Winsorized ìˆ˜ìµë¥  ë¶„í¬ (1%/99%)"</span>)
<span class="kw">for</span> ax <span class="kw">in</span> axes:
    ax.grid(<span class="kw">True</span>, alpha=<span class="nu">0.3</span>)
plt.tight_layout()
plt.show()</code></pre>

<div class="info">
<p class="ni"><strong>ì‹¤ì „ì—ì„œì˜ ì„ íƒ:</strong> ëŒ€ë¶€ë¶„ì˜ í€€íŠ¸ í€ë“œì—ì„œëŠ” ìˆ˜ìµë¥  ë°ì´í„°ì— Winsorization(ìƒí•˜ìœ„ 1~2.5%)ì„ ì ìš©í•œë‹¤. ì´ìœ ëŠ” (1) ë°ì´í„°ë¥¼ ì‚­ì œí•˜ì§€ ì•Šì•„ ì‹œê³„ì—´ ì—°ì†ì„±ì´ ìœ ì§€ë˜ê³ , (2) ê·¹ë‹¨ê°’ì˜ ì˜í–¥ì„ ì¤„ì—¬ ëª¨ë¸ì´ ì•ˆì •ì ìœ¼ë¡œ í•™ìŠµí•˜ë©°, (3) êµ¬í˜„ì´ ê°„ë‹¨í•˜ê¸° ë•Œë¬¸ì´ë‹¤. MLAT Ch.4ì—ì„œë„ ì•ŒíŒŒíŒ©í„° ê³„ì‚° ì‹œ Winsorizationì„ ê¶Œì¥í•œë‹¤.</p>
</div>

<h3>6.5 ì´ìƒì¹˜ ì²˜ë¦¬ ì „ëµ ì •ë¦¬</h3>

<div class="tc">Table 5. ì´ìƒì¹˜ ì²˜ë¦¬ ë°©ë²• ë¹„êµ</div>
<table>
<tr><th>ë°©ë²•</th><th>ì›ë¦¬</th><th>ì¥ì </th><th>ë‹¨ì </th><th>ê¸ˆìœµ ì í•©ë„</th></tr>
<tr><td>Z-Score ì œê±°</td><td>|Z| > 3 ì œê±°</td><td>í†µê³„ì  ê·¼ê±°</td><td>ì •ê·œë¶„í¬ ê°€ì •, íŒ»í…Œì¼ ë¬´ì‹œ</td><td>â–³</td></tr>
<tr><td>IQR ì œê±°</td><td>1.5Ã—IQR ë°– ì œê±°</td><td>ë¶„í¬ ê°€ì • ì—†ìŒ</td><td>ê¸ˆìœµì—ì„œ ë„ˆë¬´ ë§ì´ ì œê±°</td><td>â–³</td></tr>
<tr><td>Winsorization</td><td>ìƒí•˜ìœ„ n% ê¹ê¸°</td><td>ë°ì´í„° ë³´ì¡´, ì•ˆì •ì </td><td>ê·¹ë‹¨ê°’ ì •ë³´ ì¼ë¶€ ì†ì‹¤</td><td>â­ ì¶”ì²œ</td></tr>
<tr><td>ë¡œê·¸ ë³€í™˜</td><td>log(x)ë¡œ ìŠ¤ì¼€ì¼ ì¶•ì†Œ</td><td>ì™œë„ ê°ì†Œ</td><td>ìŒìˆ˜ ë¶ˆê°€</td><td>ê°€ê²© ë°ì´í„°ì— ì í•©</td></tr>
<tr><td>MAD</td><td>ì¤‘ì•™ê°’ ê¸°ë°˜ í¸ì°¨</td><td>ë¡œë²„ìŠ¤íŠ¸</td><td>ëœ ì•Œë ¤ì§</td><td>â—‹</td></tr>
</table>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- Ch7: ì •ê·œí™”ì™€ í‘œì¤€í™” -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<h2 id="ch7">7. ì •ê·œí™”ì™€ í‘œì¤€í™” â€” ìŠ¤ì¼€ì¼ì„ ë§ì¶°ë¼</h2>

<!-- ìŠ¤ì¼€ì¼ë§ ë¹„êµ ë‹¤ì´ì–´ê·¸ë¨ (CSS) -->
<div style="margin:25px 0;padding:25px;background:linear-gradient(135deg,#f8f9fa,#f0f0fa);border-radius:10px;border:1px solid #ccc">
<p class="ni" style="text-align:center;font-weight:bold;font-size:15px;margin-bottom:18px;color:#2c3e50">âš–ï¸ ìŠ¤ì¼€ì¼ë§ 3ì¢… ë¹„êµ</p>
<div style="display:flex;gap:12px;justify-content:center;flex-wrap:wrap;font-size:12px">
<div style="flex:1;min-width:180px;background:#fff;border-radius:8px;padding:15px;border-top:4px solid #3498db;box-shadow:0 1px 3px rgba(0,0,0,0.1)">
<div style="font-weight:bold;color:#3498db;font-size:14px;margin-bottom:8px">Min-Max ì •ê·œí™”</div>
<div style="background:#e8f4f8;padding:8px;border-radius:4px;text-align:center;font-family:monospace;margin-bottom:8px">[0, 1] ë²”ìœ„ë¡œ ì••ì¶•</div>
<div style="color:#555;margin-bottom:6px">
<div style="display:flex;justify-content:space-between;margin-bottom:2px"><span>ì›ë³¸:</span><span>70,000ì›</span></div>
<div style="display:flex;justify-content:space-between"><span>ë³€í™˜:</span><span style="color:#3498db;font-weight:bold">0.75</span></div>
</div>
<div style="font-size:11px;color:#888">âœ… ë²”ìœ„ ê³ ì • í”¼ì²˜ (RSI ë“±)</div>
<div style="font-size:11px;color:#e74c3c">âš ï¸ ì´ìƒì¹˜ì— ë§¤ìš° ë¯¼ê°</div>
</div>
<div style="flex:1;min-width:180px;background:#fff;border-radius:8px;padding:15px;border-top:4px solid #e67e22;box-shadow:0 1px 3px rgba(0,0,0,0.1)">
<div style="font-weight:bold;color:#e67e22;font-size:14px;margin-bottom:8px">Z-Score í‘œì¤€í™”</div>
<div style="background:#fff9e6;padding:8px;border-radius:4px;text-align:center;font-family:monospace;margin-bottom:8px">í‰ê· =0, í‘œì¤€í¸ì°¨=1</div>
<div style="color:#555;margin-bottom:6px">
<div style="display:flex;justify-content:space-between;margin-bottom:2px"><span>ì›ë³¸:</span><span>70,000ì›</span></div>
<div style="display:flex;justify-content:space-between"><span>ë³€í™˜:</span><span style="color:#e67e22;font-weight:bold">+0.42Ïƒ</span></div>
</div>
<div style="font-size:11px;color:#888">âœ… ìˆ˜ìµë¥ , íŒ©í„° ê°’ â­ì¶”ì²œ</div>
<div style="font-size:11px;color:#888">âœ… PCA, ì„ í˜•íšŒê·€ì— ì í•©</div>
</div>
<div style="flex:1;min-width:180px;background:#fff;border-radius:8px;padding:15px;border-top:4px solid #27ae60;box-shadow:0 1px 3px rgba(0,0,0,0.1)">
<div style="font-weight:bold;color:#27ae60;font-size:14px;margin-bottom:8px">Robust ìŠ¤ì¼€ì¼ë§</div>
<div style="background:#e8f8e8;padding:8px;border-radius:4px;text-align:center;font-family:monospace;margin-bottom:8px">ì¤‘ì•™ê°’=0, IQR ê¸°ë°˜</div>
<div style="color:#555;margin-bottom:6px">
<div style="display:flex;justify-content:space-between;margin-bottom:2px"><span>ì›ë³¸:</span><span>70,000ì›</span></div>
<div style="display:flex;justify-content:space-between"><span>ë³€í™˜:</span><span style="color:#27ae60;font-weight:bold">+0.38</span></div>
</div>
<div style="font-size:11px;color:#888">âœ… ì´ìƒì¹˜ ë§ì€ ë°ì´í„°</div>
<div style="font-size:11px;color:#888">âœ… ê±°ë˜ëŸ‰, ì‹œê°€ì´ì•¡</div>
</div>
</div>
<div style="margin-top:15px;text-align:center;font-size:12px;color:#555;background:#fff;padding:8px;border-radius:6px">
âš ï¸ <strong>í•µì‹¬ ê·œì¹™:</strong> Train ë°ì´í„°ì—ì„œ fit â†’ Test ë°ì´í„°ì—ëŠ” transformë§Œ! (ë¯¸ë˜ ì •ë³´ ëˆ„ì¶œ ë°©ì§€)
</div>
</div>

<h3>7.1 ì™œ ìŠ¤ì¼€ì¼ë§ì´ í•„ìš”í•œê°€</h3>
<p>ì‚¼ì„±ì „ì ì£¼ê°€ëŠ” ì•½ 7ë§Œ ì›ì´ê³ , SKí•˜ì´ë‹‰ìŠ¤ëŠ” ì•½ 20ë§Œ ì›ì´ê³ , ê±°ë˜ëŸ‰ì€ ìˆ˜ì²œë§Œ ì£¼ë‹¤. ì´ ì„¸ ê°€ì§€ë¥¼ í”¼ì²˜ë¡œ ì‚¬ìš©í•˜ë©´, ìˆ«ìê°€ í° í”¼ì²˜(ê±°ë˜ëŸ‰)ê°€ ML ëª¨ë¸ì„ ì§€ë°°í•˜ê²Œ ëœë‹¤. ëª¨ë¸ì´ "ê±°ë˜ëŸ‰ì´ ì¤‘ìš”í•˜ë‹¤"ê³  ì°©ê°í•˜ëŠ” ê²ƒì´ë‹¤.</p>

<p>ì´ê²ƒì„ ë¹„ìœ í•˜ë©´: í‚¤(cm)ì™€ ëª¸ë¬´ê²Œ(kg)ë¥¼ ë¹„êµí•  ë•Œ, í‚¤ê°€ 170ì´ê³  ëª¸ë¬´ê²Œê°€ 70ì´ë©´ "í‚¤ê°€ ë” í¬ë‹¤"ê³  ë§í•˜ëŠ” ê²ƒê³¼ ê°™ë‹¤. ë‹¨ìœ„ê°€ ë‹¤ë¥´ë‹ˆê¹Œ ì§ì ‘ ë¹„êµí•  ìˆ˜ ì—†ë‹¤. ìŠ¤ì¼€ì¼ë§ì€ ëª¨ë“  í”¼ì²˜ë¥¼ ê°™ì€ ë‹¨ìœ„ë¡œ ë§ì¶”ëŠ” ì‘ì—…ì´ë‹¤.</p>

<h3>7.2 Min-Max ì •ê·œí™” (Normalization)</h3>
<p>ëª¨ë“  ê°’ì„ 0~1 ì‚¬ì´ë¡œ ë³€í™˜í•œë‹¤. ìµœì†Ÿê°’ì´ 0, ìµœëŒ“ê°’ì´ 1ì´ ëœë‹¤.</p>

<div class="eq">\[ x_{\text{norm}} = \frac{x - x_{\min}}{x_{\max} - x_{\min}} \]</div>

<pre><code><span class="kw">from</span> sklearn.preprocessing <span class="kw">import</span> MinMaxScaler

<span class="cm"># ì˜ˆì œ: ì£¼ê°€ì™€ ê±°ë˜ëŸ‰ì˜ ìŠ¤ì¼€ì¼ ì°¨ì´</span>
raw = pd.DataFrame({
    <span class="st">"price"</span>: [<span class="nu">70000</span>, <span class="nu">71000</span>, <span class="nu">69500</span>, <span class="nu">72000</span>, <span class="nu">70500</span>],
    <span class="st">"volume"</span>: [<span class="nu">15000000</span>, <span class="nu">20000000</span>, <span class="nu">12000000</span>, <span class="nu">25000000</span>, <span class="nu">18000000</span>],
    <span class="st">"rsi"</span>: [<span class="nu">45</span>, <span class="nu">52</span>, <span class="nu">38</span>, <span class="nu">65</span>, <span class="nu">48</span>]
})

<span class="fn">print</span>(<span class="st">"=== ì›ë³¸ (ìŠ¤ì¼€ì¼ ì°¨ì´ ê·¹ì‹¬) ==="</span>)
<span class="fn">print</span>(raw)

<span class="cm"># Min-Max ì •ê·œí™”</span>
scaler = MinMaxScaler()
normalized = pd.DataFrame(
    scaler.fit_transform(raw),
    columns=raw.columns
)

<span class="fn">print</span>(<span class="st">"\n=== Min-Max ì •ê·œí™” (0~1) ==="</span>)
<span class="fn">print</span>(normalized.round(<span class="nu">4</span>))

<span class="cm"># ì§ì ‘ êµ¬í˜„</span>
<span class="kw">def</span> <span class="fn">minmax_normalize</span>(df):
    <span class="kw">return</span> (df - df.min()) / (df.max() - df.min())

normalized2 = minmax_normalize(raw)
<span class="fn">print</span>(<span class="st">"\n=== ì§ì ‘ êµ¬í˜„ ê²°ê³¼ ==="</span>)
<span class="fn">print</span>(normalized2.round(<span class="nu">4</span>))</code></pre>

<div class="warn">
<p class="ni"><strong>Min-Maxì˜ ì•½ì :</strong> ì´ìƒì¹˜ì— ë§¤ìš° ë¯¼ê°í•˜ë‹¤. ë§Œì•½ ê±°ë˜ëŸ‰ì— 1ì–µ ì£¼ì§œë¦¬ ì´ìƒì¹˜ê°€ í•˜ë‚˜ ìˆìœ¼ë©´, ë‚˜ë¨¸ì§€ ëª¨ë“  ê°’ì´ 0ì— ê°€ê¹ê²Œ ì••ì¶•ëœë‹¤. ë”°ë¼ì„œ ì´ìƒì¹˜ ì²˜ë¦¬ë¥¼ ë¨¼ì € í•œ í›„ì— Min-Maxë¥¼ ì ìš©í•´ì•¼ í•œë‹¤.</p>
</div>

<h3>7.3 Z-Score í‘œì¤€í™” (Standardization)</h3>
<p>í‰ê· ì„ 0, í‘œì¤€í¸ì°¨ë¥¼ 1ë¡œ ë³€í™˜í•œë‹¤. ì •ê·œë¶„í¬ë¥¼ ë”°ë¥´ëŠ” ë°ì´í„°ì— íŠ¹íˆ ì í•©í•˜ë‹¤.</p>

<div class="eq">\[ x_{\text{std}} = \frac{x - \mu}{\sigma} \]</div>

<pre><code><span class="kw">from</span> sklearn.preprocessing <span class="kw">import</span> StandardScaler

<span class="cm"># Z-Score í‘œì¤€í™”</span>
scaler_z = StandardScaler()
standardized = pd.DataFrame(
    scaler_z.fit_transform(raw),
    columns=raw.columns
)

<span class="fn">print</span>(<span class="st">"=== Z-Score í‘œì¤€í™” (í‰ê· =0, í‘œì¤€í¸ì°¨=1) ==="</span>)
<span class="fn">print</span>(standardized.round(<span class="nu">4</span>))

<span class="fn">print</span>(<span class="st">"\n=== ê²€ì¦: í‰ê· ê³¼ í‘œì¤€í¸ì°¨ ==="</span>)
<span class="fn">print</span>(<span class="st">f"í‰ê· : </span>{standardized.mean().round(<span class="nu">6</span>).tolist()}<span class="st">"</span>)  <span class="cm"># â‰ˆ 0</span>
<span class="fn">print</span>(<span class="st">f"í‘œì¤€í¸ì°¨: </span>{standardized.std().round(<span class="nu">4</span>).tolist()}<span class="st">"</span>)  <span class="cm"># â‰ˆ 1</span></code></pre>

<h3>7.4 ì–´ë–¤ ìŠ¤ì¼€ì¼ë§ì„ ì„ íƒí• ê¹Œ?</h3>

<div class="tc">Table 6. ìŠ¤ì¼€ì¼ë§ ë°©ë²• ë¹„êµ</div>
<table>
<tr><th>ë°©ë²•</th><th>ë²”ìœ„</th><th>ì´ìƒì¹˜ ë¯¼ê°ë„</th><th>ì í•©í•œ ëª¨ë¸</th><th>ê¸ˆìœµ ì‚¬ìš© ì˜ˆ</th></tr>
<tr><td>Min-Max</td><td>[0, 1]</td><td>ë§¤ìš° ë¯¼ê°</td><td>ì‹ ê²½ë§, KNN</td><td>RSI ë“± ë²”ìœ„ê°€ ì •í•´ì§„ ì§€í‘œ</td></tr>
<tr><td>Z-Score</td><td>(-âˆ, +âˆ)</td><td>ëœ ë¯¼ê°</td><td>ì„ í˜•íšŒê·€, SVM, PCA</td><td>ìˆ˜ìµë¥ , íŒ©í„° ê°’</td></tr>
<tr><td>Robust</td><td>(-âˆ, +âˆ)</td><td>ë¡œë²„ìŠ¤íŠ¸</td><td>ì´ìƒì¹˜ ë§ì€ ë°ì´í„°</td><td>ê±°ë˜ëŸ‰, ì‹œê°€ì´ì•¡</td></tr>
</table>

<pre><code><span class="kw">from</span> sklearn.preprocessing <span class="kw">import</span> RobustScaler

<span class="cm"># Robust Scaler: ì¤‘ì•™ê°’ê³¼ IQR ê¸°ë°˜ (ì´ìƒì¹˜ì— ê°•ê±´)</span>
scaler_r = RobustScaler()
robust = pd.DataFrame(
    scaler_r.fit_transform(raw),
    columns=raw.columns
)
<span class="fn">print</span>(<span class="st">"=== Robust Scaling ==="</span>)
<span class="fn">print</span>(robust.round(<span class="nu">4</span>))</code></pre>

<div class="def">
<p class="ni"><strong>í•µì‹¬ ì›ì¹™: Train/Test ë¶„ë¦¬ ì‹œ ìŠ¤ì¼€ì¼ë§</strong></p>
<p class="ni">ìŠ¤ì¼€ì¼ë§ì˜ íŒŒë¼ë¯¸í„°(í‰ê· , í‘œì¤€í¸ì°¨, ìµœì†Ÿê°’, ìµœëŒ“ê°’)ëŠ” ë°˜ë“œì‹œ í•™ìŠµ ë°ì´í„°(train set)ì—ì„œë§Œ ê³„ì‚°í•´ì•¼ í•œë‹¤. í…ŒìŠ¤íŠ¸ ë°ì´í„°ì˜ ì •ë³´ê°€ ìŠ¤ì¼€ì¼ë§ì— í¬í•¨ë˜ë©´ ë¯¸ë˜ ì •ë³´ ëˆ„ì¶œì´ë‹¤. ì´ê²ƒì€ Round 4ì—ì„œ ëª¨ë¸ì„ í•™ìŠµí•  ë•Œ ë§¤ìš° ì¤‘ìš”í•´ì§„ë‹¤.</p>
</div>

<pre><code><span class="cm"># ì˜¬ë°”ë¥¸ ìŠ¤ì¼€ì¼ë§ ì ˆì°¨</span>
<span class="kw">from</span> sklearn.model_selection <span class="kw">import</span> train_test_split

<span class="cm"># 1. ë°ì´í„° ë¶„í• </span>
X_train, X_test = train_test_split(raw, test_size=<span class="nu">0.2</span>, shuffle=<span class="kw">False</span>)
<span class="cm"># shuffle=False: ì‹œê³„ì—´ì´ë¯€ë¡œ ì„ì§€ ì•ŠëŠ”ë‹¤!</span>

<span class="cm"># 2. trainì—ì„œë§Œ fit</span>
scaler = StandardScaler()
X_train_scaled = scaler.fit_transform(X_train)  <span class="cm"># fit + transform</span>

<span class="cm"># 3. testì—ëŠ” transformë§Œ (fit í•˜ì§€ ì•ŠìŒ!)</span>
X_test_scaled = scaler.transform(X_test)  <span class="cm"># transformë§Œ!</span>

<span class="fn">print</span>(<span class="st">"Train í‰ê· :"</span>, X_train_scaled.mean(axis=<span class="nu">0</span>).round(<span class="nu">4</span>))  <span class="cm"># â‰ˆ 0</span>
<span class="fn">print</span>(<span class="st">"Test í‰ê· :"</span>, X_test_scaled.mean(axis=<span class="nu">0</span>).round(<span class="nu">4</span>))   <span class="cm"># â‰  0 (ì •ìƒ!)</span></code></pre>

<div class="warn">
<p class="ni"><strong>ê°€ì¥ í”í•œ ì‹¤ìˆ˜:</strong> <code>scaler.fit_transform(ì „ì²´ ë°ì´í„°)</code>ë¥¼ í•œ í›„ì— train/testë¡œ ë‚˜ëˆ„ëŠ” ê²ƒ. ì´ëŸ¬ë©´ test ë°ì´í„°ì˜ í†µê³„ëŸ‰ì´ ìŠ¤ì¼€ì¼ë§ì— ë°˜ì˜ë˜ì–´ ë¯¸ë˜ ì •ë³´ê°€ ëˆ„ì¶œëœë‹¤. ë°˜ë“œì‹œ "ë¨¼ì € ë‚˜ëˆ„ê³ , trainì—ì„œë§Œ fit"í•˜ì.</p>
</div>

<!-- â”€â”€ ë³´ì¶© 7.3+ ì™œ ìŠ¤ì¼€ì¼ë§ ìˆœì„œê°€ ì¤‘ìš”í•œê°€ â€” ë°ì´í„° ëˆ„ì¶œ ì‹¤í—˜ â”€â”€ -->
<div class="def">
<p class="ni"><strong>ğŸ” ë³´ì¶©: ì™œ ìŠ¤ì¼€ì¼ë§ ìˆœì„œê°€ ì¤‘ìš”í•œê°€ â€” ì˜ëª»ëœ ìˆœì„œ vs ì˜¬ë°”ë¥¸ ìˆœì„œ ì‹¤í—˜</strong></p>
<p class="ni">"ë¨¼ì € ë‚˜ëˆ„ê³  trainì—ì„œë§Œ fit" â€” ì´ ê·œì¹™ì„ ì–´ê¸°ë©´ ì‹¤ì œë¡œ ì–¼ë§ˆë‚˜ ì°¨ì´ê°€ ë‚˜ëŠ”ì§€ ìˆ«ìë¡œ í™•ì¸í•˜ì. ë°ì´í„° ëˆ„ì¶œ(data leakage)ì´ ë°±í…ŒìŠ¤íŠ¸ ì„±ê³¼ë¥¼ ì–´ë–»ê²Œ ë¶€í’€ë¦¬ëŠ”ì§€ ì§ê´€ì ìœ¼ë¡œ ì´í•´í•  ìˆ˜ ìˆë‹¤.</p>
</div>

<pre><code><span class="cm"># === ìŠ¤ì¼€ì¼ë§ ìˆœì„œ: ì˜ëª»ëœ ë°©ë²• vs ì˜¬ë°”ë¥¸ ë°©ë²• ===</span>
<span class="kw">import</span> numpy <span class="kw">as</span> np
<span class="kw">import</span> pandas <span class="kw">as</span> pd
<span class="kw">from</span> sklearn.preprocessing <span class="kw">import</span> StandardScaler

np.random.seed(<span class="nu">42</span>)

<span class="cm"># ê°€ìƒ ë°ì´í„°: train ê¸°ê°„ì€ ì•ˆì •ì , test ê¸°ê°„ì€ ê¸‰ë“±</span>
<span class="cm"># (ì‹¤ì „ì—ì„œ í”í•œ ìƒí™©: í•™ìŠµ ê¸°ê°„ê³¼ í…ŒìŠ¤íŠ¸ ê¸°ê°„ì˜ ë¶„í¬ê°€ ë‹¤ë¦„)</span>
train_data = np.random.normal(<span class="nu">100</span>, <span class="nu">10</span>, (<span class="nu">200</span>, <span class="nu">3</span>))  <span class="cm"># í‰ê·  100, í‘œì¤€í¸ì°¨ 10</span>
test_data = np.random.normal(<span class="nu">150</span>, <span class="nu">20</span>, (<span class="nu">50</span>, <span class="nu">3</span>))   <span class="cm"># í‰ê·  150, í‘œì¤€í¸ì°¨ 20 (ê¸‰ë“±!)</span>

<span class="fn">print</span>(<span class="st">"=== ì›ë³¸ ë°ì´í„° í†µê³„ ==="</span>)
<span class="fn">print</span>(<span class="st">f"Train í‰ê· : </span>{train_data.mean():.1f}<span class="st">, í‘œì¤€í¸ì°¨: </span>{train_data.std():.1f}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"Test í‰ê· :  </span>{test_data.mean():.1f}<span class="st">, í‘œì¤€í¸ì°¨: </span>{test_data.std():.1f}<span class="st">"</span>)</code></pre>

<pre><code><span class="cm"># âŒ ì˜ëª»ëœ ë°©ë²•: ì „ì²´ ë°ì´í„°ì— fit_transform í›„ ë¶„ë¦¬</span>
all_data = np.vstack([train_data, test_data])  <span class="cm"># í•©ì¹˜ê¸°</span>
scaler_wrong = StandardScaler()
all_scaled = scaler_wrong.fit_transform(all_data)  <span class="cm"># ì „ì²´ì— fit!</span>
train_wrong = all_scaled[:<span class="nu">200</span>]
test_wrong = all_scaled[<span class="nu">200</span>:]

<span class="fn">print</span>(<span class="st">"\n=== âŒ ì˜ëª»ëœ ë°©ë²• (ì „ì²´ fit) ==="</span>)
<span class="fn">print</span>(<span class="st">f"scalerê°€ í•™ìŠµí•œ í‰ê· : </span>{scaler_wrong.mean_[0]:.1f}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"  â†’ testì˜ ê¸‰ë“± ì •ë³´ê°€ í‰ê· ì— ë°˜ì˜ë¨!"</span>)
<span class="fn">print</span>(<span class="st">f"Train ìŠ¤ì¼€ì¼ë§ í›„ í‰ê· : </span>{train_wrong.mean():.4f}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"Test ìŠ¤ì¼€ì¼ë§ í›„ í‰ê· :  </span>{test_wrong.mean():.4f}<span class="st">"</span>)</code></pre>

<pre><code><span class="cm"># âœ… ì˜¬ë°”ë¥¸ ë°©ë²•: trainì—ì„œë§Œ fit, testì—ëŠ” transformë§Œ</span>
scaler_right = StandardScaler()
train_right = scaler_right.fit_transform(train_data)  <span class="cm"># trainì—ì„œë§Œ fit</span>
test_right = scaler_right.transform(test_data)         <span class="cm"># transformë§Œ!</span>

<span class="fn">print</span>(<span class="st">"\n=== âœ… ì˜¬ë°”ë¥¸ ë°©ë²• (trainë§Œ fit) ==="</span>)
<span class="fn">print</span>(<span class="st">f"scalerê°€ í•™ìŠµí•œ í‰ê· : </span>{scaler_right.mean_[0]:.1f}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"  â†’ train ë°ì´í„°ì˜ í†µê³„ë§Œ ì‚¬ìš©!"</span>)
<span class="fn">print</span>(<span class="st">f"Train ìŠ¤ì¼€ì¼ë§ í›„ í‰ê· : </span>{train_right.mean():.4f}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"Test ìŠ¤ì¼€ì¼ë§ í›„ í‰ê· :  </span>{test_right.mean():.4f}<span class="st">"</span>)

<span class="fn">print</span>(<span class="st">"\n=== ì°¨ì´ ë¹„êµ ==="</span>)
<span class="fn">print</span>(<span class="st">f"ì˜ëª»ëœ ë°©ë²• test í‰ê· : </span>{test_wrong.mean():.4f}<span class="st"> (0ì— ê°€ê¹Œì›€ â†’ ì •ìƒì²˜ëŸ¼ ë³´ì„)"</span>)
<span class="fn">print</span>(<span class="st">f"ì˜¬ë°”ë¥¸ ë°©ë²• test í‰ê· : </span>{test_right.mean():.4f}<span class="st"> (ì–‘ìˆ˜ â†’ ê¸‰ë“± ì‹ í˜¸ ë³´ì¡´!)"</span>)
<span class="fn">print</span>(<span class="st">f"\nâ†’ ì˜ëª»ëœ ë°©ë²•ì€ testì˜ ê¸‰ë“±ì„ 'ì •ìƒ'ìœ¼ë¡œ ë§Œë“¤ì–´ë²„ë¦°ë‹¤."</span>)
<span class="fn">print</span>(<span class="st">f"â†’ ëª¨ë¸ì´ 'ì´ê±´ ë¹„ì •ìƒì  ìƒìŠ¹ì´ë‹¤'ë¼ëŠ” ì‹ í˜¸ë¥¼ ë†“ì¹˜ê²Œ ëœë‹¤."</span>)
<span class="fn">print</span>(<span class="st">f"â†’ ë°±í…ŒìŠ¤íŠ¸ì—ì„œëŠ” ì˜ ë˜ì§€ë§Œ, ì‹¤ì „ì—ì„œ ì‹¤íŒ¨í•˜ëŠ” ì›ì¸!"</span>)</code></pre>

<div class="info">
<p class="ni"><strong>ì‹¤ì „ ì²´í¬ë¦¬ìŠ¤íŠ¸:</strong></p>
<ol>
<li><code>train_test_split()</code> ë˜ëŠ” ì‹œê°„ ê¸°ì¤€ìœ¼ë¡œ ë¨¼ì € ë¶„ë¦¬</li>
<li><code>scaler.fit(X_train)</code> â€” trainì—ì„œë§Œ í†µê³„ëŸ‰ í•™ìŠµ</li>
<li><code>X_train_scaled = scaler.transform(X_train)</code></li>
<li><code>X_test_scaled = scaler.transform(X_test)</code> â€” ê°™ì€ scalerë¡œ ë³€í™˜ë§Œ</li>
<li>êµì°¨ê²€ì¦(CV)ì—ì„œë„ ê° foldë§ˆë‹¤ ì´ ê³¼ì •ì„ ë°˜ë³µí•´ì•¼ í•œë‹¤ â†’ <code>Pipeline</code> ì‚¬ìš© ê¶Œì¥</li>
</ol>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- Ch8: ê¸°ìˆ ì  ì§€í‘œ í”¼ì²˜ -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<h2 id="ch8">8. ê¸°ìˆ ì  ì§€í‘œ í”¼ì²˜ â€” ê°€ê²©ì—ì„œ ì‹ í˜¸ë¥¼ ì¶”ì¶œí•˜ë‹¤</h2>

<h3>8.1 ê¸°ìˆ ì  ë¶„ì„ì´ë€?</h3>
<p>ê¸°ìˆ ì  ë¶„ì„(Technical Analysis)ì€ ê³¼ê±° ê°€ê²©ê³¼ ê±°ë˜ëŸ‰ íŒ¨í„´ì—ì„œ ë¯¸ë˜ ê°€ê²© ì›€ì§ì„ì„ ì˜ˆì¸¡í•˜ë ¤ëŠ” ë°©ë²•ë¡ ì´ë‹¤. "ì—­ì‚¬ëŠ” ë°˜ë³µëœë‹¤"ëŠ” ê°€ì •ì— ê¸°ë°˜í•œë‹¤. í•™ìˆ ì ìœ¼ë¡œëŠ” ë…¼ë€ì´ ìˆì§€ë§Œ, ì‹¤ì „ì—ì„œëŠ” ì—¬ì „íˆ ë„ë¦¬ ì‚¬ìš©ë˜ë©°, ML ëª¨ë¸ì˜ ì…ë ¥ í”¼ì²˜ë¡œë„ ë§¤ìš° ìœ ìš©í•˜ë‹¤.</p>

<p>ì™œ ê¸°ìˆ ì  ì§€í‘œê°€ ML í”¼ì²˜ë¡œ ì¢‹ì„ê¹Œ? ì›ì‹œ ê°€ê²© ë°ì´í„°(OHLCV)ë¥¼ ê·¸ëŒ€ë¡œ ëª¨ë¸ì— ë„£ìœ¼ë©´, ëª¨ë¸ì´ "ì‚¼ì„±ì „ì ì£¼ê°€ê°€ 7ë§Œ ì›ì´ë‹¤"ë¼ëŠ” ì ˆëŒ€ì  ìˆ˜ì¤€ë§Œ ë³¸ë‹¤. í•˜ì§€ë§Œ ê¸°ìˆ ì  ì§€í‘œëŠ” "ìµœê·¼ 14ì¼ ëŒ€ë¹„ ì§€ê¸ˆì´ ê³¼ë§¤ìˆ˜ì¸ê°€ ê³¼ë§¤ë„ì¸ê°€"(RSI), "ë‹¨ê¸° ì¶”ì„¸ê°€ ì¥ê¸° ì¶”ì„¸ë¥¼ ìƒí–¥ ëŒíŒŒí–ˆëŠ”ê°€"(MACD) ê°™ì€ ìƒëŒ€ì  ì •ë³´ë¥¼ ì œê³µí•œë‹¤. ì´ëŸ° ìƒëŒ€ì  ì •ë³´ê°€ ML ëª¨ë¸ì—ê²Œ í›¨ì”¬ ìœ ìš©í•˜ë‹¤.</p>

<!-- ê¸°ìˆ ì  ì§€í‘œ ë¶„ë¥˜ ë‹¤ì´ì–´ê·¸ë¨ (CSS) -->
<div style="margin:25px 0;padding:20px;background:#f8f9fa;border-radius:8px;border:1px solid #ddd">
<p class="ni" style="text-align:center;font-weight:bold;font-size:14px;margin-bottom:15px;color:#2c3e50">ğŸ“ˆ ê¸°ìˆ ì  ì§€í‘œ 4ëŒ€ ì¹´í…Œê³ ë¦¬</p>
<div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:10px;font-size:12px">
<div style="background:#e8f4f8;padding:14px;border-radius:6px;border-top:3px solid #3498db">
<div style="font-weight:bold;color:#2c3e50;font-size:13px;margin-bottom:8px">ğŸ“Š ì¶”ì„¸ (Trend)</div>
<div style="color:#555">ì‹œì¥ì´ ì˜¬ë¼ê°€ëŠ” ì¤‘ì¸ê°€, ë‚´ë ¤ê°€ëŠ” ì¤‘ì¸ê°€?</div>
<div style="margin-top:8px;font-size:11px;color:#3498db">
â€¢ SMA / EMA (ì´ë™í‰ê· )<br>
â€¢ MACD<br>
â€¢ ê³¨ë“ í¬ë¡œìŠ¤ / ë°ë“œí¬ë¡œìŠ¤
</div>
</div>
<div style="background:#fff9e6;padding:14px;border-radius:6px;border-top:3px solid #f39c12">
<div style="font-weight:bold;color:#2c3e50;font-size:13px;margin-bottom:8px">âš¡ ê³¼ë§¤ìˆ˜/ê³¼ë§¤ë„</div>
<div style="color:#555">ë„ˆë¬´ ë§ì´ ì˜¬ëë‚˜? ë„ˆë¬´ ë§ì´ ë–¨ì–´ì¡Œë‚˜?</div>
<div style="margin-top:8px;font-size:11px;color:#e67e22">
â€¢ RSI<br>
â€¢ ë³¼ë¦°ì € ë°´ë“œ %B<br>
â€¢ ìŠ¤í† ìºìŠ¤í‹±
</div>
</div>
<div style="background:#e8f8e8;padding:14px;border-radius:6px;border-top:3px solid #27ae60">
<div style="font-weight:bold;color:#2c3e50;font-size:13px;margin-bottom:8px">ğŸŒŠ ë³€ë™ì„± (Volatility)</div>
<div style="color:#555">ê°€ê²©ì´ ì–¼ë§ˆë‚˜ í¬ê²Œ í”ë“¤ë¦¬ëŠ”ê°€?</div>
<div style="margin-top:8px;font-size:11px;color:#27ae60">
â€¢ ì—­ì‚¬ì  ë³€ë™ì„±<br>
â€¢ ATR<br>
â€¢ ë³¼ë¦°ì € ë°´ë“œí­
</div>
</div>
<div style="background:#f0e8f8;padding:14px;border-radius:6px;border-top:3px solid #8e44ad">
<div style="font-weight:bold;color:#2c3e50;font-size:13px;margin-bottom:8px">ğŸ“¦ ê±°ë˜ëŸ‰ (Volume)</div>
<div style="color:#555">ì–¼ë§ˆë‚˜ ë§ì€ ì‚¬ëŒì´ ì°¸ì—¬í•˜ëŠ”ê°€?</div>
<div style="margin-top:8px;font-size:11px;color:#8e44ad">
â€¢ ê±°ë˜ëŸ‰ ë¹„ìœ¨<br>
â€¢ OBV<br>
â€¢ VWAP
</div>
</div>
</div>
</div>

<div class="info">
<p class="ni"><strong>êµì¬ ì—°ë™:</strong> MLAT Ch.4 "Financial Feature Engineering and Alpha Factors"ì—ì„œ ê¸°ìˆ ì  ì§€í‘œë¥¼ ì•ŒíŒŒíŒ©í„°ë¡œ í™œìš©í•˜ëŠ” ë°©ë²•ì„ ìƒì„¸íˆ ë‹¤ë£¬ë‹¤. ì´ ì±•í„°ëŠ” Round 3ì˜ í•µì‹¬ ì°¸ê³  ìë£Œë‹¤.</p>
</div>

<h3>8.2 ì´ë™í‰ê·  (Moving Average)</h3>
<p>ì´ë™í‰ê· ì€ ê°€ì¥ ê¸°ë³¸ì ì¸ ê¸°ìˆ ì  ì§€í‘œë‹¤. ìµœê·¼ nì¼ê°„ì˜ í‰ê·  ê°€ê²©ì„ ê³„ì‚°í•˜ì—¬ ì¶”ì„¸ë¥¼ íŒŒì•…í•œë‹¤. ë…¸ì´ì¦ˆë¥¼ ì œê±°í•˜ê³  í° íë¦„ì„ ë³´ì—¬ì£¼ëŠ” "ìŠ¤ë¬´ë”©(smoothing)" íš¨ê³¼ê°€ ìˆë‹¤.</p>

<pre><code><span class="cm"># ì‚¼ì„±ì „ì 1ë…„ ë°ì´í„°</span>
samsung_df = yf.download(<span class="st">"005930.KS"</span>, period=<span class="st">"1y"</span>)
close = samsung_df[<span class="st">"Close"</span>].squeeze()

<span class="cm"># ë‹¨ìˆœ ì´ë™í‰ê·  (SMA: Simple Moving Average)</span>
close_series = close.squeeze()  <span class="cm"># DataFrame â†’ Series ë³€í™˜</span>
sma_5 = close_series.rolling(window=<span class="nu">5</span>).mean()    <span class="cm"># 5ì¼ ì´ë™í‰ê·  (1ì£¼)</span>
sma_20 = close_series.rolling(window=<span class="nu">20</span>).mean()  <span class="cm"># 20ì¼ ì´ë™í‰ê·  (1ë‹¬)</span>
sma_60 = close_series.rolling(window=<span class="nu">60</span>).mean()  <span class="cm"># 60ì¼ ì´ë™í‰ê·  (3ë‹¬)</span>

<span class="cm"># ì§€ìˆ˜ ì´ë™í‰ê·  (EMA: Exponential Moving Average)</span>
<span class="cm"># ìµœê·¼ ë°ì´í„°ì— ë” í° ê°€ì¤‘ì¹˜ë¥¼ ë¶€ì—¬</span>
ema_12 = close_series.ewm(span=<span class="nu">12</span>).mean()
ema_26 = close_series.ewm(span=<span class="nu">26</span>).mean()

<span class="cm"># ì‹œê°í™”</span>
fig, ax = plt.subplots(figsize=(<span class="nu">14</span>, <span class="nu">6</span>))
ax.plot(close_series.index, close_series.values, color=<span class="st">"black"</span>, linewidth=<span class="nu">1</span>, label=<span class="st">"ì¢…ê°€"</span>, alpha=<span class="nu">0.8</span>)
ax.plot(sma_5.index, sma_5.values, color=<span class="st">"blue"</span>, linewidth=<span class="nu">0.8</span>, label=<span class="st">"SMA 5"</span>)
ax.plot(sma_20.index, sma_20.values, color=<span class="st">"orange"</span>, linewidth=<span class="nu">1.2</span>, label=<span class="st">"SMA 20"</span>)
ax.plot(sma_60.index, sma_60.values, color=<span class="st">"red"</span>, linewidth=<span class="nu">1.5</span>, label=<span class="st">"SMA 60"</span>)
ax.set_title(<span class="st">"ì‚¼ì„±ì „ì ì´ë™í‰ê· ì„ "</span>, fontsize=<span class="nu">14</span>)
ax.legend()
ax.grid(<span class="kw">True</span>, alpha=<span class="nu">0.3</span>)
plt.tight_layout()
plt.show()</code></pre>

<div class="def">
<p class="ni"><strong>SMA vs EMA</strong></p>
<p class="ni"><strong>SMA (Simple Moving Average):</strong> ëª¨ë“  ë‚ ì— ë™ì¼í•œ ê°€ì¤‘ì¹˜. ê³„ì‚°ì´ ë‹¨ìˆœí•˜ì§€ë§Œ ìµœê·¼ ë³€í™”ì— ëŠë¦¬ê²Œ ë°˜ì‘í•œë‹¤.</p>
<div class="eq">\[ \text{SMA}_n = \frac{1}{n} \sum_{i=0}^{n-1} P_{t-i} \]</div>
<p class="ni"><strong>EMA (Exponential Moving Average):</strong> ìµœê·¼ ë°ì´í„°ì— ë” í° ê°€ì¤‘ì¹˜. ì¶”ì„¸ ë³€í™”ì— ë¹ ë¥´ê²Œ ë°˜ì‘í•œë‹¤. MACD ê³„ì‚°ì— ì‚¬ìš©ëœë‹¤.</p>
<div class="eq">\[ \text{EMA}_t = \alpha \cdot P_t + (1-\alpha) \cdot \text{EMA}_{t-1}, \quad \alpha = \frac{2}{n+1} \]</div>
</div>

<!-- â”€â”€ ë³´ì¶© 8.2+ ì™œ EMAê°€ ë” ë¹ ë¥´ê²Œ ë°˜ì‘í•˜ëŠ”ê°€ â”€â”€ -->
<div class="def">
<p class="ni"><strong>ğŸ” ë³´ì¶©: ì™œ EMAê°€ SMAë³´ë‹¤ ë¹ ë¥´ê²Œ ë°˜ì‘í•˜ëŠ”ê°€ â€” ê°€ì¤‘ì¹˜ ê°ì‡  ì‹œê°í™”</strong></p>
<p class="ni">SMAì™€ EMAì˜ ì°¨ì´ë¥¼ ì§ê´€ì ìœ¼ë¡œ ì´í•´í•˜ë ¤ë©´, ê° ë°©ë²•ì´ ê³¼ê±° ë°ì´í„°ì— ë¶€ì—¬í•˜ëŠ” "ê°€ì¤‘ì¹˜"ë¥¼ ë¹„êµí•´ë³´ë©´ ëœë‹¤. SMAëŠ” ëª¨ë“  ë‚ ì— ë™ì¼í•œ ê°€ì¤‘ì¹˜ë¥¼ ì£¼ì§€ë§Œ, EMAëŠ” ìµœê·¼ ë‚ ì— í›¨ì”¬ í° ê°€ì¤‘ì¹˜ë¥¼ ì¤€ë‹¤. ì´ ê°€ì¤‘ì¹˜ ì°¨ì´ê°€ ë°˜ì‘ ì†ë„ì˜ ì°¨ì´ë¥¼ ë§Œë“ ë‹¤.</p>
</div>

<pre><code><span class="cm"># === SMA vs EMA ê°€ì¤‘ì¹˜ ë¹„êµ ì‹œê°í™” ===</span>
<span class="kw">import</span> numpy <span class="kw">as</span> np
<span class="kw">import</span> matplotlib.pyplot <span class="kw">as</span> plt

n = <span class="nu">20</span>  <span class="cm"># 20ì¼ ì´ë™í‰ê· </span>
alpha = <span class="nu">2</span> / (n + <span class="nu">1</span>)  <span class="cm"># EMA ê°ì‡  ê³„ìˆ˜ = 2/21 â‰ˆ 0.095</span>

<span class="cm"># SMA ê°€ì¤‘ì¹˜: ëª¨ë“  ë‚  ë™ì¼ (1/20 = 0.05)</span>
sma_weights = np.ones(n) / n

<span class="cm"># EMA ê°€ì¤‘ì¹˜: ìµœê·¼ì¼ìˆ˜ë¡ í¬ê³ , ê³¼ê±°ë¡œ ê°ˆìˆ˜ë¡ ì§€ìˆ˜ì ìœ¼ë¡œ ê°ì†Œ</span>
ema_weights = np.array([alpha * (<span class="nu">1</span> - alpha)**i <span class="kw">for</span> i <span class="kw">in</span> <span class="fn">range</span>(n)])
ema_weights = ema_weights / ema_weights.sum()  <span class="cm"># í•©ì´ 1ì´ ë˜ë„ë¡ ì •ê·œí™”</span>

<span class="cm"># ì‹œê°í™”</span>
fig, axes = plt.subplots(<span class="nu">1</span>, <span class="nu">3</span>, figsize=(<span class="nu">16</span>, <span class="nu">5</span>))

<span class="cm"># íŒ¨ë„ 1: ê°€ì¤‘ì¹˜ ë¹„êµ</span>
days_ago = np.arange(n)
axes[<span class="nu">0</span>].bar(days_ago - <span class="nu">0.2</span>, sma_weights, width=<span class="nu">0.4</span>, label=<span class="st">"SMA"</span>, color=<span class="st">"steelblue"</span>, alpha=<span class="nu">0.8</span>)
axes[<span class="nu">0</span>].bar(days_ago + <span class="nu">0.2</span>, ema_weights, width=<span class="nu">0.4</span>, label=<span class="st">"EMA"</span>, color=<span class="st">"coral"</span>, alpha=<span class="nu">0.8</span>)
axes[<span class="nu">0</span>].set_xlabel(<span class="st">"ë©°ì¹  ì „ (0=ì˜¤ëŠ˜)"</span>)
axes[<span class="nu">0</span>].set_ylabel(<span class="st">"ê°€ì¤‘ì¹˜"</span>)
axes[<span class="nu">0</span>].set_title(<span class="st">"SMA vs EMA ê°€ì¤‘ì¹˜ ë¶„í¬"</span>)
axes[<span class="nu">0</span>].legend()
axes[<span class="nu">0</span>].grid(<span class="kw">True</span>, alpha=<span class="nu">0.3</span>)

<span class="cm"># íŒ¨ë„ 2: ê¸‰ë“± ì‹œë‚˜ë¦¬ì˜¤ì—ì„œ ë°˜ì‘ ì†ë„ ë¹„êµ</span>
np.random.seed(<span class="nu">42</span>)
prices = np.concatenate([
    np.random.normal(<span class="nu">100</span>, <span class="nu">2</span>, <span class="nu">40</span>),  <span class="cm"># 40ì¼ê°„ ì•ˆì •</span>
    np.linspace(<span class="nu">100</span>, <span class="nu">120</span>, <span class="nu">10</span>),     <span class="cm"># 10ì¼ê°„ ê¸‰ë“±</span>
    np.random.normal(<span class="nu">120</span>, <span class="nu">2</span>, <span class="nu">20</span>)   <span class="cm"># 20ì¼ê°„ ì•ˆì •</span>
])
prices_series = pd.Series(prices)

sma_20 = prices_series.rolling(<span class="nu">20</span>).mean()
ema_20 = prices_series.ewm(span=<span class="nu">20</span>).mean()

axes[<span class="nu">1</span>].plot(prices_series, color=<span class="st">"gray"</span>, alpha=<span class="nu">0.5</span>, label=<span class="st">"ê°€ê²©"</span>)
axes[<span class="nu">1</span>].plot(sma_20, color=<span class="st">"steelblue"</span>, linewidth=<span class="nu">2</span>, label=<span class="st">"SMA(20)"</span>)
axes[<span class="nu">1</span>].plot(ema_20, color=<span class="st">"coral"</span>, linewidth=<span class="nu">2</span>, label=<span class="st">"EMA(20)"</span>)
axes[<span class="nu">1</span>].axvspan(<span class="nu">40</span>, <span class="nu">50</span>, alpha=<span class="nu">0.1</span>, color=<span class="st">"red"</span>, label=<span class="st">"ê¸‰ë“± êµ¬ê°„"</span>)
axes[<span class="nu">1</span>].set_title(<span class="st">"ê¸‰ë“± ì‹œ ë°˜ì‘ ì†ë„ ë¹„êµ"</span>)
axes[<span class="nu">1</span>].legend(fontsize=<span class="nu">9</span>)
axes[<span class="nu">1</span>].grid(<span class="kw">True</span>, alpha=<span class="nu">0.3</span>)

<span class="cm"># íŒ¨ë„ 3: ëˆ„ì  ê°€ì¤‘ì¹˜ (ìµœê·¼ Nì¼ì´ ì „ì²´ì˜ ëª‡ %ë¥¼ ì°¨ì§€í•˜ëŠ”ê°€)</span>
sma_cumw = np.cumsum(sma_weights)
ema_cumw = np.cumsum(ema_weights)
axes[<span class="nu">2</span>].plot(days_ago, sma_cumw, <span class="st">"o-"</span>, color=<span class="st">"steelblue"</span>, label=<span class="st">"SMA ëˆ„ì "</span>)
axes[<span class="nu">2</span>].plot(days_ago, ema_cumw, <span class="st">"s-"</span>, color=<span class="st">"coral"</span>, label=<span class="st">"EMA ëˆ„ì "</span>)
axes[<span class="nu">2</span>].axhline(y=<span class="nu">0.5</span>, color=<span class="st">"gray"</span>, linestyle=<span class="st">"--"</span>, alpha=<span class="nu">0.5</span>)
axes[<span class="nu">2</span>].set_xlabel(<span class="st">"ë©°ì¹  ì „"</span>)
axes[<span class="nu">2</span>].set_ylabel(<span class="st">"ëˆ„ì  ê°€ì¤‘ì¹˜"</span>)
axes[<span class="nu">2</span>].set_title(<span class="st">"ëˆ„ì  ê°€ì¤‘ì¹˜ (50% ë„ë‹¬ ì†ë„)"</span>)
axes[<span class="nu">2</span>].legend()
axes[<span class="nu">2</span>].grid(<span class="kw">True</span>, alpha=<span class="nu">0.3</span>)
axes[<span class="nu">2</span>].annotate(<span class="st">"SMA: 10ì¼ì§¸ 50%"</span>, xy=(<span class="nu">10</span>, <span class="nu">0.5</span>), fontsize=<span class="nu">9</span>, color=<span class="st">"steelblue"</span>)
axes[<span class="nu">2</span>].annotate(<span class="st">"EMA: 6ì¼ì§¸ 50%"</span>, xy=(<span class="nu">6</span>, <span class="nu">0.5</span>), fontsize=<span class="nu">9</span>, color=<span class="st">"coral"</span>)

plt.tight_layout()
plt.show()

<span class="fn">print</span>(<span class="st">"=== í•µì‹¬ ì°¨ì´ ==="</span>)
<span class="fn">print</span>(<span class="st">f"SMA: ìµœê·¼ 1ì¼ ê°€ì¤‘ì¹˜ = </span>{sma_weights[0]:.3f}<span class="st"> (5.0%)"</span>)
<span class="fn">print</span>(<span class="st">f"EMA: ìµœê·¼ 1ì¼ ê°€ì¤‘ì¹˜ = </span>{ema_weights[0]:.3f}<span class="st"> (</span>{ema_weights[0]*100:.1f}<span class="st">%)"</span>)
<span class="fn">print</span>(<span class="st">f"â†’ EMAëŠ” ì˜¤ëŠ˜ ê°€ê²©ì— SMA ëŒ€ë¹„ </span>{ema_weights[0]/sma_weights[0]:.1f}<span class="st">ë°° ë” í° ê°€ì¤‘ì¹˜!"</span>)
<span class="fn">print</span>(<span class="st">f"\nSMA: 20ì¼ ì „ ê°€ì¤‘ì¹˜ = </span>{sma_weights[-1]:.3f}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"EMA: 20ì¼ ì „ ê°€ì¤‘ì¹˜ = </span>{ema_weights[-1]:.3f}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"â†’ EMAëŠ” ì˜¤ë˜ëœ ë°ì´í„°ë¥¼ ë¹ ë¥´ê²Œ 'ìŠëŠ”ë‹¤'"</span>)</code></pre>

<div class="info">
<p class="ni"><strong>ì‹¤ì „ ì„ íƒ ê°€ì´ë“œ:</strong></p>
<ul>
<li><strong>SMA:</strong> ì¥ê¸° ì¶”ì„¸ í™•ì¸, ì§€ì§€/ì €í•­ì„  ë¶„ì„. ë…¸ì´ì¦ˆì— ëœ ë¯¼ê°í•˜ì—¬ ì•ˆì •ì .</li>
<li><strong>EMA:</strong> ë‹¨ê¸° ë§¤ë§¤ ì‹ í˜¸, MACD ê³„ì‚°, ë¹ ë¥¸ ì¶”ì„¸ ì „í™˜ ê°ì§€. HFTì—ì„œ ì„ í˜¸.</li>
<li><strong>ML í”¼ì²˜ë¡œëŠ”:</strong> ë‘˜ ë‹¤ ë„£ì–´ë„ ëœë‹¤. ëª¨ë¸ì´ ì•Œì•„ì„œ ìœ ìš©í•œ ê²ƒì„ ì„ íƒí•œë‹¤. ë‹¤ë§Œ SMA(20)ê³¼ EMA(20)ì˜ ìƒê´€ì´ ë§¤ìš° ë†’ìœ¼ë¯€ë¡œ(0.95+), ë‹¤ì¤‘ê³µì„ ì„±ì´ ê±±ì •ë˜ë©´ í•˜ë‚˜ë§Œ ì„ íƒ.</li>
</ul>
</div>

<h3>8.3 ì´ë™í‰ê·  ê¸°ë°˜ í”¼ì²˜</h3>
<p>ì´ë™í‰ê·  ìì²´ë³´ë‹¤ëŠ”, ì´ë™í‰ê· ì—ì„œ íŒŒìƒëœ í”¼ì²˜ê°€ MLì— ë” ìœ ìš©í•˜ë‹¤.</p>

<pre><code><span class="cm"># ì´ë™í‰ê·  ê¸°ë°˜ í”¼ì²˜ë“¤</span>
features = pd.DataFrame(index=close_series.index)

<span class="cm"># 1. ê°€ê²© ëŒ€ë¹„ ì´ë™í‰ê·  ë¹„ìœ¨ (Price/SMA ratio)</span>
<span class="cm"># "í˜„ì¬ ê°€ê²©ì´ ì´ë™í‰ê·  ëŒ€ë¹„ ì–¼ë§ˆë‚˜ ë†’ì€ê°€/ë‚®ì€ê°€"</span>
features[<span class="st">"price_sma20_ratio"</span>] = close_series / sma_20
features[<span class="st">"price_sma60_ratio"</span>] = close_series / sma_60

<span class="cm"># 2. ê³¨ë“ í¬ë¡œìŠ¤/ë°ë“œí¬ë¡œìŠ¤ ì‹ í˜¸</span>
<span class="cm"># ë‹¨ê¸° ì´ë™í‰ê· ì´ ì¥ê¸° ì´ë™í‰ê·  ìœ„ì— ìˆìœ¼ë©´ 1, ì•„ë˜ë©´ 0</span>
features[<span class="st">"golden_cross"</span>] = (sma_20 > sma_60).astype(<span class="nb">int</span>)

<span class="cm"># 3. ì´ë™í‰ê·  ê¸°ìš¸ê¸° (ì¶”ì„¸ì˜ ê°•ë„)</span>
features[<span class="st">"sma20_slope"</span>] = sma_20.pct_change(<span class="nu">5</span>)  <span class="cm"># 5ì¼ê°„ SMA20ì˜ ë³€í™”ìœ¨</span>

<span class="cm"># 4. ì´ë™í‰ê·  ê°„ ê±°ë¦¬ (ì¶”ì„¸ì˜ ê°•ë„)</span>
features[<span class="st">"sma_spread"</span>] = (sma_20 - sma_60) / sma_60

<span class="fn">print</span>(<span class="st">"=== ì´ë™í‰ê·  ê¸°ë°˜ í”¼ì²˜ ==="</span>)
<span class="fn">print</span>(features.dropna().tail(<span class="nu">10</span>).round(<span class="nu">4</span>))</code></pre>

<h3>8.4 RSI (Relative Strength Index) â€” ê³¼ë§¤ìˆ˜/ê³¼ë§¤ë„ ì§€í‘œ</h3>
<p>RSIëŠ” "ìµœê·¼ nì¼ ë™ì•ˆ ìƒìŠ¹í•œ ë‚ ì˜ í‰ê·  ìƒìŠ¹í­ ëŒ€ë¹„, í•˜ë½í•œ ë‚ ì˜ í‰ê·  í•˜ë½í­ì´ ì–¼ë§ˆì¸ê°€"ë¥¼ 0~100 ì‚¬ì´ì˜ ìˆ«ìë¡œ í‘œí˜„í•œë‹¤. 70 ì´ìƒì´ë©´ ê³¼ë§¤ìˆ˜(ë„ˆë¬´ ë§ì´ ì˜¬ëë‹¤), 30 ì´í•˜ë©´ ê³¼ë§¤ë„(ë„ˆë¬´ ë§ì´ ë–¨ì–´ì¡Œë‹¤)ë¡œ í•´ì„í•œë‹¤.</p>

<div class="eq">\[ \text{RSI} = 100 - \frac{100}{1 + RS}, \quad RS = \frac{\text{í‰ê·  ìƒìŠ¹í­}}{\text{í‰ê·  í•˜ë½í­}} \]</div>

<p>RSIì˜ ì§ê´€: ìµœê·¼ 14ì¼ ì¤‘ ë§¤ì¼ ì˜¬ëë‹¤ë©´ RS = âˆì´ë¯€ë¡œ RSI = 100ì´ë‹¤. ë§¤ì¼ ë–¨ì–´ì¡Œë‹¤ë©´ RS = 0ì´ë¯€ë¡œ RSI = 0ì´ë‹¤. ë°˜ë°˜ì´ë©´ RSI â‰ˆ 50ì´ë‹¤.</p>

<pre><code><span class="kw">def</span> <span class="fn">calculate_rsi</span>(prices, period=<span class="nu">14</span>):
    <span class="st">"""RSIë¥¼ ì§ì ‘ êµ¬í˜„í•œë‹¤"""</span>
    <span class="cm"># 1. ì¼ê°„ ë³€í™”ëŸ‰</span>
    delta = prices.diff()
    
    <span class="cm"># 2. ìƒìŠ¹ë¶„ê³¼ í•˜ë½ë¶„ ë¶„ë¦¬</span>
    gain = delta.where(delta > <span class="nu">0</span>, <span class="nu">0</span>)   <span class="cm"># ìƒìŠ¹í•œ ë‚ ë§Œ (ë‚˜ë¨¸ì§€ 0)</span>
    loss = -delta.where(delta < <span class="nu">0</span>, <span class="nu">0</span>)  <span class="cm"># í•˜ë½í•œ ë‚ ë§Œ (ì–‘ìˆ˜ë¡œ ë³€í™˜)</span>
    
    <span class="cm"># 3. í‰ê·  ìƒìŠ¹í­ / í‰ê·  í•˜ë½í­ (EMA ì‚¬ìš©)</span>
    avg_gain = gain.ewm(alpha=<span class="nu">1</span>/period, min_periods=period).mean()
    avg_loss = loss.ewm(alpha=<span class="nu">1</span>/period, min_periods=period).mean()
    
    <span class="cm"># 4. RSì™€ RSI ê³„ì‚°</span>
    rs = avg_gain / avg_loss
    rsi = <span class="nu">100</span> - (<span class="nu">100</span> / (<span class="nu">1</span> + rs))
    
    <span class="kw">return</span> rsi

<span class="cm"># RSI ê³„ì‚°</span>
rsi_14 = calculate_rsi(close_series, period=<span class="nu">14</span>)

<span class="cm"># ì‹œê°í™”</span>
fig, axes = plt.subplots(<span class="nu">2</span>, <span class="nu">1</span>, figsize=(<span class="nu">14</span>, <span class="nu">8</span>), gridspec_kw={<span class="st">"height_ratios"</span>: [<span class="nu">2</span>, <span class="nu">1</span>]})

<span class="cm"># ìƒë‹¨: ì£¼ê°€</span>
axes[<span class="nu">0</span>].plot(close_series.index, close_series.values, color=<span class="st">"black"</span>, linewidth=<span class="nu">1</span>)
axes[<span class="nu">0</span>].set_title(<span class="st">"ì‚¼ì„±ì „ì ì£¼ê°€"</span>)
axes[<span class="nu">0</span>].grid(<span class="kw">True</span>, alpha=<span class="nu">0.3</span>)

<span class="cm"># í•˜ë‹¨: RSI</span>
axes[<span class="nu">1</span>].plot(rsi_14.index, rsi_14.values, color=<span class="st">"purple"</span>, linewidth=<span class="nu">1</span>)
axes[<span class="nu">1</span>].axhline(y=<span class="nu">70</span>, color=<span class="st">"red"</span>, linestyle=<span class="st">"--"</span>, alpha=<span class="nu">0.7</span>, label=<span class="st">"ê³¼ë§¤ìˆ˜ (70)"</span>)
axes[<span class="nu">1</span>].axhline(y=<span class="nu">30</span>, color=<span class="st">"green"</span>, linestyle=<span class="st">"--"</span>, alpha=<span class="nu">0.7</span>, label=<span class="st">"ê³¼ë§¤ë„ (30)"</span>)
axes[<span class="nu">1</span>].axhline(y=<span class="nu">50</span>, color=<span class="st">"gray"</span>, linestyle=<span class="st">":"</span>, alpha=<span class="nu">0.5</span>)
axes[<span class="nu">1</span>].fill_between(rsi_14.index, rsi_14.values, <span class="nu">70</span>,
                     where=(rsi_14.values > <span class="nu">70</span>), color=<span class="st">"red"</span>, alpha=<span class="nu">0.2</span>)
axes[<span class="nu">1</span>].fill_between(rsi_14.index, rsi_14.values, <span class="nu">30</span>,
                     where=(rsi_14.values < <span class="nu">30</span>), color=<span class="st">"green"</span>, alpha=<span class="nu">0.2</span>)
axes[<span class="nu">1</span>].set_title(<span class="st">"RSI (14)"</span>)
axes[<span class="nu">1</span>].set_ylim(<span class="nu">0</span>, <span class="nu">100</span>)
axes[<span class="nu">1</span>].legend()
axes[<span class="nu">1</span>].grid(<span class="kw">True</span>, alpha=<span class="nu">0.3</span>)

plt.tight_layout()
plt.show()</code></pre>

<h3>8.5 MACD (Moving Average Convergence Divergence)</h3>
<p>MACDëŠ” ë‘ ê°œì˜ EMA(ì§€ìˆ˜ì´ë™í‰ê· ) ì°¨ì´ë¥¼ ì´ìš©í•˜ì—¬ ì¶”ì„¸ì˜ ë°©í–¥ê³¼ ê°•ë„ë¥¼ ì¸¡ì •í•˜ëŠ” ì§€í‘œë‹¤. ê°€ì¥ ë„ë¦¬ ì‚¬ìš©ë˜ëŠ” ê¸°ìˆ ì  ì§€í‘œ ì¤‘ í•˜ë‚˜ë‹¤.</p>

<p>MACDì˜ êµ¬ì„± ìš”ì†Œ:</p>
<ul>
<li><strong>MACD Line:</strong> EMA(12) - EMA(26) â€” ë‹¨ê¸° ì¶”ì„¸ì™€ ì¥ê¸° ì¶”ì„¸ì˜ ì°¨ì´</li>
<li><strong>Signal Line:</strong> MACD Lineì˜ EMA(9) â€” MACDì˜ ì´ë™í‰ê· </li>
<li><strong>Histogram:</strong> MACD Line - Signal Line â€” ì¶”ì„¸ ê°•ë„ì˜ ë³€í™”</li>
</ul>

<pre><code><span class="kw">def</span> <span class="fn">calculate_macd</span>(prices, fast=<span class="nu">12</span>, slow=<span class="nu">26</span>, signal=<span class="nu">9</span>):
    <span class="st">"""MACDë¥¼ ì§ì ‘ êµ¬í˜„í•œë‹¤"""</span>
    ema_fast = prices.ewm(span=fast).mean()
    ema_slow = prices.ewm(span=slow).mean()
    
    macd_line = ema_fast - ema_slow
    signal_line = macd_line.ewm(span=signal).mean()
    histogram = macd_line - signal_line
    
    <span class="kw">return</span> macd_line, signal_line, histogram

macd_line, signal_line, histogram = calculate_macd(close_series)

<span class="cm"># ì‹œê°í™”</span>
fig, axes = plt.subplots(<span class="nu">2</span>, <span class="nu">1</span>, figsize=(<span class="nu">14</span>, <span class="nu">8</span>), gridspec_kw={<span class="st">"height_ratios"</span>: [<span class="nu">2</span>, <span class="nu">1</span>]})

<span class="cm"># ìƒë‹¨: ì£¼ê°€</span>
axes[<span class="nu">0</span>].plot(close_series.index, close_series.values, color=<span class="st">"black"</span>, linewidth=<span class="nu">1</span>)
axes[<span class="nu">0</span>].set_title(<span class="st">"ì‚¼ì„±ì „ì ì£¼ê°€"</span>)
axes[<span class="nu">0</span>].grid(<span class="kw">True</span>, alpha=<span class="nu">0.3</span>)

<span class="cm"># í•˜ë‹¨: MACD</span>
axes[<span class="nu">1</span>].plot(macd_line.index, macd_line.values, color=<span class="st">"blue"</span>, linewidth=<span class="nu">1</span>, label=<span class="st">"MACD"</span>)
axes[<span class="nu">1</span>].plot(signal_line.index, signal_line.values, color=<span class="st">"red"</span>, linewidth=<span class="nu">1</span>, label=<span class="st">"Signal"</span>)
colors = [<span class="st">"green"</span> <span class="kw">if</span> v >= <span class="nu">0</span> <span class="kw">else</span> <span class="st">"red"</span> <span class="kw">for</span> v <span class="kw">in</span> histogram.values]
axes[<span class="nu">1</span>].bar(histogram.index, histogram.values, color=colors, alpha=<span class="nu">0.5</span>, width=<span class="nu">1</span>)
axes[<span class="nu">1</span>].axhline(y=<span class="nu">0</span>, color=<span class="st">"gray"</span>, linestyle=<span class="st">"-"</span>, linewidth=<span class="nu">0.5</span>)
axes[<span class="nu">1</span>].set_title(<span class="st">"MACD (12, 26, 9)"</span>)
axes[<span class="nu">1</span>].legend()
axes[<span class="nu">1</span>].grid(<span class="kw">True</span>, alpha=<span class="nu">0.3</span>)

plt.tight_layout()
plt.show()</code></pre>

<p>MACDë¥¼ ML í”¼ì²˜ë¡œ ì‚¬ìš©í•  ë•ŒëŠ” ì ˆëŒ€ê°’ë³´ë‹¤ ìƒëŒ€ì  ì‹ í˜¸ê°€ ë” ìœ ìš©í•˜ë‹¤:</p>

<pre><code><span class="cm"># MACD ê¸°ë°˜ í”¼ì²˜</span>
features[<span class="st">"macd"</span>] = macd_line
features[<span class="st">"macd_signal"</span>] = signal_line
features[<span class="st">"macd_hist"</span>] = histogram
features[<span class="st">"macd_cross"</span>] = (macd_line > signal_line).astype(<span class="nb">int</span>)  <span class="cm"># ë§¤ìˆ˜ ì‹ í˜¸</span>
features[<span class="st">"macd_hist_change"</span>] = histogram.diff()  <span class="cm"># íˆìŠ¤í† ê·¸ë¨ ë³€í™” ë°©í–¥</span></code></pre>

<h3>8.6 ë³¼ë¦°ì € ë°´ë“œ (Bollinger Bands)</h3>
<p>ë³¼ë¦°ì € ë°´ë“œëŠ” ì´ë™í‰ê·  ìœ„ì•„ë˜ë¡œ í‘œì¤€í¸ì°¨ì˜ në°°ë§Œí¼ ë°´ë“œë¥¼ ê·¸ë¦° ê²ƒì´ë‹¤. ê°€ê²©ì´ ë°´ë“œ ë°–ìœ¼ë¡œ ë‚˜ê°€ë©´ "ë¹„ì •ìƒì ì¸ ì›€ì§ì„"ìœ¼ë¡œ í•´ì„í•œë‹¤. ë³€ë™ì„±ì´ ì»¤ì§€ë©´ ë°´ë“œê°€ ë„“ì–´ì§€ê³ , ì¤„ì–´ë“¤ë©´ ì¢ì•„ì§„ë‹¤.</p>

<div class="eq">\[ \text{Upper Band} = \text{SMA}_{20} + 2\sigma_{20} \]
\[ \text{Lower Band} = \text{SMA}_{20} - 2\sigma_{20} \]
\[ \text{%B} = \frac{P - \text{Lower}}{\text{Upper} - \text{Lower}} \]</div>

<pre><code><span class="kw">def</span> <span class="fn">calculate_bollinger</span>(prices, window=<span class="nu">20</span>, num_std=<span class="nu">2</span>):
    <span class="st">"""ë³¼ë¦°ì € ë°´ë“œë¥¼ ì§ì ‘ êµ¬í˜„í•œë‹¤"""</span>
    sma = prices.rolling(window=window).mean()
    std = prices.rolling(window=window).std()
    
    upper = sma + num_std * std
    lower = sma - num_std * std
    
    <span class="cm"># %B: í˜„ì¬ ê°€ê²©ì´ ë°´ë“œ ë‚´ ì–´ë””ì— ìˆëŠ”ê°€ (0=í•˜ë‹¨, 1=ìƒë‹¨)</span>
    pct_b = (prices - lower) / (upper - lower)
    
    <span class="cm"># ë°´ë“œí­: ë³€ë™ì„±ì˜ proxy</span>
    bandwidth = (upper - lower) / sma
    
    <span class="kw">return</span> upper, lower, sma, pct_b, bandwidth

upper, lower, bb_sma, pct_b, bandwidth = calculate_bollinger(close_series)

<span class="cm"># ì‹œê°í™”</span>
fig, axes = plt.subplots(<span class="nu">3</span>, <span class="nu">1</span>, figsize=(<span class="nu">14</span>, <span class="nu">10</span>), gridspec_kw={<span class="st">"height_ratios"</span>: [<span class="nu">3</span>, <span class="nu">1</span>, <span class="nu">1</span>]})

<span class="cm"># ìƒë‹¨: ì£¼ê°€ + ë³¼ë¦°ì € ë°´ë“œ</span>
axes[<span class="nu">0</span>].plot(close_series.index, close_series.values, color=<span class="st">"black"</span>, linewidth=<span class="nu">1</span>, label=<span class="st">"ì¢…ê°€"</span>)
axes[<span class="nu">0</span>].plot(bb_sma.index, bb_sma.values, color=<span class="st">"blue"</span>, linewidth=<span class="nu">0.8</span>, label=<span class="st">"SMA 20"</span>)
axes[<span class="nu">0</span>].plot(upper.index, upper.values, color=<span class="st">"red"</span>, linewidth=<span class="nu">0.8</span>, linestyle=<span class="st">"--"</span>)
axes[<span class="nu">0</span>].plot(lower.index, lower.values, color=<span class="st">"green"</span>, linewidth=<span class="nu">0.8</span>, linestyle=<span class="st">"--"</span>)
axes[<span class="nu">0</span>].fill_between(upper.index, upper.values, lower.values, alpha=<span class="nu">0.1</span>, color=<span class="st">"blue"</span>)
axes[<span class="nu">0</span>].set_title(<span class="st">"ë³¼ë¦°ì € ë°´ë“œ (20, 2)"</span>)
axes[<span class="nu">0</span>].legend()
axes[<span class="nu">0</span>].grid(<span class="kw">True</span>, alpha=<span class="nu">0.3</span>)

<span class="cm"># ì¤‘ë‹¨: %B</span>
axes[<span class="nu">1</span>].plot(pct_b.index, pct_b.values, color=<span class="st">"purple"</span>, linewidth=<span class="nu">0.8</span>)
axes[<span class="nu">1</span>].axhline(y=<span class="nu">1</span>, color=<span class="st">"red"</span>, linestyle=<span class="st">"--"</span>, alpha=<span class="nu">0.5</span>)
axes[<span class="nu">1</span>].axhline(y=<span class="nu">0</span>, color=<span class="st">"green"</span>, linestyle=<span class="st">"--"</span>, alpha=<span class="nu">0.5</span>)
axes[<span class="nu">1</span>].set_title(<span class="st">"%B (0=í•˜ë‹¨, 1=ìƒë‹¨)"</span>)
axes[<span class="nu">1</span>].grid(<span class="kw">True</span>, alpha=<span class="nu">0.3</span>)

<span class="cm"># í•˜ë‹¨: ë°´ë“œí­</span>
axes[<span class="nu">2</span>].plot(bandwidth.index, bandwidth.values, color=<span class="st">"orange"</span>, linewidth=<span class="nu">0.8</span>)
axes[<span class="nu">2</span>].set_title(<span class="st">"ë°´ë“œí­ (ë³€ë™ì„± proxy)"</span>)
axes[<span class="nu">2</span>].grid(<span class="kw">True</span>, alpha=<span class="nu">0.3</span>)

plt.tight_layout()
plt.show()</code></pre>

<pre><code><span class="cm"># ë³¼ë¦°ì € ë°´ë“œ ê¸°ë°˜ í”¼ì²˜</span>
features[<span class="st">"bb_pct_b"</span>] = pct_b
features[<span class="st">"bb_bandwidth"</span>] = bandwidth
features[<span class="st">"bb_squeeze"</span>] = (bandwidth < bandwidth.rolling(<span class="nu">120</span>).quantile(<span class="nu">0.1</span>)).astype(<span class="nb">int</span>)
<span class="cm"># ë°´ë“œí­ì´ ìµœê·¼ 120ì¼ ì¤‘ í•˜ìœ„ 10%ì´ë©´ "ìŠ¤í€´ì¦ˆ" â€” í° ì›€ì§ì„ ì˜ˆê³ </span></code></pre>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- Ch9: ë³€ë™ì„± & ëª¨ë©˜í…€ í”¼ì²˜ -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<h2 id="ch9">9. ë³€ë™ì„± &amp; ëª¨ë©˜í…€ í”¼ì²˜ â€” ìœ„í—˜ê³¼ ì¶”ì„¸ë¥¼ ìˆ˜ì¹˜í™”í•˜ë‹¤</h2>

<h3>9.1 ë³€ë™ì„± í”¼ì²˜</h3>
<p>ë³€ë™ì„±(volatility)ì€ "ê°€ê²©ì´ ì–¼ë§ˆë‚˜ í¬ê²Œ í”ë“¤ë¦¬ëŠ”ê°€"ë¥¼ ì¸¡ì •í•œë‹¤. ë³€ë™ì„±ì´ ë†’ìœ¼ë©´ ìœ„í—˜ì´ í¬ê³ , ë‚®ìœ¼ë©´ ì•ˆì •ì ì´ë‹¤. ë³€ë™ì„±ì€ ê·¸ ìì²´ë¡œ ì¤‘ìš”í•œ í”¼ì²˜ì´ë©°, ë³€ë™ì„±ì˜ ë³€í™”(ë³€ë™ì„±ì´ ì»¤ì§€ê³  ìˆëŠ”ê°€, ì¤„ì–´ë“¤ê³  ìˆëŠ”ê°€)ë„ ê°•ë ¥í•œ ì˜ˆì¸¡ ì‹ í˜¸ë‹¤.</p>

<h4>9.1.1 ì—­ì‚¬ì  ë³€ë™ì„± (Historical Volatility)</h4>
<pre><code><span class="cm"># ìˆ˜ìµë¥  ê³„ì‚°</span>
ret = close_series.pct_change().dropna()

<span class="cm"># 1. ë¡¤ë§ ë³€ë™ì„± (ë‹¤ì–‘í•œ ìœˆë„ìš°)</span>
vol_5 = ret.rolling(<span class="nu">5</span>).std() * np.sqrt(<span class="nu">252</span>)    <span class="cm"># 5ì¼ ë³€ë™ì„± (ì—°í™˜ì‚°)</span>
vol_20 = ret.rolling(<span class="nu">20</span>).std() * np.sqrt(<span class="nu">252</span>)  <span class="cm"># 20ì¼ ë³€ë™ì„±</span>
vol_60 = ret.rolling(<span class="nu">60</span>).std() * np.sqrt(<span class="nu">252</span>)  <span class="cm"># 60ì¼ ë³€ë™ì„±</span>

<span class="cm"># 2. ë³€ë™ì„± ë¹„ìœ¨ (ë‹¨ê¸°/ì¥ê¸°) â€” ë³€ë™ì„± ë ˆì§ ë³€í™” ê°ì§€</span>
vol_ratio = vol_5 / vol_60  <span class="cm"># > 1ì´ë©´ ìµœê·¼ ë³€ë™ì„± ì¦ê°€</span>

<span class="cm"># 3. Parkinson ë³€ë™ì„± (ê³ ê°€-ì €ê°€ ê¸°ë°˜, ë” ì •í™•)</span>
high = samsung_df[<span class="st">"High"</span>].squeeze()
low = samsung_df[<span class="st">"Low"</span>].squeeze()
parkinson = np.sqrt(
    (<span class="nu">1</span> / (<span class="nu">4</span> * np.log(<span class="nu">2</span>))) * (np.log(high / low) ** <span class="nu">2</span>).rolling(<span class="nu">20</span>).mean()
) * np.sqrt(<span class="nu">252</span>)

<span class="cm"># ì‹œê°í™”</span>
fig, ax = plt.subplots(figsize=(<span class="nu">14</span>, <span class="nu">5</span>))
ax.plot(vol_5.index, vol_5.values, label=<span class="st">"5ì¼ ë³€ë™ì„±"</span>, alpha=<span class="nu">0.6</span>)
ax.plot(vol_20.index, vol_20.values, label=<span class="st">"20ì¼ ë³€ë™ì„±"</span>, linewidth=<span class="nu">1.5</span>)
ax.plot(vol_60.index, vol_60.values, label=<span class="st">"60ì¼ ë³€ë™ì„±"</span>, linewidth=<span class="nu">2</span>)
ax.set_title(<span class="st">"ì‚¼ì„±ì „ì ì—­ì‚¬ì  ë³€ë™ì„± (ì—°í™˜ì‚°)"</span>)
ax.set_ylabel(<span class="st">"ë³€ë™ì„±"</span>)
ax.legend()
ax.grid(<span class="kw">True</span>, alpha=<span class="nu">0.3</span>)
plt.tight_layout()
plt.show()</code></pre>

<div class="info">
<p class="ni"><strong>ì™œ âˆš252ë¥¼ ê³±í•˜ëŠ”ê°€?</strong> ì¼ê°„ ë³€ë™ì„±ì„ ì—°ê°„ ë³€ë™ì„±ìœ¼ë¡œ í™˜ì‚°í•˜ê¸° ìœ„í•´ì„œë‹¤. 1ë…„ì— ì•½ 252 ê±°ë˜ì¼ì´ ìˆê³ , ë³€ë™ì„±(í‘œì¤€í¸ì°¨)ì€ âˆšì‹œê°„ì— ë¹„ë¡€í•˜ì—¬ ì¦ê°€í•œë‹¤. ë”°ë¼ì„œ ì¼ê°„ ë³€ë™ì„± Ã— âˆš252 = ì—°ê°„ ë³€ë™ì„±ì´ë‹¤. ì´ê²ƒì€ Round 2ì—ì„œ ë°°ìš´ ì •ê·œë¶„í¬ì˜ ì„±ì§ˆì—ì„œ ë‚˜ì˜¨ë‹¤.</p>
</div>

<!-- â”€â”€ ë³´ì¶© 9.1+ Parkinson ë³€ë™ì„± ì§ê´€ì  ì„¤ëª… â”€â”€ -->
<div class="def">
<p class="ni"><strong>ğŸ” ë³´ì¶©: Parkinson ë³€ë™ì„± â€” ì™œ ê³ ê°€-ì €ê°€ê°€ ì¢…ê°€ë³´ë‹¤ ë” ì •í™•í•œê°€</strong></p>
<p class="ni">ì¼ë°˜ì ì¸ ì—­ì‚¬ì  ë³€ë™ì„±ì€ ì¢…ê°€(Close)ë§Œ ì‚¬ìš©í•œë‹¤. í•˜ì§€ë§Œ í•˜ë£¨ ë™ì•ˆ ì£¼ê°€ê°€ Â±5% ì™”ë‹¤ ê°”ë‹¤ í•´ë„ ì¢…ê°€ê°€ ì „ì¼ê³¼ ê°™ìœ¼ë©´ ë³€ë™ì„±ì´ 0ìœ¼ë¡œ ê³„ì‚°ëœë‹¤. Parkinson ë³€ë™ì„±ì€ ê³ ê°€(High)ì™€ ì €ê°€(Low)ë¥¼ ì‚¬ìš©í•˜ì—¬ ì¥ì¤‘ ë³€ë™ì„ í¬ì°©í•œë‹¤. ì´ë¡ ì ìœ¼ë¡œ ì¢…ê°€ ê¸°ë°˜ ëŒ€ë¹„ ì•½ 5ë°° ë” íš¨ìœ¨ì ì´ë‹¤.</p>
</div>

<pre><code><span class="cm"># === Parkinson ë³€ë™ì„± vs ì¢…ê°€ ê¸°ë°˜ ë³€ë™ì„± ë¹„êµ ===</span>
<span class="kw">import</span> numpy <span class="kw">as</span> np
<span class="kw">import</span> pandas <span class="kw">as</span> pd

<span class="cm"># ì‹œë‚˜ë¦¬ì˜¤: ì¢…ê°€ëŠ” ê°™ì§€ë§Œ ì¥ì¤‘ ë³€ë™ì´ ë‹¤ë¥¸ ë‘ ì¢…ëª©</span>
np.random.seed(<span class="nu">42</span>)
n_days = <span class="nu">20</span>

<span class="cm"># ì¢…ëª© A: ì¥ì¤‘ ë³€ë™ì´ í° ì¢…ëª© (ê³ ê°€-ì €ê°€ ì°¨ì´ í¼)</span>
close_A = np.full(n_days, <span class="nu">100.0</span>)  <span class="cm"># ì¢…ê°€ê°€ ë§¤ì¼ 100ì› (ë³€ë™ ì—†ì–´ ë³´ì„)</span>
high_A = close_A + np.random.uniform(<span class="nu">3</span>, <span class="nu">8</span>, n_days)   <span class="cm"># ê³ ê°€: 103~108</span>
low_A = close_A - np.random.uniform(<span class="nu">3</span>, <span class="nu">8</span>, n_days)    <span class="cm"># ì €ê°€: 92~97</span>

<span class="cm"># ì¢…ëª© B: ì¥ì¤‘ ë³€ë™ì´ ì‘ì€ ì¢…ëª©</span>
close_B = np.full(n_days, <span class="nu">100.0</span>)  <span class="cm"># ì¢…ê°€ê°€ ë§¤ì¼ 100ì› (ì—­ì‹œ ë³€ë™ ì—†ì–´ ë³´ì„)</span>
high_B = close_B + np.random.uniform(<span class="nu">0.5</span>, <span class="nu">1.5</span>, n_days)  <span class="cm"># ê³ ê°€: 100.5~101.5</span>
low_B = close_B - np.random.uniform(<span class="nu">0.5</span>, <span class="nu">1.5</span>, n_days)   <span class="cm"># ì €ê°€: 98.5~99.5</span>

<span class="cm"># ì¢…ê°€ ê¸°ë°˜ ë³€ë™ì„± (Close-to-Close)</span>
vol_close_A = pd.Series(close_A).pct_change().std() * np.sqrt(<span class="nu">252</span>)
vol_close_B = pd.Series(close_B).pct_change().std() * np.sqrt(<span class="nu">252</span>)

<span class="cm"># Parkinson ë³€ë™ì„±</span>
<span class="kw">def</span> <span class="fn">parkinson_vol</span>(high, low, window=<span class="nu">20</span>):
    <span class="st">"""Parkinson ë³€ë™ì„± ê³„ì‚°"""</span>
    log_hl = np.log(high / low) ** <span class="nu">2</span>
    <span class="kw">return</span> np.sqrt(log_hl.mean() / (<span class="nu">4</span> * np.log(<span class="nu">2</span>))) * np.sqrt(<span class="nu">252</span>)

vol_park_A = parkinson_vol(high_A, low_A)
vol_park_B = parkinson_vol(high_B, low_B)

<span class="fn">print</span>(<span class="st">"=== ì¢…ê°€ ê¸°ë°˜ vs Parkinson ë³€ë™ì„± ==="</span>)
<span class="fn">print</span>(<span class="st">f"ì¢…ëª© A (ì¥ì¤‘ ë³€ë™ í¼):"</span>)
<span class="fn">print</span>(<span class="st">f"  ì¢…ê°€ ë³€ë™ì„±: </span>{vol_close_A:.4f}<span class="st"> (â‰ˆ 0! ì¢…ê°€ê°€ ë§¤ì¼ ê°™ìœ¼ë‹ˆê¹Œ)"</span>)
<span class="fn">print</span>(<span class="st">f"  Parkinson:   </span>{vol_park_A:.4f}<span class="st"> (ì¥ì¤‘ ë³€ë™ì„ í¬ì°©!)"</span>)
<span class="fn">print</span>(<span class="st">f"\nì¢…ëª© B (ì¥ì¤‘ ë³€ë™ ì‘ìŒ):"</span>)
<span class="fn">print</span>(<span class="st">f"  ì¢…ê°€ ë³€ë™ì„±: </span>{vol_close_B:.4f}<span class="st"> (â‰ˆ 0)"</span>)
<span class="fn">print</span>(<span class="st">f"  Parkinson:   </span>{vol_park_B:.4f}<span class="st"> (ì‘ì€ ë³€ë™ë„ ê°ì§€)"</span>)
<span class="fn">print</span>(<span class="st">f"\nâ†’ ì¢…ê°€ ê¸°ë°˜: Aì™€ Bì˜ ë³€ë™ì„±ì´ ê±°ì˜ ê°™ì•„ ë³´ì„ (ë‘˜ ë‹¤ â‰ˆ 0)"</span>)
<span class="fn">print</span>(<span class="st">f"â†’ Parkinson: Aê°€ Bë³´ë‹¤ </span>{vol_park_A/vol_park_B:.1f}<span class="st">ë°° ë³€ë™ì„±ì´ í¼ (ì •í™•!)"</span>)
<span class="fn">print</span>(<span class="st">f"\nğŸ’¡ Parkinson ê³µì‹ì˜ í•µì‹¬:"</span>)
<span class="fn">print</span>(<span class="st">f"   Ïƒ_P = âˆš(1/(4Â·ln2) Â· E[ln(H/L)Â²]) Â· âˆš252"</span>)
<span class="fn">print</span>(<span class="st">f"   â†’ ln(H/L)ì´ í´ìˆ˜ë¡ ì¥ì¤‘ ë³€ë™ì´ í¬ë‹¤ëŠ” ëœ»"</span>)
<span class="fn">print</span>(<span class="st">f"   â†’ 1/(4Â·ln2) â‰ˆ 0.361ì€ ì •ê·œë¶„í¬ ê°€ì • í•˜ì˜ ë³´ì • ìƒìˆ˜"</span>)</code></pre>

<div class="info">
<p class="ni"><strong>Parkinson ë³€ë™ì„±ì˜ í•œê³„:</strong> ì¥ì¤‘ ê³ ê°€/ì €ê°€ë§Œ ì‚¬ìš©í•˜ë¯€ë¡œ, ê°­(gap) â€” ì „ì¼ ì¢…ê°€ì™€ ë‹¹ì¼ ì‹œê°€ì˜ ì°¨ì´ â€” ì„ ë°˜ì˜í•˜ì§€ ëª»í•œë‹¤. ê°­ê¹Œì§€ ë°˜ì˜í•˜ë ¤ë©´ Garman-Klass ë³€ë™ì„±ì´ë‚˜ Yang-Zhang ë³€ë™ì„±ì„ ì‚¬ìš©í•œë‹¤. í•˜ì§€ë§Œ ì‹¤ì „ì—ì„œëŠ” Parkinsonë§Œìœ¼ë¡œë„ ì¶©ë¶„íˆ ìœ ìš©í•˜ë‹¤.</p>
</div>

<h4>9.1.2 ATR (Average True Range)</h4>
<p>ATRì€ "ì§„ì •í•œ ë³€ë™ ë²”ìœ„"ì˜ í‰ê· ì´ë‹¤. ê³ ê°€-ì €ê°€ë¿ ì•„ë‹ˆë¼ ì „ì¼ ì¢…ê°€ì™€ì˜ ê°­ë„ ê³ ë ¤í•˜ì—¬ ë³€ë™ì„±ì„ ë” ì •í™•í•˜ê²Œ ì¸¡ì •í•œë‹¤.</p>

<pre><code><span class="kw">def</span> <span class="fn">calculate_atr</span>(high, low, close, period=<span class="nu">14</span>):
    <span class="st">"""ATRì„ ì§ì ‘ êµ¬í˜„í•œë‹¤"""</span>
    <span class="cm"># True Range: ì„¸ ê°€ì§€ ì¤‘ ìµœëŒ€ê°’</span>
    tr1 = high - low                    <span class="cm"># ë‹¹ì¼ ê³ ê°€ - ì €ê°€</span>
    tr2 = (high - close.shift(<span class="nu">1</span>)).abs()  <span class="cm"># ë‹¹ì¼ ê³ ê°€ - ì „ì¼ ì¢…ê°€</span>
    tr3 = (low - close.shift(<span class="nu">1</span>)).abs()   <span class="cm"># ë‹¹ì¼ ì €ê°€ - ì „ì¼ ì¢…ê°€</span>
    
    true_range = pd.concat([tr1, tr2, tr3], axis=<span class="nu">1</span>).max(axis=<span class="nu">1</span>)
    atr = true_range.rolling(window=period).mean()
    
    <span class="kw">return</span> atr, true_range

atr_14, tr = calculate_atr(high, low, close_series)

<span class="cm"># ATR ê¸°ë°˜ í”¼ì²˜</span>
features[<span class="st">"atr_14"</span>] = atr_14
features[<span class="st">"atr_ratio"</span>] = atr_14 / close_series  <span class="cm"># ê°€ê²© ëŒ€ë¹„ ATR (ìƒëŒ€ì  ë³€ë™ì„±)</span></code></pre>

<h3>9.2 ëª¨ë©˜í…€ í”¼ì²˜</h3>
<p>ëª¨ë©˜í…€(momentum)ì€ "ìµœê·¼ì— ì˜¬ëìœ¼ë©´ ê³„ì† ì˜¤ë¥´ê³ , ë–¨ì–´ì¡Œìœ¼ë©´ ê³„ì† ë–¨ì–´ì§€ëŠ”" ê²½í–¥ì„ ìˆ˜ì¹˜í™”í•œ ê²ƒì´ë‹¤. ê¸ˆìœµì—ì„œ ê°€ì¥ ê°•ë ¥í•˜ê³  ì§€ì†ì ì¸ ì´ìƒí˜„ìƒ(anomaly) ì¤‘ í•˜ë‚˜ë‹¤. Jegadeesh & Titman(1993)ì´ ë°œê²¬í•œ ì´í›„ 30ë…„ ë„˜ê²Œ ìœ íš¨ì„±ì´ í™•ì¸ë˜ê³  ìˆë‹¤.</p>

<pre><code><span class="cm"># ëª¨ë©˜í…€ í”¼ì²˜ë“¤</span>

<span class="cm"># 1. ë‹¨ìˆœ ìˆ˜ìµë¥  ëª¨ë©˜í…€ (ë‹¤ì–‘í•œ ê¸°ê°„)</span>
features[<span class="st">"mom_5d"</span>] = close_series.pct_change(<span class="nu">5</span>)    <span class="cm"># 5ì¼ ìˆ˜ìµë¥ </span>
features[<span class="st">"mom_20d"</span>] = close_series.pct_change(<span class="nu">20</span>)  <span class="cm"># 20ì¼ (1ë‹¬) ìˆ˜ìµë¥ </span>
features[<span class="st">"mom_60d"</span>] = close_series.pct_change(<span class="nu">60</span>)  <span class="cm"># 60ì¼ (3ë‹¬) ìˆ˜ìµë¥ </span>
features[<span class="st">"mom_120d"</span>] = close_series.pct_change(<span class="nu">120</span>) <span class="cm"># 120ì¼ (6ë‹¬) ìˆ˜ìµë¥ </span>
features[<span class="st">"mom_250d"</span>] = close_series.pct_change(<span class="nu">250</span>) <span class="cm"># 250ì¼ (1ë…„) ìˆ˜ìµë¥ </span>

<span class="cm"># 2. ëª¨ë©˜í…€ ê°€ì†ë„ (ëª¨ë©˜í…€ì˜ ë³€í™”)</span>
<span class="cm"># "ìƒìŠ¹ ì†ë„ê°€ ë¹¨ë¼ì§€ê³  ìˆëŠ”ê°€, ëŠë ¤ì§€ê³  ìˆëŠ”ê°€"</span>
features[<span class="st">"mom_accel"</span>] = features[<span class="st">"mom_20d"</span>] - features[<span class="st">"mom_20d"</span>].shift(<span class="nu">20</span>)

<span class="cm"># 3. 52ì£¼ ìµœê³ ê°€ ëŒ€ë¹„ ë¹„ìœ¨</span>
high_52w = close_series.rolling(<span class="nu">252</span>).max()
features[<span class="st">"pct_from_52w_high"</span>] = close_series / high_52w - <span class="nu">1</span>
<span class="cm"># 0ì´ë©´ 52ì£¼ ìµœê³ ê°€, -0.2ì´ë©´ ìµœê³ ê°€ ëŒ€ë¹„ 20% í•˜ë½</span>

<span class="cm"># 4. 52ì£¼ ìµœì €ê°€ ëŒ€ë¹„ ë¹„ìœ¨</span>
low_52w = close_series.rolling(<span class="nu">252</span>).min()
features[<span class="st">"pct_from_52w_low"</span>] = close_series / low_52w - <span class="nu">1</span>

<span class="fn">print</span>(<span class="st">"=== ëª¨ë©˜í…€ í”¼ì²˜ ==="</span>)
<span class="fn">print</span>(features[[<span class="st">"mom_5d"</span>, <span class="st">"mom_20d"</span>, <span class="st">"mom_60d"</span>, <span class="st">"pct_from_52w_high"</span>]].dropna().tail(<span class="nu">10</span>).round(<span class="nu">4</span>))</code></pre>

<h3>9.3 ê±°ë˜ëŸ‰ í”¼ì²˜</h3>
<p>ê±°ë˜ëŸ‰(volume)ì€ "ì–¼ë§ˆë‚˜ ë§ì€ ì‚¬ëŒì´ ê±°ë˜ì— ì°¸ì—¬í–ˆëŠ”ê°€"ë¥¼ ë³´ì—¬ì¤€ë‹¤. ê°€ê²© ë³€ë™ì— ê±°ë˜ëŸ‰ì´ ë™ë°˜ë˜ë©´ ê·¸ ì›€ì§ì„ì´ "ì§„ì§œ"ì¼ ê°€ëŠ¥ì„±ì´ ë†’ë‹¤. ê±°ë˜ëŸ‰ ì—†ì´ ê°€ê²©ë§Œ ì˜¤ë¥´ë©´ "ê°€ì§œ ìƒìŠ¹"ì¼ ìˆ˜ ìˆë‹¤.</p>

<pre><code>volume = samsung_df[<span class="st">"Volume"</span>].squeeze()

<span class="cm"># 1. ê±°ë˜ëŸ‰ ì´ë™í‰ê·  ëŒ€ë¹„ ë¹„ìœ¨</span>
vol_ma20 = volume.rolling(<span class="nu">20</span>).mean()
features[<span class="st">"volume_ratio"</span>] = volume / vol_ma20
<span class="cm"># > 1ì´ë©´ í‰ì†Œë³´ë‹¤ ê±°ë˜ëŸ‰ ë§ìŒ, < 1ì´ë©´ ì ìŒ</span>

<span class="cm"># 2. OBV (On-Balance Volume) â€” ëˆ„ì  ê±°ë˜ëŸ‰ ë°©í–¥</span>
<span class="kw">def</span> <span class="fn">calculate_obv</span>(close, volume):
    <span class="st">"""OBV: ìƒìŠ¹ì¼ ê±°ë˜ëŸ‰ì€ ë”í•˜ê³ , í•˜ë½ì¼ ê±°ë˜ëŸ‰ì€ ë¹¼ëŠ” ëˆ„ì ê°’"""</span>
    direction = np.sign(close.diff())
    obv = (direction * volume).cumsum()
    <span class="kw">return</span> obv

obv = calculate_obv(close_series, volume)
features[<span class="st">"obv"</span>] = obv
features[<span class="st">"obv_slope"</span>] = obv.pct_change(<span class="nu">20</span>)  <span class="cm"># OBVì˜ 20ì¼ ë³€í™”ìœ¨</span>

<span class="cm"># 3. VWAP (Volume Weighted Average Price)</span>
<span class="cm"># ê±°ë˜ëŸ‰ ê°€ì¤‘ í‰ê·  ê°€ê²© â€” ê¸°ê´€íˆ¬ììì˜ ê¸°ì¤€ ê°€ê²©</span>
typical_price = (high + low + close_series) / <span class="nu">3</span>
vwap_20 = (typical_price * volume).rolling(<span class="nu">20</span>).sum() / volume.rolling(<span class="nu">20</span>).sum()
features[<span class="st">"price_vwap_ratio"</span>] = close_series / vwap_20

<span class="cm"># 4. ê±°ë˜ëŸ‰ ë³€ë™ì„±</span>
features[<span class="st">"volume_volatility"</span>] = volume.rolling(<span class="nu">20</span>).std() / vol_ma20

<span class="fn">print</span>(<span class="st">"=== ê±°ë˜ëŸ‰ í”¼ì²˜ ==="</span>)
<span class="fn">print</span>(features[[<span class="st">"volume_ratio"</span>, <span class="st">"obv_slope"</span>, <span class="st">"price_vwap_ratio"</span>]].dropna().tail(<span class="nu">10</span>).round(<span class="nu">4</span>))</code></pre>

<div class="tc">Table 7. ê¸°ìˆ ì  ì§€í‘œ í”¼ì²˜ ì´ì •ë¦¬</div>
<table>
<tr><th>ì¹´í…Œê³ ë¦¬</th><th>í”¼ì²˜</th><th>ì˜ë¯¸</th><th>ë²”ìœ„</th></tr>
<tr><td rowspan="4">ì¶”ì„¸</td><td>price_sma20_ratio</td><td>ê°€ê²©/SMA20 ë¹„ìœ¨</td><td>0.8~1.2</td></tr>
<tr><td>golden_cross</td><td>SMA20 > SMA60 ì—¬ë¶€</td><td>0 or 1</td></tr>
<tr><td>macd_hist</td><td>MACD íˆìŠ¤í† ê·¸ë¨</td><td>(-âˆ, +âˆ)</td></tr>
<tr><td>sma20_slope</td><td>SMA20 ê¸°ìš¸ê¸°</td><td>(-âˆ, +âˆ)</td></tr>
<tr><td rowspan="3">ê³¼ë§¤ìˆ˜/ê³¼ë§¤ë„</td><td>rsi_14</td><td>RSI (14ì¼)</td><td>[0, 100]</td></tr>
<tr><td>bb_pct_b</td><td>ë³¼ë¦°ì € %B</td><td>[0, 1] ê·¼ì²˜</td></tr>
<tr><td>bb_squeeze</td><td>ë°´ë“œ ìˆ˜ì¶• ì—¬ë¶€</td><td>0 or 1</td></tr>
<tr><td rowspan="3">ë³€ë™ì„±</td><td>vol_20</td><td>20ì¼ ë³€ë™ì„± (ì—°í™˜ì‚°)</td><td>[0, +âˆ)</td></tr>
<tr><td>atr_ratio</td><td>ATR/ê°€ê²© ë¹„ìœ¨</td><td>[0, +âˆ)</td></tr>
<tr><td>bb_bandwidth</td><td>ë³¼ë¦°ì € ë°´ë“œí­</td><td>[0, +âˆ)</td></tr>
<tr><td rowspan="3">ëª¨ë©˜í…€</td><td>mom_20d</td><td>20ì¼ ìˆ˜ìµë¥ </td><td>(-1, +âˆ)</td></tr>
<tr><td>mom_accel</td><td>ëª¨ë©˜í…€ ê°€ì†ë„</td><td>(-âˆ, +âˆ)</td></tr>
<tr><td>pct_from_52w_high</td><td>52ì£¼ ê³ ê°€ ëŒ€ë¹„</td><td>[-1, 0]</td></tr>
<tr><td rowspan="3">ê±°ë˜ëŸ‰</td><td>volume_ratio</td><td>ê±°ë˜ëŸ‰/MA20 ë¹„ìœ¨</td><td>[0, +âˆ)</td></tr>
<tr><td>obv_slope</td><td>OBV ë³€í™”ìœ¨</td><td>(-âˆ, +âˆ)</td></tr>
<tr><td>price_vwap_ratio</td><td>ê°€ê²©/VWAP ë¹„ìœ¨</td><td>0.9~1.1</td></tr>
</table>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- Ch10: ì•ŒíŒŒíŒ©í„° ê¸°ì´ˆ -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<h2 id="ch10">10. ì•ŒíŒŒíŒ©í„° ê¸°ì´ˆ â€” ìˆ˜ìµì˜ ì›ì²œì„ ì°¾ì•„ì„œ</h2>

<!-- ì•ŒíŒŒíŒ©í„° í‰ê°€ íŒŒì´í”„ë¼ì¸ ë‹¤ì´ì–´ê·¸ë¨ (CSS) -->
<div style="margin:25px 0;padding:25px;background:linear-gradient(135deg,#f8f9fa,#faf0f0);border-radius:10px;border:1px solid #ccc">
<p class="ni" style="text-align:center;font-weight:bold;font-size:15px;margin-bottom:18px;color:#2c3e50">ğŸ¯ ì•ŒíŒŒíŒ©í„° í‰ê°€ íŒŒì´í”„ë¼ì¸</p>
<div style="display:flex;flex-direction:column;gap:10px;font-size:12px;max-width:700px;margin:0 auto">
<div style="display:flex;gap:8px;justify-content:center;flex-wrap:wrap">
<div style="flex:1;min-width:140px;background:#fff;border:2px solid #3498db;border-radius:8px;padding:12px;text-align:center">
<div style="font-size:20px;margin-bottom:4px">ğŸ’¡</div>
<div style="font-weight:bold;color:#3498db">íŒ©í„° í›„ë³´ ìƒì„±</div>
<div style="font-size:11px;color:#555;margin-top:4px">RSI, ëª¨ë©˜í…€, ë³€ë™ì„± ë“±<br>20+ í”¼ì²˜ í›„ë³´êµ°</div>
</div>
<div style="display:flex;align-items:center;color:#888;font-size:18px">â†’</div>
<div style="flex:1;min-width:140px;background:#fff;border:2px solid #e67e22;border-radius:8px;padding:12px;text-align:center">
<div style="font-size:20px;margin-bottom:4px">ğŸ“Š</div>
<div style="font-weight:bold;color:#e67e22">IC ê³„ì‚°</div>
<div style="font-size:11px;color:#555;margin-top:4px">íŒ©í„°ê°’ vs ë¯¸ë˜ìˆ˜ìµë¥ <br>ìƒê´€ê³„ìˆ˜ (Rank IC)</div>
</div>
<div style="display:flex;align-items:center;color:#888;font-size:18px">â†’</div>
<div style="flex:1;min-width:140px;background:#fff;border:2px solid #27ae60;border-radius:8px;padding:12px;text-align:center">
<div style="font-size:20px;margin-bottom:4px">âœ…</div>
<div style="font-weight:bold;color:#27ae60">ìœ íš¨ì„± ê²€ì¦</div>
<div style="font-size:11px;color:#555;margin-top:4px">IC > 0.03?<br>ì•ˆì •ì ? ë…ë¦½ì ?</div>
</div>
<div style="display:flex;align-items:center;color:#888;font-size:18px">â†’</div>
<div style="flex:1;min-width:140px;background:#fff;border:2px solid #e74c3c;border-radius:8px;padding:12px;text-align:center">
<div style="font-size:20px;margin-bottom:4px">ğŸ†</div>
<div style="font-weight:bold;color:#e74c3c">íŒ©í„° ì„ ì •</div>
<div style="font-size:11px;color:#555;margin-top:4px">ML ëª¨ë¸ ì…ë ¥ìœ¼ë¡œ<br>ìµœì¢… í”¼ì²˜ í…Œì´ë¸”</div>
</div>
</div>
<div style="margin-top:12px;display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:8px">
<div style="background:#e8f4f8;padding:8px;border-radius:4px;text-align:center;font-size:11px">
<strong>IC (Information Coefficient)</strong><br>|IC| > 0.05 â†’ ê°•í•œ íŒ©í„°
</div>
<div style="background:#fff9e6;padding:8px;border-radius:4px;text-align:center;font-size:11px">
<strong>IC IR (ICì˜ ìƒ¤í”„ë¹„ìœ¨)</strong><br>IC_mean / IC_std > 0.5
</div>
<div style="background:#e8f8e8;padding:8px;border-radius:4px;text-align:center;font-size:11px">
<strong>Turnover</strong><br>íŒ©í„° ìˆœìœ„ ë³€ë™ ë¹ˆë„<br>ë‚®ì„ìˆ˜ë¡ ê±°ë˜ë¹„ìš© ì ˆê°
</div>
<div style="background:#f0e8f8;padding:8px;border-radius:4px;text-align:center;font-size:11px">
<strong>íŒ©í„° ìƒê´€</strong><br>ë‹¤ë¥¸ íŒ©í„°ì™€ ìƒê´€ < 0.5<br>ë…ë¦½ì  ì •ë³´ ì œê³µ
</div>
</div>
</div>
</div>

<h3>10.1 ì•ŒíŒŒë€ ë¬´ì—‡ì¸ê°€</h3>
<p>ì•ŒíŒŒ(alpha)ëŠ” ì‹œì¥ ìˆ˜ìµë¥ ì„ ì´ˆê³¼í•˜ëŠ” ìˆ˜ìµì´ë‹¤. ì‹œì¥ì´ 10% ì˜¬ëëŠ”ë° ë‚´ í¬íŠ¸í´ë¦¬ì˜¤ê°€ 15% ì˜¬ëë‹¤ë©´, ì•ŒíŒŒëŠ” 5%ë‹¤. ëª¨ë“  í€€íŠ¸ íˆ¬ìì˜ ê¶ê·¹ì  ëª©í‘œëŠ” "ì§€ì†ì ìœ¼ë¡œ ì–‘ì˜ ì•ŒíŒŒë¥¼ ìƒì„±í•˜ëŠ” ê²ƒ"ì´ë‹¤.</p>

<p>ì•ŒíŒŒíŒ©í„°(alpha factor)ëŠ” "ì´ ì‹ í˜¸ë¥¼ ë”°ë¼ íˆ¬ìí•˜ë©´ ì•ŒíŒŒë¥¼ ì–»ì„ ìˆ˜ ìˆë‹¤"ê³  ê¸°ëŒ€ë˜ëŠ” ì˜ˆì¸¡ ë³€ìˆ˜ë‹¤. ìš°ë¦¬ê°€ ì•ì—ì„œ ë§Œë“  RSI, MACD, ëª¨ë©˜í…€ ë“±ì´ ëª¨ë‘ ì•ŒíŒŒíŒ©í„° í›„ë³´ë‹¤. í•˜ì§€ë§Œ ëª¨ë“  í”¼ì²˜ê°€ ì¢‹ì€ ì•ŒíŒŒíŒ©í„°ëŠ” ì•„ë‹ˆë‹¤. ì–´ë–¤ í”¼ì²˜ê°€ ì§„ì§œ ì˜ˆì¸¡ë ¥ì´ ìˆëŠ”ì§€ í‰ê°€í•˜ëŠ” ë°©ë²•ì´ í•„ìš”í•˜ë‹¤.</p>

<div class="def">
<p class="ni"><strong>ì •ì˜: ì•ŒíŒŒíŒ©í„° (Alpha Factor)</strong></p>
<p class="ni">ì•ŒíŒŒíŒ©í„°ëŠ” ë¯¸ë˜ ìˆ˜ìµë¥ ê³¼ í†µê³„ì ìœ¼ë¡œ ìœ ì˜ë¯¸í•œ ìƒê´€ê´€ê³„ë¥¼ ê°€ì§€ëŠ” ì˜ˆì¸¡ ë³€ìˆ˜ë‹¤. ì¢‹ì€ ì•ŒíŒŒíŒ©í„°ëŠ” (1) ì˜ˆì¸¡ë ¥ì´ ìˆê³ , (2) ì‹œê°„ì´ ì§€ë‚˜ë„ ìœ íš¨í•˜ë©°, (3) ë‹¤ë¥¸ íŒ©í„°ì™€ ìƒê´€ì´ ë‚®ì•„ì•¼ í•œë‹¤.</p>
</div>

<div class="info">
<p class="ni"><strong>êµì¬ ì—°ë™:</strong> MLAT Ch.4 "Financial Feature Engineering and Alpha Factors"ê°€ ì´ ì£¼ì œì˜ í•µì‹¬ ì°¸ê³  ìë£Œë‹¤. íŒ©í„°ì˜ ì •ì˜, IC ê³„ì‚°, íŒ©í„° ë¶„ì„ ë°©ë²•ë¡ ì„ ìƒì„¸íˆ ë‹¤ë£¬ë‹¤. MLDSF Ch.2ì—ì„œë„ í”¼ì²˜ ì—”ì§€ë‹ˆì–´ë§ì˜ ì‹¤ì „ ë¸”ë£¨í”„ë¦°íŠ¸ë¥¼ ì œì‹œí•œë‹¤.</p>
</div>

<h3>10.2 IC (Information Coefficient) â€” íŒ©í„°ì˜ ì˜ˆì¸¡ë ¥ ì¸¡ì •</h3>
<p>ICëŠ” "íŒ©í„° ê°’ê³¼ ë¯¸ë˜ ìˆ˜ìµë¥  ì‚¬ì´ì˜ ìƒê´€ê³„ìˆ˜"ë‹¤. íŒ©í„°ê°€ ë†’ì€ ì¢…ëª©ì´ ì‹¤ì œë¡œ ìˆ˜ìµë¥ ì´ ë†’ì•˜ëŠ”ì§€ë¥¼ ì¸¡ì •í•œë‹¤. ICê°€ ì–‘ìˆ˜ì´ë©´ íŒ©í„°ê°€ ì˜ˆì¸¡ë ¥ì´ ìˆë‹¤ëŠ” ëœ»ì´ë‹¤.</p>

<div class="eq">\[ \text{IC}_t = \text{corr}(\text{Factor}_t, \text{Return}_{t+1}) \]</div>

<p>ICì˜ í•´ì„:</p>
<ul>
<li><strong>|IC| > 0.05:</strong> ì˜ë¯¸ ìˆëŠ” ì˜ˆì¸¡ë ¥ (ê¸ˆìœµì—ì„œëŠ” ì´ ì •ë„ë©´ í›Œë¥­í•˜ë‹¤!)</li>
<li><strong>|IC| > 0.10:</strong> ë§¤ìš° ê°•í•œ ì˜ˆì¸¡ë ¥ (ë“œë¬¼ë‹¤)</li>
<li><strong>IC â‰ˆ 0:</strong> ì˜ˆì¸¡ë ¥ ì—†ìŒ</li>
<li><strong>ICì˜ ë¶€í˜¸:</strong> ì–‘ìˆ˜ë©´ íŒ©í„°ê°€ í´ìˆ˜ë¡ ìˆ˜ìµë¥  ë†’ìŒ, ìŒìˆ˜ë©´ ë°˜ëŒ€</li>
</ul>

<pre><code><span class="cm"># IC ê³„ì‚° ì˜ˆì œ</span>
<span class="cm"># 5ì¢…ëª© ë°ì´í„°ë¡œ ê°„ë‹¨í•œ IC ê³„ì‚°</span>

<span class="cm"># 1. ê° ì¢…ëª©ì˜ 20ì¼ ëª¨ë©˜í…€ íŒ©í„°</span>
adj_close = yf.download(tickers, period=<span class="st">"2y"</span>)[<span class="st">"Close"</span>]
adj_close.columns = names

<span class="cm"># 20ì¼ ëª¨ë©˜í…€</span>
momentum_20 = adj_close.pct_change(<span class="nu">20</span>)

<span class="cm"># ë¯¸ë˜ 20ì¼ ìˆ˜ìµë¥  (ì˜ˆì¸¡ ëŒ€ìƒ)</span>
future_return_20 = adj_close.pct_change(<span class="nu">20</span>).shift(-<span class="nu">20</span>)

<span class="cm"># 2. ë‚ ì§œë³„ IC ê³„ì‚° (íš¡ë‹¨ë©´ ìƒê´€ê³„ìˆ˜)</span>
ic_series = momentum_20.corrwith(future_return_20, axis=<span class="nu">1</span>)
ic_series = ic_series.dropna()

<span class="fn">print</span>(<span class="st">"=== 20ì¼ ëª¨ë©˜í…€ íŒ©í„°ì˜ IC ==="</span>)
<span class="fn">print</span>(<span class="st">f"í‰ê·  IC: </span>{ic_series.mean():.4f}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"IC í‘œì¤€í¸ì°¨: </span>{ic_series.std():.4f}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"IC > 0 ë¹„ìœ¨: </span>{(ic_series > 0).mean():.2%}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"IR (IC/std): </span>{ic_series.mean() / ic_series.std():.4f}<span class="st">"</span>)

<span class="cm"># IC ì‹œê³„ì—´ ì‹œê°í™”</span>
fig, axes = plt.subplots(<span class="nu">2</span>, <span class="nu">1</span>, figsize=(<span class="nu">14</span>, <span class="nu">7</span>))

axes[<span class="nu">0</span>].bar(ic_series.index, ic_series.values,
           color=[<span class="st">"green"</span> <span class="kw">if</span> v > <span class="nu">0</span> <span class="kw">else</span> <span class="st">"red"</span> <span class="kw">for</span> v <span class="kw">in</span> ic_series.values],
           alpha=<span class="nu">0.6</span>, width=<span class="nu">2</span>)
axes[<span class="nu">0</span>].axhline(y=<span class="nu">0</span>, color=<span class="st">"black"</span>, linewidth=<span class="nu">0.5</span>)
axes[<span class="nu">0</span>].set_title(<span class="st">"20ì¼ ëª¨ë©˜í…€ íŒ©í„° IC ì‹œê³„ì—´"</span>)
axes[<span class="nu">0</span>].set_ylabel(<span class="st">"IC"</span>)
axes[<span class="nu">0</span>].grid(<span class="kw">True</span>, alpha=<span class="nu">0.3</span>)

<span class="cm"># ëˆ„ì  IC</span>
axes[<span class="nu">1</span>].plot(ic_series.cumsum().index, ic_series.cumsum().values, color=<span class="st">"navy"</span>)
axes[<span class="nu">1</span>].set_title(<span class="st">"ëˆ„ì  IC (ìš°ìƒí–¥ì´ë©´ íŒ©í„°ê°€ ìœ íš¨)"</span>)
axes[<span class="nu">1</span>].set_ylabel(<span class="st">"Cumulative IC"</span>)
axes[<span class="nu">1</span>].grid(<span class="kw">True</span>, alpha=<span class="nu">0.3</span>)

plt.tight_layout()
plt.show()</code></pre>

<h3>10.3 IR (Information Ratio) â€” íŒ©í„°ì˜ ì•ˆì •ì„±</h3>

<!-- â”€â”€ ë³´ì¶© 10.2+ IC êµ¬ì²´ì  step-by-step ê³„ì‚° + Alpha Decay â”€â”€ -->
<div class="def">
<p class="ni"><strong>ğŸ” ë³´ì¶©: ICë¥¼ ì‘ì€ ìˆ«ìë¡œ step-by-step ê³„ì‚°í•´ë³´ê¸° + Alpha Decay ê°œë…</strong></p>
<p class="ni">IC ê³µì‹ \(\text{IC}_t = \text{corr}(\text{Factor}_t, \text{Return}_{t+1})\)ì´ ì‹¤ì œë¡œ ì–´ë–»ê²Œ ê³„ì‚°ë˜ëŠ”ì§€, 5ê°œ ì¢…ëª©ì˜ ì‘ì€ ì˜ˆì œë¡œ í•œ ë‹¨ê³„ì”© ë”°ë¼ê°€ë³´ì. ê·¸ë¦¬ê³  "ì•ŒíŒŒê°€ ì‹œê°„ì´ ì§€ë‚˜ë©´ ì‚¬ë¼ì§„ë‹¤"ëŠ” Alpha Decay ê°œë…ë„ ì†Œê°œí•œë‹¤.</p>
</div>

<pre><code><span class="cm"># === IC ê³„ì‚° step-by-step (5ì¢…ëª© ë¯¸ë‹ˆ ì˜ˆì œ) ===</span>
<span class="kw">import</span> numpy <span class="kw">as</span> np
<span class="kw">import</span> pandas <span class="kw">as</span> pd
<span class="kw">from</span> scipy <span class="kw">import</span> stats

<span class="cm"># Step 1: ì˜¤ëŠ˜(tì¼) 5ì¢…ëª©ì˜ 20ì¼ ëª¨ë©˜í…€ íŒ©í„°ê°’</span>
stocks = [<span class="st">"ì‚¼ì„±ì „ì"</span>, <span class="st">"SKí•˜ì´ë‹‰ìŠ¤"</span>, <span class="st">"NAVER"</span>, <span class="st">"ì¹´ì¹´ì˜¤"</span>, <span class="st">"LGì—ë„ˆì§€"</span>]
factor_t = pd.Series([<span class="nu">0.08</span>, <span class="nu">0.12</span>, -<span class="nu">0.03</span>, -<span class="nu">0.10</span>, <span class="nu">0.05</span>], index=stocks, name=<span class="st">"ëª¨ë©˜í…€(t)"</span>)
<span class="cm"># ì‚¼ì„± +8%, SK +12%, NAVER -3%, ì¹´ì¹´ì˜¤ -10%, LG +5%</span>

<span class="cm"># Step 2: ë¯¸ë˜(t+1 ~ t+20ì¼) 20ì¼ ìˆ˜ìµë¥  (ë‚˜ì¤‘ì— ì•Œê²Œ ë˜ëŠ” ê°’)</span>
return_t1 = pd.Series([<span class="nu">0.05</span>, <span class="nu">0.09</span>, <span class="nu">0.01</span>, -<span class="nu">0.06</span>, <span class="nu">0.03</span>], index=stocks, name=<span class="st">"ìˆ˜ìµë¥ (t+1)"</span>)
<span class="cm"># ì‚¼ì„± +5%, SK +9%, NAVER +1%, ì¹´ì¹´ì˜¤ -6%, LG +3%</span>

<span class="fn">print</span>(<span class="st">"=== Step 1 & 2: íŒ©í„°ê°’ê³¼ ë¯¸ë˜ ìˆ˜ìµë¥  ==="</span>)
table = pd.DataFrame({<span class="st">"ëª¨ë©˜í…€(t)"</span>: factor_t, <span class="st">"ìˆ˜ìµë¥ (t+1)"</span>: return_t1})
<span class="fn">print</span>(table)
<span class="fn">print</span>(<span class="st">"\nâ†’ ëª¨ë©˜í…€ì´ ë†’ì€ ì¢…ëª©(SK +12%)ì´ ì‹¤ì œë¡œ ìˆ˜ìµë¥ ë„ ë†’ì•˜ëŠ”ê°€(SK +9%)?"</span>)</code></pre>

<pre><code><span class="cm"># Step 3: ìˆœìœ„ ë³€í™˜ (Rank IC = Spearman ìƒê´€ê³„ìˆ˜)</span>
rank_factor = factor_t.rank()
rank_return = return_t1.rank()

<span class="fn">print</span>(<span class="st">"=== Step 3: ìˆœìœ„ ë³€í™˜ ==="</span>)
rank_table = pd.DataFrame({
    <span class="st">"ëª¨ë©˜í…€ê°’"</span>: factor_t,
    <span class="st">"ëª¨ë©˜í…€ìˆœìœ„"</span>: rank_factor,
    <span class="st">"ìˆ˜ìµë¥ ê°’"</span>: return_t1,
    <span class="st">"ìˆ˜ìµë¥ ìˆœìœ„"</span>: rank_return
})
<span class="fn">print</span>(rank_table)
<span class="cm"># SKí•˜ì´ë‹‰ìŠ¤: ëª¨ë©˜í…€ 1ìœ„ â†’ ìˆ˜ìµë¥ ë„ 1ìœ„ âœ“</span>
<span class="cm"># ì¹´ì¹´ì˜¤: ëª¨ë©˜í…€ 5ìœ„(ê¼´ì°Œ) â†’ ìˆ˜ìµë¥ ë„ 5ìœ„(ê¼´ì°Œ) âœ“</span>
<span class="cm"># â†’ ìˆœìœ„ê°€ ì˜ ë§ìœ¼ë©´ ICê°€ ë†’ë‹¤!</span>

<span class="cm"># Step 4: IC ê³„ì‚° (Spearman ìˆœìœ„ ìƒê´€ê³„ìˆ˜)</span>
ic_value, p_value = stats.spearmanr(factor_t, return_t1)
<span class="fn">print</span>(<span class="st">f"\n=== Step 4: IC ê³„ì‚° ==="</span>)
<span class="fn">print</span>(<span class="st">f"Rank IC = </span>{ic_value:.4f}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"p-value = </span>{p_value:.4f}<span class="st">"</span>)

<span class="cm"># Pearson ICë„ ë¹„êµ</span>
pearson_ic = factor_t.corr(return_t1)
<span class="fn">print</span>(<span class="st">f"Pearson IC = </span>{pearson_ic:.4f}<span class="st">"</span>)

<span class="fn">print</span>(<span class="st">f"\n=== IC í•´ì„ ==="</span>)
<span class="fn">print</span>(<span class="st">f"IC = </span>{ic_value:.2f}<span class="st"> â†’ ëª¨ë©˜í…€ íŒ©í„°ê°€ ë¯¸ë˜ ìˆ˜ìµë¥ ì„ ì˜ ì˜ˆì¸¡í–ˆë‹¤!"</span>)
<span class="fn">print</span>(<span class="st">f"(ê¸ˆìœµì—ì„œ |IC| > 0.05ë©´ ì˜ë¯¸ ìˆê³ , > 0.10ì´ë©´ ë§¤ìš° ê°•í•œ íŒ©í„°)"</span>)</code></pre>

<pre><code><span class="cm"># Step 5: ì—¬ëŸ¬ ë‚ ì˜ ICë¥¼ ëª¨ì•„ì„œ í‰ê·  ICì™€ IR ê³„ì‚°</span>
<span class="cm"># (ì‹¤ì „ì—ì„œëŠ” ë§¤ì¼ ICë¥¼ ê³„ì‚°í•˜ê³ , ê·¸ í‰ê· ê³¼ ì•ˆì •ì„±ì„ ë³¸ë‹¤)</span>

np.random.seed(<span class="nu">42</span>)
n_days = <span class="nu">250</span>  <span class="cm"># 1ë…„</span>

<span class="cm"># ì‹œë®¬ë ˆì´ì…˜: ë§¤ì¼ 5ì¢…ëª©ì˜ IC ê³„ì‚°</span>
daily_ics = []
<span class="kw">for</span> day <span class="kw">in</span> <span class="fn">range</span>(n_days):
    <span class="cm"># íŒ©í„°ê°’ (ëœë¤)</span>
    f = np.random.normal(<span class="nu">0</span>, <span class="nu">0.1</span>, <span class="nu">5</span>)
    <span class="cm"># ë¯¸ë˜ ìˆ˜ìµë¥  = íŒ©í„° Ã— 0.3 + ë…¸ì´ì¦ˆ (ì•½í•œ ì˜ˆì¸¡ë ¥)</span>
    r = f * <span class="nu">0.3</span> + np.random.normal(<span class="nu">0</span>, <span class="nu">0.05</span>, <span class="nu">5</span>)
    ic, _ = stats.spearmanr(f, r)
    daily_ics.append(ic)

daily_ics = pd.Series(daily_ics)

<span class="fn">print</span>(<span class="st">"=== 1ë…„ê°„ ì¼ë³„ IC í†µê³„ ==="</span>)
<span class="fn">print</span>(<span class="st">f"í‰ê·  IC (Mean IC): </span>{daily_ics.mean():.4f}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"IC í‘œì¤€í¸ì°¨:       </span>{daily_ics.std():.4f}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"IR = IC/std:       </span>{daily_ics.mean()/daily_ics.std():.4f}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"IC > 0 ë¹„ìœ¨:       </span>{(daily_ics > 0).mean():.1%}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"\nâ†’ IR > 0.5ì´ë©´ ì•ˆì •ì ì¸ íŒ©í„°, > 1.0ì´ë©´ ë§¤ìš° ìš°ìˆ˜"</span>)</code></pre>

<pre><code><span class="cm"># === Alpha Decay (ì•ŒíŒŒ ê°ì‡ ) ===</span>
<span class="cm"># "íŒ©í„°ì˜ ì˜ˆì¸¡ë ¥ì€ ì‹œê°„ì´ ì§€ë‚˜ë©´ ì‚¬ë¼ì§„ë‹¤"</span>

<span class="cm"># ë‹¤ì–‘í•œ ì˜ˆì¸¡ ê¸°ê°„(horizon)ì— ëŒ€í•´ IC ê³„ì‚°</span>
horizons = [<span class="nu">1</span>, <span class="nu">5</span>, <span class="nu">10</span>, <span class="nu">20</span>, <span class="nu">40</span>, <span class="nu">60</span>]  <span class="cm"># 1ì¼ ~ 60ì¼ í›„</span>
ic_by_horizon = []

np.random.seed(<span class="nu">42</span>)
<span class="kw">for</span> h <span class="kw">in</span> horizons:
    ics = []
    <span class="kw">for</span> _ <span class="kw">in</span> <span class="fn">range</span>(<span class="nu">500</span>):
        f = np.random.normal(<span class="nu">0</span>, <span class="nu">0.1</span>, <span class="nu">20</span>)
        <span class="cm"># ì˜ˆì¸¡ë ¥ì´ horizonì— ë°˜ë¹„ë¡€í•˜ì—¬ ê°ì†Œ</span>
        signal_strength = <span class="nu">0.5</span> / np.sqrt(h)
        r = f * signal_strength + np.random.normal(<span class="nu">0</span>, <span class="nu">0.05</span>, <span class="nu">20</span>)
        ic, _ = stats.spearmanr(f, r)
        ics.append(ic)
    ic_by_horizon.append(np.mean(ics))

<span class="fn">print</span>(<span class="st">"=== Alpha Decay: ì˜ˆì¸¡ ê¸°ê°„ë³„ IC ==="</span>)
<span class="kw">for</span> h, ic <span class="kw">in</span> <span class="fn">zip</span>(horizons, ic_by_horizon):
    bar = <span class="st">"â–ˆ"</span> * <span class="nb">int</span>(ic * <span class="nu">100</span>)
    <span class="fn">print</span>(<span class="st">f"  </span>{h:2d}<span class="st">ì¼ í›„: IC = </span>{ic:.4f}<span class="st"> </span>{bar}<span class="st">"</span>)

<span class="fn">print</span>(<span class="st">f"\nğŸ’¡ Alpha Decayë€?"</span>)
<span class="fn">print</span>(<span class="st">f"  â†’ íŒ©í„°ì˜ ì˜ˆì¸¡ë ¥(IC)ì€ ì˜ˆì¸¡ ê¸°ê°„ì´ ê¸¸ì–´ì§ˆìˆ˜ë¡ ê°ì†Œí•œë‹¤."</span>)
<span class="fn">print</span>(<span class="st">f"  â†’ 1ì¼ í›„ ICê°€ ë†’ì•„ë„, 20ì¼ í›„ì—ëŠ” ê±°ì˜ 0ì— ê°€ê¹Œìš¸ ìˆ˜ ìˆë‹¤."</span>)
<span class="fn">print</span>(<span class="st">f"  â†’ HFTì—ì„œëŠ” ì´ ê°ì‡ ê°€ ë§¤ìš° ë¹ ë¥´ë‹¤ (ë¶„~ì‹œê°„ ë‹¨ìœ„)."</span>)
<span class="fn">print</span>(<span class="st">f"  â†’ Alpha Decayê°€ ëŠë¦° íŒ©í„° = ë” ì˜¤ë˜ ìœ íš¨í•œ íŒ©í„° = ë” ê°€ì¹˜ ìˆë‹¤."</span>)
<span class="fn">print</span>(<span class="st">f"  â†’ ì‹¤ì „ì—ì„œëŠ” íŒ©í„°ì˜ 'half-life'(ICê°€ ì ˆë°˜ì´ ë˜ëŠ” ê¸°ê°„)ë¥¼ ì¸¡ì •í•œë‹¤."</span>)</code></pre>

<div class="info">
<p class="ni"><strong>IC ì‹¤ì „ ì²´í¬ë¦¬ìŠ¤íŠ¸:</strong></p>
<ul>
<li><strong>Mean IC > 0.03:</strong> ìµœì†Œí•œì˜ ì˜ˆì¸¡ë ¥ (ì‚¬ìš© ê°€ëŠ¥)</li>
<li><strong>Mean IC > 0.05:</strong> ì˜ë¯¸ ìˆëŠ” ì˜ˆì¸¡ë ¥ (ì¢‹ì€ íŒ©í„°)</li>
<li><strong>IR > 0.5:</strong> ì•ˆì •ì ì¸ íŒ©í„° (ICê°€ ì¼ê´€ë˜ê²Œ ì–‘ìˆ˜)</li>
<li><strong>IC > 0 ë¹„ìœ¨ > 55%:</strong> ì ˆë°˜ ì´ìƒì˜ ë‚ ì—ì„œ ì˜ˆì¸¡ì´ ë§ìŒ</li>
<li><strong>Alpha Decay half-life > 5ì¼:</strong> ì¼ê°„ ë¦¬ë°¸ëŸ°ì‹± ì „ëµì— ì í•©</li>
</ul>
</div>
<p>ICê°€ ë†’ì•„ë„ ë‚ ë§ˆë‹¤ ë“¤ì­‰ë‚ ì­‰í•˜ë©´ ì‹ ë¢°í•˜ê¸° ì–´ë µë‹¤. IR(Information Ratio)ì€ ICì˜ í‰ê· ì„ ICì˜ í‘œì¤€í¸ì°¨ë¡œ ë‚˜ëˆˆ ê²ƒìœ¼ë¡œ, "íŒ©í„°ì˜ ì˜ˆì¸¡ë ¥ì´ ì–¼ë§ˆë‚˜ ì•ˆì •ì ì¸ê°€"ë¥¼ ì¸¡ì •í•œë‹¤. ìƒ¤í”„ë¹„ìœ¨ì˜ íŒ©í„° ë²„ì „ì´ë¼ê³  ìƒê°í•˜ë©´ ëœë‹¤.</p>

<div class="eq">\[ \text{IR} = \frac{\text{Mean}(\text{IC})}{\text{Std}(\text{IC})} \]</div>

<p>IRì˜ í•´ì„:</p>
<ul>
<li><strong>IR > 0.5:</strong> ë§¤ìš° ì¢‹ì€ íŒ©í„°</li>
<li><strong>IR > 0.3:</strong> ê´œì°®ì€ íŒ©í„°</li>
<li><strong>IR < 0.1:</strong> ì‹ ë¢°í•˜ê¸° ì–´ë ¤ì›€</li>
</ul>

<h3>10.4 íŒ©í„° ìƒê´€ê´€ê³„ â€” ë‹¤ì–‘ì„±ì´ ì¤‘ìš”í•˜ë‹¤</h3>
<p>ì—¬ëŸ¬ íŒ©í„°ë¥¼ ë™ì‹œì— ì‚¬ìš©í•  ë•Œ, íŒ©í„°ë“¤ ê°„ì˜ ìƒê´€ê´€ê³„ê°€ ë‚®ì•„ì•¼ í•œë‹¤. ëª¨ë©˜í…€ê³¼ RSIëŠ” ë‘˜ ë‹¤ "ì¶”ì„¸"ë¥¼ ì¸¡ì •í•˜ë¯€ë¡œ ìƒê´€ì´ ë†’ì„ ìˆ˜ ìˆë‹¤. ìƒê´€ì´ ë†’ì€ íŒ©í„°ë¥¼ ì—¬ëŸ¬ ê°œ ë„£ì–´ë´¤ì ì •ë³´ê°€ ì¤‘ë³µë  ë¿ì´ë‹¤.</p>

<pre><code><span class="cm"># í”¼ì²˜ ê°„ ìƒê´€ê´€ê³„ ë¶„ì„</span>
feature_cols = [<span class="st">"mom_20d"</span>, <span class="st">"mom_60d"</span>, <span class="st">"bb_pct_b"</span>, <span class="st">"bb_bandwidth"</span>,
                <span class="st">"volume_ratio"</span>, <span class="st">"atr_ratio"</span>, <span class="st">"price_sma20_ratio"</span>]

<span class="cm"># ì‚¬ìš© ê°€ëŠ¥í•œ í”¼ì²˜ë§Œ ì„ íƒ</span>
available = [c <span class="kw">for</span> c <span class="kw">in</span> feature_cols <span class="kw">if</span> c <span class="kw">in</span> features.columns]
corr_matrix = features[available].dropna().corr()

<span class="cm"># íˆíŠ¸ë§µ ì‹œê°í™”</span>
fig, ax = plt.subplots(figsize=(<span class="nu">8</span>, <span class="nu">6</span>))
im = ax.imshow(corr_matrix, cmap=<span class="st">"RdBu_r"</span>, vmin=-<span class="nu">1</span>, vmax=<span class="nu">1</span>)
ax.set_xticks(<span class="fn">range</span>(<span class="fn">len</span>(available)))
ax.set_yticks(<span class="fn">range</span>(<span class="fn">len</span>(available)))
ax.set_xticklabels(available, rotation=<span class="nu">45</span>, ha=<span class="st">"right"</span>, fontsize=<span class="nu">9</span>)
ax.set_yticklabels(available, fontsize=<span class="nu">9</span>)

<span class="cm"># ìƒê´€ê³„ìˆ˜ ê°’ í‘œì‹œ</span>
<span class="kw">for</span> i <span class="kw">in</span> <span class="fn">range</span>(<span class="fn">len</span>(available)):
    <span class="kw">for</span> j <span class="kw">in</span> <span class="fn">range</span>(<span class="fn">len</span>(available)):
        ax.text(j, i, <span class="st">f"</span>{corr_matrix.iloc[i, j]:.2f}<span class="st">"</span>,
                ha=<span class="st">"center"</span>, va=<span class="st">"center"</span>, fontsize=<span class="nu">8</span>,
                color=<span class="st">"white"</span> <span class="kw">if</span> abs(corr_matrix.iloc[i, j]) > <span class="nu">0.5</span> <span class="kw">else</span> <span class="st">"black"</span>)

plt.colorbar(im)
ax.set_title(<span class="st">"í”¼ì²˜ ê°„ ìƒê´€ê´€ê³„ íˆíŠ¸ë§µ"</span>)
plt.tight_layout()
plt.show()</code></pre>

<div class="warn">
<p class="ni"><strong>ë‹¤ì¤‘ê³µì„ ì„± (Multicollinearity):</strong> í”¼ì²˜ ê°„ ìƒê´€ì´ 0.8 ì´ìƒì´ë©´ ë‹¤ì¤‘ê³µì„ ì„± ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤. ì„ í˜• ëª¨ë¸(íšŒê·€, ë¡œì§€ìŠ¤í‹±)ì—ì„œ ê³„ìˆ˜ê°€ ë¶ˆì•ˆì •í•´ì§€ê³ , í•´ì„ì´ ì–´ë ¤ì›Œì§„ë‹¤. í•´ê²° ë°©ë²•: (1) ìƒê´€ì´ ë†’ì€ í”¼ì²˜ ì¤‘ í•˜ë‚˜ë¥¼ ì œê±°, (2) PCAë¡œ ì°¨ì› ì¶•ì†Œ (Round 5), (3) íŠ¸ë¦¬ ê¸°ë°˜ ëª¨ë¸ ì‚¬ìš© (ë‹¤ì¤‘ê³µì„ ì„±ì— ê°•ê±´).</p>
</div>

<h3>10.5 íŒ©í„° ì¤‘ë¦½í™” (Factor Neutralization)</h3>
<p>ì•ŒíŒŒíŒ©í„°ë¥¼ ì‚¬ìš©í•  ë•Œ ì£¼ì˜í•  ì ì´ ìˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ëª¨ë©˜í…€ íŒ©í„°ê°€ "ëŒ€í˜•ì£¼ì—ì„œë§Œ ì˜ ì‘ë™í•˜ê³  ì†Œí˜•ì£¼ì—ì„œëŠ” ì•ˆ ëœë‹¤"ë©´, ì´ê²ƒì€ ì§„ì§œ ëª¨ë©˜í…€ ì•ŒíŒŒê°€ ì•„ë‹ˆë¼ ì‚¬ì´ì¦ˆ íŒ©í„°ì˜ ì˜í–¥ì¼ ìˆ˜ ìˆë‹¤. ì´ëŸ° í˜¼ë™ì„ ì œê±°í•˜ê¸° ìœ„í•´ íŒ©í„° ì¤‘ë¦½í™”ë¥¼ í•œë‹¤.</p>

<pre><code><span class="cm"># ê°„ë‹¨í•œ íŒ©í„° ì¤‘ë¦½í™” ì˜ˆì œ</span>
<span class="cm"># ì„¹í„° ì¤‘ë¦½í™”: ê° ì„¹í„° ë‚´ì—ì„œ íŒ©í„° ê°’ì„ í‘œì¤€í™”</span>

<span class="cm"># ì˜ˆì œ ë°ì´í„°</span>
factor_data = pd.DataFrame({
    <span class="st">"ticker"</span>: [<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span>, <span class="st">"E"</span>, <span class="st">"F"</span>],
    <span class="st">"sector"</span>: [<span class="st">"IT"</span>, <span class="st">"IT"</span>, <span class="st">"IT"</span>, <span class="st">"ê¸ˆìœµ"</span>, <span class="st">"ê¸ˆìœµ"</span>, <span class="st">"ê¸ˆìœµ"</span>],
    <span class="st">"momentum"</span>: [<span class="nu">0.15</span>, <span class="nu">0.10</span>, <span class="nu">0.20</span>, <span class="nu">0.05</span>, <span class="nu">0.03</span>, <span class="nu">0.08</span>]
})

<span class="cm"># ì„¹í„° ì¤‘ë¦½í™”: ê° ì„¹í„° ë‚´ì—ì„œ Z-score</span>
factor_data[<span class="st">"mom_neutral"</span>] = factor_data.groupby(<span class="st">"sector"</span>)[<span class="st">"momentum"</span>].transform(
    <span class="kw">lambda</span> x: (x - x.mean()) / x.std()
)

<span class="fn">print</span>(<span class="st">"=== ì„¹í„° ì¤‘ë¦½í™” ==="</span>)
<span class="fn">print</span>(factor_data)
<span class="cm"># IT ì„¹í„° ë‚´ì—ì„œ Cê°€ ê°€ì¥ ë†’ê³ , ê¸ˆìœµ ì„¹í„° ë‚´ì—ì„œ Fê°€ ê°€ì¥ ë†’ìŒ</span>
<span class="cm"># ì„¹í„° ê°„ ìˆ˜ì¤€ ì°¨ì´ê°€ ì œê±°ë¨</span></code></pre>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- Ch11: ì‹¤ì „ í”¼ì²˜ í…Œì´ë¸” êµ¬ì¶• -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<h2 id="ch11">11. ì‹¤ì „: í”¼ì²˜ í…Œì´ë¸” êµ¬ì¶• â€” ëª¨ë“  ê²ƒì„ í•˜ë‚˜ë¡œ</h2>

<h3>11.1 ì „ì²´ íŒŒì´í”„ë¼ì¸ í†µí•©</h3>
<p>ì§€ê¸ˆê¹Œì§€ ë°°ìš´ ëª¨ë“  ê²ƒì„ í•˜ë‚˜ì˜ íŒŒì´í”„ë¼ì¸ìœ¼ë¡œ í†µí•©í•œë‹¤. ì›ì‹œ ë°ì´í„°ì—ì„œ ì¶œë°œí•˜ì—¬, ì •ì œí•˜ê³ , í”¼ì²˜ë¥¼ ìƒì„±í•˜ê³ , ìµœì¢… í”¼ì²˜ í…Œì´ë¸”ì„ ë§Œë“œëŠ” ì „ì²´ ê³¼ì •ì´ë‹¤. ì´ ì½”ë“œëŠ” Round 4ì—ì„œ ML ëª¨ë¸ì˜ ì…ë ¥ìœ¼ë¡œ ì§ì ‘ ì‚¬ìš©ëœë‹¤.</p>

<pre><code><span class="kw">import</span> yfinance <span class="kw">as</span> yf
<span class="kw">import</span> pandas <span class="kw">as</span> pd
<span class="kw">import</span> numpy <span class="kw">as</span> np
<span class="kw">import</span> matplotlib.pyplot <span class="kw">as</span> plt

<span class="cm"># â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
<span class="cm"># STEP 1: ë°ì´í„° ìˆ˜ì§‘</span>
<span class="cm"># â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
ticker = <span class="st">"005930.KS"</span>  <span class="cm"># ì‚¼ì„±ì „ì</span>
raw = yf.download(ticker, period=<span class="st">"2y"</span>)

<span class="cm"># ì»¬ëŸ¼ ì •ë¦¬ (MultiIndex ì œê±°)</span>
raw.columns = [c[<span class="nu">0</span>] <span class="kw">if</span> <span class="fn">isinstance</span>(c, <span class="nb">tuple</span>) <span class="kw">else</span> c <span class="kw">for</span> c <span class="kw">in</span> raw.columns]

<span class="fn">print</span>(<span class="st">f"ì›ì‹œ ë°ì´í„°: </span>{raw.shape}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"ê¸°ê°„: </span>{raw.index[0].date()}<span class="st"> ~ </span>{raw.index[-1].date()}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"ê²°ì¸¡ì¹˜:\n</span>{raw.isnull().sum()}<span class="st">"</span>)</code></pre>

<pre><code><span class="cm"># â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
<span class="cm"># STEP 2: ë°ì´í„° ì •ì œ</span>
<span class="cm"># â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>

<span class="cm"># ê²°ì¸¡ì¹˜ ì²˜ë¦¬</span>
raw = raw.ffill(limit=<span class="nu">5</span>)  <span class="cm"># ìµœëŒ€ 5ì¼ê¹Œì§€ ì „ë°© ì±„ì›€</span>
raw = raw.dropna()         <span class="cm"># ë‚˜ë¨¸ì§€ ê²°ì¸¡ í–‰ ì œê±°</span>

<span class="cm"># ê¸°ë³¸ ë³€ìˆ˜ ì¶”ì¶œ</span>
close = raw[<span class="st">"Close"</span>]
high = raw[<span class="st">"High"</span>]
low = raw[<span class="st">"Low"</span>]
volume = raw[<span class="st">"Volume"</span>]
open_price = raw[<span class="st">"Open"</span>]

<span class="cm"># ìˆ˜ìµë¥  ê³„ì‚°</span>
ret = close.pct_change()
log_ret = np.log(close / close.shift(<span class="nu">1</span>))

<span class="fn">print</span>(<span class="st">f"ì •ì œ í›„: </span>{raw.shape}<span class="st">"</span>)</code></pre>

<pre><code><span class="cm"># â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
<span class="cm"># STEP 3: í”¼ì²˜ ìƒì„± (20ê°œ ì´ìƒ)</span>
<span class="cm"># â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>

feat = pd.DataFrame(index=raw.index)

<span class="cm"># --- ìˆ˜ìµë¥  í”¼ì²˜ ---</span>
feat[<span class="st">"ret_1d"</span>] = ret                          <span class="cm"># 1ì¼ ìˆ˜ìµë¥ </span>
feat[<span class="st">"ret_5d"</span>] = close.pct_change(<span class="nu">5</span>)           <span class="cm"># 5ì¼ ìˆ˜ìµë¥ </span>
feat[<span class="st">"ret_20d"</span>] = close.pct_change(<span class="nu">20</span>)         <span class="cm"># 20ì¼ ìˆ˜ìµë¥ </span>

<span class="cm"># --- ì´ë™í‰ê·  í”¼ì²˜ ---</span>
sma_5 = close.rolling(<span class="nu">5</span>).mean()
sma_20 = close.rolling(<span class="nu">20</span>).mean()
sma_60 = close.rolling(<span class="nu">60</span>).mean()
feat[<span class="st">"price_sma5"</span>] = close / sma_5             <span class="cm"># ê°€ê²©/SMA5</span>
feat[<span class="st">"price_sma20"</span>] = close / sma_20           <span class="cm"># ê°€ê²©/SMA20</span>
feat[<span class="st">"price_sma60"</span>] = close / sma_60           <span class="cm"># ê°€ê²©/SMA60</span>
feat[<span class="st">"sma_cross"</span>] = (sma_5 > sma_20).astype(<span class="nb">int</span>)  <span class="cm"># ë‹¨ê¸°>ì¥ê¸°</span>

<span class="cm"># --- RSI ---</span>
delta = close.diff()
gain = delta.where(delta > <span class="nu">0</span>, <span class="nu">0</span>)
loss = -delta.where(delta < <span class="nu">0</span>, <span class="nu">0</span>)
avg_gain = gain.ewm(alpha=<span class="nu">1</span>/<span class="nu">14</span>, min_periods=<span class="nu">14</span>).mean()
avg_loss = loss.ewm(alpha=<span class="nu">1</span>/<span class="nu">14</span>, min_periods=<span class="nu">14</span>).mean()
rs = avg_gain / avg_loss
feat[<span class="st">"rsi_14"</span>] = <span class="nu">100</span> - (<span class="nu">100</span> / (<span class="nu">1</span> + rs))          <span class="cm"># RSI</span>

<span class="cm"># --- MACD ---</span>
ema12 = close.ewm(span=<span class="nu">12</span>).mean()
ema26 = close.ewm(span=<span class="nu">26</span>).mean()
macd = ema12 - ema26
signal = macd.ewm(span=<span class="nu">9</span>).mean()
feat[<span class="st">"macd_hist"</span>] = macd - signal               <span class="cm"># MACD íˆìŠ¤í† ê·¸ë¨</span>
feat[<span class="st">"macd_cross"</span>] = (macd > signal).astype(<span class="nb">int</span>)  <span class="cm"># MACD í¬ë¡œìŠ¤</span>

<span class="cm"># --- ë³¼ë¦°ì € ë°´ë“œ ---</span>
bb_sma = close.rolling(<span class="nu">20</span>).mean()
bb_std = close.rolling(<span class="nu">20</span>).std()
bb_upper = bb_sma + <span class="nu">2</span> * bb_std
bb_lower = bb_sma - <span class="nu">2</span> * bb_std
feat[<span class="st">"bb_pct_b"</span>] = (close - bb_lower) / (bb_upper - bb_lower)  <span class="cm"># %B</span>
feat[<span class="st">"bb_width"</span>] = (bb_upper - bb_lower) / bb_sma              <span class="cm"># ë°´ë“œí­</span>

<span class="cm"># --- ë³€ë™ì„± ---</span>
feat[<span class="st">"vol_20d"</span>] = ret.rolling(<span class="nu">20</span>).std() * np.sqrt(<span class="nu">252</span>)  <span class="cm"># 20ì¼ ë³€ë™ì„±</span>
feat[<span class="st">"vol_ratio"</span>] = (ret.rolling(<span class="nu">5</span>).std()) / (ret.rolling(<span class="nu">60</span>).std())  <span class="cm"># ë³€ë™ì„± ë¹„ìœ¨</span>

<span class="cm"># --- ATR ---</span>
tr1 = high - low
tr2 = (high - close.shift(<span class="nu">1</span>)).abs()
tr3 = (low - close.shift(<span class="nu">1</span>)).abs()
true_range = pd.concat([tr1, tr2, tr3], axis=<span class="nu">1</span>).max(axis=<span class="nu">1</span>)
feat[<span class="st">"atr_pct"</span>] = true_range.rolling(<span class="nu">14</span>).mean() / close  <span class="cm"># ATR/ê°€ê²©</span>

<span class="cm"># --- ê±°ë˜ëŸ‰ ---</span>
feat[<span class="st">"vol_ma_ratio"</span>] = volume / volume.rolling(<span class="nu">20</span>).mean()  <span class="cm"># ê±°ë˜ëŸ‰/MA20</span>

<span class="cm"># --- ëª¨ë©˜í…€ ---</span>
feat[<span class="st">"mom_60d"</span>] = close.pct_change(<span class="nu">60</span>)          <span class="cm"># 60ì¼ ëª¨ë©˜í…€</span>
high_52w = close.rolling(<span class="nu">252</span>).max()
feat[<span class="st">"dist_52w_high"</span>] = close / high_52w - <span class="nu">1</span>    <span class="cm"># 52ì£¼ ê³ ê°€ ëŒ€ë¹„</span>

<span class="cm"># --- ìº”ë“¤ìŠ¤í‹± íŒ¨í„´ ---</span>
feat[<span class="st">"body_ratio"</span>] = (close - open_price) / (high - low + <span class="nu">1e-8</span>)  <span class="cm"># ëª¸í†µ/ì „ì²´</span>
feat[<span class="st">"upper_shadow"</span>] = (high - pd.concat([close, open_price], axis=<span class="nu">1</span>).max(axis=<span class="nu">1</span>)) / (high - low + <span class="nu">1e-8</span>)

<span class="fn">print</span>(<span class="st">f"\n=== í”¼ì²˜ í…Œì´ë¸” ==="</span>)
<span class="fn">print</span>(<span class="st">f"Shape: </span>{feat.shape}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"í”¼ì²˜ ìˆ˜: </span>{feat.shape[1]}<span class="st">ê°œ"</span>)
<span class="fn">print</span>(<span class="st">f"\nì»¬ëŸ¼ ëª©ë¡:"</span>)
<span class="kw">for</span> i, col <span class="kw">in</span> <span class="fn">enumerate</span>(feat.columns, <span class="nu">1</span>):
    <span class="fn">print</span>(<span class="st">f"  {i:2d}. </span>{col}<span class="st">"</span>)</code></pre>

<pre><code><span class="cm"># â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
<span class="cm"># STEP 4: íƒ€ê²Ÿ ë³€ìˆ˜ ìƒì„±</span>
<span class="cm"># â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>

<span class="cm"># ë¯¸ë˜ 5ì¼ ìˆ˜ìµë¥  (ì˜ˆì¸¡ ëŒ€ìƒ)</span>
feat[<span class="st">"target_5d"</span>] = close.pct_change(<span class="nu">5</span>).shift(-<span class="nu">5</span>)

<span class="cm"># ë¯¸ë˜ 5ì¼ ë°©í–¥ (ë¶„ë¥˜ ë¬¸ì œìš©)</span>
feat[<span class="st">"target_dir"</span>] = (feat[<span class="st">"target_5d"</span>] > <span class="nu">0</span>).astype(<span class="nb">int</span>)

<span class="fn">print</span>(<span class="st">f"\n=== íƒ€ê²Ÿ ë¶„í¬ ==="</span>)
<span class="fn">print</span>(feat[<span class="st">"target_dir"</span>].value_counts())
<span class="fn">print</span>(<span class="st">f"ìƒìŠ¹ ë¹„ìœ¨: </span>{feat[<span class="st">'target_dir'</span>].mean():.2%}<span class="st">"</span>)</code></pre>

<pre><code><span class="cm"># â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>
<span class="cm"># STEP 5: ìµœì¢… ì •ë¦¬ + ì €ì¥</span>
<span class="cm"># â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span>

<span class="cm"># ê²°ì¸¡ì¹˜ ì œê±° (ì´ë™í‰ê·  ë“±ì˜ ì´ˆê¸° NaN)</span>
feat_clean = feat.dropna()
<span class="fn">print</span>(<span class="st">f"\nìµœì¢… í”¼ì²˜ í…Œì´ë¸”: </span>{feat_clean.shape}<span class="st">"</span>)
<span class="fn">print</span>(feat_clean.head().round(<span class="nu">4</span>))

<span class="cm"># CSVë¡œ ì €ì¥</span>
feat_clean.to_csv(<span class="st">"samsung_features.csv"</span>)
<span class="fn">print</span>(<span class="st">"\nâœ… samsung_features.csv ì €ì¥ ì™„ë£Œ!"</span>)

<span class="cm"># ê¸°ìˆ í†µê³„ í™•ì¸</span>
<span class="fn">print</span>(<span class="st">"\n=== í”¼ì²˜ ê¸°ìˆ í†µê³„ ==="</span>)
<span class="fn">print</span>(feat_clean.describe().round(<span class="nu">4</span>).T)</code></pre>

<h3>11.2 í”¼ì²˜ í…Œì´ë¸” ì‹œê°í™”</h3>
<pre><code><span class="cm"># í”¼ì²˜ ë¶„í¬ ì‹œê°í™”</span>
fig, axes = plt.subplots(<span class="nu">4</span>, <span class="nu">4</span>, figsize=(<span class="nu">16</span>, <span class="nu">12</span>))
axes = axes.flatten()

plot_cols = [c <span class="kw">for</span> c <span class="kw">in</span> feat_clean.columns <span class="kw">if</span> <span class="kw">not</span> c.startswith(<span class="st">"target"</span>)][:<span class="nu">16</span>]

<span class="kw">for</span> i, col <span class="kw">in</span> <span class="fn">enumerate</span>(plot_cols):
    axes[i].hist(feat_clean[col].dropna(), bins=<span class="nu">40</span>, color=<span class="st">"steelblue"</span>,
                 alpha=<span class="nu">0.7</span>, edgecolor=<span class="st">"white"</span>)
    axes[i].set_title(col, fontsize=<span class="nu">9</span>)
    axes[i].tick_params(labelsize=<span class="nu">7</span>)

plt.suptitle(<span class="st">"í”¼ì²˜ ë¶„í¬ (Feature Distributions)"</span>, fontsize=<span class="nu">14</span>, y=<span class="nu">1.01</span>)
plt.tight_layout()
plt.show()</code></pre>

<h3>11.3 í”¼ì²˜-íƒ€ê²Ÿ ìƒê´€ê´€ê³„</h3>
<pre><code><span class="cm"># ê° í”¼ì²˜ì™€ íƒ€ê²Ÿ(ë¯¸ë˜ 5ì¼ ìˆ˜ìµë¥ )ì˜ ìƒê´€ê³„ìˆ˜</span>
target_corr = feat_clean.drop(columns=[<span class="st">"target_5d"</span>, <span class="st">"target_dir"</span>]).corrwith(
    feat_clean[<span class="st">"target_5d"</span>]
).sort_values()

<span class="cm"># ì‹œê°í™”</span>
fig, ax = plt.subplots(figsize=(<span class="nu">10</span>, <span class="nu">8</span>))
colors = [<span class="st">"green"</span> <span class="kw">if</span> v > <span class="nu">0</span> <span class="kw">else</span> <span class="st">"red"</span> <span class="kw">for</span> v <span class="kw">in</span> target_corr.values]
ax.barh(target_corr.index, target_corr.values, color=colors, alpha=<span class="nu">0.7</span>)
ax.axvline(x=<span class="nu">0</span>, color=<span class="st">"black"</span>, linewidth=<span class="nu">0.5</span>)
ax.set_title(<span class="st">"í”¼ì²˜-íƒ€ê²Ÿ(5ì¼ ìˆ˜ìµë¥ ) ìƒê´€ê³„ìˆ˜"</span>, fontsize=<span class="nu">14</span>)
ax.set_xlabel(<span class="st">"Correlation"</span>)
ax.grid(<span class="kw">True</span>, alpha=<span class="nu">0.3</span>, axis=<span class="st">"x"</span>)
plt.tight_layout()
plt.show()

<span class="fn">print</span>(<span class="st">"=== ìƒê´€ê³„ìˆ˜ Top 5 (ì–‘ìˆ˜) ==="</span>)
<span class="fn">print</span>(target_corr.tail(<span class="nu">5</span>).round(<span class="nu">4</span>))
<span class="fn">print</span>(<span class="st">"\n=== ìƒê´€ê³„ìˆ˜ Top 5 (ìŒìˆ˜) ==="</span>)
<span class="fn">print</span>(target_corr.head(<span class="nu">5</span>).round(<span class="nu">4</span>))</code></pre>

<div class="ok">
<p class="ni"><strong>Round 3 â†’ Round 4 ì—°ê²°:</strong> ì´ í”¼ì²˜ í…Œì´ë¸”ì´ ë°”ë¡œ Round 4ì—ì„œ ì§€ë„í•™ìŠµ ëª¨ë¸(ì„ í˜•íšŒê·€, XGBoost ë“±)ì˜ ì…ë ¥ì´ ëœë‹¤. <code>target_5d</code>ëŠ” íšŒê·€ ë¬¸ì œì˜ íƒ€ê²Ÿ, <code>target_dir</code>ì€ ë¶„ë¥˜ ë¬¸ì œì˜ íƒ€ê²Ÿì´ë‹¤. í”¼ì²˜ ì—”ì§€ë‹ˆì–´ë§ì˜ í’ˆì§ˆì´ ëª¨ë¸ ì„±ëŠ¥ì˜ 80%ë¥¼ ê²°ì •í•œë‹¤ëŠ” ê²ƒì„ ê¸°ì–µí•˜ì.</p>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- Ch12: í”¼ë“œë°± ì„¸ì…˜ + Quiz -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<h2 id="ch12">12. ğŸ”„ í”¼ë“œë°± ì„¸ì…˜ + Mini Project + Quiz</h2>

<h3>12.1 Round 1~3 í•µì‹¬ ë³µìŠµ</h3>
<p>Round 3ëŠ” ì²« ë²ˆì§¸ í”¼ë“œë°± í¬ì¸íŠ¸ë‹¤. ì§€ë‚œ 3ë¼ìš´ë“œì—ì„œ ë°°ìš´ í•µì‹¬ì„ ì •ë¦¬í•˜ì.</p>

<div class="tc">Table 8. Round 1~3 í•µì‹¬ ìš”ì•½</div>
<table>
<tr><th>ë¼ìš´ë“œ</th><th>ì£¼ì œ</th><th>í•µì‹¬ ìŠ¤í‚¬</th><th>ê¸ˆìœµ ì ìš©</th></tr>
<tr><td>R1</td><td>Python ê¸°ì´ˆ</td><td>ë³€ìˆ˜, ì¡°ê±´ë¬¸, ë°˜ë³µë¬¸, í•¨ìˆ˜, NumPy, Pandas, Matplotlib</td><td>yfinanceë¡œ ì£¼ê°€ ìˆ˜ì§‘, ìˆ˜ìµë¥ Â·ìƒ¤í”„ë¹„ìœ¨ ê³„ì‚°</td></tr>
<tr><td>R2</td><td>ì„ í˜•ëŒ€ìˆ˜ + í†µê³„</td><td>ë²¡í„°, í–‰ë ¬, ë‚´ì , ê³ ìœ ê°’, ì •ê·œë¶„í¬, ê³µë¶„ì‚°, ë² ì´ì¦ˆ, ê·¸ë˜ë””ì–¸íŠ¸</td><td>í¬íŠ¸í´ë¦¬ì˜¤ ìˆ˜ìµë¥ (ë‚´ì ), ê³µë¶„ì‚° í–‰ë ¬, íˆíŠ¸ë§µ</td></tr>
<tr><td>R3</td><td>ë°ì´í„° + í”¼ì²˜ ì—”ì§€ë‹ˆì–´ë§</td><td>yfinance, FRED, ê²°ì¸¡ì¹˜, ì´ìƒì¹˜, ìŠ¤ì¼€ì¼ë§, RSI, MACD, ë³¼ë¦°ì €, IC</td><td>20ê°œ í”¼ì²˜ í…Œì´ë¸” êµ¬ì¶•, ì•ŒíŒŒíŒ©í„° í‰ê°€</td></tr>
</table>

<p>ì´ ì„¸ ë¼ìš´ë“œê°€ "ê¸°ì´ˆ ì²´ë ¥"ì´ë‹¤. Round 4ë¶€í„°ëŠ” ì´ ê¸°ì´ˆ ìœ„ì— ML ëª¨ë¸ì„ ìŒ“ì•„ì˜¬ë¦°ë‹¤.</p>

<h3>12.2 ì´í•´ë„ ìê°€ ì²´í¬ë¦¬ìŠ¤íŠ¸</h3>
<p class="ni">ì•„ë˜ í•­ëª©ì„ ìŠ¤ìŠ¤ë¡œ ì²´í¬í•´ë³´ì. ìì‹  ìˆê²Œ "ì˜ˆ"ë¼ê³  ë‹µí•  ìˆ˜ ìˆì–´ì•¼ í•œë‹¤:</p>

<div class="info">
<p class="ni"><strong>Round 1 ì²´í¬:</strong></p>
<ul>
<li>â˜ Python í•¨ìˆ˜ë¥¼ ì •ì˜í•˜ê³  í˜¸ì¶œí•  ìˆ˜ ìˆë‹¤</li>
<li>â˜ ë¦¬ìŠ¤íŠ¸ì™€ ë”•ì…”ë„ˆë¦¬ì˜ ì°¨ì´ë¥¼ ì•ˆë‹¤</li>
<li>â˜ NumPy ë°°ì—´ ì—°ì‚°ì„ í•  ìˆ˜ ìˆë‹¤</li>
<li>â˜ Pandas DataFrameì„ ìƒì„±í•˜ê³  ì¡°ì‘í•  ìˆ˜ ìˆë‹¤</li>
<li>â˜ Matplotlibìœ¼ë¡œ ì°¨íŠ¸ë¥¼ ê·¸ë¦´ ìˆ˜ ìˆë‹¤</li>
<li>â˜ ìƒ¤í”„ë¹„ìœ¨ì˜ ì˜ë¯¸ì™€ ê³„ì‚°ë²•ì„ ì•ˆë‹¤</li>
</ul>
</div>

<div class="info">
<p class="ni"><strong>Round 2 ì²´í¬:</strong></p>
<ul>
<li>â˜ ë²¡í„°ì˜ ë‚´ì ì´ í¬íŠ¸í´ë¦¬ì˜¤ ìˆ˜ìµë¥ ì„ì„ ì•ˆë‹¤</li>
<li>â˜ í–‰ë ¬ê³±ì˜ ì¡°ê±´(ì• ì—´ = ë’¤ í–‰)ì„ ì•ˆë‹¤</li>
<li>â˜ ê³ ìœ ê°’/ê³ ìœ ë²¡í„°ê°€ PCAì™€ ì—°ê²°ë¨ì„ ì•ˆë‹¤</li>
<li>â˜ ì •ê·œë¶„í¬ì™€ ë¡œê·¸ì •ê·œë¶„í¬ì˜ ì°¨ì´ë¥¼ ì•ˆë‹¤</li>
<li>â˜ ê³µë¶„ì‚° í–‰ë ¬ì„ ê³„ì‚°í•˜ê³  í•´ì„í•  ìˆ˜ ìˆë‹¤</li>
<li>â˜ ê·¸ë˜ë””ì–¸íŠ¸ê°€ "ê°€ì¥ ê°€íŒŒë¥¸ ìƒìŠ¹ ë°©í–¥"ì„ì„ ì•ˆë‹¤</li>
</ul>
</div>

<div class="info">
<p class="ni"><strong>Round 3 ì²´í¬:</strong></p>
<ul>
<li>â˜ yfinanceë¡œ ì—¬ëŸ¬ ì¢…ëª© ë°ì´í„°ë¥¼ ë™ì‹œì— ë‹¤ìš´ë¡œë“œí•  ìˆ˜ ìˆë‹¤</li>
<li>â˜ yfinance 1.0+ì—ì„œ Closeê°€ ìˆ˜ì •ì¢…ê°€ì„ì„ ì•ˆë‹¤</li>
<li>â˜ ê²°ì¸¡ì¹˜ ì²˜ë¦¬ ë°©ë²• 3ê°€ì§€ ì´ìƒì„ ì•Œê³ , ìƒí™©ë³„ë¡œ ì„ íƒí•  ìˆ˜ ìˆë‹¤</li>
<li>â˜ Winsorizationì´ ë¬´ì—‡ì¸ì§€ ì•ˆë‹¤</li>
<li>â˜ Min-Max ì •ê·œí™”ì™€ Z-Score í‘œì¤€í™”ì˜ ì°¨ì´ë¥¼ ì•ˆë‹¤</li>
<li>â˜ RSIë¥¼ ì§ì ‘ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤</li>
<li>â˜ MACDì˜ ì„¸ êµ¬ì„±ìš”ì†Œë¥¼ ì•ˆë‹¤</li>
<li>â˜ IC(Information Coefficient)ì˜ ì˜ë¯¸ë¥¼ ì•ˆë‹¤</li>
<li>â˜ Train/Test ë¶„ë¦¬ ì‹œ ìŠ¤ì¼€ì¼ë§ ìˆœì„œë¥¼ ì•ˆë‹¤</li>
</ul>
</div>

<h3>12.3 Mini Project: ë‹¤ì¢…ëª© í”¼ì²˜ í…Œì´ë¸”</h3>

<div class="def">
<p class="ni"><strong>ë¯¸ë‹ˆ í”„ë¡œì íŠ¸: KOSPI ëŒ€í‘œ 10ì¢…ëª© í”¼ì²˜ í…Œì´ë¸” êµ¬ì¶•</strong></p>
<p class="ni">ì•„ë˜ 10ì¢…ëª©ì— ëŒ€í•´ 20ê°œ ì´ìƒì˜ í”¼ì²˜ë¥¼ ê°€ì§„ í”¼ì²˜ í…Œì´ë¸”ì„ êµ¬ì¶•í•˜ë¼.</p>
<ul>
<li>ì¢…ëª©: ì‚¼ì„±ì „ì, SKí•˜ì´ë‹‰ìŠ¤, NAVER, ì¹´ì¹´ì˜¤, LGì—ë„ˆì§€ì†”ë£¨ì…˜, í˜„ëŒ€ì°¨, ì‚¼ì„±ë°”ì´ì˜¤, ì…€íŠ¸ë¦¬ì˜¨, KBê¸ˆìœµ, POSCOí™€ë”©ìŠ¤</li>
<li>ê¸°ê°„: ìµœê·¼ 2ë…„</li>
<li>í”¼ì²˜: Ch.8~10ì—ì„œ ë°°ìš´ ê¸°ìˆ ì  ì§€í‘œ + ë³€ë™ì„± + ëª¨ë©˜í…€ + ê±°ë˜ëŸ‰ í”¼ì²˜</li>
<li>íƒ€ê²Ÿ: ë¯¸ë˜ 5ì¼ ìˆ˜ìµë¥ , ë¯¸ë˜ 5ì¼ ë°©í–¥(ìƒìŠ¹/í•˜ë½)</li>
</ul>
<p class="ni"><strong>íŒíŠ¸:</strong> Ch.11ì˜ ì½”ë“œë¥¼ í•¨ìˆ˜ë¡œ ë§Œë“¤ì–´ì„œ ê° ì¢…ëª©ì— ë°˜ë³µ ì ìš©í•˜ë©´ ëœë‹¤.</p>
</div>

<pre><code><span class="cm"># ë¯¸ë‹ˆ í”„ë¡œì íŠ¸ ìŠ¤ì¼ˆë ˆí†¤ ì½”ë“œ</span>

<span class="kw">def</span> <span class="fn">build_features</span>(ticker, period=<span class="st">"2y"</span>):
    <span class="st">"""í•œ ì¢…ëª©ì˜ í”¼ì²˜ í…Œì´ë¸”ì„ ìƒì„±í•˜ëŠ” í•¨ìˆ˜"""</span>
    raw = yf.download(ticker, period=period)
    raw.columns = [c[<span class="nu">0</span>] <span class="kw">if</span> <span class="fn">isinstance</span>(c, <span class="nb">tuple</span>) <span class="kw">else</span> c <span class="kw">for</span> c <span class="kw">in</span> raw.columns]
    raw = raw.ffill(limit=<span class="nu">5</span>).dropna()
    
    close = raw[<span class="st">"Close"</span>]
    high = raw[<span class="st">"High"</span>]
    low = raw[<span class="st">"Low"</span>]
    volume = raw[<span class="st">"Volume"</span>]
    open_p = raw[<span class="st">"Open"</span>]
    ret = close.pct_change()
    
    feat = pd.DataFrame(index=raw.index)
    feat[<span class="st">"ticker"</span>] = ticker
    
    <span class="cm"># ì—¬ê¸°ì— Ch.11ì˜ í”¼ì²˜ ìƒì„± ì½”ë“œë¥¼ ë„£ëŠ”ë‹¤</span>
    <span class="cm"># feat["ret_1d"] = ret</span>
    <span class="cm"># feat["rsi_14"] = calculate_rsi(close)</span>
    <span class="cm"># ... (20ê°œ ì´ìƒ)</span>
    
    <span class="cm"># íƒ€ê²Ÿ</span>
    feat[<span class="st">"target_5d"</span>] = close.pct_change(<span class="nu">5</span>).shift(-<span class="nu">5</span>)
    feat[<span class="st">"target_dir"</span>] = (feat[<span class="st">"target_5d"</span>] > <span class="nu">0</span>).astype(<span class="nb">int</span>)
    
    <span class="kw">return</span> feat.dropna()

<span class="cm"># 10ì¢…ëª© í”¼ì²˜ í…Œì´ë¸” ìƒì„±</span>
kospi_tickers = {
    <span class="st">"005930.KS"</span>: <span class="st">"ì‚¼ì„±ì „ì"</span>,
    <span class="st">"000660.KS"</span>: <span class="st">"SKí•˜ì´ë‹‰ìŠ¤"</span>,
    <span class="st">"035420.KS"</span>: <span class="st">"NAVER"</span>,
    <span class="st">"035720.KS"</span>: <span class="st">"ì¹´ì¹´ì˜¤"</span>,
    <span class="st">"373220.KS"</span>: <span class="st">"LGì—ë„ˆì§€ì†”ë£¨ì…˜"</span>,
    <span class="st">"005380.KS"</span>: <span class="st">"í˜„ëŒ€ì°¨"</span>,
    <span class="st">"207940.KS"</span>: <span class="st">"ì‚¼ì„±ë°”ì´ì˜¤"</span>,
    <span class="st">"068270.KS"</span>: <span class="st">"ì…€íŠ¸ë¦¬ì˜¨"</span>,
    <span class="st">"105560.KS"</span>: <span class="st">"KBê¸ˆìœµ"</span>,
    <span class="st">"005490.KS"</span>: <span class="st">"POSCOí™€ë”©ìŠ¤"</span>
}

all_features = []
<span class="kw">for</span> ticker, name <span class="kw">in</span> kospi_tickers.items():
    <span class="fn">print</span>(<span class="st">f"Processing </span>{name}<span class="st">..."</span>)
    feat = build_features(ticker)
    all_features.append(feat)

<span class="cm"># ì „ì²´ í•©ì¹˜ê¸°</span>
full_table = pd.concat(all_features)
<span class="fn">print</span>(<span class="st">f"\n=== ì „ì²´ í”¼ì²˜ í…Œì´ë¸” ==="</span>)
<span class="fn">print</span>(<span class="st">f"Shape: </span>{full_table.shape}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"ì¢…ëª© ìˆ˜: </span>{full_table[<span class="st">'ticker'</span>].nunique()}<span class="st">"</span>)

<span class="cm"># ì €ì¥</span>
full_table.to_csv(<span class="st">"kospi10_features.csv"</span>)
<span class="fn">print</span>(<span class="st">"âœ… kospi10_features.csv ì €ì¥ ì™„ë£Œ!"</span>)</code></pre>

<h3>12.4 Quiz â€” Round 1~3 í†µí•©</h3>

<div class="warn">
<p class="ni"><strong>Quiz 1.</strong> yfinance 1.0 ì´ì „ì—ëŠ” <code>Adj Close</code>ì™€ <code>Close</code>ê°€ ë³„ë„ë¡œ ì¡´ì¬í–ˆë‹¤. í˜„ì¬ ë²„ì „ì—ì„œëŠ” ì–´ë–»ê²Œ ë°”ë€Œì—ˆìœ¼ë©°, ìˆ˜ìµë¥  ê³„ì‚° ì‹œ ì–´ë–¤ ì»¬ëŸ¼ì„ ì‚¬ìš©í•´ì•¼ í•˜ëŠ”ê°€?</p>
</div>

<div class="warn">
<p class="ni"><strong>Quiz 2.</strong> ê²°ì¸¡ì¹˜ ì²˜ë¦¬ì—ì„œ <code>ffill()</code>ì´ ê¸ˆìœµ ì‹œê³„ì—´ì— ì í•©í•œ ì´ìœ ë¥¼ ì„¤ëª…í•˜ë¼. <code>fillna(mean())</code>ì´ ë¶€ì í•©í•œ ì´ìœ ëŠ”?</p>
</div>

<div class="warn">
<p class="ni"><strong>Quiz 3.</strong> Winsorizationê³¼ ì´ìƒì¹˜ ì‚­ì œì˜ ì°¨ì´ëŠ” ë¬´ì—‡ì¸ê°€? ê¸ˆìœµ ë°ì´í„°ì—ì„œ Winsorizationì´ ì„ í˜¸ë˜ëŠ” ì´ìœ ë¥¼ 2ê°€ì§€ ì´ìƒ ì„¤ëª…í•˜ë¼.</p>
</div>

<div class="warn">
<p class="ni"><strong>Quiz 4.</strong> ìŠ¤ì¼€ì¼ë§(ì •ê·œí™”/í‘œì¤€í™”)ì„ í•  ë•Œ, ì™œ train ë°ì´í„°ì—ì„œë§Œ <code>fit</code>í•˜ê³  test ë°ì´í„°ì—ëŠ” <code>transform</code>ë§Œ í•´ì•¼ í•˜ëŠ”ê°€?</p>
</div>

<div class="warn">
<p class="ni"><strong>Quiz 5.</strong> RSIê°€ 75ì¼ ë•Œì™€ 25ì¼ ë•Œ, ê°ê° ì–´ë–¤ ì‹œì¥ ìƒíƒœë¥¼ ì˜ë¯¸í•˜ëŠ”ê°€? RSIë§Œìœ¼ë¡œ ë§¤ë§¤ ê²°ì •ì„ ë‚´ë¦¬ë©´ ì•ˆ ë˜ëŠ” ì´ìœ ëŠ”?</p>
</div>

<div class="warn">
<p class="ni"><strong>Quiz 6.</strong> MACD íˆìŠ¤í† ê·¸ë¨ì´ ì–‘ìˆ˜ì—ì„œ ìŒìˆ˜ë¡œ ì „í™˜ë˜ë©´ ì–´ë–¤ ì˜ë¯¸ì¸ê°€? MACDì˜ ì„¸ êµ¬ì„±ìš”ì†Œ(MACD Line, Signal Line, Histogram)ë¥¼ ê°ê° ì„¤ëª…í•˜ë¼.</p>
</div>

<div class="warn">
<p class="ni"><strong>Quiz 7.</strong> IC(Information Coefficient)ê°€ 0.08ì´ê³  IR(Information Ratio)ì´ 0.4ì¸ íŒ©í„°ê°€ ìˆë‹¤. ì´ íŒ©í„°ì˜ ì˜ˆì¸¡ë ¥ê³¼ ì•ˆì •ì„±ì„ í‰ê°€í•˜ë¼.</p>
</div>

<div class="warn">
<p class="ni"><strong>Quiz 8.</strong> í¬íŠ¸í´ë¦¬ì˜¤ ìˆ˜ìµë¥ ì´ ë²¡í„°ì˜ ë‚´ì (dot product)ì¸ ì´ìœ ë¥¼ ìˆ˜ì‹ê³¼ í•¨ê»˜ ì„¤ëª…í•˜ë¼. (Round 2 ë³µìŠµ)</p>
</div>

<div class="warn">
<p class="ni"><strong>Quiz 9.</strong> Look-Ahead Biasë€ ë¬´ì—‡ì¸ê°€? í”¼ì²˜ ì—”ì§€ë‹ˆì–´ë§ì—ì„œ ì´ë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•œ êµ¬ì²´ì ì¸ ë°©ë²• 2ê°€ì§€ë¥¼ ì œì‹œí•˜ë¼.</p>
</div>

<div class="warn">
<p class="ni"><strong>Quiz 10.</strong> ì•„ë˜ ì½”ë“œì˜ ë¬¸ì œì ì„ ì°¾ê³  ìˆ˜ì •í•˜ë¼:</p>
<pre><code><span class="kw">from</span> sklearn.preprocessing <span class="kw">import</span> StandardScaler
scaler = StandardScaler()
X_scaled = scaler.fit_transform(X_all)  <span class="cm"># ì „ì²´ ë°ì´í„°</span>
X_train = X_scaled[:<span class="nu">800</span>]
X_test = X_scaled[<span class="nu">800</span>:]</code></pre>
</div>

<h3>12.5 ë‹¤ìŒ ë¼ìš´ë“œ ì˜ˆê³ </h3>

<div class="ok">
<p class="ni"><strong>Round 4 ì˜ˆê³ : ì§€ë„í•™ìŠµ â€” íšŒê·€ + ë¶„ë¥˜</strong></p>
<p class="ni">ì´ë²ˆ ë¼ìš´ë“œì—ì„œ ë§Œë“  í”¼ì²˜ í…Œì´ë¸”ì„ ì…ë ¥ìœ¼ë¡œ, ë“œë””ì–´ ML ëª¨ë¸ì„ í•™ìŠµì‹œí‚¨ë‹¤! ì„ í˜•íšŒê·€, Ridge/Lasso, ë¡œì§€ìŠ¤í‹± íšŒê·€, SVM, Random Forest, XGBoost, LightGBMê¹Œì§€ â€” ì£¼ê°€ ë°©í–¥ ì˜ˆì¸¡ ëª¨ë¸ì„ ì§ì ‘ ë§Œë“¤ì–´ë³¸ë‹¤. "í”¼ì²˜ê°€ ì¢‹ìœ¼ë©´ ëª¨ë¸ì€ ê°„ë‹¨í•´ë„ ëœë‹¤"ëŠ” ê²ƒì„ ì²´ê°í•˜ê²Œ ë  ê²ƒì´ë‹¤.</p>
<p class="ni"><strong>êµì¬:</strong> MLAT Ch.6~7 (ì„ í˜•ëª¨ë¸), Ch.11~12 (íŠ¸ë¦¬/ì•™ìƒë¸”) / MLDSF Ch.4~6 (ì§€ë„í•™ìŠµ ì¼€ì´ìŠ¤)</p>
</div>

</div><!-- paper-content -->
</div><!-- container -->
</div><!-- main-wrapper -->

</body>
</html>