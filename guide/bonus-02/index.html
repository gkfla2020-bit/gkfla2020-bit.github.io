<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bonus 2 - ë¯¸ì ë¶„ ì˜¬ì¸ì› (Calculus All-in-One)</title>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@300;400;500&family=Space+Mono:wght@400&family=Inter:wght@300;400&display=swap" rel="stylesheet">
<script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Inter',sans-serif;background:#fafaf8;color:#1a1a1a;line-height:1.7;overflow-x:hidden}
.sidebar{position:fixed;left:0;top:0;width:260px;height:100vh;background:rgba(255,255,255,.97);border-right:1px solid rgba(0,0,0,.06);padding:32px 24px;z-index:100;overflow-y:auto;display:flex;flex-direction:column}
.sidebar-profile{text-align:center;margin-bottom:28px;padding-bottom:24px;border-bottom:1px solid rgba(0,0,0,.08)}
.profile-icon{font-size:48px;margin-bottom:8px}
.profile-name{font-family:'Cormorant Garamond',serif;font-size:1.3rem;font-weight:500;margin-bottom:4px}
.profile-title{font-size:.68rem;color:#888;letter-spacing:.08em;text-transform:uppercase;margin-bottom:8px}
.profile-bio{font-size:.78rem;color:#666;line-height:1.5}
.sidebar-nav{flex:1;margin-top:16px}
.nav-section{margin-bottom:20px}
.nav-section-title{font-size:.6rem;font-weight:600;color:#aaa;letter-spacing:.15em;text-transform:uppercase;margin-bottom:10px}
.nav-list{list-style:none}
.nav-list li{margin-bottom:5px}
.nav-list a{font-size:.78rem;color:#555;text-decoration:none;transition:all .2s;display:block;padding:3px 0}
.nav-list a:hover{color:#0080c6;padding-left:4px}
.nav-list a.active{color:#0080c6;font-weight:500}
.nav-list a.done{color:#28a745}
.badge{display:inline-block;font-size:.5rem;background:#0080c6;color:#fff;padding:1px 5px;border-radius:8px;margin-left:3px;vertical-align:middle}
.badge-done{background:#28a745}
.badge-bonus{background:#9c27b0}
.sidebar-footer{padding-top:16px;border-top:1px solid rgba(0,0,0,.06);font-size:.65rem;color:#aaa;text-align:center}
.main-wrapper{margin-left:260px;min-height:100vh}
.container{max-width:1100px;margin:0 auto;padding:50px 40px 80px}
.paper-content{font-family:'Times New Roman','Nanum Myeongjo',serif;line-height:1.8;background:#fff;padding:40px;border-radius:8px;box-shadow:0 2px 20px rgba(0,0,0,.05)}
.paper-header{text-align:center;margin-bottom:40px;padding-bottom:30px;border-bottom:2px solid #333}
.paper-category{font-size:14px;color:#666;margin-bottom:10px}
.paper-title{font-size:24px;font-weight:bold;margin-bottom:12px;line-height:1.4}
.paper-subtitle{font-size:14px;color:#555;margin-bottom:8px}
.paper-team{font-size:13px;color:#444}
.abstract{background:#f8f9fa;padding:25px;margin:30px 0;border-left:4px solid #2c3e50}
.abstract-title{font-weight:bold;font-size:16px;margin-bottom:15px}
h2{font-size:18px;margin:35px 0 20px;padding-bottom:8px;border-bottom:1px solid #ddd;color:#2c3e50}
h3{font-size:15px;margin:25px 0 15px;color:#34495e}
h4{font-size:14px;margin:20px 0 12px;color:#34495e}
p{text-align:justify;margin-bottom:15px;text-indent:2em}
p.ni{text-indent:0}
table{width:100%;border-collapse:collapse;margin:20px 0;font-size:12px}
th,td{border:1px solid #ddd;padding:10px 8px;text-align:center}
th{background:#2c3e50;color:white;font-weight:bold}
tr:nth-child(even){background:#f8f9fa}
tr:hover{background:#e8f4f8}
.tc{font-size:13px;font-weight:bold;margin:15px 0 10px;text-align:center}
.eq{text-align:center;margin:20px 0;padding:15px;background:#f8f9fa;border-radius:4px;overflow-x:auto}
ul,ol{margin-left:2em;margin-bottom:15px}
li{margin-bottom:6px}
.def{background:#fff9e6;border:1px solid #ffc107;border-radius:4px;padding:20px;margin:20px 0}
.info{background:#e8f4f8;border-left:4px solid #3498db;padding:20px;margin:20px 0}
.warn{background:#fff3cd;border-left:4px solid #f39c12;padding:20px;margin:20px 0}
.ok{background:#d4edda;border-left:4px solid #28a745;padding:20px;margin:20px 0}
pre{background:#1e1e1e;color:#d4d4d4;padding:20px;border-radius:6px;overflow-x:auto;margin:20px 0;font-family:'Space Mono','Consolas',monospace;font-size:13px;line-height:1.6}
code{font-family:'Space Mono','Consolas',monospace;font-size:13px}
p code,li code,td code{background:#f0f0f0;padding:2px 6px;border-radius:3px;color:#c7254e;font-size:12px}
.cc{font-size:12px;font-weight:bold;color:#2c3e50;margin-top:15px;margin-bottom:4px}
.cm{color:#6a9955}.kw{color:#569cd6}.st{color:#ce9178}.fn{color:#dcdcaa}.nb{color:#4ec9b0}.nu{color:#b5cea8}
.progress-bar{width:100%;height:6px;background:#e0e0e0;border-radius:3px;margin-top:16px}
.progress-fill{height:100%;background:linear-gradient(90deg,#9c27b0,#e040fb);border-radius:3px;width:100%}
.progress-label{font-size:11px;color:#888;margin-top:4px;text-align:center}
details{margin:20px 0;border:1px solid #ddd;border-radius:6px;overflow:hidden}
details summary{padding:14px 20px;background:#f0f4f8;cursor:pointer;font-weight:bold;font-size:14px;color:#2c3e50;user-select:none;transition:background .2s}
details summary:hover{background:#e0e8f0}
details[open] summary{background:#d0dce8;border-bottom:1px solid #ddd}
details .answer-content{padding:20px;background:#fff}
.problem-box{background:#f0f4ff;border:2px solid #5c6bc0;border-radius:8px;padding:20px;margin:20px 0}
.problem-box .problem-title{font-weight:bold;color:#283593;font-size:15px;margin-bottom:12px}
@media(max-width:1024px){
.sidebar{width:100%;height:auto;position:relative;border-right:none;border-bottom:1px solid rgba(0,0,0,.08);padding:16px}
.sidebar-profile{margin-bottom:10px;padding-bottom:10px;display:flex;align-items:center;gap:12px;text-align:left}
.profile-icon{font-size:32px;margin-bottom:0}.profile-bio{display:none}
.nav-section{display:inline-block;margin-right:16px;margin-bottom:8px}
.nav-list{display:flex;gap:10px;flex-wrap:wrap}.nav-list li{margin-bottom:0}
.sidebar-footer{display:none}
.main-wrapper{margin-left:0}
.container{padding:0}.paper-content{padding:20px 16px;border-radius:0;box-shadow:none}
.paper-title{font-size:18px}p{font-size:14px;text-indent:1.5em;text-align:left}
pre{font-size:11px;padding:14px}table{font-size:10px;display:block;overflow-x:auto}
}
.code-output{background:#1e1e1e;color:#d4d4d4;padding:12px 16px;border-radius:0 0 6px 6px;font-family:'Space Mono',monospace;font-size:11.5px;line-height:1.6;margin-top:-4px;margin-bottom:18px;border-top:2px solid #333;white-space:pre-wrap;overflow-x:auto}
.code-output .out-label{color:#888;font-size:10px;margin-bottom:4px;display:block}
</style>
</head>
<body>

<div class="sidebar">
<div class="sidebar-profile">
<div class="profile-icon">&#x1F4D0;</div>
<div class="profile-name">HFT ML Master Plan</div>
<div class="profile-title">Convex Opt + DL + HFT</div>
<div class="profile-bio">Bonus Rounds: ìˆ˜í•™ ê¸°ì´ˆ ì˜¬ì¸ì›</div>
</div>
<div class="sidebar-nav">
<div class="nav-section">
<div class="nav-section-title">Curriculum</div>
<ul class="nav-list">
<li><a class="done" href="../round-01/">R1. Python + Finance <span class="badge badge-done">DONE</span></a></li>
<li><a class="done" href="../bonus-01/">B1. ì„ í˜•ëŒ€ìˆ˜ ì˜¬ì¸ì› <span class="badge badge-done">DONE</span></a></li>
<li><a class="done" href="../round-02/">R2. Linear Algebra + Stats <span class="badge badge-done">DONE</span></a></li>
<li><a class="active" href="#">B2. ë¯¸ì ë¶„ ì˜¬ì¸ì› <span class="badge badge-bonus">BONUS</span></a></li>
<li><a href="../round-03/">R3. Data / Feature Eng.</a></li>
<li><a href="../bonus-04/">B4. ì¬ë¬´ê´€ë¦¬ ì˜¬ì¸ì›</a></li>
<li><a href="../round-04/">R4. Supervised Learning</a></li>
<li><a href="../bonus-03/">B3. í™•ë¥ Â·í†µê³„ ì˜¬ì¸ì›</a></li>
<li><a href="../round-05/">R5. Unsupervised + TS</a></li>
<li><a href="../bonus-05/">B5. ê¸ˆìœµê³µí•™ ì˜¬ì¸ì›</a></li>
<li><a href="../round-06/">R6. NLP + Sentiment</a></li>
<li><a href="../round-07/">R7. Deep Learning</a></li>
<li><a href="../bonus-06/">B6. ìµœì í™” ì´ë¡  ì˜¬ì¸ì›</a></li>
<li><a href="../round-08/">R8. Convex Opt + Transformer</a></li>
<li><a href="../round-09/">R9. HFT + RL</a></li>
<li><a href="../round-10/">R10. Final Project</a></li>
</ul>
</div>
<div class="nav-section">
<div class="nav-section-title">This Lecture</div>
<ul class="nav-list">
<li><a href="#ch1">1. ê·¹í•œê³¼ ì—°ì†</a></li>
<li><a href="#ch2">2. ë¯¸ë¶„ì˜ ì •ì˜ì™€ ì§ê´€</a></li>
<li><a href="#ch3">3. ë¯¸ë¶„ ê³µì‹ ì´ì •ë¦¬</a></li>
<li><a href="#ch4">4. í¸ë¯¸ë¶„ê³¼ ê·¸ë˜ë””ì–¸íŠ¸</a></li>
<li><a href="#ch5">5. ì²´ì¸ë£° (ì—°ì‡„ë²•ì¹™)</a></li>
<li><a href="#ch6">6. ì ë¶„ì˜ ì§ê´€</a></li>
<li><a href="#ch7">7. í…Œì¼ëŸ¬ ê¸‰ìˆ˜</a></li>
<li><a href="#ch8">8. ê²½ì‚¬í•˜ê°•ë²•</a></li>
<li><a href="#ch9">9. ê¸ˆìœµì—ì„œì˜ ë¯¸ì ë¶„</a></li>
<li><a href="#ch10">10. ì¢…í•© ë¬¸ì œ</a></li>
</ul>
</div>
</div>
<div class="sidebar-footer">Bonus 2 â€” ë¯¸ì ë¶„ ì˜¬ì¸ì›</div>
</div>

<div class="main-wrapper">
<div class="container">
<div class="paper-content">

<div class="paper-header">
<div class="paper-category">Bonus Round 2 / 6 â€” R2ì™€ R3 ì‚¬ì´</div>
<h1 class="paper-title">ë¯¸ì ë¶„ ì˜¬ì¸ì› (Calculus All-in-One)</h1>
<div class="paper-subtitle">ê·¹í•œ â†’ ë¯¸ë¶„ â†’ í¸ë¯¸ë¶„ â†’ ì²´ì¸ë£° â†’ ì ë¶„ â†’ í…Œì¼ëŸ¬ ê¸‰ìˆ˜ â†’ ê²½ì‚¬í•˜ê°•ë²•</div>
<div class="paper-team">ë”¥ëŸ¬ë‹ê³¼ ê¸ˆìœµê³µí•™ì˜ ìˆ˜í•™ì  ì—”ì§„ì„ ì™„ì „ ì •ë³µí•˜ëŠ” ììŠµì„œ</div>
<div class="progress-bar"><div class="progress-fill"></div></div>
<div class="progress-label">Bonus Round â€” ë¯¸ì ë¶„ ì™„ì „ ì •ë³µ</div>
</div>

<div class="abstract">
<div class="abstract-title">ì™œ ë¯¸ì ë¶„ì¸ê°€?</div>
<p class="ni">ë”¥ëŸ¬ë‹ì˜ ì—­ì „íŒŒ(backpropagation)ëŠ” ì²´ì¸ë£°ì´ê³ , ê²½ì‚¬í•˜ê°•ë²•ì€ ë¯¸ë¶„ì´ë©°, ì˜µì…˜ ê°€ê²©ì˜ ë¸”ë™-ìˆ„ì¦ˆ ê³µì‹ì€ í¸ë¯¸ë¶„ë°©ì •ì‹ì´ë‹¤. ë¯¸ì ë¶„ ì—†ì´ëŠ” MLë„, ê¸ˆìœµê³µí•™ë„ ì´í•´í•  ìˆ˜ ì—†ë‹¤. ì´ ê°•ì˜ë¥¼ ë§ˆì¹˜ë©´:</p>
<ul>
<li>ë¯¸ë¶„ì˜ ê¸°í•˜í•™ì  ì˜ë¯¸(ì ‘ì„ ì˜ ê¸°ìš¸ê¸°)ë¥¼ ì§ê´€ì ìœ¼ë¡œ ì„¤ëª…í•  ìˆ˜ ìˆë‹¤</li>
<li>ì£¼ìš” í•¨ìˆ˜ì˜ ë¯¸ë¶„ ê³µì‹ì„ ì™¸ìš°ê³  ì ìš©í•  ìˆ˜ ìˆë‹¤</li>
<li>í¸ë¯¸ë¶„ê³¼ ê·¸ë˜ë””ì–¸íŠ¸ ë²¡í„°ë¥¼ ì´í•´í•˜ê³  ê³„ì‚°í•  ìˆ˜ ìˆë‹¤</li>
<li>ì²´ì¸ë£°ì„ ì ìš©í•˜ì—¬ í•©ì„±í•¨ìˆ˜ë¥¼ ë¯¸ë¶„í•  ìˆ˜ ìˆë‹¤</li>
<li>ê²½ì‚¬í•˜ê°•ë²•ì˜ ì›ë¦¬ë¥¼ ì´í•´í•˜ê³  Pythonìœ¼ë¡œ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤</li>
<li>ê¸ˆìœµì—ì„œ ë¯¸ì ë¶„ì´ ì–´ë–»ê²Œ ì‚¬ìš©ë˜ëŠ”ì§€(ë“€ë ˆì´ì…˜, ê·¸ë¦­ìŠ¤, BSM) ì„¤ëª…í•  ìˆ˜ ìˆë‹¤</li>
</ul>
<div style="font-size:13px;color:#555;margin-top:15px;font-style:italic"><strong>Keywords:</strong> Limit, Derivative, Partial Derivative, Chain Rule, Integral, Taylor Series, Gradient Descent, Black-Scholes</div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- Ch1: ê·¹í•œê³¼ ì—°ì† -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<h2 id="ch1">1. ê·¹í•œê³¼ ì—°ì† â€” ë¯¸ì ë¶„ì˜ ì¶œë°œì </h2>

<h3>1.1 ê·¹í•œì´ë€?</h3>
<p>ê·¹í•œ(limit)ì€ "ì–´ë–¤ ê°’ì— í•œì—†ì´ ê°€ê¹Œì´ ë‹¤ê°€ê°ˆ ë•Œ í•¨ìˆ˜ê°’ì´ ì–´ë””ë¡œ í–¥í•˜ëŠ”ê°€"ë¥¼ ë¬»ëŠ” ê²ƒì´ë‹¤. ë¯¸ë¶„ì˜ ì •ì˜ ìì²´ê°€ ê·¹í•œì´ë¯€ë¡œ, ê·¹í•œì„ ì´í•´í•´ì•¼ ë¯¸ë¶„ì„ ì´í•´í•  ìˆ˜ ìˆë‹¤.</p>

<div class="eq">
$$\lim_{x \to a} f(x) = L \quad \Longleftrightarrow \quad x\text{ê°€ }a\text{ì— ê°€ê¹Œì›Œì§ˆìˆ˜ë¡ }f(x)\text{ê°€ }L\text{ì— ê°€ê¹Œì›Œì§„ë‹¤}$$
</div>

<p>ê¸ˆìœµ ë¹„ìœ : ì£¼ê°€ê°€ 70,000ì›ì— "ìˆ˜ë ´"í•œë‹¤ëŠ” ê²ƒì€, ì‹œê°„ì´ ì§€ë‚ ìˆ˜ë¡ ì£¼ê°€ê°€ 70,000ì›ì— ê°€ê¹Œì›Œì§„ë‹¤ëŠ” ëœ»ì´ë‹¤. ì •í™•íˆ 70,000ì›ì´ ë˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, í•œì—†ì´ ê°€ê¹Œì›Œì§€ëŠ” ê²ƒì´ë‹¤.</p>

<pre><code><span class="kw">import</span> numpy <span class="kw">as</span> np

<span class="cm"># ê·¹í•œ ì˜ˆ: lim(xâ†’0) sin(x)/x = 1</span>
xs = [<span class="nu">1</span>, <span class="nu">0.1</span>, <span class="nu">0.01</span>, <span class="nu">0.001</span>, <span class="nu">0.0001</span>, <span class="nu">0.00001</span>]
<span class="kw">for</span> x <span class="kw">in</span> xs:
    <span class="fn">print</span>(<span class="st">f"x = </span>{x:<span class="nu">10</span>}<span class="st">  â†’  sin(x)/x = </span>{np.sin(x)/x:.10f}<span class="st">"</span>)
<span class="cm"># xê°€ 0ì— ê°€ê¹Œì›Œì§ˆìˆ˜ë¡ sin(x)/x â†’ 1.0000000000</span></code></pre>
<div class="code-output"><span class="out-label">Output:</span>
x =          1  â†’  sin(x)/x = 0.8414709848
x =        0.1  â†’  sin(x)/x = 0.9983341665
x =       0.01  â†’  sin(x)/x = 0.9999833334
x =      0.001  â†’  sin(x)/x = 0.9999998333
x =     0.0001  â†’  sin(x)/x = 0.9999999983
x =    0.00001  â†’  sin(x)/x = 1.0000000000</div>

<h3>1.2 ì—°ì†í•¨ìˆ˜</h3>
<p>í•¨ìˆ˜ê°€ ì  \(a\)ì—ì„œ ì—°ì†(continuous)ì´ë¼ í•¨ì€: (1) \(f(a)\)ê°€ ì¡´ì¬í•˜ê³ , (2) \(\lim_{x \to a} f(x)\)ê°€ ì¡´ì¬í•˜ê³ , (3) ë‘˜ì´ ê°™ë‹¤ëŠ” ê²ƒì´ë‹¤. ì§ê´€ì ìœ¼ë¡œ "ê·¸ë˜í”„ë¥¼ íœì„ ë–¼ì§€ ì•Šê³  ê·¸ë¦´ ìˆ˜ ìˆë‹¤"ëŠ” ëœ»ì´ë‹¤.</p>

<div class="info">
<p class="ni"><strong>ì™œ ì—°ì†ì´ ì¤‘ìš”í•œê°€:</strong> ë¯¸ë¶„ì€ ì—°ì†ì¸ í•¨ìˆ˜ì—ì„œë§Œ ì •ì˜ëœë‹¤. ì£¼ê°€ ë°ì´í„°ëŠ” ì´ì‚°ì (discrete)ì´ì§€ë§Œ, ë¸”ë™-ìˆ„ì¦ˆ ëª¨ë¸ì€ ì£¼ê°€ë¥¼ ì—°ì† í•¨ìˆ˜ë¡œ ëª¨ë¸ë§í•œë‹¤. ì´ "ì´ì‚° â†’ ì—°ì†" ê·¼ì‚¬ê°€ ê¸ˆìœµê³µí•™ì˜ ì¶œë°œì ì´ë‹¤.</p>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- Ch2: ë¯¸ë¶„ì˜ ì •ì˜ì™€ ì§ê´€ -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<h2 id="ch2">2. ë¯¸ë¶„ì˜ ì •ì˜ì™€ ì§ê´€</h2>

<h3>2.1 ë¯¸ë¶„ = ìˆœê°„ ë³€í™”ìœ¨ = ì ‘ì„ ì˜ ê¸°ìš¸ê¸°</h3>
<p>ë¯¸ë¶„(derivative)ì€ í•¨ìˆ˜ê°€ ì–´ë–¤ ì ì—ì„œ ì–¼ë§ˆë‚˜ ë¹ ë¥´ê²Œ ë³€í•˜ëŠ”ì§€ë¥¼ ì¸¡ì •í•œë‹¤. ê¸°í•˜í•™ì ìœ¼ë¡œëŠ” ê·¸ë˜í”„ ìœ„ì˜ í•œ ì ì—ì„œ ì ‘ì„ ì˜ ê¸°ìš¸ê¸°ë‹¤.</p>

<div class="def">
<p class="ni"><strong>ë¯¸ë¶„ì˜ ì •ì˜:</strong></p>
<div class="eq">
$$f'(x) = \lim_{h \to 0} \frac{f(x+h) - f(x)}{h}$$
</div>
<p class="ni">\(\frac{f(x+h) - f(x)}{h}\)ëŠ” ë‘ ì ì„ ì‡ëŠ” í• ì„ (secant line)ì˜ ê¸°ìš¸ê¸°ë‹¤. \(h \to 0\)ì´ë©´ í• ì„ ì´ ì ‘ì„ (tangent line)ì´ ëœë‹¤.</p>
</div>

<p>ê¸ˆìœµ ë¹„ìœ : ì£¼ê°€ \(P(t)\)ì˜ ë¯¸ë¶„ \(P'(t)\)ëŠ” "ì§€ê¸ˆ ì´ ìˆœê°„ ì£¼ê°€ê°€ ì–¼ë§ˆë‚˜ ë¹ ë¥´ê²Œ ì˜¤ë¥´ê³  ìˆëŠ”ê°€"ë‹¤. ì–‘ìˆ˜ë©´ ìƒìŠ¹ ì¤‘, ìŒìˆ˜ë©´ í•˜ë½ ì¤‘, 0ì´ë©´ ë³€ê³¡ì (ê³ ì  ë˜ëŠ” ì €ì )ì´ë‹¤.</p>

<!-- â–¼ Plotly: ì ‘ì„  ì‹œê°í™” -->
<div id="plot-ch2-tangent" style="width:100%;height:420px;margin:25px 0"></div>
<script>
(function(){
  var xs=[],ys=[],tx=[],ty=[];
  for(var x=-2;x<=4;x+=0.05){xs.push(x);ys.push(x*x);}
  // x=1ì—ì„œ ì ‘ì„ : f(1)=1, f'(1)=2 â†’ y=2(x-1)+1=2x-1
  for(var x=-0.5;x<=2.5;x+=0.05){tx.push(x);ty.push(2*x-1);}
  Plotly.newPlot('plot-ch2-tangent',[
    {x:xs,y:ys,mode:'lines',name:'f(x) = xÂ²',line:{width:3,color:'#1e88e5'}},
    {x:tx,y:ty,mode:'lines',name:'ì ‘ì„  at x=1 (ê¸°ìš¸ê¸°=2)',line:{width:2,color:'#e53935',dash:'dash'}},
    {x:[1],y:[1],mode:'markers',name:'ì ‘ì  (1, 1)',marker:{size:12,color:'#e53935',symbol:'circle'}}
  ],{
    title:{text:'ğŸ“ ë¯¸ë¶„ = ì ‘ì„ ì˜ ê¸°ìš¸ê¸°: f(x)=xÂ²ì—ì„œ f\'(1)=2',font:{size:13}},
    xaxis:{title:'x',range:[-2,4],zeroline:true,zerolinewidth:2},
    yaxis:{title:'f(x)',range:[-2,10],zeroline:true,zerolinewidth:2},
    margin:{l:50,r:20,t:45,b:40},
    legend:{x:0.02,y:0.98},
    annotations:[{x:2,y:3,text:'ê¸°ìš¸ê¸° = 2<br>(xê°€ 1 ì¦ê°€í•˜ë©´ f(x)ê°€ 2 ì¦ê°€)',
      showarrow:true,arrowhead:2,ax:80,ay:-40,font:{size:11}}]
  },{responsive:true});
})();
</script>
<p class="ni" style="font-size:11px;color:#888;text-align:center;margin-top:-10px">ğŸ–±ï¸ íŒŒë€ ê³¡ì„  f(x)=xÂ² ìœ„ì˜ ì  (1,1)ì—ì„œ ë¹¨ê°„ ì ‘ì„ ì˜ ê¸°ìš¸ê¸°ê°€ f'(1)=2</p>

<h3>2.2 ìˆ˜ì¹˜ ë¯¸ë¶„ (Numerical Differentiation)</h3>
<p>ì»´í“¨í„°ì—ì„œëŠ” ê·¹í•œì„ ì§ì ‘ ê³„ì‚°í•  ìˆ˜ ì—†ìœ¼ë¯€ë¡œ, ì•„ì£¼ ì‘ì€ \(h\)ë¥¼ ì‚¬ìš©í•˜ì—¬ ê·¼ì‚¬í•œë‹¤. ì¤‘ì•™ì°¨ë¶„ë²•(central difference)ì´ ê°€ì¥ ì •í™•í•˜ë‹¤.</p>

<div class="eq">
$$f'(x) \approx \frac{f(x+h) - f(x-h)}{2h} \quad (\text{ì¤‘ì•™ì°¨ë¶„, ì˜¤ì°¨ } O(h^2))$$
</div>

<pre><code><span class="kw">import</span> numpy <span class="kw">as</span> np

<span class="kw">def</span> <span class="fn">numerical_derivative</span>(f, x, h=<span class="nu">1e-5</span>):
    <span class="st">"""ì¤‘ì•™ì°¨ë¶„ë²•ìœ¼ë¡œ ìˆ˜ì¹˜ ë¯¸ë¶„"""</span>
    <span class="kw">return</span> (f(x + h) - f(x - h)) / (<span class="nu">2</span> * h)

<span class="cm"># f(x) = xÂ² â†’ f'(x) = 2x</span>
f = <span class="kw">lambda</span> x: x**<span class="nu">2</span>
<span class="fn">print</span>(<span class="st">f"f'(3) ìˆ˜ì¹˜: </span>{numerical_derivative(f, 3):.6f}<span class="st">"</span>)  <span class="cm"># â‰ˆ 6.0</span>
<span class="fn">print</span>(<span class="st">f"f'(3) í•´ì„: </span>{2*3}<span class="st">"</span>)  <span class="cm"># ì •í™•íˆ 6</span>

<span class="cm"># g(x) = sin(x) â†’ g'(x) = cos(x)</span>
g = <span class="kw">lambda</span> x: np.sin(x)
<span class="fn">print</span>(<span class="st">f"\ng'(Ï€/4) ìˆ˜ì¹˜: </span>{numerical_derivative(g, np.pi/4):.6f}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"g'(Ï€/4) í•´ì„: </span>{np.cos(np.pi/4):.6f}<span class="st">"</span>)</code></pre>
<div class="code-output"><span class="out-label">Output:</span>
f'(3) ìˆ˜ì¹˜: 6.000000
f'(3) í•´ì„: 6

g'(Ï€/4) ìˆ˜ì¹˜: 0.707107
g'(Ï€/4) í•´ì„: 0.707107</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- ì—°ìŠµë¬¸ì œ 2 -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="problem-box">
<div class="problem-title">âœï¸ ì—°ìŠµë¬¸ì œ 2.1</div>
<p class="ni">í•¨ìˆ˜ \(f(x) = x^3 - 3x + 1\)ì— ëŒ€í•´:</p>
<ol>
<li>ë¯¸ë¶„ì˜ ì •ì˜ë¥¼ ì‚¬ìš©í•˜ì—¬ \(f'(x)\)ë¥¼ êµ¬í•˜ë¼.</li>
<li>\(f'(x) = 0\)ì¸ ì ì„ êµ¬í•˜ë¼. ì´ ì ë“¤ì€ ë¬´ì—‡ì„ ì˜ë¯¸í•˜ëŠ”ê°€?</li>
<li>ìˆ˜ì¹˜ ë¯¸ë¶„ìœ¼ë¡œ \(f'(2)\)ë¥¼ ê²€ì¦í•˜ë¼.</li>
</ol>
</div>

<details>
<summary>ğŸ”‘ í’€ì´ ë³´ê¸°</summary>
<div class="answer-content">
<p class="ni"><strong>1) í•´ì„ì  ë¯¸ë¶„:</strong></p>
<div class="eq">$$f'(x) = 3x^2 - 3$$</div>

<p class="ni"><strong>2) ì„ê³„ì :</strong></p>
<div class="eq">$$3x^2 - 3 = 0 \quad \Rightarrow \quad x^2 = 1 \quad \Rightarrow \quad x = \pm 1$$</div>
<p class="ni">\(x = -1\): ê·¹ëŒ€ì  (f(-1) = 3), \(x = 1\): ê·¹ì†Œì  (f(1) = -1). ì´ ì ë“¤ì—ì„œ ì ‘ì„ ì˜ ê¸°ìš¸ê¸°ê°€ 0ì´ë¯€ë¡œ í•¨ìˆ˜ê°€ ì¦ê°€ì—ì„œ ê°ì†Œë¡œ(ë˜ëŠ” ë°˜ëŒ€ë¡œ) ì „í™˜ëœë‹¤. ê¸ˆìœµì—ì„œ ì£¼ê°€ì˜ ê³ ì /ì €ì ì— í•´ë‹¹.</p>

<p class="ni"><strong>3) ìˆ˜ì¹˜ ê²€ì¦:</strong></p>
<div class="eq">$$f'(2) = 3(4) - 3 = 9$$</div>
<pre><code>f = <span class="kw">lambda</span> x: x**<span class="nu">3</span> - <span class="nu">3</span>*x + <span class="nu">1</span>
<span class="fn">print</span>(<span class="st">f"ìˆ˜ì¹˜: </span>{numerical_derivative(f, 2):.6f}<span class="st">"</span>)  <span class="cm"># 9.000000</span>
<span class="fn">print</span>(<span class="st">f"í•´ì„: </span>{3*4-3}<span class="st">"</span>)  <span class="cm"># 9</span></code></pre>
</div>
</details>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- Ch3: ë¯¸ë¶„ ê³µì‹ ì´ì •ë¦¬ -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<h2 id="ch3">3. ë¯¸ë¶„ ê³µì‹ ì´ì •ë¦¬</h2>

<h3>3.1 ê¸°ë³¸ ë¯¸ë¶„ ê³µì‹</h3>
<p>ë‹¤ìŒ ê³µì‹ë“¤ì€ ì™¸ì›Œì•¼ í•œë‹¤. MLê³¼ ê¸ˆìœµì—ì„œ ë°˜ë³µì ìœ¼ë¡œ ë“±ì¥í•œë‹¤.</p>

<div class="tc">Table 1. í•µì‹¬ ë¯¸ë¶„ ê³µì‹</div>
<table>
<tr><th>í•¨ìˆ˜ \(f(x)\)</th><th>ë„í•¨ìˆ˜ \(f'(x)\)</th><th>ML/ê¸ˆìœµ í™œìš©</th></tr>
<tr><td>\(c\) (ìƒìˆ˜)</td><td>\(0\)</td><td>ë°”ì´ì–´ìŠ¤ í•­</td></tr>
<tr><td>\(x^n\)</td><td>\(nx^{n-1}\)</td><td>ë‹¤í•­ íšŒê·€, ë³µë¦¬ ê³„ì‚°</td></tr>
<tr><td>\(e^x\)</td><td>\(e^x\)</td><td>ì—°ì† ë³µë¦¬, ì†Œí”„íŠ¸ë§¥ìŠ¤</td></tr>
<tr><td>\(\ln x\)</td><td>\(\frac{1}{x}\)</td><td>ë¡œê·¸ ìˆ˜ìµë¥ , í¬ë¡œìŠ¤ì—”íŠ¸ë¡œí”¼</td></tr>
<tr><td>\(\sin x\)</td><td>\(\cos x\)</td><td>ì‹œê³„ì—´ ì£¼ê¸° ë¶„ì„</td></tr>
<tr><td>\(\cos x\)</td><td>\(-\sin x\)</td><td>ì‹œê³„ì—´ ì£¼ê¸° ë¶„ì„</td></tr>
<tr><td>\(\frac{1}{1+e^{-x}}\) (ì‹œê·¸ëª¨ì´ë“œ)</td><td>\(\sigma(x)(1-\sigma(x))\)</td><td>ë¡œì§€ìŠ¤í‹± íšŒê·€, ë‰´ëŸ´ë„·</td></tr>
<tr><td>\(\tanh x\)</td><td>\(1 - \tanh^2 x\)</td><td>RNN í™œì„±í™” í•¨ìˆ˜</td></tr>
<tr><td>\(\max(0, x)\) (ReLU)</td><td>\(\begin{cases}1 & x>0\\0 & x<0\end{cases}\)</td><td>ë”¥ëŸ¬ë‹ í™œì„±í™” í•¨ìˆ˜</td></tr>
</table>

<h3>3.2 ë¯¸ë¶„ ë²•ì¹™</h3>

<div class="def">
<p class="ni"><strong>ë„¤ ê°€ì§€ í•µì‹¬ ë²•ì¹™:</strong></p>
<ul>
<li><strong>í•©ì˜ ë²•ì¹™:</strong> \((f + g)' = f' + g'\)</li>
<li><strong>ìƒìˆ˜ë°° ë²•ì¹™:</strong> \((cf)' = cf'\)</li>
<li><strong>ê³±ì˜ ë²•ì¹™:</strong> \((fg)' = f'g + fg'\)</li>
<li><strong>ëª«ì˜ ë²•ì¹™:</strong> \(\left(\frac{f}{g}\right)' = \frac{f'g - fg'}{g^2}\)</li>
</ul>
</div>

<pre><code><span class="kw">import</span> numpy <span class="kw">as</span> np

<span class="kw">def</span> <span class="fn">nd</span>(f, x, h=<span class="nu">1e-7</span>):
    <span class="st">"""ìˆ˜ì¹˜ ë¯¸ë¶„ (ì¤‘ì•™ì°¨ë¶„)"""</span>
    <span class="kw">return</span> (f(x+h) - f(x-h)) / (<span class="nu">2</span>*h)

<span class="cm"># ê±°ë“­ì œê³± ë²•ì¹™: (x^3)' = 3x^2</span>
<span class="fn">print</span>(<span class="st">"(xÂ³)' at x=2:"</span>, nd(<span class="kw">lambda</span> x: x**<span class="nu">3</span>, <span class="nu">2</span>))  <span class="cm"># 12.0</span>

<span class="cm"># ì§€ìˆ˜í•¨ìˆ˜: (e^x)' = e^x</span>
<span class="fn">print</span>(<span class="st">"(eË£)' at x=1:"</span>, nd(np.exp, <span class="nu">1</span>))  <span class="cm"># 2.71828...</span>
<span class="fn">print</span>(<span class="st">"eÂ¹ =         "</span>, np.exp(<span class="nu">1</span>))

<span class="cm"># ë¡œê·¸í•¨ìˆ˜: (ln x)' = 1/x</span>
<span class="fn">print</span>(<span class="st">"(ln x)' at x=2:"</span>, nd(np.log, <span class="nu">2</span>))  <span class="cm"># 0.5</span>

<span class="cm"># ì‹œê·¸ëª¨ì´ë“œ: Ïƒ'(x) = Ïƒ(x)(1-Ïƒ(x))</span>
sigmoid = <span class="kw">lambda</span> x: <span class="nu">1</span> / (<span class="nu">1</span> + np.exp(-x))
x = <span class="nu">0.5</span>
<span class="fn">print</span>(<span class="st">f"\nÏƒ'(0.5) ìˆ˜ì¹˜: </span>{nd(sigmoid, x):.6f}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"Ïƒ'(0.5) ê³µì‹: </span>{sigmoid(x)*(1-sigmoid(x)):.6f}<span class="st">"</span>)</code></pre>
<div class="code-output"><span class="out-label">Output:</span>
(xÂ³)' at x=2: 12.000000
(eË£)' at x=1: 2.718282
eÂ¹ =          2.718281828459045
(ln x)' at x=2: 0.500000

Ïƒ'(0.5) ìˆ˜ì¹˜: 0.235004
Ïƒ'(0.5) ê³µì‹: 0.235004</div>

<h3>3.3 ì‹œê·¸ëª¨ì´ë“œì™€ ReLU â€” ë”¥ëŸ¬ë‹ì˜ í•µì‹¬ í•¨ìˆ˜</h3>
<p>ë”¥ëŸ¬ë‹ì—ì„œ í™œì„±í™” í•¨ìˆ˜ì˜ ë¯¸ë¶„ì€ ì—­ì „íŒŒ(backpropagation)ì˜ í•µì‹¬ì´ë‹¤. ì‹œê·¸ëª¨ì´ë“œì˜ ë¯¸ë¶„ì´ ì™œ ë¬¸ì œê°€ ë˜ëŠ”ì§€, ReLUê°€ ì™œ ë“±ì¥í–ˆëŠ”ì§€ ì´í•´í•˜ì.</p>

<!-- â–¼ Plotly: í™œì„±í™” í•¨ìˆ˜ì™€ ë„í•¨ìˆ˜ -->
<div id="plot-ch3-activation" style="width:100%;height:420px;margin:25px 0"></div>
<script>
(function(){
  var xs=[],sig=[],sig_d=[],relu=[],relu_d=[],tanh_v=[],tanh_d=[];
  for(var x=-5;x<=5;x+=0.05){
    xs.push(x);
    var s=1/(1+Math.exp(-x));
    sig.push(s); sig_d.push(s*(1-s));
    relu.push(Math.max(0,x)); relu_d.push(x>0?1:0);
    var t=Math.tanh(x);
    tanh_v.push(t); tanh_d.push(1-t*t);
  }
  Plotly.newPlot('plot-ch3-activation',[
    {x:xs,y:sig,mode:'lines',name:'Ïƒ(x)',line:{width:2,color:'#1e88e5'}},
    {x:xs,y:sig_d,mode:'lines',name:"Ïƒ'(x)",line:{width:2,color:'#1e88e5',dash:'dash'}},
    {x:xs,y:relu,mode:'lines',name:'ReLU(x)',line:{width:2,color:'#e53935'}},
    {x:xs,y:relu_d,mode:'lines',name:"ReLU'(x)",line:{width:2,color:'#e53935',dash:'dash'}},
    {x:xs,y:tanh_v,mode:'lines',name:'tanh(x)',line:{width:2,color:'#43a047'}},
    {x:xs,y:tanh_d,mode:'lines',name:"tanh'(x)",line:{width:2,color:'#43a047',dash:'dash'}}
  ],{
    title:{text:'ğŸ§  í™œì„±í™” í•¨ìˆ˜(ì‹¤ì„ )ì™€ ë„í•¨ìˆ˜(ì ì„ )',font:{size:13}},
    xaxis:{title:'x',zeroline:true,zerolinewidth:2},
    yaxis:{title:'y',range:[-1.5,5],zeroline:true,zerolinewidth:2},
    margin:{l:50,r:20,t:45,b:40},
    legend:{x:0.02,y:0.98,bgcolor:'rgba(255,255,255,0.8)'},
    annotations:[{x:0,y:0.25,text:"Ïƒ' ìµœëŒ€ = 0.25<br>(ê¸°ìš¸ê¸° ì†Œì‹¤!)",showarrow:true,arrowhead:2,ax:-80,ay:-30,font:{size:10,color:'#1e88e5'}}]
  },{responsive:true});
})();
</script>
<p class="ni" style="font-size:11px;color:#888;text-align:center;margin-top:-10px">ğŸ–±ï¸ ì‹œê·¸ëª¨ì´ë“œì˜ ë„í•¨ìˆ˜ ìµœëŒ€ê°’ì€ 0.25 â†’ ë ˆì´ì–´ê°€ ê¹Šì–´ì§€ë©´ ê¸°ìš¸ê¸°ê°€ ì†Œì‹¤ëœë‹¤. ReLUëŠ” ì–‘ìˆ˜ ì˜ì—­ì—ì„œ ë„í•¨ìˆ˜=1ë¡œ ì´ ë¬¸ì œë¥¼ í•´ê²°</p>

<div class="warn">
<p class="ni"><strong>ê¸°ìš¸ê¸° ì†Œì‹¤ ë¬¸ì œ (Vanishing Gradient):</strong> ì‹œê·¸ëª¨ì´ë“œì˜ ë„í•¨ìˆ˜ ìµœëŒ€ê°’ì€ 0.25ë‹¤. 10ê°œ ë ˆì´ì–´ë¥¼ í†µê³¼í•˜ë©´ ê¸°ìš¸ê¸°ê°€ \(0.25^{10} \approx 0.000001\)ë¡œ ê±°ì˜ ì‚¬ë¼ì§„ë‹¤. ì´ê²ƒì´ ë”¥ëŸ¬ë‹ ì´ˆê¸°ì˜ ìµœëŒ€ ë‚œì œì˜€ê³ , ReLUì˜ ë“±ì¥ìœ¼ë¡œ í•´ê²°ë˜ì—ˆë‹¤. ReLUì˜ ë„í•¨ìˆ˜ëŠ” ì–‘ìˆ˜ ì˜ì—­ì—ì„œ í•­ìƒ 1ì´ë¯€ë¡œ ê¸°ìš¸ê¸°ê°€ ë³´ì¡´ëœë‹¤.</p>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- Ch4: í¸ë¯¸ë¶„ê³¼ ê·¸ë˜ë””ì–¸íŠ¸ -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<h2 id="ch4">4. í¸ë¯¸ë¶„ê³¼ ê·¸ë˜ë””ì–¸íŠ¸</h2>

<h3>4.1 í¸ë¯¸ë¶„ (Partial Derivative)</h3>
<p>ë³€ìˆ˜ê°€ ì—¬ëŸ¬ ê°œì¸ í•¨ìˆ˜ì—ì„œ, í•˜ë‚˜ì˜ ë³€ìˆ˜ë§Œ ë³€í™”ì‹œí‚¤ê³  ë‚˜ë¨¸ì§€ëŠ” ê³ ì •í•œ ì±„ ë¯¸ë¶„í•˜ëŠ” ê²ƒì´ í¸ë¯¸ë¶„ì´ë‹¤. MLì—ì„œ ì†ì‹¤í•¨ìˆ˜ëŠ” ìˆ˜ì²œ~ìˆ˜ì–µ ê°œì˜ íŒŒë¼ë¯¸í„°ë¥¼ ê°€ì§€ë¯€ë¡œ, í¸ë¯¸ë¶„ì€ í•„ìˆ˜ë‹¤.</p>

<div class="eq">
$$f(x, y) = x^2 + 3xy + y^2 \quad \Rightarrow \quad \frac{\partial f}{\partial x} = 2x + 3y, \quad \frac{\partial f}{\partial y} = 3x + 2y$$
</div>

<p>ê¸ˆìœµ ë¹„ìœ : í¬íŠ¸í´ë¦¬ì˜¤ ìˆ˜ìµë¥ ì´ ì‚¼ì„±ì „ì ë¹„ì¤‘(\(w_1\))ê³¼ SKí•˜ì´ë‹‰ìŠ¤ ë¹„ì¤‘(\(w_2\))ì— ì˜ì¡´í•œë‹¤ë©´, \(\frac{\partial r_p}{\partial w_1}\)ì€ "ì‚¼ì„±ì „ì ë¹„ì¤‘ì„ 1% ëŠ˜ë¦¬ë©´ í¬íŠ¸í´ë¦¬ì˜¤ ìˆ˜ìµë¥ ì´ ì–¼ë§ˆë‚˜ ë³€í•˜ëŠ”ê°€"ë¥¼ ì˜ë¯¸í•œë‹¤.</p>

<pre><code><span class="kw">import</span> numpy <span class="kw">as</span> np

<span class="cm"># f(x,y) = xÂ² + 3xy + yÂ²</span>
f = <span class="kw">lambda</span> x, y: x**<span class="nu">2</span> + <span class="nu">3</span>*x*y + y**<span class="nu">2</span>

<span class="cm"># í¸ë¯¸ë¶„ (ìˆ˜ì¹˜)</span>
<span class="kw">def</span> <span class="fn">partial_x</span>(f, x, y, h=<span class="nu">1e-7</span>):
    <span class="kw">return</span> (f(x+h, y) - f(x-h, y)) / (<span class="nu">2</span>*h)

<span class="kw">def</span> <span class="fn">partial_y</span>(f, x, y, h=<span class="nu">1e-7</span>):
    <span class="kw">return</span> (f(x, y+h) - f(x, y-h)) / (<span class="nu">2</span>*h)

x, y = <span class="nu">1</span>, <span class="nu">2</span>
<span class="fn">print</span>(<span class="st">f"âˆ‚f/âˆ‚x at (1,2) ìˆ˜ì¹˜: </span>{partial_x(f, x, y):.4f}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"âˆ‚f/âˆ‚x at (1,2) í•´ì„: </span>{2*x + 3*y}<span class="st">"</span>)  <span class="cm"># 2+6=8</span>
<span class="fn">print</span>(<span class="st">f"âˆ‚f/âˆ‚y at (1,2) ìˆ˜ì¹˜: </span>{partial_y(f, x, y):.4f}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"âˆ‚f/âˆ‚y at (1,2) í•´ì„: </span>{3*x + 2*y}<span class="st">"</span>)  <span class="cm"># 3+4=7</span></code></pre>
<div class="code-output"><span class="out-label">Output:</span>
âˆ‚f/âˆ‚x at (1,2) ìˆ˜ì¹˜: 8.0000
âˆ‚f/âˆ‚x at (1,2) í•´ì„: 8
âˆ‚f/âˆ‚y at (1,2) ìˆ˜ì¹˜: 7.0000
âˆ‚f/âˆ‚y at (1,2) í•´ì„: 7</div>

<h3>4.2 ê·¸ë˜ë””ì–¸íŠ¸ ë²¡í„° (Gradient)</h3>
<p>ëª¨ë“  í¸ë¯¸ë¶„ì„ í•˜ë‚˜ì˜ ë²¡í„°ë¡œ ëª¨ì€ ê²ƒì´ ê·¸ë˜ë””ì–¸íŠ¸ë‹¤. ê·¸ë˜ë””ì–¸íŠ¸ëŠ” í•¨ìˆ˜ê°€ ê°€ì¥ ë¹ ë¥´ê²Œ ì¦ê°€í•˜ëŠ” ë°©í–¥ì„ ê°€ë¦¬í‚¨ë‹¤.</p>

<div class="eq">
$$\nabla f = \begin{bmatrix} \frac{\partial f}{\partial x_1} \\ \frac{\partial f}{\partial x_2} \\ \vdots \\ \frac{\partial f}{\partial x_n} \end{bmatrix}$$
</div>

<div class="def">
<p class="ni"><strong>ê·¸ë˜ë””ì–¸íŠ¸ì˜ í•µì‹¬ ì„±ì§ˆ:</strong></p>
<ul>
<li>ê·¸ë˜ë””ì–¸íŠ¸ ë°©í–¥ = í•¨ìˆ˜ê°€ ê°€ì¥ ë¹ ë¥´ê²Œ ì¦ê°€í•˜ëŠ” ë°©í–¥</li>
<li>ê·¸ë˜ë””ì–¸íŠ¸ ë°˜ëŒ€ ë°©í–¥ = í•¨ìˆ˜ê°€ ê°€ì¥ ë¹ ë¥´ê²Œ ê°ì†Œí•˜ëŠ” ë°©í–¥ â†’ ê²½ì‚¬í•˜ê°•ë²•!</li>
<li>ê·¸ë˜ë””ì–¸íŠ¸ í¬ê¸° = ë³€í™”ì˜ ì†ë„ (ê°€íŒŒë¥¸ ì •ë„)</li>
<li>ê·¸ë˜ë””ì–¸íŠ¸ = 0ì¸ ì  = ê·¹ê°’ (ìµœëŒ€, ìµœì†Œ, ì•ˆì¥ì )</li>
</ul>
</div>

<!-- â–¼ Plotly: 3D ê³¡ë©´ + ê·¸ë˜ë””ì–¸íŠ¸ -->
<div id="plot-ch4-gradient" style="width:100%;height:520px;margin:25px 0"></div>
<script>
(function(){
  var n=40;
  var xv=[],yv=[],zv=[];
  for(var i=0;i<n;i++){
    var row_x=[],row_y=[],row_z=[];
    for(var j=0;j<n;j++){
      var x=-3+6*i/(n-1), y=-3+6*j/(n-1);
      row_x.push(x);row_y.push(y);
      row_z.push(x*x+y*y);
    }
    xv.push(row_x);yv.push(row_y);zv.push(row_z);
  }
  // ê·¸ë˜ë””ì–¸íŠ¸ í™”ì‚´í‘œ ì‹œì‘ì 
  var gx=[2,2,-2,-2,0],gy=[2,-2,2,-2,0],gz=[];
  for(var i=0;i<gx.length;i++) gz.push(gx[i]*gx[i]+gy[i]*gy[i]+0.5);
  Plotly.newPlot('plot-ch4-gradient',[
    {x:xv,y:yv,z:zv,type:'surface',colorscale:'Viridis',opacity:0.85,showscale:false},
    {x:gx,y:gy,z:gz,mode:'markers',type:'scatter3d',name:'ê·¸ë˜ë””ì–¸íŠ¸ ë°©í–¥',
     marker:{size:6,color:'#e53935',symbol:'diamond'}}
  ],{
    title:{text:'ğŸ”ï¸ f(x,y) = xÂ² + yÂ² â€” ê·¸ë˜ë””ì–¸íŠ¸ëŠ” ë°”ê¹¥(ì¦ê°€) ë°©í–¥',font:{size:13}},
    scene:{
      xaxis:{title:'x'},yaxis:{title:'y'},zaxis:{title:'f(x,y)'},
      camera:{eye:{x:1.8,y:1.8,z:1.2}}
    },
    margin:{l:0,r:0,t:45,b:0}
  },{responsive:true});
})();
</script>
<p class="ni" style="font-size:11px;color:#888;text-align:center;margin-top:-10px">ğŸ–±ï¸ 3D íšŒì „ ê°€ëŠ¥! ê·¸ë˜ë””ì–¸íŠ¸ëŠ” ê³¡ë©´ì˜ ê°€ì¥ ê°€íŒŒë¥¸ ì˜¤ë¥´ë§‰ ë°©í–¥. ê²½ì‚¬í•˜ê°•ë²•ì€ ì´ ë°˜ëŒ€ ë°©í–¥ìœ¼ë¡œ ë‚´ë ¤ê°„ë‹¤</p>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- ì—°ìŠµë¬¸ì œ 4 -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="problem-box">
<div class="problem-title">âœï¸ ì—°ìŠµë¬¸ì œ 4.1</div>
<p class="ni">í•¨ìˆ˜ \(f(x, y) = 3x^2 y + y^3 - 6xy\)ì— ëŒ€í•´:</p>
<ol>
<li>\(\frac{\partial f}{\partial x}\)ì™€ \(\frac{\partial f}{\partial y}\)ë¥¼ êµ¬í•˜ë¼.</li>
<li>ì  \((1, 2)\)ì—ì„œì˜ ê·¸ë˜ë””ì–¸íŠ¸ ë²¡í„° \(\nabla f(1, 2)\)ë¥¼ êµ¬í•˜ë¼.</li>
<li>ê·¸ë˜ë””ì–¸íŠ¸ì˜ í¬ê¸°(ë…¸ë¦„)ë¥¼ êµ¬í•˜ë¼. ì´ê²ƒì€ ë¬´ì—‡ì„ ì˜ë¯¸í•˜ëŠ”ê°€?</li>
</ol>
</div>

<details>
<summary>ğŸ”‘ í’€ì´ ë³´ê¸°</summary>
<div class="answer-content">
<p class="ni"><strong>1) í¸ë¯¸ë¶„:</strong></p>
<div class="eq">$$\frac{\partial f}{\partial x} = 6xy - 6y, \quad \frac{\partial f}{\partial y} = 3x^2 + 3y^2 - 6x$$</div>

<p class="ni"><strong>2) ê·¸ë˜ë””ì–¸íŠ¸ at (1,2):</strong></p>
<div class="eq">$$\frac{\partial f}{\partial x}\bigg|_{(1,2)} = 6(1)(2) - 6(2) = 12 - 12 = 0$$</div>
<div class="eq">$$\frac{\partial f}{\partial y}\bigg|_{(1,2)} = 3(1) + 3(4) - 6(1) = 3 + 12 - 6 = 9$$</div>
<div class="eq">$$\nabla f(1,2) = \begin{bmatrix} 0 \\ 9 \end{bmatrix}$$</div>

<p class="ni"><strong>3) í¬ê¸°:</strong> \(\|\nabla f\| = \sqrt{0^2 + 9^2} = 9\). ì´ ì ì—ì„œ í•¨ìˆ˜ëŠ” y ë°©í–¥ìœ¼ë¡œë§Œ ë³€í™”í•˜ë©°, ë³€í™” ì†ë„ëŠ” 9ì´ë‹¤.</p>

<pre><code>f = <span class="kw">lambda</span> x,y: <span class="nu">3</span>*x**<span class="nu">2</span>*y + y**<span class="nu">3</span> - <span class="nu">6</span>*x*y
grad = np.array([partial_x(f,<span class="nu">1</span>,<span class="nu">2</span>), partial_y(f,<span class="nu">1</span>,<span class="nu">2</span>)])
<span class="fn">print</span>(<span class="st">f"âˆ‡f(1,2) = </span>{grad}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"|âˆ‡f| = </span>{np.linalg.norm(grad):.4f}<span class="st">"</span>)</code></pre>
</div>
</details>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- Ch5: ì²´ì¸ë£° (ì—°ì‡„ë²•ì¹™) -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<h2 id="ch5">5. ì²´ì¸ë£° (Chain Rule, ì—°ì‡„ë²•ì¹™)</h2>

<h3>5.1 í•©ì„±í•¨ìˆ˜ì˜ ë¯¸ë¶„</h3>
<p>ì²´ì¸ë£°ì€ ë”¥ëŸ¬ë‹ ì—­ì „íŒŒì˜ ìˆ˜í•™ì  ê¸°ì´ˆë‹¤. í•©ì„±í•¨ìˆ˜ \(f(g(x))\)ì˜ ë¯¸ë¶„ì€ ë°”ê¹¥ í•¨ìˆ˜ì˜ ë¯¸ë¶„ Ã— ì•ˆìª½ í•¨ìˆ˜ì˜ ë¯¸ë¶„ì´ë‹¤.</p>

<div class="eq">
$$\frac{d}{dx}f(g(x)) = f'(g(x)) \cdot g'(x)$$
</div>

<p>ë¹„ìœ : ìë™ì°¨ ì†ë„(km/h) Ã— ì‹œê°„ë‹¹ ì—°ë£Œ ì†Œë¹„(L/h) = kmë‹¹ ì—°ë£Œ ì†Œë¹„(L/km). ì¤‘ê°„ ë³€ìˆ˜ë¥¼ í†µí•´ ì—°ê²°ë˜ëŠ” ë³€í™”ìœ¨ì„ ê³±í•˜ëŠ” ê²ƒì´ë‹¤.</p>

<div class="def">
<p class="ni"><strong>ì²´ì¸ë£° ì ìš© ì˜ˆ:</strong></p>
<div class="eq">$$\frac{d}{dx}e^{3x^2} = e^{3x^2} \cdot 6x \quad \text{(ë°”ê¹¥: } e^u \to e^u, \text{ ì•ˆìª½: } 3x^2 \to 6x\text{)}$$</div>
<div class="eq">$$\frac{d}{dx}\ln(\sin x) = \frac{1}{\sin x} \cdot \cos x = \frac{\cos x}{\sin x} = \cot x$$</div>
<div class="eq">$$\frac{d}{dx}\sigma(wx+b) = \sigma(wx+b)(1-\sigma(wx+b)) \cdot w \quad \text{(ë‰´ëŸ´ë„· 1ê°œ ë‰´ëŸ°!)}$$</div>
</div>

<pre><code><span class="kw">import</span> numpy <span class="kw">as</span> np

<span class="kw">def</span> <span class="fn">nd</span>(f, x, h=<span class="nu">1e-7</span>):
    <span class="kw">return</span> (f(x+h) - f(x-h)) / (<span class="nu">2</span>*h)

<span class="cm"># ì˜ˆ1: d/dx e^(3xÂ²) at x=1</span>
f1 = <span class="kw">lambda</span> x: np.exp(<span class="nu">3</span>*x**<span class="nu">2</span>)
<span class="fn">print</span>(<span class="st">f"d/dx e^(3xÂ²) at x=1"</span>)
<span class="fn">print</span>(<span class="st">f"  ìˆ˜ì¹˜: </span>{nd(f1, 1):.4f}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"  í•´ì„: </span>{np.exp(3)*6:.4f}<span class="st">"</span>)  <span class="cm"># eÂ³ Ã— 6</span>

<span class="cm"># ì˜ˆ2: ë‰´ëŸ´ë„· 1ê°œ ë‰´ëŸ° â€” Ïƒ(2x + 1)</span>
sigmoid = <span class="kw">lambda</span> x: <span class="nu">1</span>/(<span class="nu">1</span>+np.exp(-x))
neuron = <span class="kw">lambda</span> x: sigmoid(<span class="nu">2</span>*x + <span class="nu">1</span>)
x = <span class="nu">0.5</span>
z = <span class="nu">2</span>*x + <span class="nu">1</span>  <span class="cm"># = 2</span>
<span class="fn">print</span>(<span class="st">f"\nd/dx Ïƒ(2x+1) at x=0.5"</span>)
<span class="fn">print</span>(<span class="st">f"  ìˆ˜ì¹˜: </span>{nd(neuron, x):.6f}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"  í•´ì„: </span>{sigmoid(z)*(1-sigmoid(z))*2:.6f}<span class="st">"</span>)  <span class="cm"># Ïƒ(2)(1-Ïƒ(2))Ã—2</span></code></pre>
<div class="code-output"><span class="out-label">Output:</span>
d/dx e^(3xÂ²) at x=1
  ìˆ˜ì¹˜: 120.5131
  í•´ì„: 120.5131

d/dx Ïƒ(2x+1) at x=0.5
  ìˆ˜ì¹˜: 0.209987
  í•´ì„: 0.209987</div>

<h3>5.2 ë‹¤ë³€ìˆ˜ ì²´ì¸ë£° â€” ì—­ì „íŒŒì˜ í•µì‹¬</h3>
<p>ë”¥ëŸ¬ë‹ì—ì„œ ì†ì‹¤í•¨ìˆ˜ \(L\)ì€ ì—¬ëŸ¬ ë ˆì´ì–´ë¥¼ ê±°ì³ ê³„ì‚°ëœë‹¤: \(L = L(y, \hat{y})\), \(\hat{y} = \sigma(z)\), \(z = wx + b\). ê° íŒŒë¼ë¯¸í„°ì— ëŒ€í•œ ë¯¸ë¶„ì€ ì²´ì¸ë£°ì„ ì—°ì‡„ì ìœ¼ë¡œ ì ìš©í•œë‹¤.</p>

<div class="eq">
$$\frac{\partial L}{\partial w} = \frac{\partial L}{\partial \hat{y}} \cdot \frac{\partial \hat{y}}{\partial z} \cdot \frac{\partial z}{\partial w}$$
</div>

<pre><code><span class="cm"># ì—­ì „íŒŒ ì‹œë®¬ë ˆì´ì…˜: 1ê°œ ë‰´ëŸ°</span>
<span class="cm"># ìˆœì „íŒŒ: z = wx + b â†’ Å· = Ïƒ(z) â†’ L = (y - Å·)Â²</span>
w, b, x, y = <span class="nu">0.5</span>, <span class="nu">0.1</span>, <span class="nu">2.0</span>, <span class="nu">1.0</span>

<span class="cm"># Forward pass</span>
z = w * x + b           <span class="cm"># 1.1</span>
y_hat = sigmoid(z)       <span class="cm"># Ïƒ(1.1) â‰ˆ 0.7503</span>
L = (y - y_hat) ** <span class="nu">2</span>    <span class="cm"># ì†ì‹¤</span>

<span class="cm"># Backward pass (ì²´ì¸ë£°!)</span>
dL_dyhat = -<span class="nu">2</span> * (y - y_hat)                    <span class="cm"># âˆ‚L/âˆ‚Å·</span>
dyhat_dz = sigmoid(z) * (<span class="nu">1</span> - sigmoid(z))       <span class="cm"># âˆ‚Å·/âˆ‚z = Ïƒ'(z)</span>
dz_dw = x                                       <span class="cm"># âˆ‚z/âˆ‚w = x</span>
dz_db = <span class="nu">1</span>                                       <span class="cm"># âˆ‚z/âˆ‚b = 1</span>

dL_dw = dL_dyhat * dyhat_dz * dz_dw  <span class="cm"># ì²´ì¸ë£°!</span>
dL_db = dL_dyhat * dyhat_dz * dz_db

<span class="fn">print</span>(<span class="st">f"z = </span>{z:.4f}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"Å· = Ïƒ(z) = </span>{y_hat:.4f}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"L = (y-Å·)Â² = </span>{L:.4f}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"\nâˆ‚L/âˆ‚w = </span>{dL_dw:.6f}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"âˆ‚L/âˆ‚b = </span>{dL_db:.6f}<span class="st">"</span>)</code></pre>
<div class="code-output"><span class="out-label">Output:</span>
z = 1.1000
Å· = Ïƒ(z) = 0.7503
L = (y-Å·)Â² = 0.0624

âˆ‚L/âˆ‚w = -0.186867
âˆ‚L/âˆ‚b = -0.093434</div>

<div class="ok">
<p class="ni"><strong>ì—­ì „íŒŒ = ì²´ì¸ë£°ì˜ ë°˜ë³µ ì ìš©:</strong> ë”¥ëŸ¬ë‹ì˜ ì—­ì „íŒŒ ì•Œê³ ë¦¬ì¦˜ì€ ê²°êµ­ ì²´ì¸ë£°ì„ ì¶œë ¥ì¸µì—ì„œ ì…ë ¥ì¸µ ë°©í–¥ìœ¼ë¡œ ë°˜ë³µ ì ìš©í•˜ëŠ” ê²ƒì´ë‹¤. ê° ë ˆì´ì–´ì—ì„œ "ë¡œì»¬ ê·¸ë˜ë””ì–¸íŠ¸"ë¥¼ ê³„ì‚°í•˜ê³ , ì´ì „ ë ˆì´ì–´ì—ì„œ ì „ë‹¬ëœ ê·¸ë˜ë””ì–¸íŠ¸ì™€ ê³±í•œë‹¤. ì´ê²ƒì´ ì „ë¶€ë‹¤.</p>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- Ch6: ì ë¶„ì˜ ì§ê´€ -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<h2 id="ch6">6. ì ë¶„ì˜ ì§ê´€</h2>

<h3>6.1 ì ë¶„ = ë¯¸ë¶„ì˜ ì—­ì—°ì‚° = ë„“ì´</h3>
<p>ë¯¸ë¶„ì´ "ìˆœê°„ ë³€í™”ìœ¨"ì´ë¼ë©´, ì ë¶„ì€ "ë³€í™”ìœ¨ì˜ ëˆ„ì "ì´ë‹¤. ê¸°í•˜í•™ì ìœ¼ë¡œ ê³¡ì„  ì•„ë˜ì˜ ë„“ì´ë‹¤.</p>

<div class="eq">
$$\int_a^b f(x)\,dx = F(b) - F(a), \quad \text{ì—¬ê¸°ì„œ } F'(x) = f(x)$$
</div>

<p>ê¸ˆìœµ ë¹„ìœ : ì¼ê°„ ìˆ˜ìµë¥  \(r(t)\)ë¥¼ ì ë¶„í•˜ë©´ ëˆ„ì  ìˆ˜ìµë¥ ì´ ëœë‹¤. ìˆœê°„ ë³€ë™ì„±ì„ ì ë¶„í•˜ë©´ ê¸°ê°„ ë³€ë™ì„±ì´ ëœë‹¤.</p>

<h3>6.2 í•µì‹¬ ì ë¶„ ê³µì‹</h3>

<div class="tc">Table 2. í•µì‹¬ ì ë¶„ ê³µì‹</div>
<table>
<tr><th>í•¨ìˆ˜</th><th>ë¶€ì •ì ë¶„</th><th>ê¸ˆìœµ í™œìš©</th></tr>
<tr><td>\(x^n\)</td><td>\(\frac{x^{n+1}}{n+1} + C\)</td><td>ë‹¤í•­ ëª¨ë¸</td></tr>
<tr><td>\(e^x\)</td><td>\(e^x + C\)</td><td>ì—°ì† ë³µë¦¬</td></tr>
<tr><td>\(\frac{1}{x}\)</td><td>\(\ln|x| + C\)</td><td>ë¡œê·¸ ìˆ˜ìµë¥ </td></tr>
<tr><td>\(e^{-x^2}\)</td><td>í•´ì„í•´ ì—†ìŒ (ìˆ˜ì¹˜ì ë¶„)</td><td>ì •ê·œë¶„í¬ CDF</td></tr>
</table>

<pre><code><span class="kw">import</span> numpy <span class="kw">as</span> np
<span class="kw">from</span> scipy <span class="kw">import</span> integrate

<span class="cm"># ìˆ˜ì¹˜ ì ë¶„: âˆ«â‚€Â¹ xÂ² dx = [xÂ³/3]â‚€Â¹ = 1/3</span>
result, error = integrate.quad(<span class="kw">lambda</span> x: x**<span class="nu">2</span>, <span class="nu">0</span>, <span class="nu">1</span>)
<span class="fn">print</span>(<span class="st">f"âˆ«â‚€Â¹ xÂ² dx = </span>{result:.6f}<span class="st"> (í•´ì„: </span>{1/3:.6f}<span class="st">)"</span>)

<span class="cm"># ì •ê·œë¶„í¬ í™•ë¥ : P(-1 < Z < 1) = âˆ«â‚‹â‚Â¹ Ï†(z) dz</span>
<span class="kw">from</span> scipy.stats <span class="kw">import</span> norm
phi = <span class="kw">lambda</span> z: norm.pdf(z)
prob, _ = integrate.quad(phi, -<span class="nu">1</span>, <span class="nu">1</span>)
<span class="fn">print</span>(<span class="st">f"P(-1 < Z < 1) = </span>{prob:.4f}<span class="st">"</span>)  <span class="cm"># â‰ˆ 0.6827 (68-95-99.7 ë²•ì¹™)</span>

<span class="cm"># ëˆ„ì  ìˆ˜ìµë¥  = ì¼ê°„ ìˆ˜ìµë¥ ì˜ ì ë¶„(í•©)</span>
daily_returns = np.array([<span class="nu">0.01</span>, -<span class="nu">0.005</span>, <span class="nu">0.02</span>, -<span class="nu">0.01</span>, <span class="nu">0.015</span>])
cumulative = np.cumsum(daily_returns)
<span class="fn">print</span>(<span class="st">f"\nì¼ê°„ ìˆ˜ìµë¥ : </span>{daily_returns}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"ëˆ„ì  ìˆ˜ìµë¥ : </span>{cumulative}<span class="st">"</span>)</code></pre>
<div class="code-output"><span class="out-label">Output:</span>
âˆ«â‚€Â¹ xÂ² dx = 0.333333 (í•´ì„: 0.333333)
P(-1 < Z < 1) = 0.6827
ì¼ê°„ ìˆ˜ìµë¥ : [ 0.01  -0.005  0.02  -0.01   0.015]
ëˆ„ì  ìˆ˜ìµë¥ : [0.01  0.005 0.025 0.015 0.03 ]</div>

<!-- â–¼ Plotly: ì ë¶„ = ë„“ì´ ì‹œê°í™” -->
<div id="plot-ch6-integral" style="width:100%;height:400px;margin:25px 0"></div>
<script>
(function(){
  var xs=[],ys=[],fx=[],fy=[];
  for(var x=0;x<=3;x+=0.02){xs.push(x);ys.push(x*x);}
  // ì ë¶„ ì˜ì—­ (0~2)
  fx.push(0);fy.push(0);
  for(var x=0;x<=2;x+=0.02){fx.push(x);fy.push(x*x);}
  fx.push(2);fy.push(0);
  Plotly.newPlot('plot-ch6-integral',[
    {x:fx,y:fy,fill:'toself',fillcolor:'rgba(30,136,229,0.3)',line:{color:'transparent'},name:'âˆ«â‚€Â² xÂ² dx = 8/3',showlegend:true},
    {x:xs,y:ys,mode:'lines',name:'f(x) = xÂ²',line:{width:3,color:'#1e88e5'}}
  ],{
    title:{text:'ğŸ“ ì ë¶„ = ê³¡ì„  ì•„ë˜ ë„“ì´: âˆ«â‚€Â² xÂ² dx = 8/3 â‰ˆ 2.667',font:{size:13}},
    xaxis:{title:'x',range:[-0.5,3.5],zeroline:true,zerolinewidth:2},
    yaxis:{title:'f(x)',range:[-0.5,9],zeroline:true,zerolinewidth:2},
    margin:{l:50,r:20,t:45,b:40},
    legend:{x:0.02,y:0.98}
  },{responsive:true});
})();
</script>
<p class="ni" style="font-size:11px;color:#888;text-align:center;margin-top:-10px">ğŸ–±ï¸ íŒŒë€ ì˜ì—­ì˜ ë„“ì´ = âˆ«â‚€Â² xÂ² dx = [xÂ³/3]â‚€Â² = 8/3 â‰ˆ 2.667</p>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- Ch7: í…Œì¼ëŸ¬ ê¸‰ìˆ˜ -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<h2 id="ch7">7. í…Œì¼ëŸ¬ ê¸‰ìˆ˜ (Taylor Series)</h2>

<h3>7.1 ì–´ë–¤ í•¨ìˆ˜ë“  ë‹¤í•­ì‹ìœ¼ë¡œ ê·¼ì‚¬í•  ìˆ˜ ìˆë‹¤</h3>
<p>í…Œì¼ëŸ¬ ê¸‰ìˆ˜ëŠ” ë³µì¡í•œ í•¨ìˆ˜ë¥¼ ë‹¤í•­ì‹ìœ¼ë¡œ ê·¼ì‚¬í•˜ëŠ” ë„êµ¬ë‹¤. ì  \(a\) ê·¼ì²˜ì—ì„œ:</p>

<div class="eq">
$$f(x) \approx f(a) + f'(a)(x-a) + \frac{f''(a)}{2!}(x-a)^2 + \frac{f'''(a)}{3!}(x-a)^3 + \cdots$$
</div>

<p>íŠ¹íˆ \(a = 0\)ì¼ ë•Œ ë§¤í´ë¡œë¦° ê¸‰ìˆ˜ë¼ í•œë‹¤:</p>

<div class="eq">
$$e^x = 1 + x + \frac{x^2}{2!} + \frac{x^3}{3!} + \cdots, \quad \sin x = x - \frac{x^3}{3!} + \frac{x^5}{5!} - \cdots$$
</div>

<p>ê¸ˆìœµì—ì„œì˜ í™œìš©: ì˜µì…˜ ê°€ê²©ì˜ ê·¸ë¦­ìŠ¤(Greeks)ëŠ” í…Œì¼ëŸ¬ ì „ê°œì˜ ê° í•­ì´ë‹¤. ë¸íƒ€(Î”)ëŠ” 1ì°¨ í•­, ê°ë§ˆ(Î“)ëŠ” 2ì°¨ í•­ì´ë‹¤.</p>

<pre><code><span class="kw">import</span> numpy <span class="kw">as</span> np
<span class="kw">import</span> math

<span class="cm"># e^xì˜ í…Œì¼ëŸ¬ ê·¼ì‚¬ (nì°¨ê¹Œì§€)</span>
<span class="kw">def</span> <span class="fn">taylor_exp</span>(x, n):
    <span class="kw">return</span> <span class="fn">sum</span>(x**k / math.factorial(k) <span class="kw">for</span> k <span class="kw">in</span> <span class="fn">range</span>(n+<span class="nu">1</span>))

x = <span class="nu">1.0</span>
<span class="fn">print</span>(<span class="st">f"e^1 ì •í™•ê°’: </span>{np.exp(1):.10f}<span class="st">"</span>)
<span class="kw">for</span> n <span class="kw">in</span> [<span class="nu">1</span>, <span class="nu">2</span>, <span class="nu">3</span>, <span class="nu">5</span>, <span class="nu">10</span>]:
    approx = taylor_exp(x, n)
    error = <span class="fn">abs</span>(approx - np.exp(<span class="nu">1</span>))
    <span class="fn">print</span>(<span class="st">f"  {n:2d}ì°¨ ê·¼ì‚¬: </span>{approx:.10f}<span class="st">  ì˜¤ì°¨: </span>{error:.2e}<span class="st">"</span>)</code></pre>
<div class="code-output"><span class="out-label">Output:</span>
e^1 ì •í™•ê°’: 2.7182818285
   1ì°¨ ê·¼ì‚¬: 2.0000000000  ì˜¤ì°¨: 7.18e-01
   2ì°¨ ê·¼ì‚¬: 2.5000000000  ì˜¤ì°¨: 2.18e-01
   3ì°¨ ê·¼ì‚¬: 2.6666666667  ì˜¤ì°¨: 5.16e-02
   5ì°¨ ê·¼ì‚¬: 2.7166666667  ì˜¤ì°¨: 1.62e-03
  10ì°¨ ê·¼ì‚¬: 2.7182818011  ì˜¤ì°¨: 2.73e-08</div>

<!-- â–¼ Plotly: í…Œì¼ëŸ¬ ê·¼ì‚¬ ì‹œê°í™” -->
<div id="plot-ch7-taylor" style="width:100%;height:420px;margin:25px 0"></div>
<script>
(function(){
  function factorial(n){var r=1;for(var i=2;i<=n;i++)r*=i;return r;}
  function taylorSin(x,n){var s=0;for(var k=0;k<=n;k++){var p=2*k+1;s+=Math.pow(-1,k)*Math.pow(x,p)/factorial(p);}return s;}
  var xs=[],exact=[],t1=[],t3=[],t5=[],t9=[];
  for(var x=-8;x<=8;x+=0.05){
    xs.push(x);exact.push(Math.sin(x));
    t1.push(taylorSin(x,0));t3.push(taylorSin(x,1));
    t5.push(taylorSin(x,2));t9.push(taylorSin(x,4));
  }
  Plotly.newPlot('plot-ch7-taylor',[
    {x:xs,y:exact,mode:'lines',name:'sin(x) ì •í™•ê°’',line:{width:3,color:'#333'}},
    {x:xs,y:t1,mode:'lines',name:'1ì°¨ (x)',line:{width:2,color:'#e53935',dash:'dot'}},
    {x:xs,y:t3,mode:'lines',name:'3ì°¨ (x - xÂ³/6)',line:{width:2,color:'#ff9800',dash:'dash'}},
    {x:xs,y:t5,mode:'lines',name:'5ì°¨',line:{width:2,color:'#43a047',dash:'dashdot'}},
    {x:xs,y:t9,mode:'lines',name:'9ì°¨',line:{width:2,color:'#1e88e5'}}
  ],{
    title:{text:'ğŸ”¬ sin(x)ì˜ í…Œì¼ëŸ¬ ê·¼ì‚¬: ì°¨ìˆ˜ê°€ ë†’ì„ìˆ˜ë¡ ì •í™•',font:{size:13}},
    xaxis:{title:'x',range:[-8,8]},
    yaxis:{title:'y',range:[-3,3]},
    margin:{l:50,r:20,t:45,b:40},
    legend:{x:0.02,y:0.98,bgcolor:'rgba(255,255,255,0.8)'}
  },{responsive:true});
})();
</script>
<p class="ni" style="font-size:11px;color:#888;text-align:center;margin-top:-10px">ğŸ–±ï¸ ì°¨ìˆ˜ê°€ ë†’ì•„ì§ˆìˆ˜ë¡ ê·¼ì‚¬ê°€ ì •í™•í•´ì§„ë‹¤. 9ì°¨ë©´ -6~6 ë²”ìœ„ì—ì„œ ê±°ì˜ ì™„ë²½</p>

<div class="info">
<p class="ni"><strong>í…Œì¼ëŸ¬ ê¸‰ìˆ˜ì™€ ML:</strong> ë‰´ëŸ´ë„·ì˜ ë³´í¸ ê·¼ì‚¬ ì •ë¦¬(Universal Approximation Theorem)ëŠ” "ì¶©ë¶„íˆ ë„“ì€ ë„¤íŠ¸ì›Œí¬ëŠ” ì–´ë–¤ ì—°ì†í•¨ìˆ˜ë“  ê·¼ì‚¬í•  ìˆ˜ ìˆë‹¤"ëŠ” ê²ƒì´ë‹¤. í…Œì¼ëŸ¬ ê¸‰ìˆ˜ê°€ ë‹¤í•­ì‹ìœ¼ë¡œ í•¨ìˆ˜ë¥¼ ê·¼ì‚¬í•˜ë“¯, ë‰´ëŸ´ë„·ì€ í™œì„±í™” í•¨ìˆ˜ì˜ ì¡°í•©ìœ¼ë¡œ í•¨ìˆ˜ë¥¼ ê·¼ì‚¬í•œë‹¤.</p>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- Ch8: ê²½ì‚¬í•˜ê°•ë²• -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<h2 id="ch8">8. ê²½ì‚¬í•˜ê°•ë²• (Gradient Descent)</h2>

<h3>8.1 ìµœì í™” ë¬¸ì œ</h3>
<p>MLì˜ í•µì‹¬ì€ ìµœì í™”ë‹¤: ì†ì‹¤í•¨ìˆ˜ \(L(\theta)\)ë¥¼ ìµœì†Œí™”í•˜ëŠ” íŒŒë¼ë¯¸í„° \(\theta\)ë¥¼ ì°¾ëŠ” ê²ƒ. ê²½ì‚¬í•˜ê°•ë²•ì€ ê·¸ë˜ë””ì–¸íŠ¸ì˜ ë°˜ëŒ€ ë°©í–¥ìœ¼ë¡œ ì¡°ê¸ˆì”© ì´ë™í•˜ì—¬ ìµœì†Ÿê°’ì„ ì°¾ëŠ” ì•Œê³ ë¦¬ì¦˜ì´ë‹¤.</p>

<div class="eq">
$$\theta_{t+1} = \theta_t - \alpha \nabla L(\theta_t)$$
</div>

<div class="def">
<p class="ni"><strong>ê²½ì‚¬í•˜ê°•ë²•ì˜ êµ¬ì„±ìš”ì†Œ:</strong></p>
<ul>
<li>\(\theta_t\): í˜„ì¬ íŒŒë¼ë¯¸í„° ê°’</li>
<li>\(\alpha\): í•™ìŠµë¥  (learning rate) â€” í•œ ë²ˆì— ì–¼ë§ˆë‚˜ ì´ë™í• ì§€</li>
<li>\(\nabla L(\theta_t)\): í˜„ì¬ ìœ„ì¹˜ì—ì„œì˜ ê·¸ë˜ë””ì–¸íŠ¸ â€” ì–´ëŠ ë°©í–¥ìœ¼ë¡œ ì´ë™í• ì§€</li>
<li>\(\theta_{t+1}\): ì—…ë°ì´íŠ¸ëœ íŒŒë¼ë¯¸í„°</li>
</ul>
<p class="ni">ë¹„ìœ : ì•ˆê°œ ë‚€ ì‚°ì—ì„œ ê°€ì¥ ë‚®ì€ ê³³ì„ ì°¾ìœ¼ë ¤ë©´? ë°œë°‘ì˜ ê²½ì‚¬(ê·¸ë˜ë””ì–¸íŠ¸)ë¥¼ ëŠë¼ê³ , ë‚´ë¦¬ë§‰ ë°©í–¥ìœ¼ë¡œ í•œ ê±¸ìŒì”© ë‚´ë ¤ê°„ë‹¤.</p>
</div>

<h3>8.2 1D ê²½ì‚¬í•˜ê°•ë²• êµ¬í˜„</h3>
<pre><code><span class="kw">import</span> numpy <span class="kw">as</span> np

<span class="cm"># ëª©ì í•¨ìˆ˜: f(x) = (x-3)Â² + 2  â†’ ìµœì†Ÿê°’ì€ x=3ì—ì„œ f=2</span>
f = <span class="kw">lambda</span> x: (x - <span class="nu">3</span>)**<span class="nu">2</span> + <span class="nu">2</span>
df = <span class="kw">lambda</span> x: <span class="nu">2</span> * (x - <span class="nu">3</span>)  <span class="cm"># ë„í•¨ìˆ˜</span>

<span class="cm"># ê²½ì‚¬í•˜ê°•ë²•</span>
x = <span class="nu">10.0</span>          <span class="cm"># ì‹œì‘ì </span>
lr = <span class="nu">0.1</span>          <span class="cm"># í•™ìŠµë¥ </span>
history = [x]

<span class="kw">for</span> i <span class="kw">in</span> <span class="fn">range</span>(<span class="nu">30</span>):
    grad = df(x)
    x = x - lr * grad  <span class="cm"># ì—…ë°ì´íŠ¸!</span>
    history.append(x)
    <span class="kw">if</span> i < <span class="nu">5</span> <span class="kw">or</span> i % <span class="nu">10</span> == <span class="nu">9</span>:
        <span class="fn">print</span>(<span class="st">f"Step </span>{i+1:2d}<span class="st">: x = </span>{x:.6f}<span class="st">, f(x) = </span>{f(x):.6f}<span class="st">, grad = </span>{grad:.4f}<span class="st">"</span>)

<span class="fn">print</span>(<span class="st">f"\nìµœì¢…: x = </span>{x:.6f}<span class="st"> (ì •ë‹µ: 3.0)"</span>)</code></pre>
<div class="code-output"><span class="out-label">Output:</span>
Step  1: x = 8.600000, f(x) = 33.360000, grad = 14.0000
Step  2: x = 7.480000, f(x) = 22.070400, grad = 11.2000
Step  3: x = 6.584000, f(x) = 14.852256, grad = 8.9600
Step  4: x = 5.867200, f(x) = 10.225444, grad = 7.1680
Step  5: x = 5.293760, f(x) = 7.264284, grad = 5.7344
Step 10: x = 3.440729, f(x) = 2.194243, grad = 1.1018
Step 20: x = 3.003623, f(x) = 2.000013, grad = 0.0090
Step 30: x = 3.000003, f(x) = 2.000000, grad = 0.0000

ìµœì¢…: x = 3.000003 (ì •ë‹µ: 3.0)</div>

<!-- â–¼ Plotly: ê²½ì‚¬í•˜ê°•ë²• ì• ë‹ˆë©”ì´ì…˜ -->
<div id="plot-ch8-gd" style="width:100%;height:420px;margin:25px 0"></div>
<script>
(function(){
  var xs=[],ys=[];
  for(var x=-1;x<=11;x+=0.05){xs.push(x);ys.push((x-3)*(x-3)+2);}
  // GD ê²½ë¡œ
  var gx=[10],gy=[(10-3)*(10-3)+2];
  var cx=10,lr=0.1;
  for(var i=0;i<30;i++){
    var g=2*(cx-3);cx=cx-lr*g;
    gx.push(cx);gy.push((cx-3)*(cx-3)+2);
  }
  Plotly.newPlot('plot-ch8-gd',[
    {x:xs,y:ys,mode:'lines',name:'f(x) = (x-3)Â²+2',line:{width:3,color:'#1e88e5'}},
    {x:gx,y:gy,mode:'lines+markers',name:'ê²½ì‚¬í•˜ê°•ë²• ê²½ë¡œ',
     line:{width:2,color:'#e53935'},marker:{size:5,color:'#e53935'}},
    {x:[3],y:[2],mode:'markers',name:'ìµœì†Ÿê°’ (3, 2)',
     marker:{size:14,color:'#43a047',symbol:'star'}}
  ],{
    title:{text:'â›°ï¸ ê²½ì‚¬í•˜ê°•ë²•: x=10ì—ì„œ ì¶œë°œ â†’ x=3ìœ¼ë¡œ ìˆ˜ë ´',font:{size:13}},
    xaxis:{title:'x',range:[-1,11]},
    yaxis:{title:'f(x)',range:[0,55]},
    margin:{l:50,r:20,t:45,b:40},
    legend:{x:0.5,y:0.98}
  },{responsive:true});
})();
</script>
<p class="ni" style="font-size:11px;color:#888;text-align:center;margin-top:-10px">ğŸ–±ï¸ ë¹¨ê°„ ì ì´ x=10ì—ì„œ ì¶œë°œí•˜ì—¬ ìµœì†Ÿê°’ x=3ìœ¼ë¡œ ìˆ˜ë ´í•˜ëŠ” ê³¼ì •. ì²˜ìŒì—” í° ë³´í­, ì ì  ì‘ì•„ì§„ë‹¤</p>

<h3>8.3 í•™ìŠµë¥ ì˜ ì¤‘ìš”ì„±</h3>

<div class="warn">
<p class="ni"><strong>í•™ìŠµë¥ (Î±)ì´ ë„ˆë¬´ í¬ë©´:</strong> ìµœì†Ÿê°’ì„ ì§€ë‚˜ì³ì„œ ë°œì‚°í•œë‹¤. ì‚°ì—ì„œ ë„ˆë¬´ í° ë³´í­ìœ¼ë¡œ ë›°ë©´ ë°˜ëŒ€í¸ ì ˆë²½ìœ¼ë¡œ ë‚ ì•„ê°„ë‹¤.</p>
<p class="ni"><strong>í•™ìŠµë¥ ì´ ë„ˆë¬´ ì‘ìœ¼ë©´:</strong> ìˆ˜ë ´ì´ ë„ˆë¬´ ëŠë¦¬ë‹¤. ê°œë¯¸ ê±¸ìŒìœ¼ë¡œ ì‚°ì„ ë‚´ë ¤ê°€ëŠ” ê²©.</p>
<p class="ni"><strong>ì ì ˆí•œ í•™ìŠµë¥ :</strong> ë³´í†µ 0.001~0.01ì—ì„œ ì‹œì‘. Adam ê°™ì€ ì ì‘í˜• ì˜µí‹°ë§ˆì´ì €ëŠ” í•™ìŠµë¥ ì„ ìë™ ì¡°ì ˆí•œë‹¤.</p>
</div>

<!-- â–¼ Plotly: í•™ìŠµë¥  ë¹„êµ -->
<div id="plot-ch8-lr" style="width:100%;height:400px;margin:25px 0"></div>
<script>
(function(){
  function gd(lr,steps){
    var x=10,path=[x];
    for(var i=0;i<steps;i++){x=x-lr*2*(x-3);path.push(x);}
    return path;
  }
  var steps=Array.from({length:31},function(_,i){return i;});
  var p1=gd(0.01,30),p2=gd(0.1,30),p3=gd(0.5,30),p4=gd(0.95,30);
  Plotly.newPlot('plot-ch8-lr',[
    {x:steps,y:p1,mode:'lines+markers',name:'Î±=0.01 (ëŠë¦¼)',line:{width:2},marker:{size:3}},
    {x:steps,y:p2,mode:'lines+markers',name:'Î±=0.1 (ì ì ˆ)',line:{width:2},marker:{size:3}},
    {x:steps,y:p3,mode:'lines+markers',name:'Î±=0.5 (ë¹ ë¦„)',line:{width:2},marker:{size:3}},
    {x:steps,y:p4,mode:'lines+markers',name:'Î±=0.95 (ì§„ë™)',line:{width:2,color:'#e53935'},marker:{size:3}}
  ],{
    title:{text:'ğŸ“‰ í•™ìŠµë¥ ì— ë”°ë¥¸ ìˆ˜ë ´ ì†ë„ ë¹„êµ',font:{size:13}},
    xaxis:{title:'Step'},
    yaxis:{title:'x ê°’',zeroline:true},
    margin:{l:50,r:20,t:45,b:40},
    legend:{x:0.5,y:0.98},
    shapes:[{type:'line',x0:0,x1:30,y0:3,y1:3,line:{color:'#43a047',dash:'dot',width:2}}],
    annotations:[{x:25,y:3.5,text:'ì •ë‹µ x=3',showarrow:false,font:{size:10,color:'#43a047'}}]
  },{responsive:true});
})();
</script>
<p class="ni" style="font-size:11px;color:#888;text-align:center;margin-top:-10px">ğŸ–±ï¸ Î±=0.01ì€ 30ìŠ¤í… í›„ì—ë„ ë©€ê³ , Î±=0.1ì€ ì ì ˆíˆ ìˆ˜ë ´, Î±=0.95ëŠ” ì§„ë™í•˜ë©° ë¶ˆì•ˆì •</p>

<h3>8.4 2D ê²½ì‚¬í•˜ê°•ë²•</h3>
<pre><code><span class="cm"># 2D ê²½ì‚¬í•˜ê°•ë²•: f(x,y) = xÂ² + 2yÂ² (íƒ€ì›í˜• ë“±ê³ ì„ )</span>
f2d = <span class="kw">lambda</span> x, y: x**<span class="nu">2</span> + <span class="nu">2</span>*y**<span class="nu">2</span>
grad_f = <span class="kw">lambda</span> x, y: np.array([<span class="nu">2</span>*x, <span class="nu">4</span>*y])

pos = np.array([<span class="nu">4.0</span>, <span class="nu">3.0</span>])  <span class="cm"># ì‹œì‘ì </span>
lr = <span class="nu">0.1</span>
path = [pos.copy()]

<span class="kw">for</span> i <span class="kw">in</span> <span class="fn">range</span>(<span class="nu">30</span>):
    g = grad_f(pos[<span class="nu">0</span>], pos[<span class="nu">1</span>])
    pos = pos - lr * g
    path.append(pos.copy())

path = np.array(path)
<span class="fn">print</span>(<span class="st">f"ì‹œì‘: ({path[0,0]:.2f}, {path[0,1]:.2f}), f = {f2d(*path[0]):.2f}"</span>)
<span class="fn">print</span>(<span class="st">f"ìµœì¢…: ({path[-1,0]:.4f}, {path[-1,1]:.4f}), f = {f2d(*path[-1]):.6f}"</span>)</code></pre>
<div class="code-output"><span class="out-label">Output:</span>
ì‹œì‘: (4.00, 3.00), f = 34.00
ìµœì¢…: (0.0048, 0.0000), f = 0.000023</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- ì—°ìŠµë¬¸ì œ 8 -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="problem-box">
<div class="problem-title">âœï¸ ì—°ìŠµë¬¸ì œ 8.1</div>
<p class="ni">í•¨ìˆ˜ \(f(x) = x^4 - 4x^2 + 5\)ì— ëŒ€í•´:</p>
<ol>
<li>\(f'(x)\)ë¥¼ êµ¬í•˜ë¼.</li>
<li>ê·¹ê°’(ê·¹ëŒ€/ê·¹ì†Œ)ì„ ëª¨ë‘ êµ¬í•˜ë¼.</li>
<li>\(x = 3\)ì—ì„œ ì‹œì‘í•˜ì—¬ í•™ìŠµë¥  0.01ë¡œ ê²½ì‚¬í•˜ê°•ë²•ì„ 50ìŠ¤í… ì‹¤í–‰í•˜ë¼. ì–´ëŠ ê·¹ì†Œë¡œ ìˆ˜ë ´í•˜ëŠ”ê°€?</li>
<li>\(x = 0.1\)ì—ì„œ ì‹œì‘í•˜ë©´ ì–´ë””ë¡œ ìˆ˜ë ´í•˜ëŠ”ê°€? ì™œ ë‹¤ë¥¸ ê²°ê³¼ê°€ ë‚˜ì˜¤ëŠ”ê°€?</li>
</ol>
</div>

<details>
<summary>ğŸ”‘ í’€ì´ ë³´ê¸°</summary>
<div class="answer-content">
<p class="ni"><strong>1)</strong> \(f'(x) = 4x^3 - 8x\)</p>

<p class="ni"><strong>2)</strong> \(f'(x) = 0 \Rightarrow 4x(x^2 - 2) = 0 \Rightarrow x = 0, \pm\sqrt{2}\)</p>
<ul>
<li>\(x = 0\): \(f''(0) = -8 < 0\) â†’ ê·¹ëŒ€ (f=5)</li>
<li>\(x = \pm\sqrt{2}\): \(f''(\pm\sqrt{2}) = 16 > 0\) â†’ ê·¹ì†Œ (f=1)</li>
</ul>

<p class="ni"><strong>3-4)</strong></p>
<pre><code>f = <span class="kw">lambda</span> x: x**<span class="nu">4</span> - <span class="nu">4</span>*x**<span class="nu">2</span> + <span class="nu">5</span>
df = <span class="kw">lambda</span> x: <span class="nu">4</span>*x**<span class="nu">3</span> - <span class="nu">8</span>*x

<span class="kw">for</span> x0 <span class="kw">in</span> [<span class="nu">3.0</span>, <span class="nu">0.1</span>]:
    x = x0
    <span class="kw">for</span> _ <span class="kw">in</span> <span class="fn">range</span>(<span class="nu">500</span>):
        x = x - <span class="nu">0.01</span> * df(x)
    <span class="fn">print</span>(<span class="st">f"xâ‚€={x0} â†’ x={x:.4f}, f(x)={f(x):.4f}"</span>)
<span class="cm"># xâ‚€=3.0 â†’ x=1.4142 (âˆš2), f=1.0  (ì˜¤ë¥¸ìª½ ê·¹ì†Œ)</span>
<span class="cm"># xâ‚€=0.1 â†’ x=1.4142 (âˆš2), f=1.0  (ê°€ê¹Œìš´ ê·¹ì†Œë¡œ)</span></code></pre>
<p class="ni">ì‹œì‘ì ì— ë”°ë¼ ë‹¤ë¥¸ ê·¹ì†Œë¡œ ìˆ˜ë ´í•  ìˆ˜ ìˆë‹¤. ì´ê²ƒì´ ë¹„ë³¼ë¡(non-convex) ìµœì í™”ì˜ í•µì‹¬ ë¬¸ì œë‹¤. ë”¥ëŸ¬ë‹ì—ì„œ ëœë¤ ì´ˆê¸°í™”ë¥¼ ì—¬ëŸ¬ ë²ˆ í•˜ëŠ” ì´ìœ .</p>
</div>
</details>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- Ch9: ê¸ˆìœµì—ì„œì˜ ë¯¸ì ë¶„ -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<h2 id="ch9">9. ê¸ˆìœµì—ì„œì˜ ë¯¸ì ë¶„ â€” ì‹¤ì „ ì‘ìš©</h2>

<h3>9.1 ì—°ì† ë³µë¦¬ì™€ ë¡œê·¸ ìˆ˜ìµë¥ </h3>
<p>ì´ì‚° ë³µë¦¬ \(P(1+r)^t\)ì—ì„œ ë³µë¦¬ ì£¼ê¸°ë¥¼ ë¬´í•œíˆ ì§§ê²Œ í•˜ë©´ ì—°ì† ë³µë¦¬ê°€ ëœë‹¤:</p>

<div class="eq">
$$\lim_{n \to \infty} P\left(1 + \frac{r}{n}\right)^{nt} = Pe^{rt}$$
</div>

<p>ë¡œê·¸ ìˆ˜ìµë¥ (ì—°ì† ìˆ˜ìµë¥ )ì€ ê°€ê²©ì˜ ë¡œê·¸ ì°¨ë¶„ì´ë‹¤:</p>

<div class="eq">
$$r_{\text{log}} = \ln\frac{P_t}{P_{t-1}} = \ln P_t - \ln P_{t-1}$$
</div>

<pre><code><span class="kw">import</span> numpy <span class="kw">as</span> np

<span class="cm"># ì´ì‚° ë³µë¦¬ vs ì—°ì† ë³µë¦¬</span>
P, r, t = <span class="nu">10000000</span>, <span class="nu">0.05</span>, <span class="nu">10</span>
discrete = P * (<span class="nu">1</span> + r)**t
continuous = P * np.exp(r * t)
<span class="fn">print</span>(<span class="st">f"ì´ì‚° ë³µë¦¬:  </span>{discrete:,.0f}<span class="st">ì›"</span>)
<span class="fn">print</span>(<span class="st">f"ì—°ì† ë³µë¦¬:  </span>{continuous:,.0f}<span class="st">ì›"</span>)
<span class="fn">print</span>(<span class="st">f"ì°¨ì´:       </span>{continuous-discrete:,.0f}<span class="st">ì›"</span>)

<span class="cm"># ë¡œê·¸ ìˆ˜ìµë¥  vs ë‹¨ìˆœ ìˆ˜ìµë¥ </span>
prices = np.array([<span class="nu">100</span>, <span class="nu">105</span>, <span class="nu">102</span>, <span class="nu">110</span>, <span class="nu">108</span>])
simple_ret = np.diff(prices) / prices[:-<span class="nu">1</span>]
log_ret = np.diff(np.log(prices))

<span class="fn">print</span>(<span class="st">f"\në‹¨ìˆœ ìˆ˜ìµë¥ : </span>{simple_ret}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"ë¡œê·¸ ìˆ˜ìµë¥ : </span>{log_ret}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"\në¡œê·¸ ìˆ˜ìµë¥  í•© = </span>{log_ret.sum():.4f}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"ln(108/100)  = </span>{np.log(108/100):.4f}<span class="st">"</span>)  <span class="cm"># ê°™ë‹¤! (ì‹œê°„ ê°€ì‚°ì„±)</span></code></pre>
<div class="code-output"><span class="out-label">Output:</span>
ì´ì‚° ë³µë¦¬:  16,288,946ì›
ì—°ì† ë³µë¦¬:  16,487,213ì›
ì°¨ì´:       198,267ì›

ë‹¨ìˆœ ìˆ˜ìµë¥ : [ 0.05   -0.0286  0.0784 -0.0182]
ë¡œê·¸ ìˆ˜ìµë¥ : [ 0.0488 -0.029   0.0755 -0.0183]

ë¡œê·¸ ìˆ˜ìµë¥  í•© = 0.0770
ln(108/100)  = 0.0770</div>

<div class="ok">
<p class="ni"><strong>ë¡œê·¸ ìˆ˜ìµë¥ ì˜ ì¥ì :</strong> ë¡œê·¸ ìˆ˜ìµë¥ ì€ ì‹œê°„ì— ëŒ€í•´ ê°€ì‚°ì (additive)ì´ë‹¤. 5ì¼ê°„ì˜ ë¡œê·¸ ìˆ˜ìµë¥ ì„ ë”í•˜ë©´ 5ì¼ê°„ì˜ ì´ ë¡œê·¸ ìˆ˜ìµë¥ ì´ ëœë‹¤. ë‹¨ìˆœ ìˆ˜ìµë¥ ì€ ì´ ì„±ì§ˆì´ ì—†ë‹¤. ì´ê²ƒì´ ê¸ˆìœµ ëª¨ë¸ë§ì—ì„œ ë¡œê·¸ ìˆ˜ìµë¥ ì„ ì„ í˜¸í•˜ëŠ” ì´ìœ ë‹¤.</p>
</div>

<h3>9.2 ë“€ë ˆì´ì…˜ â€” ì±„ê¶Œ ê°€ê²©ì˜ ë¯¸ë¶„</h3>
<p>ì±„ê¶Œ ê°€ê²© \(P\)ëŠ” ê¸ˆë¦¬ \(y\)ì˜ í•¨ìˆ˜ë‹¤. ë“€ë ˆì´ì…˜(duration)ì€ ì±„ê¶Œ ê°€ê²©ì˜ ê¸ˆë¦¬ ë¯¼ê°ë„, ì¦‰ ë¯¸ë¶„ì´ë‹¤:</p>

<div class="eq">
$$D = -\frac{1}{P}\frac{dP}{dy} \quad \Rightarrow \quad \Delta P \approx -D \cdot P \cdot \Delta y$$
</div>

<p>ê¸ˆë¦¬ê°€ 1% ì˜¤ë¥´ë©´ ë“€ë ˆì´ì…˜ 5ë…„ì¸ ì±„ê¶Œì˜ ê°€ê²©ì€ ì•½ 5% í•˜ë½í•œë‹¤.</p>

<pre><code><span class="cm"># ì±„ê¶Œ ê°€ê²©ê³¼ ë“€ë ˆì´ì…˜</span>
<span class="kw">def</span> <span class="fn">bond_price</span>(face, coupon_rate, ytm, years):
    <span class="st">"""ì±„ê¶Œ ê°€ê²© ê³„ì‚°"""</span>
    coupon = face * coupon_rate
    price = <span class="fn">sum</span>(coupon / (<span class="nu">1</span>+ytm)**t <span class="kw">for</span> t <span class="kw">in</span> <span class="fn">range</span>(<span class="nu">1</span>, years+<span class="nu">1</span>))
    price += face / (<span class="nu">1</span>+ytm)**years
    <span class="kw">return</span> price

face = <span class="nu">10000</span>  <span class="cm"># ì•¡ë©´ê°€</span>
coupon = <span class="nu">0.03</span>  <span class="cm"># ì¿ í° 3%</span>
ytm = <span class="nu">0.04</span>     <span class="cm"># ì‹œì¥ ê¸ˆë¦¬ 4%</span>
years = <span class="nu">5</span>

P = bond_price(face, coupon, ytm, years)
<span class="fn">print</span>(<span class="st">f"ì±„ê¶Œ ê°€ê²©: </span>{P:,.2f}<span class="st">ì›"</span>)

<span class="cm"># ìˆ˜ì¹˜ ë¯¸ë¶„ìœ¼ë¡œ ë“€ë ˆì´ì…˜ ê³„ì‚°</span>
h = <span class="nu">0.0001</span>
dP_dy = (bond_price(face, coupon, ytm+h, years) - bond_price(face, coupon, ytm-h, years)) / (<span class="nu">2</span>*h)
duration = -dP_dy / P
<span class="fn">print</span>(<span class="st">f"ë“€ë ˆì´ì…˜: </span>{duration:.4f}<span class="st">ë…„"</span>)
<span class="fn">print</span>(<span class="st">f"\nê¸ˆë¦¬ 1%â†‘ ì‹œ ê°€ê²© ë³€í™”: </span>{-duration * P * 0.01:,.2f}<span class="st">ì› (</span>{-duration*0.01:.2%}<span class="st">)"</span>)</code></pre>
<div class="code-output"><span class="out-label">Output:</span>
ì±„ê¶Œ ê°€ê²©: 9,554.42ì›
ë“€ë ˆì´ì…˜: 4.6299ë…„

ê¸ˆë¦¬ 1%â†‘ ì‹œ ê°€ê²© ë³€í™”: -442.44ì› (-4.63%)</div>

<h3>9.3 ì˜µì…˜ ê·¸ë¦­ìŠ¤ â€” í¸ë¯¸ë¶„ì˜ ê¸ˆìœµ ì‘ìš©</h3>
<p>ì˜µì…˜ ê°€ê²© \(C\)ëŠ” ê¸°ì´ˆìì‚° ê°€ê²© \(S\), ì‹œê°„ \(t\), ë³€ë™ì„± \(\sigma\) ë“± ì—¬ëŸ¬ ë³€ìˆ˜ì˜ í•¨ìˆ˜ë‹¤. ê° ë³€ìˆ˜ì— ëŒ€í•œ í¸ë¯¸ë¶„ì´ ê·¸ë¦­ìŠ¤(Greeks)ë‹¤:</p>

<div class="tc">Table 3. ì˜µì…˜ ê·¸ë¦­ìŠ¤ = í¸ë¯¸ë¶„</div>
<table>
<tr><th>ê·¸ë¦­</th><th>ì •ì˜</th><th>ì˜ë¯¸</th><th>í…Œì¼ëŸ¬ ê¸‰ìˆ˜ í•­</th></tr>
<tr><td>ë¸íƒ€ (Î”)</td><td>\(\frac{\partial C}{\partial S}\)</td><td>ê¸°ì´ˆìì‚° ê°€ê²© ë³€í™”ì— ëŒ€í•œ ë¯¼ê°ë„</td><td>1ì°¨ í•­</td></tr>
<tr><td>ê°ë§ˆ (Î“)</td><td>\(\frac{\partial^2 C}{\partial S^2}\)</td><td>ë¸íƒ€ì˜ ë³€í™”ìœ¨ (2ì°¨ ë¯¸ë¶„)</td><td>2ì°¨ í•­</td></tr>
<tr><td>ì„¸íƒ€ (Î˜)</td><td>\(\frac{\partial C}{\partial t}\)</td><td>ì‹œê°„ ê²½ê³¼ì— ë”°ë¥¸ ê°€ì¹˜ ê°ì†Œ</td><td>ì‹œê°„ í•­</td></tr>
<tr><td>ë² ê°€ (Î½)</td><td>\(\frac{\partial C}{\partial \sigma}\)</td><td>ë³€ë™ì„± ë³€í™”ì— ëŒ€í•œ ë¯¼ê°ë„</td><td>ë³€ë™ì„± í•­</td></tr>
<tr><td>ë¡œ (Ï)</td><td>\(\frac{\partial C}{\partial r}\)</td><td>ê¸ˆë¦¬ ë³€í™”ì— ëŒ€í•œ ë¯¼ê°ë„</td><td>ê¸ˆë¦¬ í•­</td></tr>
</table>

<pre><code><span class="kw">from</span> scipy.stats <span class="kw">import</span> norm

<span class="kw">def</span> <span class="fn">black_scholes_call</span>(S, K, T, r, sigma):
    <span class="st">"""ë¸”ë™-ìˆ„ì¦ˆ ì½œì˜µì…˜ ê°€ê²©"""</span>
    d1 = (np.log(S/K) + (r + sigma**<span class="nu">2</span>/<span class="nu">2</span>)*T) / (sigma*np.sqrt(T))
    d2 = d1 - sigma*np.sqrt(T)
    <span class="kw">return</span> S * norm.cdf(d1) - K * np.exp(-r*T) * norm.cdf(d2)

S, K, T, r, sigma = <span class="nu">100</span>, <span class="nu">100</span>, <span class="nu">0.5</span>, <span class="nu">0.05</span>, <span class="nu">0.2</span>
C = black_scholes_call(S, K, T, r, sigma)
<span class="fn">print</span>(<span class="st">f"ì½œì˜µì…˜ ê°€ê²©: </span>{C:.4f}<span class="st">"</span>)

<span class="cm"># ìˆ˜ì¹˜ ë¯¸ë¶„ìœ¼ë¡œ ê·¸ë¦­ìŠ¤ ê³„ì‚°</span>
h = <span class="nu">0.01</span>
delta = (black_scholes_call(S+h,K,T,r,sigma) - black_scholes_call(S-h,K,T,r,sigma)) / (<span class="nu">2</span>*h)
gamma = (black_scholes_call(S+h,K,T,r,sigma) - <span class="nu">2</span>*C + black_scholes_call(S-h,K,T,r,sigma)) / h**<span class="nu">2</span>
theta = (black_scholes_call(S,K,T-h,r,sigma) - black_scholes_call(S,K,T+h,r,sigma)) / (<span class="nu">2</span>*h)
vega = (black_scholes_call(S,K,T,r,sigma+h) - black_scholes_call(S,K,T,r,sigma-h)) / (<span class="nu">2</span>*h)

<span class="fn">print</span>(<span class="st">f"\nÎ” (Delta): </span>{delta:.4f}<span class="st">  â† ì£¼ê°€ 1ì›â†‘ â†’ ì˜µì…˜ </span>{delta:.4f}<span class="st">ì›â†‘"</span>)
<span class="fn">print</span>(<span class="st">f"Î“ (Gamma): </span>{gamma:.4f}<span class="st">  â† ë¸íƒ€ì˜ ë³€í™”ìœ¨"</span>)
<span class="fn">print</span>(<span class="st">f"Î˜ (Theta): </span>{theta:.4f}<span class="st">  â† í•˜ë£¨ ì‹œê°„ê°€ì¹˜ ê°ì†Œ"</span>)
<span class="fn">print</span>(<span class="st">f"Î½ (Vega):  </span>{vega:.4f}<span class="st">  â† ë³€ë™ì„± 1%â†‘ â†’ ì˜µì…˜ </span>{vega/100:.4f}<span class="st">ì›â†‘"</span>)</code></pre>
<div class="code-output"><span class="out-label">Output:</span>
ì½œì˜µì…˜ ê°€ê²©: 6.8893

Î” (Delta): 0.5955  â† ì£¼ê°€ 1ì›â†‘ â†’ ì˜µì…˜ 0.5955ì›â†‘
Î“ (Gamma): 0.0274  â† ë¸íƒ€ì˜ ë³€í™”ìœ¨
Î˜ (Theta): -8.8073  â† í•˜ë£¨ ì‹œê°„ê°€ì¹˜ ê°ì†Œ
Î½ (Vega):  27.4093  â† ë³€ë™ì„± 1%â†‘ â†’ ì˜µì…˜ 0.2741ì›â†‘</div>

<!-- â–¼ Plotly: ì˜µì…˜ ê°€ê²© ê³¡ë©´ 3D -->
<div id="plot-ch9-bsm" style="width:100%;height:520px;margin:25px 0"></div>
<script>
(function(){
  // ê°„ì´ BSM (ì •ê·œë¶„í¬ CDF ê·¼ì‚¬)
  function normcdf(x){var t=1/(1+0.2316419*Math.abs(x));var d=0.3989422802*Math.exp(-x*x/2);
    var p=d*t*(0.3193815+t*(-0.3565638+t*(1.781478+t*(-1.821256+t*1.330274))));
    return x>0?1-p:p;}
  function bsCall(S,K,T,r,sig){
    if(T<=0)return Math.max(S-K,0);
    var d1=(Math.log(S/K)+(r+sig*sig/2)*T)/(sig*Math.sqrt(T));
    var d2=d1-sig*Math.sqrt(T);
    return S*normcdf(d1)-K*Math.exp(-r*T)*normcdf(d2);
  }
  var n=30;var xv=[],yv=[],zv=[];
  for(var i=0;i<n;i++){
    var rx=[],ry=[],rz=[];
    for(var j=0;j<n;j++){
      var S=60+80*i/(n-1);  // 60~140
      var sig=0.05+0.55*j/(n-1);  // 0.05~0.6
      rx.push(S);ry.push(sig*100);rz.push(bsCall(S,100,0.5,0.05,sig));
    }
    xv.push(rx);yv.push(ry);zv.push(rz);
  }
  Plotly.newPlot('plot-ch9-bsm',[
    {x:xv,y:yv,z:zv,type:'surface',colorscale:'Viridis',opacity:0.9,showscale:true,
     colorbar:{title:'ì˜µì…˜ê°€ê²©',titleside:'right'}}
  ],{
    title:{text:'ğŸ’° ë¸”ë™-ìˆ„ì¦ˆ ì½œì˜µì…˜ ê°€ê²© ê³¡ë©´ (K=100, T=0.5ë…„)',font:{size:13}},
    scene:{
      xaxis:{title:'ê¸°ì´ˆìì‚° ê°€ê²© S'},
      yaxis:{title:'ë³€ë™ì„± Ïƒ (%)'},
      zaxis:{title:'ì½œì˜µì…˜ ê°€ê²© C'},
      camera:{eye:{x:1.8,y:-1.5,z:1.0}}
    },
    margin:{l:0,r:0,t:45,b:0}
  },{responsive:true});
})();
</script>
<p class="ni" style="font-size:11px;color:#888;text-align:center;margin-top:-10px">ğŸ–±ï¸ 3D íšŒì „ ê°€ëŠ¥! Sì¶• ë°©í–¥ ê¸°ìš¸ê¸° = ë¸íƒ€(Î”), Ïƒì¶• ë°©í–¥ ê¸°ìš¸ê¸° = ë² ê°€(Î½). ê³¡ë©´ì˜ ê¸°ìš¸ê¸°ê°€ ê³§ ê·¸ë¦­ìŠ¤</p>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- Ch10: ì¢…í•© ë¬¸ì œ -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<h2 id="ch10">10. ì¢…í•© ë¬¸ì œ</h2>

<p>ì§€ê¸ˆê¹Œì§€ ë°°ìš´ ë¯¸ì ë¶„ ê°œë…ì„ ì¢…í•©í•˜ëŠ” ë¬¸ì œë“¤ì´ë‹¤.</p>

<!-- ì¢…í•©ë¬¸ì œ 1 -->
<div class="problem-box">
<div class="problem-title">âœï¸ ì¢…í•©ë¬¸ì œ 1: ê²½ì‚¬í•˜ê°•ë²•ìœ¼ë¡œ ì„ í˜• íšŒê·€</div>
<p class="ni">ë°ì´í„° \(\{(1,2), (2,4), (3,5), (4,4), (5,5)\}\)ì— ëŒ€í•´ \(y = wx + b\)ë¥¼ ê²½ì‚¬í•˜ê°•ë²•ìœ¼ë¡œ í”¼íŒ…í•˜ë¼.</p>
<ol>
<li>MSE ì†ì‹¤í•¨ìˆ˜ \(L(w,b) = \frac{1}{n}\sum(y_i - wx_i - b)^2\)ì˜ \(\frac{\partial L}{\partial w}\)ì™€ \(\frac{\partial L}{\partial b}\)ë¥¼ êµ¬í•˜ë¼.</li>
<li>í•™ìŠµë¥  0.01ë¡œ 100ìŠ¤í… ê²½ì‚¬í•˜ê°•ë²•ì„ ì‹¤í–‰í•˜ë¼.</li>
<li>ìµœì¢… \(w\)ì™€ \(b\)ë¥¼ êµ¬í•˜ê³ , NumPyì˜ <code>np.polyfit</code>ê³¼ ë¹„êµí•˜ë¼.</li>
</ol>
</div>

<details>
<summary>ğŸ”‘ í’€ì´ ë³´ê¸°</summary>
<div class="answer-content">
<p class="ni"><strong>1) ê·¸ë˜ë””ì–¸íŠ¸:</strong></p>
<div class="eq">$$\frac{\partial L}{\partial w} = \frac{-2}{n}\sum x_i(y_i - wx_i - b), \quad \frac{\partial L}{\partial b} = \frac{-2}{n}\sum (y_i - wx_i - b)$$</div>

<pre><code><span class="kw">import</span> numpy <span class="kw">as</span> np

x = np.array([<span class="nu">1</span>, <span class="nu">2</span>, <span class="nu">3</span>, <span class="nu">4</span>, <span class="nu">5</span>], dtype=<span class="nb">float</span>)
y = np.array([<span class="nu">2</span>, <span class="nu">4</span>, <span class="nu">5</span>, <span class="nu">4</span>, <span class="nu">5</span>], dtype=<span class="nb">float</span>)
n = <span class="fn">len</span>(x)

w, b = <span class="nu">0.0</span>, <span class="nu">0.0</span>
lr = <span class="nu">0.01</span>

<span class="kw">for</span> step <span class="kw">in</span> <span class="fn">range</span>(<span class="nu">1000</span>):
    pred = w * x + b
    error = y - pred
    dw = -<span class="nu">2</span>/n * np.sum(x * error)
    db = -<span class="nu">2</span>/n * np.sum(error)
    w -= lr * dw
    b -= lr * db

<span class="fn">print</span>(<span class="st">f"GD ê²°ê³¼: w = </span>{w:.4f}<span class="st">, b = </span>{b:.4f}<span class="st">"</span>)

<span class="cm"># NumPy ê²€ì¦</span>
w_np, b_np = np.polyfit(x, y, <span class="nu">1</span>)
<span class="fn">print</span>(<span class="st">f"polyfit:  w = </span>{w_np:.4f}<span class="st">, b = </span>{b_np:.4f}<span class="st">"</span>)</code></pre>
<div class="code-output"><span class="out-label">Output:</span>
GD ê²°ê³¼: w = 0.6000, b = 2.2000
polyfit:  w = 0.6000, b = 2.2000</div>
<p class="ni">ê²½ì‚¬í•˜ê°•ë²•ê³¼ í•´ì„ì  í•´ê°€ ì¼ì¹˜í•œë‹¤.</p>
</div>
</details>

<!-- ì¢…í•©ë¬¸ì œ 2 -->
<div class="problem-box">
<div class="problem-title">âœï¸ ì¢…í•©ë¬¸ì œ 2: ë‰´ëŸ´ë„· ì—­ì „íŒŒ ì†ê³„ì‚°</div>
<p class="ni">1ê°œ ë‰´ëŸ° ë„¤íŠ¸ì›Œí¬: \(\hat{y} = \sigma(w_1 x_1 + w_2 x_2 + b)\), ì†ì‹¤ \(L = (\hat{y} - y)^2\)</p>
<p class="ni">ì…ë ¥: \(x_1 = 2, x_2 = 3\), ì •ë‹µ: \(y = 1\), íŒŒë¼ë¯¸í„°: \(w_1 = 0.5, w_2 = -0.3, b = 0.1\)</p>
<ol>
<li>ìˆœì „íŒŒë¥¼ ìˆ˜í–‰í•˜ì—¬ \(\hat{y}\)ì™€ \(L\)ì„ êµ¬í•˜ë¼.</li>
<li>ì²´ì¸ë£°ë¡œ \(\frac{\partial L}{\partial w_1}\), \(\frac{\partial L}{\partial w_2}\), \(\frac{\partial L}{\partial b}\)ë¥¼ êµ¬í•˜ë¼.</li>
<li>í•™ìŠµë¥  0.1ë¡œ íŒŒë¼ë¯¸í„°ë¥¼ 1ìŠ¤í… ì—…ë°ì´íŠ¸í•˜ë¼.</li>
</ol>
</div>

<details>
<summary>ğŸ”‘ í’€ì´ ë³´ê¸°</summary>
<div class="answer-content">
<pre><code><span class="kw">import</span> numpy <span class="kw">as</span> np
sigmoid = <span class="kw">lambda</span> x: <span class="nu">1</span>/(<span class="nu">1</span>+np.exp(-x))

x1, x2, y = <span class="nu">2</span>, <span class="nu">3</span>, <span class="nu">1</span>
w1, w2, b = <span class="nu">0.5</span>, -<span class="nu">0.3</span>, <span class="nu">0.1</span>

<span class="cm"># 1) ìˆœì „íŒŒ</span>
z = w1*x1 + w2*x2 + b  <span class="cm"># 0.5Ã—2 + (-0.3)Ã—3 + 0.1 = 0.2</span>
y_hat = sigmoid(z)       <span class="cm"># Ïƒ(0.2) â‰ˆ 0.5498</span>
L = (y_hat - y)**<span class="nu">2</span>       <span class="cm"># (0.5498-1)Â² â‰ˆ 0.2027</span>
<span class="fn">print</span>(<span class="st">f"z = </span>{z:.4f}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"Å· = </span>{y_hat:.4f}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"L = </span>{L:.4f}<span class="st">"</span>)

<span class="cm"># 2) ì—­ì „íŒŒ (ì²´ì¸ë£°)</span>
dL_dyhat = <span class="nu">2</span> * (y_hat - y)                      <span class="cm"># -0.9004</span>
dyhat_dz = sigmoid(z) * (<span class="nu">1</span> - sigmoid(z))         <span class="cm"># 0.2475</span>
dz_dw1 = x1                                       <span class="cm"># 2</span>
dz_dw2 = x2                                       <span class="cm"># 3</span>
dz_db = <span class="nu">1</span>

dL_dw1 = dL_dyhat * dyhat_dz * dz_dw1
dL_dw2 = dL_dyhat * dyhat_dz * dz_dw2
dL_db  = dL_dyhat * dyhat_dz * dz_db

<span class="fn">print</span>(<span class="st">f"\nâˆ‚L/âˆ‚wâ‚ = </span>{dL_dw1:.6f}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"âˆ‚L/âˆ‚wâ‚‚ = </span>{dL_dw2:.6f}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"âˆ‚L/âˆ‚b  = </span>{dL_db:.6f}<span class="st">"</span>)

<span class="cm"># 3) ì—…ë°ì´íŠ¸</span>
lr = <span class="nu">0.1</span>
w1_new = w1 - lr * dL_dw1
w2_new = w2 - lr * dL_dw2
b_new  = b  - lr * dL_db
<span class="fn">print</span>(<span class="st">f"\nì—…ë°ì´íŠ¸: wâ‚ </span>{w1:.4f}<span class="st"> â†’ </span>{w1_new:.4f}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"ì—…ë°ì´íŠ¸: wâ‚‚ </span>{w2:.4f}<span class="st"> â†’ </span>{w2_new:.4f}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"ì—…ë°ì´íŠ¸: b  </span>{b:.4f}<span class="st"> â†’ </span>{b_new:.4f}<span class="st">"</span>)</code></pre>
<div class="code-output"><span class="out-label">Output:</span>
z = 0.2000
Å· = 0.5498
L = 0.2027

âˆ‚L/âˆ‚wâ‚ = -0.445596
âˆ‚L/âˆ‚wâ‚‚ = -0.668394
âˆ‚L/âˆ‚b  = -0.222798

ì—…ë°ì´íŠ¸: wâ‚ 0.5000 â†’ 0.5446
ì—…ë°ì´íŠ¸: wâ‚‚ -0.3000 â†’ -0.2332
ì—…ë°ì´íŠ¸: b  0.1000 â†’ 0.1223</div>
<p class="ni">wâ‚ê³¼ wâ‚‚ê°€ ì¦ê°€í•˜ê³  bë„ ì¦ê°€í–ˆë‹¤. ì´ëŠ” Å·ë¥¼ 1ì— ê°€ê¹ê²Œ ë§Œë“¤ê¸° ìœ„í•´ zë¥¼ í‚¤ìš°ëŠ” ë°©í–¥ì´ë‹¤. ì´ ê³¼ì •ì„ ìˆ˜ì²œ ë²ˆ ë°˜ë³µí•˜ë©´ ë„¤íŠ¸ì›Œí¬ê°€ í•™ìŠµëœë‹¤.</p>
</div>
</details>

<!-- ì¢…í•©ë¬¸ì œ 3 -->
<div class="problem-box">
<div class="problem-title">âœï¸ ì¢…í•©ë¬¸ì œ 3: ì˜µì…˜ ë¸íƒ€ í—¤ì§•</div>
<p class="ni">ATM ì½œì˜µì…˜(S=K=100, T=0.5, r=5%, Ïƒ=20%)ì„ 100ê³„ì•½ ë§¤ë„í–ˆë‹¤.</p>
<ol>
<li>ë¸íƒ€(Î”)ë¥¼ êµ¬í•˜ë¼.</li>
<li>ë¸íƒ€ ì¤‘ë¦½(delta-neutral)ì„ ë§Œë“¤ë ¤ë©´ ê¸°ì´ˆìì‚°ì„ ëª‡ ì£¼ ë§¤ìˆ˜í•´ì•¼ í•˜ëŠ”ê°€?</li>
<li>ê¸°ì´ˆìì‚°ì´ 100â†’102ë¡œ ì˜¬ëì„ ë•Œ, ì˜µì…˜ í¬ì§€ì…˜ ì†ì‹¤ê³¼ ì£¼ì‹ í¬ì§€ì…˜ ì´ìµì„ ë¹„êµí•˜ë¼.</li>
</ol>
</div>

<details>
<summary>ğŸ”‘ í’€ì´ ë³´ê¸°</summary>
<div class="answer-content">
<pre><code><span class="kw">from</span> scipy.stats <span class="kw">import</span> norm

<span class="kw">def</span> <span class="fn">bs_call</span>(S,K,T,r,sig):
    d1 = (np.log(S/K)+(r+sig**<span class="nu">2</span>/<span class="nu">2</span>)*T)/(sig*np.sqrt(T))
    d2 = d1 - sig*np.sqrt(T)
    <span class="kw">return</span> S*norm.cdf(d1) - K*np.exp(-r*T)*norm.cdf(d2)

<span class="kw">def</span> <span class="fn">bs_delta</span>(S,K,T,r,sig):
    d1 = (np.log(S/K)+(r+sig**<span class="nu">2</span>/<span class="nu">2</span>)*T)/(sig*np.sqrt(T))
    <span class="kw">return</span> norm.cdf(d1)

S,K,T,r,sig = <span class="nu">100</span>,<span class="nu">100</span>,<span class="nu">0.5</span>,<span class="nu">0.05</span>,<span class="nu">0.2</span>
contracts = <span class="nu">100</span>

<span class="cm"># 1) ë¸íƒ€</span>
delta = bs_delta(S,K,T,r,sig)
<span class="fn">print</span>(<span class="st">f"1) Î” = </span>{delta:.4f}<span class="st">"</span>)

<span class="cm"># 2) í—¤ì§€ ìˆ˜ëŸ‰</span>
hedge_shares = delta * contracts
<span class="fn">print</span>(<span class="st">f"2) ë§¤ìˆ˜í•  ì£¼ì‹: </span>{hedge_shares:.1f}<span class="st">ì£¼"</span>)

<span class="cm"># 3) S: 100 â†’ 102</span>
C_old = bs_call(<span class="nu">100</span>,K,T,r,sig)
C_new = bs_call(<span class="nu">102</span>,K,T,r,sig)
option_loss = (C_new - C_old) * contracts  <span class="cm"># ë§¤ë„í–ˆìœ¼ë¯€ë¡œ ê°€ê²©â†‘ = ì†ì‹¤</span>
stock_gain = hedge_shares * (<span class="nu">102</span> - <span class="nu">100</span>)
<span class="fn">print</span>(<span class="st">f"\n3) ì˜µì…˜ ì†ì‹¤: </span>{-option_loss:.2f}<span class="st">ì›"</span>)
<span class="fn">print</span>(<span class="st">f"   ì£¼ì‹ ì´ìµ: </span>{stock_gain:.2f}<span class="st">ì›"</span>)
<span class="fn">print</span>(<span class="st">f"   ìˆœì†ìµ:    </span>{stock_gain - option_loss:.2f}<span class="st">ì› (ê±°ì˜ 0!)"</span>)</code></pre>
<div class="code-output"><span class="out-label">Output:</span>
1) Î” = 0.5955
2) ë§¤ìˆ˜í•  ì£¼ì‹: 59.5ì£¼

3) ì˜µì…˜ ì†ì‹¤: 122.72ì›
   ì£¼ì‹ ì´ìµ: 119.10ì›
   ìˆœì†ìµ:    -3.62ì› (ê±°ì˜ 0!)</div>
<p class="ni">ë¸íƒ€ í—¤ì§•ìœ¼ë¡œ ì£¼ê°€ ë³€ë™ ë¦¬ìŠ¤í¬ë¥¼ ê±°ì˜ ì œê±°í–ˆë‹¤. ë‚¨ì€ -3.62ì›ì˜ ì°¨ì´ëŠ” ê°ë§ˆ(Î“) íš¨ê³¼ ë•Œë¬¸ì´ë‹¤. ì´ê²ƒì´ "ê·¸ë¦­ìŠ¤ = í¸ë¯¸ë¶„"ì˜ ì‹¤ì „ ì‘ìš©ì´ë‹¤.</p>
</div>
</details>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- í•µì‹¬ ìš”ì•½ -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<h2>í•µì‹¬ ìš”ì•½: ë¯¸ì ë¶„ ì¹˜íŠ¸ì‹œíŠ¸</h2>

<div class="tc">Table 4. ë¯¸ì ë¶„ í•µì‹¬ ê°œë… â†’ ML/ê¸ˆìœµ ë§¤í•‘</div>
<table>
<tr><th>ê°œë…</th><th>ìˆ˜ì‹</th><th>ML ì‘ìš©</th><th>ê¸ˆìœµ ì‘ìš©</th></tr>
<tr><td>ë¯¸ë¶„</td><td>\(f'(x) = \lim \frac{f(x+h)-f(x)}{h}\)</td><td>ê·¸ë˜ë””ì–¸íŠ¸ ê³„ì‚°</td><td>ë¯¼ê°ë„ ë¶„ì„</td></tr>
<tr><td>í¸ë¯¸ë¶„</td><td>\(\frac{\partial f}{\partial x_i}\)</td><td>ë‹¤ë³€ìˆ˜ ìµœì í™”</td><td>ê·¸ë¦­ìŠ¤ (Î”, Î“, Î˜, Î½)</td></tr>
<tr><td>ê·¸ë˜ë””ì–¸íŠ¸</td><td>\(\nabla f\)</td><td>ê²½ì‚¬í•˜ê°•ë²• ë°©í–¥</td><td>ë¦¬ìŠ¤í¬ ë°©í–¥</td></tr>
<tr><td>ì²´ì¸ë£°</td><td>\(\frac{dL}{dw} = \frac{dL}{dy}\frac{dy}{dz}\frac{dz}{dw}\)</td><td>ì—­ì „íŒŒ</td><td>ë³µí•© íŒŒìƒìƒí’ˆ</td></tr>
<tr><td>ì ë¶„</td><td>\(\int f(x)dx\)</td><td>í™•ë¥  ê³„ì‚° (CDF)</td><td>ëˆ„ì  ìˆ˜ìµë¥ , VaR</td></tr>
<tr><td>í…Œì¼ëŸ¬ ê¸‰ìˆ˜</td><td>\(f(a) + f'(a)(x-a) + \cdots\)</td><td>ë³´í¸ ê·¼ì‚¬ ì •ë¦¬</td><td>ë¸íƒ€-ê°ë§ˆ ê·¼ì‚¬</td></tr>
<tr><td>ê²½ì‚¬í•˜ê°•ë²•</td><td>\(\theta \leftarrow \theta - \alpha\nabla L\)</td><td>ëª¨ë“  ML í•™ìŠµ</td><td>í¬íŠ¸í´ë¦¬ì˜¤ ìµœì í™”</td></tr>
<tr><td>ìˆ˜ì¹˜ ë¯¸ë¶„</td><td>\(\frac{f(x+h)-f(x-h)}{2h}\)</td><td>ê·¸ë˜ë””ì–¸íŠ¸ ê²€ì¦</td><td>ê·¸ë¦­ìŠ¤ ìˆ˜ì¹˜ ê³„ì‚°</td></tr>
</table>

<div class="info">
<p class="ni"><strong>ë‹¤ìŒ ë‹¨ê³„:</strong> ì´ ê°•ì˜ì˜ ë¯¸ì ë¶„ ê¸°ì´ˆëŠ” R3(Data/Feature Engineering)ì—ì„œ í”¼ì²˜ ë³€í™˜ê³¼ ì •ê·œí™”ì˜ ìˆ˜í•™ì  ë°°ê²½ì´ ë˜ê³ , R4(Supervised Learning)ì—ì„œ ê²½ì‚¬í•˜ê°•ë²• ê¸°ë°˜ ëª¨ë¸ í•™ìŠµì˜ í•µì‹¬ì´ ëœë‹¤. íŠ¹íˆ ì²´ì¸ë£°ì€ R7(Deep Learning)ì˜ ì—­ì „íŒŒë¥¼ ì´í•´í•˜ëŠ” ë° í•„ìˆ˜ì ì´ë‹¤.</p>
</div>

</div><!-- paper-content -->
</div><!-- container -->
</div><!-- main-wrapper -->

</body>
</html>