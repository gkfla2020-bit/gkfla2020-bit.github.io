<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bonus 1 - ì„ í˜•ëŒ€ìˆ˜ ì˜¬ì¸ì› (Linear Algebra All-in-One)</title>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@300;400;500&family=Space+Mono:wght@400&family=Inter:wght@300;400&display=swap" rel="stylesheet">
<script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Inter',sans-serif;background:#fafaf8;color:#1a1a1a;line-height:1.7;overflow-x:hidden}
.sidebar{position:fixed;left:0;top:0;width:260px;height:100vh;background:rgba(255,255,255,.97);border-right:1px solid rgba(0,0,0,.06);padding:32px 24px;z-index:100;overflow-y:auto;display:flex;flex-direction:column}
.sidebar-profile{text-align:center;margin-bottom:28px;padding-bottom:24px;border-bottom:1px solid rgba(0,0,0,.08)}
.profile-icon{font-size:48px;margin-bottom:8px}
.profile-name{font-family:'Cormorant Garamond',serif;font-size:1.3rem;font-weight:500;margin-bottom:4px}
.profile-title{font-size:.68rem;color:#888;letter-spacing:.08em;text-transform:uppercase;margin-bottom:8px}
.profile-bio{font-size:.78rem;color:#666;line-height:1.5}
.sidebar-nav{flex:1;margin-top:16px}
.nav-section{margin-bottom:20px}
.nav-section-title{font-size:.6rem;font-weight:600;color:#aaa;letter-spacing:.15em;text-transform:uppercase;margin-bottom:10px}
.nav-list{list-style:none}
.nav-list li{margin-bottom:5px}
.nav-list a{font-size:.78rem;color:#555;text-decoration:none;transition:all .2s;display:block;padding:3px 0}
.nav-list a:hover{color:#0080c6;padding-left:4px}
.nav-list a.active{color:#0080c6;font-weight:500}
.nav-list a.done{color:#28a745}
.badge{display:inline-block;font-size:.5rem;background:#0080c6;color:#fff;padding:1px 5px;border-radius:8px;margin-left:3px;vertical-align:middle}
.badge-done{background:#28a745}
.badge-bonus{background:#9c27b0}
.sidebar-footer{padding-top:16px;border-top:1px solid rgba(0,0,0,.06);font-size:.65rem;color:#aaa;text-align:center}
.main-wrapper{margin-left:260px;min-height:100vh}
.container{max-width:1100px;margin:0 auto;padding:50px 40px 80px}
.paper-content{font-family:'Times New Roman','Nanum Myeongjo',serif;line-height:1.8;background:#fff;padding:40px;border-radius:8px;box-shadow:0 2px 20px rgba(0,0,0,.05)}
.paper-header{text-align:center;margin-bottom:40px;padding-bottom:30px;border-bottom:2px solid #333}
.paper-category{font-size:14px;color:#666;margin-bottom:10px}
.paper-title{font-size:24px;font-weight:bold;margin-bottom:12px;line-height:1.4}
.paper-subtitle{font-size:14px;color:#555;margin-bottom:8px}
.paper-team{font-size:13px;color:#444}
.abstract{background:#f8f9fa;padding:25px;margin:30px 0;border-left:4px solid #2c3e50}
.abstract-title{font-weight:bold;font-size:16px;margin-bottom:15px}
h2{font-size:18px;margin:35px 0 20px;padding-bottom:8px;border-bottom:1px solid #ddd;color:#2c3e50}
h3{font-size:15px;margin:25px 0 15px;color:#34495e}
h4{font-size:14px;margin:20px 0 12px;color:#34495e}
p{text-align:justify;margin-bottom:15px;text-indent:2em}
p.ni{text-indent:0}
table{width:100%;border-collapse:collapse;margin:20px 0;font-size:12px}
th,td{border:1px solid #ddd;padding:10px 8px;text-align:center}
th{background:#2c3e50;color:white;font-weight:bold}
tr:nth-child(even){background:#f8f9fa}
tr:hover{background:#e8f4f8}
.tc{font-size:13px;font-weight:bold;margin:15px 0 10px;text-align:center}
.eq{text-align:center;margin:20px 0;padding:15px;background:#f8f9fa;border-radius:4px;overflow-x:auto}
ul,ol{margin-left:2em;margin-bottom:15px}
li{margin-bottom:6px}
.def{background:#fff9e6;border:1px solid #ffc107;border-radius:4px;padding:20px;margin:20px 0}
.info{background:#e8f4f8;border-left:4px solid #3498db;padding:20px;margin:20px 0}
.warn{background:#fff3cd;border-left:4px solid #f39c12;padding:20px;margin:20px 0}
.ok{background:#d4edda;border-left:4px solid #28a745;padding:20px;margin:20px 0}
pre{background:#1e1e1e;color:#d4d4d4;padding:20px;border-radius:6px;overflow-x:auto;margin:20px 0;font-family:'Space Mono','Consolas',monospace;font-size:13px;line-height:1.6}
code{font-family:'Space Mono','Consolas',monospace;font-size:13px}
p code,li code,td code{background:#f0f0f0;padding:2px 6px;border-radius:3px;color:#c7254e;font-size:12px}
.cc{font-size:12px;font-weight:bold;color:#2c3e50;margin-top:15px;margin-bottom:4px}
.cm{color:#6a9955}.kw{color:#569cd6}.st{color:#ce9178}.fn{color:#dcdcaa}.nb{color:#4ec9b0}.nu{color:#b5cea8}
.progress-bar{width:100%;height:6px;background:#e0e0e0;border-radius:3px;margin-top:16px}
.progress-fill{height:100%;background:linear-gradient(90deg,#9c27b0,#e040fb);border-radius:3px;width:100%}
.progress-label{font-size:11px;color:#888;margin-top:4px;text-align:center}
details{margin:20px 0;border:1px solid #ddd;border-radius:6px;overflow:hidden}
details summary{padding:14px 20px;background:#f0f4f8;cursor:pointer;font-weight:bold;font-size:14px;color:#2c3e50;user-select:none;transition:background .2s}
details summary:hover{background:#e0e8f0}
details[open] summary{background:#d0dce8;border-bottom:1px solid #ddd}
details .answer-content{padding:20px;background:#fff}
.problem-box{background:#f0f4ff;border:2px solid #5c6bc0;border-radius:8px;padding:20px;margin:20px 0}
.problem-box .problem-title{font-weight:bold;color:#283593;font-size:15px;margin-bottom:12px}
@media(max-width:1024px){
.sidebar{width:100%;height:auto;position:relative;border-right:none;border-bottom:1px solid rgba(0,0,0,.08);padding:16px}
.sidebar-profile{margin-bottom:10px;padding-bottom:10px;display:flex;align-items:center;gap:12px;text-align:left}
.profile-icon{font-size:32px;margin-bottom:0}.profile-bio{display:none}
.nav-section{display:inline-block;margin-right:16px;margin-bottom:8px}
.nav-list{display:flex;gap:10px;flex-wrap:wrap}.nav-list li{margin-bottom:0}
.sidebar-footer{display:none}
.main-wrapper{margin-left:0}
.container{padding:0}.paper-content{padding:20px 16px;border-radius:0;box-shadow:none}
.paper-title{font-size:18px}p{font-size:14px;text-indent:1.5em;text-align:left}
pre{font-size:11px;padding:14px}table{font-size:10px;display:block;overflow-x:auto}
}
.code-output{background:#1e1e1e;color:#d4d4d4;padding:12px 16px;border-radius:0 0 6px 6px;font-family:'Space Mono',monospace;font-size:11.5px;line-height:1.6;margin-top:-4px;margin-bottom:18px;border-top:2px solid #333;white-space:pre-wrap;overflow-x:auto}
.code-output .out-label{color:#888;font-size:10px;margin-bottom:4px;display:block}
</style>
</head>
<body>

<div class="sidebar">
<div class="sidebar-profile">
<div class="profile-icon">&#x1F9EE;</div>
<div class="profile-name">HFT ML Master Plan</div>
<div class="profile-title">Convex Opt + DL + HFT</div>
<div class="profile-bio">Bonus Rounds: ìˆ˜í•™ ê¸°ì´ˆ ì˜¬ì¸ì›</div>
</div>
<div class="sidebar-nav">
<div class="nav-section">
<div class="nav-section-title">Curriculum</div>
<ul class="nav-list">
<li><a class="done" href="../round-01/">R1. Python + Finance <span class="badge badge-done">DONE</span></a></li>
<li><a class="active" href="#">B1. ì„ í˜•ëŒ€ìˆ˜ ì˜¬ì¸ì› <span class="badge badge-bonus">BONUS</span></a></li>
<li><a href="../round-02/">R2. Linear Algebra + Stats</a></li>
<li><a href="../bonus-02/">B2. ë¯¸ì ë¶„ ì˜¬ì¸ì›</a></li>
<li><a href="../round-03/">R3. Data / Feature Eng.</a></li>
<li><a href="../bonus-04/">B4. ì¬ë¬´ê´€ë¦¬ ì˜¬ì¸ì›</a></li>
<li><a href="../round-04/">R4. Supervised Learning</a></li>
<li><a href="../bonus-03/">B3. í™•ë¥ Â·í†µê³„ ì˜¬ì¸ì›</a></li>
<li><a href="../round-05/">R5. Unsupervised + TS</a></li>
<li><a href="../bonus-05/">B5. ê¸ˆìœµê³µí•™ ì˜¬ì¸ì›</a></li>
<li><a href="../round-06/">R6. NLP + Sentiment</a></li>
<li><a href="../round-07/">R7. Deep Learning</a></li>
<li><a href="../bonus-06/">B6. ìµœì í™” ì´ë¡  ì˜¬ì¸ì›</a></li>
<li><a href="../round-08/">R8. Convex Opt + Transformer</a></li>
<li><a href="../round-09/">R9. HFT + RL</a></li>
<li><a href="../round-10/">R10. Final Project</a></li>
</ul>
</div>
<div class="nav-section">
<div class="nav-section-title">This Lecture</div>
<ul class="nav-list">
<li><a href="#ch1">1. ìŠ¤ì¹¼ë¼, ë²¡í„°, í–‰ë ¬, í…ì„œ</a></li>
<li><a href="#ch2">2. ë²¡í„° ì—°ì‚°ê³¼ ë‚´ì </a></li>
<li><a href="#ch3">3. í–‰ë ¬ ì—°ì‚°</a></li>
<li><a href="#ch4">4. ì—­í–‰ë ¬ê³¼ ì—°ë¦½ë°©ì •ì‹</a></li>
<li><a href="#ch5">5. ì„ í˜•ë³€í™˜ì˜ ê¸°í•˜í•™</a></li>
<li><a href="#ch6">6. ê³ ìœ ê°’ê³¼ ê³ ìœ ë²¡í„°</a></li>
<li><a href="#ch7">7. SVD (íŠ¹ì´ê°’ ë¶„í•´)</a></li>
<li><a href="#ch8">8. PCA (ì£¼ì„±ë¶„ ë¶„ì„)</a></li>
<li><a href="#ch9">9. ê¸ˆìœµì—ì„œì˜ ì„ í˜•ëŒ€ìˆ˜</a></li>
<li><a href="#ch10">10. ì¢…í•© ë¬¸ì œ</a></li>
</ul>
</div>
</div>
<div class="sidebar-footer">Bonus 1 â€” ì„ í˜•ëŒ€ìˆ˜ ì˜¬ì¸ì›</div>
</div>

<div class="main-wrapper">
<div class="container">
<div class="paper-content">

<div class="paper-header">
<div class="paper-category">Bonus Round 1 / 6 â€” R1ê³¼ R2 ì‚¬ì´</div>
<h1 class="paper-title">ì„ í˜•ëŒ€ìˆ˜ ì˜¬ì¸ì› (Linear Algebra All-in-One)</h1>
<div class="paper-subtitle">ë²¡í„° â†’ í–‰ë ¬ â†’ ë‚´ì  â†’ ì—­í–‰ë ¬ â†’ ê³ ìœ ê°’ â†’ SVD â†’ PCA</div>
<div class="paper-team">ìˆ˜í•™ì´ ë‘ë ¤ìš´ ì‚¬ëŒë„ ëê¹Œì§€ ë”°ë¼ì˜¬ ìˆ˜ ìˆëŠ” ì™„ì „ ììŠµì„œ</div>
<div class="progress-bar"><div class="progress-fill"></div></div>
<div class="progress-label">Bonus Round â€” ì„ í˜•ëŒ€ìˆ˜ ì™„ì „ ì •ë³µ</div>
</div>

<div class="abstract">
<div class="abstract-title">ì™œ ì„ í˜•ëŒ€ìˆ˜ì¸ê°€?</div>
<p class="ni">ë¨¸ì‹ ëŸ¬ë‹ì˜ ëª¨ë“  ê²ƒì€ ì„ í˜•ëŒ€ìˆ˜ ìœ„ì— ì„¸ì›Œì ¸ ìˆë‹¤. ì£¼ê°€ ë°ì´í„°ëŠ” í–‰ë ¬ì´ê³ , í¬íŠ¸í´ë¦¬ì˜¤ ìµœì í™”ëŠ” í–‰ë ¬ ì—°ì‚°ì´ë©°, PCAë¡œ ì°¨ì›ì„ ì¶•ì†Œí•˜ê³ , ë”¥ëŸ¬ë‹ì˜ ëª¨ë“  ë ˆì´ì–´ëŠ” í–‰ë ¬ ê³±ì…ˆì´ë‹¤. ì´ ê°•ì˜ë¥¼ ë§ˆì¹˜ë©´:</p>
<ul>
<li>ë²¡í„°ì™€ í–‰ë ¬ì„ ì§ê´€ì ìœ¼ë¡œ ì´í•´í•˜ê³  NumPyë¡œ ë‹¤ë£° ìˆ˜ ìˆë‹¤</li>
<li>ë‚´ì , ì™¸ì , í–‰ë ¬ê³±ì˜ ê¸°í•˜í•™ì  ì˜ë¯¸ë¥¼ ì„¤ëª…í•  ìˆ˜ ìˆë‹¤</li>
<li>ì—­í–‰ë ¬ê³¼ ì—°ë¦½ë°©ì •ì‹ì˜ ê´€ê³„ë¥¼ ì´í•´í•œë‹¤</li>
<li>ê³ ìœ ê°’/ê³ ìœ ë²¡í„°ê°€ ì™œ ì¤‘ìš”í•œì§€ ì„¤ëª…í•  ìˆ˜ ìˆë‹¤</li>
<li>SVDì™€ PCAì˜ ì›ë¦¬ë¥¼ ì´í•´í•˜ê³  ê¸ˆìœµ ë°ì´í„°ì— ì ìš©í•  ìˆ˜ ìˆë‹¤</li>
</ul>
<div style="font-size:13px;color:#555;margin-top:15px;font-style:italic"><strong>Keywords:</strong> Vector, Matrix, Dot Product, Inverse, Eigenvalue, SVD, PCA, NumPy, Portfolio</div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- Ch1: ìŠ¤ì¹¼ë¼, ë²¡í„°, í–‰ë ¬, í…ì„œ -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<h2 id="ch1">1. ìŠ¤ì¹¼ë¼, ë²¡í„°, í–‰ë ¬, í…ì„œ â€” ë°ì´í„°ì˜ ì°¨ì›</h2>

<h3>1.1 ë„¤ ê°€ì§€ ìˆ˜í•™ ê°ì²´</h3>
<p>ì„ í˜•ëŒ€ìˆ˜ë¥¼ ë°°ìš°ê¸° ì „ì—, ë°ì´í„°ê°€ ì–´ë–¤ "ëª¨ì–‘"ìœ¼ë¡œ ì¡´ì¬í•˜ëŠ”ì§€ ì´í•´í•´ì•¼ í•œë‹¤. ì¼ìƒì—ì„œ ìš°ë¦¬ê°€ ë‹¤ë£¨ëŠ” ëª¨ë“  ìˆ«ì ë°ì´í„°ëŠ” ë„¤ ê°€ì§€ ì¤‘ í•˜ë‚˜ì— ì†í•œë‹¤.</p>

<div class="def">
<p class="ni"><strong>ì •ì˜ 1.1 â€” ìˆ˜í•™ ê°ì²´ì˜ ê³„ì¸µ</strong></p>
<ul>
<li><strong>ìŠ¤ì¹¼ë¼(Scalar):</strong> í•˜ë‚˜ì˜ ìˆ«ì. ì˜ˆ: ì‚¼ì„±ì „ì ì£¼ê°€ 70,000ì›, ìˆ˜ìµë¥  2.5%</li>
<li><strong>ë²¡í„°(Vector):</strong> ìˆ«ìë“¤ì˜ 1ì°¨ì› ë‚˜ì—´. ì˜ˆ: 5ì¼ê°„ ì¢…ê°€ [70000, 71000, 69500, 72000, 73000]</li>
<li><strong>í–‰ë ¬(Matrix):</strong> ìˆ«ìë“¤ì˜ 2ì°¨ì› ë°°ì—´(í‘œ). ì˜ˆ: 3ì¢…ëª© Ã— 5ì¼ ì¢…ê°€ ë°ì´í„°</li>
<li><strong>í…ì„œ(Tensor):</strong> 3ì°¨ì› ì´ìƒì˜ ë°°ì—´. ì˜ˆ: 10ì¢…ëª© Ã— 252ì¼ Ã— 5ê°œ íŠ¹ì„±(ì‹œê°€,ê³ ê°€,ì €ê°€,ì¢…ê°€,ê±°ë˜ëŸ‰)</li>
</ul>
</div>

<div class="eq">
$$\underbrace{42}_{\text{ìŠ¤ì¹¼ë¼}} \quad \underbrace{\begin{bmatrix} 1 \\ 2 \\ 3 \end{bmatrix}}_{\text{ë²¡í„° (3Ã—1)}} \quad \underbrace{\begin{bmatrix} 1 & 2 \\ 3 & 4 \\ 5 & 6 \end{bmatrix}}_{\text{í–‰ë ¬ (3Ã—2)}} \quad \underbrace{\boxed{\text{3D ë°°ì—´}}}_{\text{í…ì„œ}}$$
</div>

<pre><code><span class="kw">import</span> numpy <span class="kw">as</span> np

<span class="cm"># ìŠ¤ì¹¼ë¼: ê·¸ëƒ¥ ìˆ«ì</span>
price = <span class="nu">70000</span>
<span class="fn">print</span>(<span class="st">"ìŠ¤ì¹¼ë¼:"</span>, price)

<span class="cm"># ë²¡í„°: 1ì°¨ì› ë°°ì—´</span>
prices = np.array([<span class="nu">70000</span>, <span class="nu">71000</span>, <span class="nu">69500</span>, <span class="nu">72000</span>, <span class="nu">73000</span>])
<span class="fn">print</span>(<span class="st">"ë²¡í„° shape:"</span>, prices.shape)  <span class="cm"># (5,)</span>

<span class="cm"># í–‰ë ¬: 2ì°¨ì› ë°°ì—´ (3ì¢…ëª© Ã— 5ì¼)</span>
stock_matrix = np.array([
    [<span class="nu">70000</span>, <span class="nu">71000</span>, <span class="nu">69500</span>, <span class="nu">72000</span>, <span class="nu">73000</span>],  <span class="cm"># ì‚¼ì„±ì „ì</span>
    [<span class="nu">50000</span>, <span class="nu">51000</span>, <span class="nu">49000</span>, <span class="nu">52000</span>, <span class="nu">53000</span>],  <span class="cm"># SKí•˜ì´ë‹‰ìŠ¤</span>
    [<span class="nu">30000</span>, <span class="nu">30500</span>, <span class="nu">29800</span>, <span class="nu">31000</span>, <span class="nu">31500</span>]   <span class="cm"># NAVER</span>
])
<span class="fn">print</span>(<span class="st">"í–‰ë ¬ shape:"</span>, stock_matrix.shape)  <span class="cm"># (3, 5)</span>

<span class="cm"># í…ì„œ: 3ì°¨ì› ë°°ì—´ (2ì¢…ëª© Ã— 3ì¼ Ã— 4íŠ¹ì„±)</span>
tensor = np.random.randn(<span class="nu">2</span>, <span class="nu">3</span>, <span class="nu">4</span>)
<span class="fn">print</span>(<span class="st">"í…ì„œ shape:"</span>, tensor.shape)  <span class="cm"># (2, 3, 4)</span></code></pre>
<div class="code-output"><span class="out-label">Output:</span>
ìŠ¤ì¹¼ë¼: 70000
ë²¡í„° shape: (5,)
í–‰ë ¬ shape: (3, 5)
í…ì„œ shape: (2, 3, 4)</div>

<h3>1.2 ë²¡í„°ì˜ ê¸°í•˜í•™ì  ì˜ë¯¸</h3>
<p>ë²¡í„°ëŠ” ë‹¨ìˆœíˆ "ìˆ«ìì˜ ë‚˜ì—´"ì´ ì•„ë‹ˆë‹¤. ê¸°í•˜í•™ì ìœ¼ë¡œ ë²¡í„°ëŠ” ê³µê°„ì—ì„œì˜ í™”ì‚´í‘œë‹¤. ì›ì ì—ì„œ ì¶œë°œí•˜ì—¬ ì–´ë–¤ ì ì„ ê°€ë¦¬í‚¤ëŠ” ë°©í–¥ê³¼ í¬ê¸°ë¥¼ ê°€ì§„ í™”ì‚´í‘œ.</p>

<p>ì˜ˆë¥¼ ë“¤ì–´ ë²¡í„° \(\mathbf{v} = \begin{bmatrix} 3 \\ 2 \end{bmatrix}\)ëŠ” 2ì°¨ì› í‰ë©´ì—ì„œ ì›ì  (0,0)ì—ì„œ ì  (3,2)ë¥¼ ê°€ë¦¬í‚¤ëŠ” í™”ì‚´í‘œë‹¤. ì´ í™”ì‚´í‘œì˜ ê¸¸ì´(í¬ê¸°)ëŠ” í”¼íƒ€ê³ ë¼ìŠ¤ ì •ë¦¬ë¡œ êµ¬í•œë‹¤:</p>

<div class="eq">
$$\|\mathbf{v}\| = \sqrt{3^2 + 2^2} = \sqrt{13} \approx 3.61$$
</div>

<p>ê¸ˆìœµì—ì„œ ë²¡í„°ì˜ ì˜ë¯¸: í¬íŠ¸í´ë¦¬ì˜¤ ë¹„ì¤‘ ë²¡í„° \(\mathbf{w} = \begin{bmatrix} 0.4 \\ 0.3 \\ 0.3 \end{bmatrix}\)ëŠ” "ì‚¼ì„±ì „ì 40%, SKí•˜ì´ë‹‰ìŠ¤ 30%, NAVER 30%"ë¥¼ ì˜ë¯¸í•œë‹¤. ìˆ˜ìµë¥  ë²¡í„° \(\mathbf{r} = \begin{bmatrix} 0.05 \\ -0.02 \\ 0.03 \end{bmatrix}\)ëŠ” ê° ì¢…ëª©ì˜ ìˆ˜ìµë¥ ì´ë‹¤.</p>

<!-- â–¼ Plotly: 2D ë²¡í„° ì‹œê°í™” -->
<div id="plot-ch1-vectors" style="width:100%;height:420px;margin:25px 0"></div>
<script>
(function(){
  var traces = [];
  var vecs = [[3,2,'v = (3,2)','#e53935'],[1,4,'u = (1,4)','#1e88e5'],[4,6,'v+u = (4,6)','#43a047']];
  for(var i=0;i<vecs.length;i++){
    traces.push({x:[0,vecs[i][0]],y:[0,vecs[i][1]],mode:'lines+markers',name:vecs[i][2],
      line:{width:3,color:vecs[i][3]},marker:{size:[4,10],symbol:['circle','arrow'],
      angleref:'previous'}});
  }
  traces.push({x:[3,4],y:[2,6],mode:'lines',name:'u ì´ë™',line:{width:2,dash:'dot',color:'#1e88e5'},showlegend:false});
  traces.push({x:[1,4],y:[4,6],mode:'lines',name:'v ì´ë™',line:{width:2,dash:'dot',color:'#e53935'},showlegend:false});
  Plotly.newPlot('plot-ch1-vectors',traces,{
    title:{text:'ğŸ“ ë²¡í„°ì˜ ë§ì…ˆ: v + u = (3+1, 2+4) = (4, 6)',font:{size:13}},
    xaxis:{title:'x',range:[-1,7],zeroline:true,zerolinewidth:2},
    yaxis:{title:'y',range:[-1,8],zeroline:true,zerolinewidth:2,scaleanchor:'x'},
    margin:{l:50,r:20,t:45,b:40},
    legend:{x:0.02,y:0.98},
    annotations:[
      {x:3,y:2,text:'v(3,2)',showarrow:true,arrowhead:2,ax:30,ay:20,font:{size:11,color:'#e53935'}},
      {x:1,y:4,text:'u(1,4)',showarrow:true,arrowhead:2,ax:-40,ay:10,font:{size:11,color:'#1e88e5'}},
      {x:4,y:6,text:'v+u(4,6)',showarrow:true,arrowhead:2,ax:30,ay:-20,font:{size:11,color:'#43a047'}}
    ]
  },{responsive:true});
})();
</script>
<p class="ni" style="font-size:11px;color:#888;text-align:center;margin-top:-10px">ğŸ–±ï¸ ë²¡í„° ë§ì…ˆì˜ í‰í–‰ì‚¬ë³€í˜• ë²•ì¹™: vì˜ ëì—ì„œ uë¥¼ ì´ì–´ ë¶™ì´ë©´ v+uê°€ ëœë‹¤</p>

<h3>1.3 ë²¡í„°ì˜ í¬ê¸°(ë…¸ë¦„)ì™€ ë‹¨ìœ„ë²¡í„°</h3>
<p>ë²¡í„°ì˜ í¬ê¸°ë¥¼ ë…¸ë¦„(norm)ì´ë¼ í•œë‹¤. ê°€ì¥ ë§ì´ ì“°ëŠ” ê²ƒì€ L2 ë…¸ë¦„(ìœ í´ë¦¬ë“œ ê±°ë¦¬)ì´ë‹¤.</p>

<div class="eq">
$$\|\mathbf{v}\|_2 = \sqrt{\sum_{i=1}^{n} v_i^2} = \sqrt{v_1^2 + v_2^2 + \cdots + v_n^2}$$
</div>

<p>ë‹¨ìœ„ë²¡í„°(unit vector)ëŠ” í¬ê¸°ê°€ 1ì¸ ë²¡í„°ë‹¤. ì–´ë–¤ ë²¡í„°ë“  ìê¸° í¬ê¸°ë¡œ ë‚˜ëˆ„ë©´ ë‹¨ìœ„ë²¡í„°ê°€ ëœë‹¤: \(\hat{\mathbf{v}} = \frac{\mathbf{v}}{\|\mathbf{v}\|}\). ê¸ˆìœµì—ì„œ ë‹¨ìœ„ë²¡í„°ëŠ” "ë°©í–¥ë§Œ ë‚¨ê¸°ê³  í¬ê¸°ë¥¼ ì •ê·œí™”"í•  ë•Œ ì‚¬ìš©í•œë‹¤.</p>

<pre><code><span class="kw">import</span> numpy <span class="kw">as</span> np

v = np.array([<span class="nu">3</span>, <span class="nu">4</span>])

<span class="cm"># L2 ë…¸ë¦„ (ìœ í´ë¦¬ë“œ ê±°ë¦¬)</span>
norm_v = np.linalg.norm(v)
<span class="fn">print</span>(<span class="st">f"||v|| = </span>{norm_v}<span class="st">"</span>)  <span class="cm"># 5.0 (3-4-5 ì§ê°ì‚¼ê°í˜•!)</span>

<span class="cm"># ë‹¨ìœ„ë²¡í„°</span>
unit_v = v / norm_v
<span class="fn">print</span>(<span class="st">f"ë‹¨ìœ„ë²¡í„°: </span>{unit_v}<span class="st">"</span>)           <span class="cm"># [0.6, 0.8]</span>
<span class="fn">print</span>(<span class="st">f"ë‹¨ìœ„ë²¡í„° í¬ê¸°: </span>{np.linalg.norm(unit_v)}<span class="st">"</span>)  <span class="cm"># 1.0</span>

<span class="cm"># L1 ë…¸ë¦„ (ë§¨í•´íŠ¼ ê±°ë¦¬) â€” ì •ê·œí™”ì— ì‚¬ìš©</span>
norm_l1 = np.linalg.norm(v, ord=<span class="nu">1</span>)
<span class="fn">print</span>(<span class="st">f"L1 ë…¸ë¦„: </span>{norm_l1}<span class="st">"</span>)  <span class="cm"># 7.0 (|3| + |4|)</span></code></pre>
<div class="code-output"><span class="out-label">Output:</span>
||v|| = 5.0
ë‹¨ìœ„ë²¡í„°: [0.6 0.8]
ë‹¨ìœ„ë²¡í„° í¬ê¸°: 1.0
L1 ë…¸ë¦„: 7.0</div>

<div class="info">
<p class="ni"><strong>ê¸ˆìœµì—ì„œì˜ ë…¸ë¦„:</strong> í¬íŠ¸í´ë¦¬ì˜¤ ë¹„ì¤‘ ë²¡í„° \(\mathbf{w}\)ì˜ L1 ë…¸ë¦„ì´ 1ì´ë©´ "ë¹„ì¤‘ì˜ í•© = 100%"ë¥¼ ì˜ë¯¸í•œë‹¤. L2 ë…¸ë¦„ì€ í¬íŠ¸í´ë¦¬ì˜¤ì˜ "ì§‘ì¤‘ë„"ë¥¼ ì¸¡ì •í•œë‹¤ â€” L2ê°€ í¬ë©´ íŠ¹ì • ì¢…ëª©ì— ì§‘ì¤‘, ì‘ìœ¼ë©´ ë¶„ì‚° íˆ¬ì.</p>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- ì—°ìŠµë¬¸ì œ 1 -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="problem-box">
<div class="problem-title">âœï¸ ì—°ìŠµë¬¸ì œ 1.1</div>
<p class="ni">í¬íŠ¸í´ë¦¬ì˜¤ ë¹„ì¤‘ ë²¡í„° \(\mathbf{w} = \begin{bmatrix} 0.5 \\ 0.3 \\ 0.2 \end{bmatrix}\)ì— ëŒ€í•´:</p>
<ol>
<li>L1 ë…¸ë¦„ì„ êµ¬í•˜ê³ , ì´ê²ƒì´ ì˜ë¯¸í•˜ëŠ” ë°”ë¥¼ ì„¤ëª…í•˜ë¼.</li>
<li>L2 ë…¸ë¦„ì„ êµ¬í•˜ë¼.</li>
<li>ë™ì¼ ë¹„ì¤‘ í¬íŠ¸í´ë¦¬ì˜¤ \(\mathbf{w}_{eq} = \begin{bmatrix} 1/3 \\ 1/3 \\ 1/3 \end{bmatrix}\)ì˜ L2 ë…¸ë¦„ê³¼ ë¹„êµí•˜ë¼. ì–´ëŠ ìª½ì´ ë” ì§‘ì¤‘ëœ í¬íŠ¸í´ë¦¬ì˜¤ì¸ê°€?</li>
</ol>
</div>

<details>
<summary>ğŸ”‘ í’€ì´ ë³´ê¸°</summary>
<div class="answer-content">
<p class="ni"><strong>1) L1 ë…¸ë¦„:</strong></p>
<div class="eq">$$\|\mathbf{w}\|_1 = |0.5| + |0.3| + |0.2| = 1.0$$</div>
<p class="ni">L1 ë…¸ë¦„ = 1.0ì€ ë¹„ì¤‘ì˜ í•©ì´ 100%ë¼ëŠ” ëœ»ì´ë‹¤. ë ˆë²„ë¦¬ì§€ ì—†ì´ ì „ì•¡ íˆ¬ìí•œ ìƒíƒœ.</p>

<p class="ni"><strong>2) L2 ë…¸ë¦„:</strong></p>
<div class="eq">$$\|\mathbf{w}\|_2 = \sqrt{0.5^2 + 0.3^2 + 0.2^2} = \sqrt{0.25 + 0.09 + 0.04} = \sqrt{0.38} \approx 0.6164$$</div>

<p class="ni"><strong>3) ë™ì¼ ë¹„ì¤‘ L2 ë…¸ë¦„:</strong></p>
<div class="eq">$$\|\mathbf{w}_{eq}\|_2 = \sqrt{3 \times (1/3)^2} = \sqrt{3 \times 1/9} = \sqrt{1/3} \approx 0.5774$$</div>
<p class="ni">\(0.6164 > 0.5774\)ì´ë¯€ë¡œ \(\mathbf{w}\)ê°€ ë” ì§‘ì¤‘ëœ í¬íŠ¸í´ë¦¬ì˜¤ë‹¤. ì‚¼ì„±ì „ìì— 50%ë¥¼ ëª°ì•˜ê¸° ë•Œë¬¸.</p>

<pre><code><span class="kw">import</span> numpy <span class="kw">as</span> np
w = np.array([<span class="nu">0.5</span>, <span class="nu">0.3</span>, <span class="nu">0.2</span>])
w_eq = np.array([<span class="nu">1</span>/<span class="nu">3</span>, <span class="nu">1</span>/<span class="nu">3</span>, <span class="nu">1</span>/<span class="nu">3</span>])
<span class="fn">print</span>(<span class="st">f"w  L1: </span>{np.linalg.norm(w, ord=1):.4f}<span class="st">"</span>)   <span class="cm"># 1.0000</span>
<span class="fn">print</span>(<span class="st">f"w  L2: </span>{np.linalg.norm(w):.4f}<span class="st">"</span>)        <span class="cm"># 0.6164</span>
<span class="fn">print</span>(<span class="st">f"eq L2: </span>{np.linalg.norm(w_eq):.4f}<span class="st">"</span>)     <span class="cm"># 0.5774</span></code></pre>
</div>
</details>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- Ch2: ë²¡í„° ì—°ì‚°ê³¼ ë‚´ì  -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<h2 id="ch2">2. ë²¡í„° ì—°ì‚°ê³¼ ë‚´ì </h2>

<h3>2.1 ë²¡í„°ì˜ ê¸°ë³¸ ì—°ì‚°</h3>
<p>ë²¡í„° ì—°ì‚°ì€ ì›ì†Œë³„(element-wise)ë¡œ ì´ë£¨ì–´ì§„ë‹¤. ê°™ì€ ìœ„ì¹˜ì˜ ì›ì†Œë¼ë¦¬ ë”í•˜ê³ , ë¹¼ê³ , ê³±í•œë‹¤. ìŠ¤ì¹¼ë¼ì™€ì˜ ì—°ì‚°ì€ ëª¨ë“  ì›ì†Œì— ë™ì¼í•˜ê²Œ ì ìš©ëœë‹¤.</p>

<div class="eq">
$$\mathbf{a} + \mathbf{b} = \begin{bmatrix} a_1 + b_1 \\ a_2 + b_2 \\ \vdots \\ a_n + b_n \end{bmatrix}, \quad c \cdot \mathbf{a} = \begin{bmatrix} c \cdot a_1 \\ c \cdot a_2 \\ \vdots \\ c \cdot a_n \end{bmatrix}$$
</div>

<pre><code><span class="kw">import</span> numpy <span class="kw">as</span> np

<span class="cm"># ë‘ ì¢…ëª©ì˜ 5ì¼ ìˆ˜ìµë¥ </span>
ret_samsung = np.array([<span class="nu">0.02</span>, -<span class="nu">0.01</span>, <span class="nu">0.03</span>, -<span class="nu">0.005</span>, <span class="nu">0.015</span>])
ret_sk      = np.array([<span class="nu">0.01</span>,  <span class="nu">0.02</span>, -<span class="nu">0.01</span>, <span class="nu">0.025</span>, -<span class="nu">0.005</span>])

<span class="cm"># ì›ì†Œë³„ ë§ì…ˆ: í¬íŠ¸í´ë¦¬ì˜¤ ìˆ˜ìµë¥  (ë™ì¼ ë¹„ì¤‘)</span>
portfolio_ret = <span class="nu">0.5</span> * ret_samsung + <span class="nu">0.5</span> * ret_sk
<span class="fn">print</span>(<span class="st">"í¬íŠ¸í´ë¦¬ì˜¤ ìˆ˜ìµë¥ :"</span>, portfolio_ret)

<span class="cm"># ìŠ¤ì¹¼ë¼ ê³±: ë ˆë²„ë¦¬ì§€ 2ë°°</span>
leveraged = <span class="nu">2</span> * ret_samsung
<span class="fn">print</span>(<span class="st">"2ë°° ë ˆë²„ë¦¬ì§€:"</span>, leveraged)</code></pre>
<div class="code-output"><span class="out-label">Output:</span>
í¬íŠ¸í´ë¦¬ì˜¤ ìˆ˜ìµë¥ : [ 0.015   0.005   0.01    0.01    0.005 ]
2ë°° ë ˆë²„ë¦¬ì§€: [ 0.04  -0.02   0.06  -0.01   0.03 ]</div>

<h3>2.2 ë‚´ì  (Dot Product) â€” ì„ í˜•ëŒ€ìˆ˜ì˜ í•µì‹¬ ì—°ì‚°</h3>
<p>ë‚´ì ì€ ì„ í˜•ëŒ€ìˆ˜ì—ì„œ ê°€ì¥ ì¤‘ìš”í•œ ì—°ì‚°ì´ë‹¤. ë‘ ë²¡í„°ë¥¼ í•˜ë‚˜ì˜ ìŠ¤ì¹¼ë¼ë¡œ ìš”ì•½í•œë‹¤. ì •ì˜ëŠ” ê°„ë‹¨í•˜ë‹¤: ê°™ì€ ìœ„ì¹˜ì˜ ì›ì†Œë¼ë¦¬ ê³±í•´ì„œ ëª¨ë‘ ë”í•œë‹¤.</p>

<div class="eq">
$$\mathbf{a} \cdot \mathbf{b} = \sum_{i=1}^{n} a_i b_i = a_1 b_1 + a_2 b_2 + \cdots + a_n b_n$$
</div>

<p>ë‚´ì ì˜ ê¸°í•˜í•™ì  ì˜ë¯¸ê°€ í•µì‹¬ì´ë‹¤. ë‚´ì ì€ ë‘ ë²¡í„° ì‚¬ì´ì˜ ê°ë„ \(\theta\)ì™€ ê´€ë ¨ëœë‹¤:</p>

<div class="eq">
$$\mathbf{a} \cdot \mathbf{b} = \|\mathbf{a}\| \|\mathbf{b}\| \cos\theta$$
</div>

<div class="def">
<p class="ni"><strong>ë‚´ì ì´ ì•Œë ¤ì£¼ëŠ” ê²ƒ:</strong></p>
<ul>
<li>\(\mathbf{a} \cdot \mathbf{b} > 0\): ë‘ ë²¡í„°ê°€ ê°™ì€ ë°©í–¥ (ì˜ˆê°, \(\theta < 90Â°\))</li>
<li>\(\mathbf{a} \cdot \mathbf{b} = 0\): ë‘ ë²¡í„°ê°€ ì§êµ (ìˆ˜ì§, \(\theta = 90Â°\))</li>
<li>\(\mathbf{a} \cdot \mathbf{b} < 0\): ë‘ ë²¡í„°ê°€ ë°˜ëŒ€ ë°©í–¥ (ë‘”ê°, \(\theta > 90Â°\))</li>
</ul>
<p class="ni">ê¸ˆìœµ í•´ì„: ë‘ ì¢…ëª©ì˜ ìˆ˜ìµë¥  ë²¡í„°ë¥¼ ë‚´ì í•˜ë©´, ì–‘ìˆ˜ë©´ "ê°™ì´ ì›€ì§ì´ëŠ” ì¢…ëª©", 0ì´ë©´ "ë¬´ê´€í•œ ì¢…ëª©", ìŒìˆ˜ë©´ "ë°˜ëŒ€ë¡œ ì›€ì§ì´ëŠ” ì¢…ëª©"ì´ë‹¤. ì´ê²ƒì´ ë°”ë¡œ ìƒê´€ê³„ìˆ˜ì˜ ê¸°ì´ˆë‹¤!</p>
</div>

<pre><code><span class="kw">import</span> numpy <span class="kw">as</span> np

<span class="cm"># ë‚´ì  ê³„ì‚°</span>
a = np.array([<span class="nu">1</span>, <span class="nu">2</span>, <span class="nu">3</span>])
b = np.array([<span class="nu">4</span>, <span class="nu">5</span>, <span class="nu">6</span>])

<span class="cm"># ë°©ë²• 1: np.dot</span>
dot1 = np.dot(a, b)
<span class="fn">print</span>(<span class="st">f"np.dot: </span>{dot1}<span class="st">"</span>)  <span class="cm"># 1Ã—4 + 2Ã—5 + 3Ã—6 = 32</span>

<span class="cm"># ë°©ë²• 2: @ ì—°ì‚°ì (íŒŒì´ì¬ 3.5+)</span>
dot2 = a @ b
<span class="fn">print</span>(<span class="st">f"a @ b:  </span>{dot2}<span class="st">"</span>)  <span class="cm"># 32</span>

<span class="cm"># ë‘ ë²¡í„° ì‚¬ì´ì˜ ê°ë„ êµ¬í•˜ê¸°</span>
cos_theta = np.dot(a, b) / (np.linalg.norm(a) * np.linalg.norm(b))
theta = np.degrees(np.arccos(cos_theta))
<span class="fn">print</span>(<span class="st">f"cos Î¸ = </span>{cos_theta:.4f}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"Î¸ = </span>{theta:.1f}<span class="st">Â°"</span>)  <span class="cm"># ì•½ 12.9Â° â†’ ê±°ì˜ ê°™ì€ ë°©í–¥</span></code></pre>
<div class="code-output"><span class="out-label">Output:</span>
np.dot: 32
a @ b:  32
cos Î¸ = 0.9746
Î¸ = 12.9Â°</div>

<h3>2.3 ë‚´ì ì˜ ê¸ˆìœµ ì‘ìš©: í¬íŠ¸í´ë¦¬ì˜¤ ìˆ˜ìµë¥ </h3>
<p>í¬íŠ¸í´ë¦¬ì˜¤ ìˆ˜ìµë¥ ì€ ë¹„ì¤‘ ë²¡í„°ì™€ ìˆ˜ìµë¥  ë²¡í„°ì˜ ë‚´ì ì´ë‹¤. ì´ê²ƒì´ ì„ í˜•ëŒ€ìˆ˜ê°€ ê¸ˆìœµì—ì„œ ì¤‘ìš”í•œ ê°€ì¥ ì§ì ‘ì ì¸ ì´ìœ ë‹¤.</p>

<div class="eq">
$$r_p = \mathbf{w}^T \mathbf{r} = \sum_{i=1}^{n} w_i r_i$$
</div>

<pre><code><span class="cm"># í¬íŠ¸í´ë¦¬ì˜¤ ìˆ˜ìµë¥  = ë¹„ì¤‘ Â· ìˆ˜ìµë¥  (ë‚´ì )</span>
weights = np.array([<span class="nu">0.4</span>, <span class="nu">0.35</span>, <span class="nu">0.25</span>])  <span class="cm"># ì‚¼ì„± 40%, SK 35%, NAVER 25%</span>
returns = np.array([<span class="nu">0.05</span>, -<span class="nu">0.02</span>, <span class="nu">0.03</span>])  <span class="cm"># ê° ì¢…ëª© ìˆ˜ìµë¥ </span>

portfolio_return = weights @ returns
<span class="fn">print</span>(<span class="st">f"í¬íŠ¸í´ë¦¬ì˜¤ ìˆ˜ìµë¥ : </span>{portfolio_return:.2%}<span class="st">"</span>)
<span class="cm"># 0.4Ã—0.05 + 0.35Ã—(-0.02) + 0.25Ã—0.03 = 0.02 + (-0.007) + 0.0075 = 2.05%</span></code></pre>
<div class="code-output"><span class="out-label">Output:</span>
í¬íŠ¸í´ë¦¬ì˜¤ ìˆ˜ìµë¥ : 2.05%</div>

<!-- â–¼ Plotly: ë‚´ì ê³¼ ê°ë„ ì‹œê°í™” -->
<div id="plot-ch2-dot" style="width:100%;height:420px;margin:25px 0"></div>
<script>
(function(){
  function mulberry32(a){return function(){a|=0;a=a+0x6D2B79F5|0;var t=Math.imul(a^a>>>15,1|a);t=t+Math.imul(t^t>>>7,61|t)^t;return((t^t>>>14)>>>0)/4294967296}}
  var rng=mulberry32(2024);
  var angles=[],dots=[];
  for(var deg=0;deg<=360;deg+=5){
    var rad=deg*Math.PI/180;
    var bx=Math.cos(rad),by=Math.sin(rad);
    angles.push(deg);
    dots.push(3*bx+2*by);
  }
  Plotly.newPlot('plot-ch2-dot',[{
    x:angles,y:dots,mode:'lines',name:'aÂ·b',
    line:{width:3,color:'#e53935'},
    fill:'tozeroy',fillcolor:'rgba(229,57,53,0.1)'
  }],{
    title:{text:'ğŸ“Š ë²¡í„° a=(3,2)ì™€ ë‹¨ìœ„ë²¡í„° b(Î¸)ì˜ ë‚´ì  ë³€í™”',font:{size:13}},
    xaxis:{title:'bì˜ ê°ë„ Î¸ (ë„)',dtick:45,range:[0,360]},
    yaxis:{title:'ë‚´ì  ê°’ aÂ·b',zeroline:true,zerolinewidth:2,zerolinecolor:'#333'},
    margin:{l:50,r:20,t:45,b:40},
    shapes:[
      {type:'line',x0:90,x1:90,y0:-4,y1:4,line:{color:'#1e88e5',dash:'dot',width:1}},
      {type:'line',x0:270,x1:270,y0:-4,y1:4,line:{color:'#1e88e5',dash:'dot',width:1}}
    ],
    annotations:[
      {x:90,y:0.3,text:'ì§êµ (90Â°)',showarrow:false,font:{size:10,color:'#1e88e5'}},
      {x:270,y:0.3,text:'ì§êµ (270Â°)',showarrow:false,font:{size:10,color:'#1e88e5'}},
      {x:33.7,y:3.7,text:'ìµœëŒ€ (ê°™ì€ ë°©í–¥)',showarrow:true,arrowhead:2,font:{size:10}},
      {x:213.7,y:-3.7,text:'ìµœì†Œ (ë°˜ëŒ€ ë°©í–¥)',showarrow:true,arrowhead:2,font:{size:10}}
    ]
  },{responsive:true});
})();
</script>
<p class="ni" style="font-size:11px;color:#888;text-align:center;margin-top:-10px">ğŸ–±ï¸ ë‚´ì ì€ cos í•¨ìˆ˜ì²˜ëŸ¼ ë³€í•œë‹¤. ê°™ì€ ë°©í–¥ì´ë©´ ìµœëŒ€, ì§êµí•˜ë©´ 0, ë°˜ëŒ€ ë°©í–¥ì´ë©´ ìµœì†Œ</p>

<h3>2.4 ì§êµ(Orthogonality) â€” ë¶„ì‚° íˆ¬ìì˜ ìˆ˜í•™ì  ê·¼ê±°</h3>
<p>ë‘ ë²¡í„°ì˜ ë‚´ì ì´ 0ì´ë©´ ì§êµ(orthogonal)í•œë‹¤ê³  í•œë‹¤. ì§êµí•˜ëŠ” ë²¡í„°ë“¤ì€ ì„œë¡œ ì™„ì „íˆ ë…ë¦½ì ì´ë‹¤. ê¸ˆìœµì—ì„œ ì§êµ = ìƒê´€ê´€ê³„ 0 = ì™„ë²½í•œ ë¶„ì‚° íˆ¬ì.</p>

<div class="eq">
$$\mathbf{a} \perp \mathbf{b} \iff \mathbf{a} \cdot \mathbf{b} = 0$$
</div>

<pre><code><span class="cm"># ì§êµ ë²¡í„° í™•ì¸</span>
a = np.array([<span class="nu">1</span>, <span class="nu">0</span>])   <span class="cm"># xì¶• ë°©í–¥</span>
b = np.array([<span class="nu">0</span>, <span class="nu">1</span>])   <span class="cm"># yì¶• ë°©í–¥</span>
<span class="fn">print</span>(<span class="st">f"a Â· b = </span>{np.dot(a, b)}<span class="st">"</span>)  <span class="cm"># 0 â†’ ì§êµ!</span>

<span class="cm"># ê¸ˆìœµ ì˜ˆ: ìƒê´€ê´€ê³„ ì—†ëŠ” ë‘ ìì‚°</span>
<span class="cm"># (ì‹¤ì œë¡œëŠ” ì™„ë²½í•œ ì§êµëŠ” ë“œë¬¼ì§€ë§Œ, ê°€ê¹Œìš¸ìˆ˜ë¡ ë¶„ì‚° íš¨ê³¼ â†‘)</span>
gold_ret  = np.array([<span class="nu">0.01</span>, -<span class="nu">0.02</span>,  <span class="nu">0.03</span>, <span class="nu">0.01</span>])
stock_ret = np.array([<span class="nu">0.02</span>,  <span class="nu">0.01</span>, -<span class="nu">0.01</span>, <span class="nu">0.03</span>])

<span class="cm"># í‰ê·  ì œê±° í›„ ë‚´ì  â†’ ê³µë¶„ì‚°ì˜ ê¸°ì´ˆ</span>
gold_dm  = gold_ret - gold_ret.mean()
stock_dm = stock_ret - stock_ret.mean()
<span class="fn">print</span>(<span class="st">f"í‰ê·  ì œê±° í›„ ë‚´ì : </span>{np.dot(gold_dm, stock_dm):.6f}<span class="st">"</span>)</code></pre>
<div class="code-output"><span class="out-label">Output:</span>
a Â· b = 0
í‰ê·  ì œê±° í›„ ë‚´ì : -0.000163</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- ì—°ìŠµë¬¸ì œ 2 -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="problem-box">
<div class="problem-title">âœï¸ ì—°ìŠµë¬¸ì œ 2.1</div>
<p class="ni">ë²¡í„° \(\mathbf{a} = \begin{bmatrix} 2 \\ -1 \\ 3 \end{bmatrix}\)ì™€ \(\mathbf{b} = \begin{bmatrix} 1 \\ 4 \\ -2 \end{bmatrix}\)ì— ëŒ€í•´:</p>
<ol>
<li>ë‚´ì  \(\mathbf{a} \cdot \mathbf{b}\)ë¥¼ êµ¬í•˜ë¼.</li>
<li>ë‘ ë²¡í„° ì‚¬ì´ì˜ ê°ë„ \(\theta\)ë¥¼ êµ¬í•˜ë¼.</li>
<li>ë‘ ë²¡í„°ëŠ” ê°™ì€ ë°©í–¥ì¸ê°€, ë°˜ëŒ€ ë°©í–¥ì¸ê°€, ì§êµì— ê°€ê¹Œìš´ê°€?</li>
</ol>
</div>

<details>
<summary>ğŸ”‘ í’€ì´ ë³´ê¸°</summary>
<div class="answer-content">
<p class="ni"><strong>1) ë‚´ì :</strong></p>
<div class="eq">$$\mathbf{a} \cdot \mathbf{b} = 2 \times 1 + (-1) \times 4 + 3 \times (-2) = 2 - 4 - 6 = -8$$</div>

<p class="ni"><strong>2) ê°ë„:</strong></p>
<div class="eq">$$\|\mathbf{a}\| = \sqrt{4+1+9} = \sqrt{14}, \quad \|\mathbf{b}\| = \sqrt{1+16+4} = \sqrt{21}$$</div>
<div class="eq">$$\cos\theta = \frac{-8}{\sqrt{14}\sqrt{21}} = \frac{-8}{\sqrt{294}} \approx \frac{-8}{17.146} \approx -0.4667$$</div>
<div class="eq">$$\theta = \arccos(-0.4667) \approx 117.8Â°$$</div>

<p class="ni"><strong>3) í•´ì„:</strong> ë‚´ì ì´ ìŒìˆ˜ì´ê³  ê°ë„ê°€ 90Â°ë³´ë‹¤ í¬ë¯€ë¡œ, ë‘ ë²¡í„°ëŠ” ë°˜ëŒ€ ë°©í–¥ì— ê°€ê¹ë‹¤. ê¸ˆìœµìœ¼ë¡œ í•´ì„í•˜ë©´ ì´ ë‘ ìì‚°ì€ ì—­ìƒê´€ ê´€ê³„ì— ìˆì–´ ë¶„ì‚° íˆ¬ìì— ìœ ë¦¬í•˜ë‹¤.</p>

<pre><code><span class="kw">import</span> numpy <span class="kw">as</span> np
a = np.array([<span class="nu">2</span>, -<span class="nu">1</span>, <span class="nu">3</span>])
b = np.array([<span class="nu">1</span>, <span class="nu">4</span>, -<span class="nu">2</span>])
<span class="fn">print</span>(<span class="st">f"ë‚´ì : </span>{a @ b}<span class="st">"</span>)  <span class="cm"># -8</span>
cos_t = (a @ b) / (np.linalg.norm(a) * np.linalg.norm(b))
<span class="fn">print</span>(<span class="st">f"Î¸ = </span>{np.degrees(np.arccos(cos_t)):.1f}<span class="st">Â°"</span>)  <span class="cm"># 117.8Â°</span></code></pre>
</div>
</details>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- Ch3: í–‰ë ¬ ì—°ì‚° -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<h2 id="ch3">3. í–‰ë ¬ ì—°ì‚°</h2>

<h3>3.1 í–‰ë ¬ì´ë€?</h3>
<p>í–‰ë ¬(matrix)ì€ ìˆ«ìë¥¼ ì§ì‚¬ê°í˜• ëª¨ì–‘ìœ¼ë¡œ ë°°ì—´í•œ ê²ƒì´ë‹¤. \(m\)ê°œì˜ í–‰(row)ê³¼ \(n\)ê°œì˜ ì—´(column)ì„ ê°€ì§„ í–‰ë ¬ì„ \(m \times n\) í–‰ë ¬ì´ë¼ í•œë‹¤. ê¸ˆìœµì—ì„œ í–‰ë ¬ì€ ì–´ë””ì—ë‚˜ ìˆë‹¤: ì¢…ëª©Ã—ë‚ ì§œ ìˆ˜ìµë¥  í…Œì´ë¸”, ê³µë¶„ì‚° í–‰ë ¬, íŒ©í„° ë¡œë”© í–‰ë ¬ ë“±.</p>

<div class="eq">
$$A = \begin{bmatrix} a_{11} & a_{12} & \cdots & a_{1n} \\ a_{21} & a_{22} & \cdots & a_{2n} \\ \vdots & \vdots & \ddots & \vdots \\ a_{m1} & a_{m2} & \cdots & a_{mn} \end{bmatrix}_{m \times n}$$
</div>

<pre><code><span class="kw">import</span> numpy <span class="kw">as</span> np

<span class="cm"># 3ì¢…ëª© Ã— 4ì¼ ìˆ˜ìµë¥  í–‰ë ¬</span>
returns = np.array([
    [<span class="nu">0.02</span>, -<span class="nu">0.01</span>,  <span class="nu">0.03</span>,  <span class="nu">0.01</span>],  <span class="cm"># ì‚¼ì„±ì „ì</span>
    [<span class="nu">0.01</span>,  <span class="nu">0.02</span>, -<span class="nu">0.01</span>,  <span class="nu">0.03</span>],  <span class="cm"># SKí•˜ì´ë‹‰ìŠ¤</span>
    [<span class="nu">0.03</span>, -<span class="nu">0.02</span>,  <span class="nu">0.01</span>, -<span class="nu">0.01</span>]   <span class="cm"># NAVER</span>
])
<span class="fn">print</span>(<span class="st">f"shape: </span>{returns.shape}<span class="st">"</span>)  <span class="cm"># (3, 4) â†’ 3í–‰ 4ì—´</span>
<span class="fn">print</span>(<span class="st">f"ì‚¼ì„±ì „ì 2ì¼ì°¨ ìˆ˜ìµë¥ : </span>{returns[0, 1]}<span class="st">"</span>)  <span class="cm"># -0.01</span>
<span class="fn">print</span>(<span class="st">f"SKí•˜ì´ë‹‰ìŠ¤ ì „ì²´: </span>{returns[1, :]}<span class="st">"</span>)  <span class="cm"># í–‰ ìŠ¬ë¼ì´ì‹±</span>
<span class="fn">print</span>(<span class="st">f"3ì¼ì°¨ ì „ ì¢…ëª©: </span>{returns[:, 2]}<span class="st">"</span>)    <span class="cm"># ì—´ ìŠ¬ë¼ì´ì‹±</span></code></pre>
<div class="code-output"><span class="out-label">Output:</span>
shape: (3, 4)
ì‚¼ì„±ì „ì 2ì¼ì°¨ ìˆ˜ìµë¥ : -0.01
SKí•˜ì´ë‹‰ìŠ¤ ì „ì²´: [ 0.01  0.02 -0.01  0.03]
3ì¼ì°¨ ì „ ì¢…ëª©: [ 0.03 -0.01  0.01]</div>

<h3>3.2 ì „ì¹˜ (Transpose)</h3>
<p>í–‰ë ¬ì˜ í–‰ê³¼ ì—´ì„ ë’¤ë°”ê¾¸ëŠ” ì—°ì‚°ì´ë‹¤. \(m \times n\) í–‰ë ¬ì´ \(n \times m\) í–‰ë ¬ì´ ëœë‹¤. ê¸°í˜¸ëŠ” \(A^T\).</p>

<div class="eq">
$$A = \begin{bmatrix} 1 & 2 & 3 \\ 4 & 5 & 6 \end{bmatrix}_{2 \times 3} \quad \Rightarrow \quad A^T = \begin{bmatrix} 1 & 4 \\ 2 & 5 \\ 3 & 6 \end{bmatrix}_{3 \times 2}$$
</div>

<pre><code>A = np.array([[<span class="nu">1</span>, <span class="nu">2</span>, <span class="nu">3</span>],
              [<span class="nu">4</span>, <span class="nu">5</span>, <span class="nu">6</span>]])
<span class="fn">print</span>(<span class="st">"A shape:"</span>, A.shape)      <span class="cm"># (2, 3)</span>
<span class="fn">print</span>(<span class="st">"A^T shape:"</span>, A.T.shape)  <span class="cm"># (3, 2)</span>
<span class="fn">print</span>(A.T)</code></pre>
<div class="code-output"><span class="out-label">Output:</span>
A shape: (2, 3)
A^T shape: (3, 2)
[[1 4]
 [2 5]
 [3 6]]</div>

<h3>3.3 í–‰ë ¬ ê³±ì…ˆ â€” ê°€ì¥ ì¤‘ìš”í•œ ì—°ì‚°</h3>
<p>í–‰ë ¬ ê³±ì…ˆì€ ì›ì†Œë³„ ê³±ì…ˆì´ ì•„ë‹ˆë‹¤. \(A\)ì˜ í–‰ê³¼ \(B\)ì˜ ì—´ì„ ë‚´ì í•˜ëŠ” ê²ƒì´ë‹¤. \(A\)ê°€ \(m \times k\)ì´ê³  \(B\)ê°€ \(k \times n\)ì´ë©´, ê²°ê³¼ \(C = AB\)ëŠ” \(m \times n\)ì´ë‹¤. ì•ˆìª½ ì°¨ì› \(k\)ê°€ ê°™ì•„ì•¼ ê³±ì…ˆì´ ê°€ëŠ¥í•˜ë‹¤.</p>

<div class="eq">
$$C_{ij} = \sum_{p=1}^{k} A_{ip} B_{pj} = \text{Aì˜ ië²ˆì§¸ í–‰} \cdot \text{Bì˜ jë²ˆì§¸ ì—´}$$
</div>

<div class="warn">
<p class="ni"><strong>í–‰ë ¬ ê³±ì…ˆ â‰  ì›ì†Œë³„ ê³±ì…ˆ:</strong> <code>A @ B</code>ëŠ” í–‰ë ¬ ê³±ì…ˆ, <code>A * B</code>ëŠ” ì›ì†Œë³„ ê³±ì…ˆ(Hadamard product). ì´ ë‘˜ì„ í˜¼ë™í•˜ë©´ í° ë²„ê·¸ê°€ ìƒê¸´ë‹¤. í–‰ë ¬ ê³±ì…ˆì€ êµí™˜ë²•ì¹™ì´ ì„±ë¦½í•˜ì§€ ì•ŠëŠ”ë‹¤: \(AB \neq BA\) (ì¼ë°˜ì ìœ¼ë¡œ).</p>
</div>

<pre><code><span class="cm"># í–‰ë ¬ ê³±ì…ˆ ì˜ˆì œ</span>
A = np.array([[<span class="nu">1</span>, <span class="nu">2</span>],
              [<span class="nu">3</span>, <span class="nu">4</span>]])  <span class="cm"># 2Ã—2</span>
B = np.array([[<span class="nu">5</span>, <span class="nu">6</span>],
              [<span class="nu">7</span>, <span class="nu">8</span>]])  <span class="cm"># 2Ã—2</span>

<span class="cm"># í–‰ë ¬ ê³±ì…ˆ (@ ì—°ì‚°ì)</span>
C = A @ B
<span class="fn">print</span>(<span class="st">"A @ B ="</span>)
<span class="fn">print</span>(C)
<span class="cm"># [[1Ã—5+2Ã—7, 1Ã—6+2Ã—8],   = [[19, 22],</span>
<span class="cm">#  [3Ã—5+4Ã—7, 3Ã—6+4Ã—8]]      [43, 50]]</span>

<span class="cm"># êµí™˜ë²•ì¹™ ë¶ˆì„±ë¦½ í™•ì¸</span>
<span class="fn">print</span>(<span class="st">"\nB @ A ="</span>)
<span class="fn">print</span>(B @ A)  <span class="cm"># ë‹¤ë¥¸ ê²°ê³¼!</span>

<span class="cm"># ì›ì†Œë³„ ê³±ì…ˆ (Hadamard product)</span>
<span class="fn">print</span>(<span class="st">"\nA * B (ì›ì†Œë³„) ="</span>)
<span class="fn">print</span>(A * B)  <span class="cm"># ì™„ì „íˆ ë‹¤ë¥¸ ê²°ê³¼!</span></code></pre>
<div class="code-output"><span class="out-label">Output:</span>
A @ B =
[[19 22]
 [43 50]]

B @ A =
[[23 34]
 [31 46]]

A * B (ì›ì†Œë³„) =
[[ 5 12]
 [21 32]]</div>

<h3>3.4 íŠ¹ìˆ˜ í–‰ë ¬ë“¤</h3>
<p>ìì£¼ ë“±ì¥í•˜ëŠ” íŠ¹ìˆ˜ í–‰ë ¬ë“¤ì„ ì•Œì•„ë‘ì. ì´ë“¤ì€ ë‚˜ì¤‘ì— ê³ ìœ ê°’, SVD, PCAì—ì„œ í•µì‹¬ ì—­í• ì„ í•œë‹¤.</p>

<div class="tc">Table 1. íŠ¹ìˆ˜ í–‰ë ¬ ì •ë¦¬</div>
<table>
<tr><th>í–‰ë ¬</th><th>ì •ì˜</th><th>ì„±ì§ˆ</th><th>ê¸ˆìœµ ì˜ˆì‹œ</th></tr>
<tr><td>ë‹¨ìœ„í–‰ë ¬ \(I\)</td><td>ëŒ€ê°ì„  1, ë‚˜ë¨¸ì§€ 0</td><td>\(AI = IA = A\)</td><td>ë¬´ë³€í™˜ (ì›ë³¸ ìœ ì§€)</td></tr>
<tr><td>ëŒ€ê°í–‰ë ¬</td><td>ëŒ€ê°ì„ ë§Œ ê°’, ë‚˜ë¨¸ì§€ 0</td><td>ìŠ¤ì¼€ì¼ë§</td><td>ê°œë³„ ìì‚° ë¶„ì‚°</td></tr>
<tr><td>ëŒ€ì¹­í–‰ë ¬</td><td>\(A = A^T\)</td><td>ê³ ìœ ê°’ì´ ì‹¤ìˆ˜</td><td>ê³µë¶„ì‚° í–‰ë ¬</td></tr>
<tr><td>ì§êµí–‰ë ¬</td><td>\(Q^T Q = I\)</td><td>ê¸¸ì´/ê°ë„ ë³´ì¡´</td><td>PCA íšŒì „ í–‰ë ¬</td></tr>
<tr><td>ì–‘ì •ì¹˜í–‰ë ¬</td><td>\(\mathbf{x}^T A \mathbf{x} > 0\)</td><td>ê³ ìœ ê°’ ëª¨ë‘ ì–‘ìˆ˜</td><td>ìœ íš¨í•œ ê³µë¶„ì‚° í–‰ë ¬</td></tr>
</table>

<pre><code><span class="cm"># íŠ¹ìˆ˜ í–‰ë ¬ ìƒì„±</span>
I = np.eye(<span class="nu">3</span>)           <span class="cm"># 3Ã—3 ë‹¨ìœ„í–‰ë ¬</span>
D = np.diag([<span class="nu">2</span>, <span class="nu">3</span>, <span class="nu">5</span>])  <span class="cm"># ëŒ€ê°í–‰ë ¬</span>
Z = np.zeros((<span class="nu">2</span>, <span class="nu">3</span>))    <span class="cm"># ì˜í–‰ë ¬</span>
O = np.ones((<span class="nu">3</span>, <span class="nu">3</span>))     <span class="cm"># ëª¨ë“  ì›ì†Œ 1</span>

<span class="fn">print</span>(<span class="st">"ë‹¨ìœ„í–‰ë ¬:\n"</span>, I)
<span class="fn">print</span>(<span class="st">"ëŒ€ê°í–‰ë ¬:\n"</span>, D)

<span class="cm"># ëŒ€ì¹­í–‰ë ¬ í™•ì¸: ê³µë¶„ì‚° í–‰ë ¬ì€ í•­ìƒ ëŒ€ì¹­</span>
data = np.random.randn(<span class="nu">100</span>, <span class="nu">3</span>)
cov = np.cov(data.T)
<span class="fn">print</span>(<span class="st">f"\nê³µë¶„ì‚° í–‰ë ¬ ëŒ€ì¹­? </span>{np.allclose(cov, cov.T)}<span class="st">"</span>)  <span class="cm"># True</span></code></pre>
<div class="code-output"><span class="out-label">Output:</span>
ë‹¨ìœ„í–‰ë ¬:
 [[1. 0. 0.]
 [0. 1. 0.]
 [0. 0. 1.]]
ëŒ€ê°í–‰ë ¬:
 [[2 0 0]
 [0 3 0]
 [0 0 5]]

ê³µë¶„ì‚° í–‰ë ¬ ëŒ€ì¹­? True</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- ì—°ìŠµë¬¸ì œ 3 -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="problem-box">
<div class="problem-title">âœï¸ ì—°ìŠµë¬¸ì œ 3.1</div>
<p class="ni">í–‰ë ¬ \(A = \begin{bmatrix} 1 & 2 \\ 3 & 4 \end{bmatrix}\)ì™€ \(B = \begin{bmatrix} 0 & 1 \\ 1 & 0 \end{bmatrix}\)ì— ëŒ€í•´:</p>
<ol>
<li>\(AB\)ë¥¼ ì†ìœ¼ë¡œ ê³„ì‚°í•˜ë¼.</li>
<li>\(BA\)ë¥¼ ì†ìœ¼ë¡œ ê³„ì‚°í•˜ë¼.</li>
<li>\(AB = BA\)ì¸ê°€? í–‰ë ¬ ê³±ì…ˆì˜ ì–´ë–¤ ì„±ì§ˆì„ ë³´ì—¬ì£¼ëŠ”ê°€?</li>
<li>\(B\)ëŠ” ì–´ë–¤ íŠ¹ìˆ˜ í–‰ë ¬ì¸ê°€? \(B\)ë¥¼ ê³±í•˜ë©´ ì›ë˜ í–‰ë ¬ì— ì–´ë–¤ ë³€í™”ê°€ ìƒê¸°ëŠ”ê°€?</li>
</ol>
</div>

<details>
<summary>ğŸ”‘ í’€ì´ ë³´ê¸°</summary>
<div class="answer-content">
<p class="ni"><strong>1) AB:</strong></p>
<div class="eq">$$AB = \begin{bmatrix} 1 \times 0 + 2 \times 1 & 1 \times 1 + 2 \times 0 \\ 3 \times 0 + 4 \times 1 & 3 \times 1 + 4 \times 0 \end{bmatrix} = \begin{bmatrix} 2 & 1 \\ 4 & 3 \end{bmatrix}$$</div>

<p class="ni"><strong>2) BA:</strong></p>
<div class="eq">$$BA = \begin{bmatrix} 0 \times 1 + 1 \times 3 & 0 \times 2 + 1 \times 4 \\ 1 \times 1 + 0 \times 3 & 1 \times 2 + 0 \times 4 \end{bmatrix} = \begin{bmatrix} 3 & 4 \\ 1 & 2 \end{bmatrix}$$</div>

<p class="ni"><strong>3)</strong> \(AB \neq BA\). í–‰ë ¬ ê³±ì…ˆì€ êµí™˜ë²•ì¹™ì´ ì„±ë¦½í•˜ì§€ ì•ŠëŠ”ë‹¤.</p>

<p class="ni"><strong>4)</strong> \(B\)ëŠ” ì¹˜í™˜ í–‰ë ¬(permutation matrix)ì´ë‹¤. \(AB\)ëŠ” \(A\)ì˜ ì—´ì„ êµí™˜í•˜ê³ , \(BA\)ëŠ” \(A\)ì˜ í–‰ì„ êµí™˜í•œë‹¤.</p>

<pre><code>A = np.array([[<span class="nu">1</span>,<span class="nu">2</span>],[<span class="nu">3</span>,<span class="nu">4</span>]])
B = np.array([[<span class="nu">0</span>,<span class="nu">1</span>],[<span class="nu">1</span>,<span class="nu">0</span>]])
<span class="fn">print</span>(<span class="st">"AB =\n"</span>, A @ B)  <span class="cm"># ì—´ êµí™˜</span>
<span class="fn">print</span>(<span class="st">"BA =\n"</span>, B @ A)  <span class="cm"># í–‰ êµí™˜</span></code></pre>
</div>
</details>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- Ch4: ì—­í–‰ë ¬ê³¼ ì—°ë¦½ë°©ì •ì‹ -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<h2 id="ch4">4. ì—­í–‰ë ¬ê³¼ ì—°ë¦½ë°©ì •ì‹</h2>

<h3>4.1 ì—­í–‰ë ¬ì´ë€?</h3>
<p>ìˆ«ìì—ì„œ 5ì˜ ì—­ìˆ˜ëŠ” 1/5ì´ë‹¤. 5 Ã— (1/5) = 1. í–‰ë ¬ì—ì„œë„ ë§ˆì°¬ê°€ì§€ë‹¤. í–‰ë ¬ \(A\)ì˜ ì—­í–‰ë ¬ \(A^{-1}\)ì€ ê³±í•˜ë©´ ë‹¨ìœ„í–‰ë ¬ì´ ë˜ëŠ” í–‰ë ¬ì´ë‹¤.</p>

<div class="eq">
$$A A^{-1} = A^{-1} A = I$$
</div>

<p>ì—­í–‰ë ¬ì´ ì¡´ì¬í•˜ë ¤ë©´ í–‰ë ¬ì´ ì •ë°©í–‰ë ¬(í–‰=ì—´)ì´ê³ , í–‰ë ¬ì‹(determinant)ì´ 0ì´ ì•„ë‹ˆì–´ì•¼ í•œë‹¤. í–‰ë ¬ì‹ì´ 0ì´ë©´ ì—­í–‰ë ¬ì´ ì—†ê³ , ì´ë¥¼ íŠ¹ì´í–‰ë ¬(singular matrix)ì´ë¼ í•œë‹¤.</p>

<h3>4.2 í–‰ë ¬ì‹ (Determinant)</h3>
<p>2Ã—2 í–‰ë ¬ì˜ í–‰ë ¬ì‹ì€ ê°„ë‹¨í•˜ë‹¤:</p>

<div class="eq">
$$\det\begin{bmatrix} a & b \\ c & d \end{bmatrix} = ad - bc$$
</div>

<p>í–‰ë ¬ì‹ì˜ ê¸°í•˜í•™ì  ì˜ë¯¸: í–‰ë ¬ì´ ê³µê°„ì„ ì–¼ë§ˆë‚˜ ëŠ˜ë¦¬ê±°ë‚˜ ì¤„ì´ëŠ”ì§€ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤. \(|\det(A)| = 2\)ì´ë©´ ë©´ì ì´ 2ë°°ë¡œ ëŠ˜ì–´ë‚˜ê³ , \(\det(A) = 0\)ì´ë©´ ì°¨ì›ì´ ì¶•ì†Œëœë‹¤(ë©´ì ì´ 0ì´ ëœë‹¤).</p>

<pre><code><span class="kw">import</span> numpy <span class="kw">as</span> np

A = np.array([[<span class="nu">3</span>, <span class="nu">1</span>],
              [<span class="nu">2</span>, <span class="nu">4</span>]])

<span class="cm"># í–‰ë ¬ì‹</span>
det_A = np.linalg.det(A)
<span class="fn">print</span>(<span class="st">f"det(A) = </span>{det_A:.1f}<span class="st">"</span>)  <span class="cm"># 3Ã—4 - 1Ã—2 = 10</span>

<span class="cm"># ì—­í–‰ë ¬</span>
A_inv = np.linalg.inv(A)
<span class="fn">print</span>(<span class="st">f"A^(-1) =\n</span>{A_inv}<span class="st">"</span>)

<span class="cm"># ê²€ì¦: A Ã— A^(-1) = I</span>
<span class="fn">print</span>(<span class="st">f"\nA @ A^(-1) =\n</span>{A @ A_inv}<span class="st">"</span>)  <span class="cm"># ë‹¨ìœ„í–‰ë ¬</span></code></pre>
<div class="code-output"><span class="out-label">Output:</span>
det(A) = 10.0
A^(-1) =
[[ 0.4 -0.1]
 [-0.2  0.3]]

A @ A^(-1) =
[[1. 0.]
 [0. 1.]]</div>

<h3>4.3 ì—°ë¦½ë°©ì •ì‹ê³¼ ì—­í–‰ë ¬</h3>
<p>ì—°ë¦½ë°©ì •ì‹ \(A\mathbf{x} = \mathbf{b}\)ì˜ í•´ëŠ” \(\mathbf{x} = A^{-1}\mathbf{b}\)ì´ë‹¤. ì´ê²ƒì´ ì—­í–‰ë ¬ì˜ ê°€ì¥ ì‹¤ìš©ì ì¸ ìš©ë„ë‹¤.</p>

<div class="eq">
$$\begin{cases} 3x + y = 7 \\ 2x + 4y = 12 \end{cases} \quad \Rightarrow \quad \begin{bmatrix} 3 & 1 \\ 2 & 4 \end{bmatrix} \begin{bmatrix} x \\ y \end{bmatrix} = \begin{bmatrix} 7 \\ 12 \end{bmatrix}$$
</div>

<pre><code><span class="cm"># ì—°ë¦½ë°©ì •ì‹ í’€ê¸°</span>
A = np.array([[<span class="nu">3</span>, <span class="nu">1</span>],
              [<span class="nu">2</span>, <span class="nu">4</span>]])
b = np.array([<span class="nu">7</span>, <span class="nu">12</span>])

<span class="cm"># ë°©ë²• 1: ì—­í–‰ë ¬ ì‚¬ìš©</span>
x = np.linalg.inv(A) @ b
<span class="fn">print</span>(<span class="st">f"ì—­í–‰ë ¬ ë°©ë²•: x = </span>{x[0]:.2f}<span class="st">, y = </span>{x[1]:.2f}<span class="st">"</span>)

<span class="cm"># ë°©ë²• 2: np.linalg.solve (ë” ë¹ ë¥´ê³  ì•ˆì •ì !)</span>
x = np.linalg.solve(A, b)
<span class="fn">print</span>(<span class="st">f"solve ë°©ë²•:  x = </span>{x[0]:.2f}<span class="st">, y = </span>{x[1]:.2f}<span class="st">"</span>)

<span class="cm"># ê²€ì¦: A @ x = b?</span>
<span class="fn">print</span>(<span class="st">f"ê²€ì¦: A @ x = </span>{A @ x}<span class="st">"</span>)  <span class="cm"># [7, 12] âœ“</span></code></pre>
<div class="code-output"><span class="out-label">Output:</span>
ì—­í–‰ë ¬ ë°©ë²•: x = 1.60, y = 2.20
solve ë°©ë²•:  x = 1.60, y = 2.20
ê²€ì¦: A @ x = [ 7. 12.]</div>

<div class="info">
<p class="ni"><strong>ì‹¤ë¬´ íŒ:</strong> ì—­í–‰ë ¬ì„ ì§ì ‘ êµ¬í•˜ëŠ” ê²ƒ(<code>np.linalg.inv</code>)ë³´ë‹¤ <code>np.linalg.solve</code>ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ìˆ˜ì¹˜ì ìœ¼ë¡œ ë” ì•ˆì •ì ì´ê³  ë¹ ë¥´ë‹¤. ì—­í–‰ë ¬ ê³„ì‚°ì€ ë°˜ì˜¬ë¦¼ ì˜¤ì°¨ê°€ ëˆ„ì ë  ìˆ˜ ìˆë‹¤. ê¸ˆìœµì—ì„œ ëŒ€ê·œëª¨ í¬íŠ¸í´ë¦¬ì˜¤ ìµœì í™”ë¥¼ í•  ë•Œ ì´ ì°¨ì´ê°€ ì¤‘ìš”í•´ì§„ë‹¤.</p>
</div>

<h3>4.4 ê¸ˆìœµ ì‘ìš©: íŒ©í„° ëª¨ë¸ íšŒê·€</h3>
<p>ì£¼ì‹ ìˆ˜ìµë¥ ì„ ì‹œì¥ íŒ©í„°ë¡œ ì„¤ëª…í•˜ëŠ” íšŒê·€ ëª¨ë¸ \(\mathbf{r} = X\boldsymbol{\beta} + \boldsymbol{\epsilon}\)ì—ì„œ, ìµœì†Œì œê³±ë²•(OLS)ì˜ í•´ëŠ”:</p>

<div class="eq">
$$\hat{\boldsymbol{\beta}} = (X^T X)^{-1} X^T \mathbf{r}$$
</div>

<p>ì´ ê³µì‹ì´ ë°”ë¡œ ì—­í–‰ë ¬ì˜ ê¸ˆìœµ ì‘ìš©ì´ë‹¤. \(X^T X\)ì˜ ì—­í–‰ë ¬ì´ ì¡´ì¬í•´ì•¼ íšŒê·€ ê³„ìˆ˜ë¥¼ êµ¬í•  ìˆ˜ ìˆë‹¤. ë‹¤ì¤‘ê³µì„ ì„±(multicollinearity)ì´ ìˆìœ¼ë©´ \(X^T X\)ê°€ ê±°ì˜ íŠ¹ì´í–‰ë ¬ì´ ë˜ì–´ ì—­í–‰ë ¬ì´ ë¶ˆì•ˆì •í•´ì§„ë‹¤.</p>

<pre><code><span class="cm"># ê°„ë‹¨í•œ OLS íšŒê·€: ì‚¼ì„±ì „ì ìˆ˜ìµë¥  = Î²â‚€ + Î²â‚ Ã— ì‹œì¥ìˆ˜ìµë¥ </span>
np.random.seed(<span class="nu">42</span>)
n = <span class="nu">100</span>
market_ret = np.random.normal(<span class="nu">0.001</span>, <span class="nu">0.02</span>, n)  <span class="cm"># ì‹œì¥ ìˆ˜ìµë¥ </span>
samsung_ret = <span class="nu">0.0005</span> + <span class="nu">1.2</span> * market_ret + np.random.normal(<span class="nu">0</span>, <span class="nu">0.01</span>, n)

<span class="cm"># X í–‰ë ¬ êµ¬ì„± (ì ˆí¸ í¬í•¨)</span>
X = np.column_stack([np.ones(n), market_ret])

<span class="cm"># OLS: Î² = (X'X)^(-1) X'y</span>
beta = np.linalg.solve(X.T @ X, X.T @ samsung_ret)
<span class="fn">print</span>(<span class="st">f"Î± (ì ˆí¸): </span>{beta[0]:.6f}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"Î² (ì‹œì¥ ë² íƒ€): </span>{beta[1]:.4f}<span class="st">"</span>)  <span class="cm"># â‰ˆ 1.2</span></code></pre>
<div class="code-output"><span class="out-label">Output:</span>
Î± (ì ˆí¸): 0.000312
Î² (ì‹œì¥ ë² íƒ€): 1.2143</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- ì—°ìŠµë¬¸ì œ 4 -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="problem-box">
<div class="problem-title">âœï¸ ì—°ìŠµë¬¸ì œ 4.1</div>
<p class="ni">ë‹¤ìŒ ì—°ë¦½ë°©ì •ì‹ì„ í–‰ë ¬ë¡œ í‘œí˜„í•˜ê³  NumPyë¡œ í’€ì–´ë¼:</p>
<div class="eq">$$\begin{cases} 2x + 3y - z = 1 \\ 4x + y + 2z = 11 \\ x - 2y + 3z = 8 \end{cases}$$</div>
</div>

<details>
<summary>ğŸ”‘ í’€ì´ ë³´ê¸°</summary>
<div class="answer-content">
<div class="eq">$$\begin{bmatrix} 2 & 3 & -1 \\ 4 & 1 & 2 \\ 1 & -2 & 3 \end{bmatrix} \begin{bmatrix} x \\ y \\ z \end{bmatrix} = \begin{bmatrix} 1 \\ 11 \\ 8 \end{bmatrix}$$</div>

<pre><code>A = np.array([[<span class="nu">2</span>, <span class="nu">3</span>, -<span class="nu">1</span>],
              [<span class="nu">4</span>, <span class="nu">1</span>,  <span class="nu">2</span>],
              [<span class="nu">1</span>, -<span class="nu">2</span>, <span class="nu">3</span>]])
b = np.array([<span class="nu">1</span>, <span class="nu">11</span>, <span class="nu">8</span>])

x = np.linalg.solve(A, b)
<span class="fn">print</span>(<span class="st">f"x = </span>{x[0]:.4f}<span class="st">, y = </span>{x[1]:.4f}<span class="st">, z = </span>{x[2]:.4f}<span class="st">"</span>)
<span class="cm"># x = 2.0000, y = -1.0000, z = 3.0000</span>

<span class="cm"># ê²€ì¦</span>
<span class="fn">print</span>(<span class="st">f"ê²€ì¦: A @ x = </span>{A @ x}<span class="st">"</span>)  <span class="cm"># [1, 11, 8]</span></code></pre>
<div class="code-output"><span class="out-label">Output:</span>
x = 2.0000, y = -1.0000, z = 3.0000
ê²€ì¦: A @ x = [ 1. 11.  8.]</div>
</div>
</details>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- Ch5: ì„ í˜•ë³€í™˜ì˜ ê¸°í•˜í•™ -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<h2 id="ch5">5. ì„ í˜•ë³€í™˜ì˜ ê¸°í•˜í•™</h2>

<h3>5.1 í–‰ë ¬ = ê³µê°„ì˜ ë³€í™˜</h3>
<p>í–‰ë ¬ ê³±ì…ˆ \(A\mathbf{x}\)ëŠ” ë²¡í„° \(\mathbf{x}\)ë¥¼ ìƒˆë¡œìš´ ìœ„ì¹˜ë¡œ ì´ë™ì‹œí‚¤ëŠ” ë³€í™˜ì´ë‹¤. ì´ê²ƒì´ ì„ í˜•ëŒ€ìˆ˜ì˜ ê°€ì¥ ì•„ë¦„ë‹¤ìš´ í†µì°°ì´ë‹¤: í–‰ë ¬ì€ ìˆ«ìì˜ ë°°ì—´ì´ ì•„ë‹ˆë¼, ê³µê°„ì„ ë³€í˜•í•˜ëŠ” í•¨ìˆ˜ë‹¤.</p>

<div class="def">
<p class="ni"><strong>ì„ í˜•ë³€í™˜ì˜ ì¢…ë¥˜:</strong></p>
<ul>
<li><strong>íšŒì „(Rotation):</strong> \(\begin{bmatrix} \cos\theta & -\sin\theta \\ \sin\theta & \cos\theta \end{bmatrix}\) â€” ì›ì  ì¤‘ì‹¬ìœ¼ë¡œ Î¸ë§Œí¼ íšŒì „</li>
<li><strong>ìŠ¤ì¼€ì¼ë§(Scaling):</strong> \(\begin{bmatrix} s_x & 0 \\ 0 & s_y \end{bmatrix}\) â€” x, y ë°©í–¥ìœ¼ë¡œ ëŠ˜ë¦¬ê¸°/ì¤„ì´ê¸°</li>
<li><strong>ì „ë‹¨(Shear):</strong> \(\begin{bmatrix} 1 & k \\ 0 & 1 \end{bmatrix}\) â€” í•œ ë°©í–¥ìœ¼ë¡œ ê¸°ìš¸ì´ê¸°</li>
<li><strong>ë°˜ì‚¬(Reflection):</strong> \(\begin{bmatrix} 1 & 0 \\ 0 & -1 \end{bmatrix}\) â€” xì¶• ëŒ€ì¹­</li>
</ul>
</div>

<!-- â–¼ Plotly: ì„ í˜•ë³€í™˜ ì‹œê°í™” -->
<div id="plot-ch5-transform" style="width:100%;height:480px;margin:25px 0"></div>
<script>
(function(){
  // ë‹¨ìœ„ ì •ì‚¬ê°í˜•ì˜ ê¼­ì§“ì 
  var sq_x=[0,1,1,0,0], sq_y=[0,0,1,1,0];
  // ë³€í™˜ í–‰ë ¬: íšŒì „ 45Â° + ìŠ¤ì¼€ì¼ 1.5
  var angle=Math.PI/4, s=1.5;
  var cos=Math.cos(angle)*s, sin=Math.sin(angle)*s;
  var tx=[],ty=[];
  for(var i=0;i<sq_x.length;i++){
    tx.push(cos*sq_x[i]-sin*sq_y[i]);
    ty.push(sin*sq_x[i]+cos*sq_y[i]);
  }
  // ì „ë‹¨ ë³€í™˜
  var shx=[],shy=[];
  var k=0.8;
  for(var i=0;i<sq_x.length;i++){
    shx.push(sq_x[i]+k*sq_y[i]);
    shy.push(sq_y[i]);
  }
  Plotly.newPlot('plot-ch5-transform',[
    {x:sq_x,y:sq_y,mode:'lines',name:'ì›ë³¸ (ë‹¨ìœ„ ì •ì‚¬ê°í˜•)',line:{width:3,color:'#1e88e5'},fill:'toself',fillcolor:'rgba(30,136,229,0.15)'},
    {x:tx,y:ty,mode:'lines',name:'íšŒì „+ìŠ¤ì¼€ì¼ (45Â°, 1.5Ã—)',line:{width:3,color:'#e53935'},fill:'toself',fillcolor:'rgba(229,57,53,0.15)'},
    {x:shx,y:shy,mode:'lines',name:'ì „ë‹¨ (k=0.8)',line:{width:3,color:'#43a047',dash:'dash'},fill:'toself',fillcolor:'rgba(67,160,71,0.15)'}
  ],{
    title:{text:'ğŸ”„ ì„ í˜•ë³€í™˜: í–‰ë ¬ì´ ê³µê°„ì„ ì–´ë–»ê²Œ ë³€í˜•í•˜ëŠ”ê°€',font:{size:13}},
    xaxis:{title:'x',range:[-2,2.5],zeroline:true,zerolinewidth:2,scaleanchor:'y'},
    yaxis:{title:'y',range:[-1,2.5],zeroline:true,zerolinewidth:2},
    margin:{l:50,r:20,t:45,b:40},
    legend:{x:0.02,y:0.98}
  },{responsive:true});
})();
</script>
<p class="ni" style="font-size:11px;color:#888;text-align:center;margin-top:-10px">ğŸ–±ï¸ íŒŒë€ ì •ì‚¬ê°í˜•ì´ í–‰ë ¬ ê³±ì…ˆìœ¼ë¡œ ë¹¨ê°„ìƒ‰(íšŒì „+í™•ëŒ€)ê³¼ ì´ˆë¡ìƒ‰(ì „ë‹¨)ìœ¼ë¡œ ë³€í™˜ëœë‹¤</p>

<h3>5.2 ì™œ ê¸ˆìœµì—ì„œ ì¤‘ìš”í•œê°€?</h3>
<p>í¬íŠ¸í´ë¦¬ì˜¤ ìµœì í™”ì—ì„œ ê³µë¶„ì‚° í–‰ë ¬ \(\Sigma\)ëŠ” ìˆ˜ìµë¥  ê³µê°„ì„ ë³€í™˜í•˜ëŠ” í–‰ë ¬ì´ë‹¤. \(\Sigma\)ê°€ ìˆ˜ìµë¥  ë²¡í„°ë¥¼ ì–´ë–»ê²Œ ë³€í™˜í•˜ëŠ”ì§€ ì´í•´í•˜ë©´, ë¦¬ìŠ¤í¬ê°€ ì–´ëŠ ë°©í–¥ìœ¼ë¡œ ì§‘ì¤‘ë˜ì–´ ìˆëŠ”ì§€ ì•Œ ìˆ˜ ìˆë‹¤. ì´ê²ƒì´ ë°”ë¡œ ê³ ìœ ê°’ ë¶„í•´ì™€ PCAì˜ í•µì‹¬ ì•„ì´ë””ì–´ë‹¤.</p>

<div class="info">
<p class="ni"><strong>í•µì‹¬ í†µì°°:</strong> í–‰ë ¬ \(A\)ê°€ ê³µê°„ì„ ë³€í™˜í•  ë•Œ, ëŒ€ë¶€ë¶„ì˜ ë²¡í„°ëŠ” ë°©í–¥ì´ ë°”ë€ë‹¤. í•˜ì§€ë§Œ íŠ¹ë³„í•œ ë²¡í„°ë“¤ì€ ë°©í–¥ì´ ë°”ë€Œì§€ ì•Šê³  í¬ê¸°ë§Œ ë³€í•œë‹¤. ì´ íŠ¹ë³„í•œ ë²¡í„°ê°€ ë°”ë¡œ ê³ ìœ ë²¡í„°(eigenvector)ì´ê³ , í¬ê¸°ê°€ ë³€í•˜ëŠ” ë¹„ìœ¨ì´ ê³ ìœ ê°’(eigenvalue)ì´ë‹¤. â†’ 6ì¥ì—ì„œ ìì„¸íˆ!</p>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- Ch6: ê³ ìœ ê°’ê³¼ ê³ ìœ ë²¡í„° -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<h2 id="ch6">6. ê³ ìœ ê°’ê³¼ ê³ ìœ ë²¡í„° (Eigenvalues &amp; Eigenvectors)</h2>

<h3>6.1 ì§ê´€ì  ì´í•´</h3>
<p>í–‰ë ¬ \(A\)ë¥¼ ê³±í•´ë„ ë°©í–¥ì´ ë³€í•˜ì§€ ì•ŠëŠ” ë²¡í„° \(\mathbf{v}\)ê°€ ìˆë‹¤ë©´, ê·¸ ë²¡í„°ë¥¼ ê³ ìœ ë²¡í„°ë¼ í•˜ê³ , í¬ê¸°ê°€ ë³€í•˜ëŠ” ë¹„ìœ¨ \(\lambda\)ë¥¼ ê³ ìœ ê°’ì´ë¼ í•œë‹¤.</p>

<div class="eq">
$$A\mathbf{v} = \lambda\mathbf{v}$$
</div>

<p>ë¹„ìœ í•˜ìë©´: ì§€ì§„ì´ ì¼ì–´ë‚˜ë©´ ê±´ë¬¼ì´ ì—¬ëŸ¬ ë°©í–¥ìœ¼ë¡œ í”ë“¤ë¦°ë‹¤. í•˜ì§€ë§Œ íŠ¹ì • ë°©í–¥ìœ¼ë¡œëŠ” ë” í¬ê²Œ í”ë“¤ë¦¬ê³ , ë‹¤ë¥¸ ë°©í–¥ìœ¼ë¡œëŠ” ëœ í”ë“¤ë¦°ë‹¤. ê³ ìœ ë²¡í„°ëŠ” "í”ë“¤ë¦¬ëŠ” ë°©í–¥"ì´ê³ , ê³ ìœ ê°’ì€ "ì–¼ë§ˆë‚˜ í¬ê²Œ í”ë“¤ë¦¬ëŠ”ì§€"ë‹¤.</p>

<p>ê¸ˆìœµì—ì„œ: ê³µë¶„ì‚° í–‰ë ¬ì˜ ê³ ìœ ë²¡í„°ëŠ” "ë¦¬ìŠ¤í¬ê°€ ì§‘ì¤‘ëœ ë°©í–¥"ì´ê³ , ê³ ìœ ê°’ì€ "ê·¸ ë°©í–¥ì˜ ë¦¬ìŠ¤í¬ í¬ê¸°(ë¶„ì‚°)"ë‹¤. ê°€ì¥ í° ê³ ìœ ê°’ì— ëŒ€ì‘í•˜ëŠ” ê³ ìœ ë²¡í„°ê°€ ì‹œì¥ ì „ì²´ì˜ ì›€ì§ì„(ì‹œì¥ íŒ©í„°)ì„ ë‚˜íƒ€ë‚¸ë‹¤.</p>

<h3>6.2 ê³ ìœ ê°’ ë¶„í•´ (Eigendecomposition)</h3>
<p>ëŒ€ì¹­í–‰ë ¬ \(A\)ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ë¶„í•´í•  ìˆ˜ ìˆë‹¤:</p>

<div class="eq">
$$A = Q \Lambda Q^T$$
</div>

<p>ì—¬ê¸°ì„œ \(Q\)ëŠ” ê³ ìœ ë²¡í„°ë¥¼ ì—´ë¡œ ê°€ì§„ ì§êµí–‰ë ¬, \(\Lambda\)ëŠ” ê³ ìœ ê°’ì„ ëŒ€ê°ì„ ì— ê°€ì§„ ëŒ€ê°í–‰ë ¬ì´ë‹¤. ì´ê²ƒì´ ê³ ìœ ê°’ ë¶„í•´(eigendecomposition)ë‹¤.</p>

<pre><code><span class="kw">import</span> numpy <span class="kw">as</span> np

<span class="cm"># ëŒ€ì¹­í–‰ë ¬ (ê³µë¶„ì‚° í–‰ë ¬ì²˜ëŸ¼)</span>
A = np.array([[<span class="nu">4</span>, <span class="nu">2</span>],
              [<span class="nu">2</span>, <span class="nu">3</span>]])

<span class="cm"># ê³ ìœ ê°’ ë¶„í•´</span>
eigenvalues, eigenvectors = np.linalg.eigh(A)  <span class="cm"># eigh: ëŒ€ì¹­í–‰ë ¬ ì „ìš© (ë” ì•ˆì •ì )</span>

<span class="fn">print</span>(<span class="st">"ê³ ìœ ê°’:"</span>, eigenvalues)
<span class="fn">print</span>(<span class="st">"ê³ ìœ ë²¡í„°:\n"</span>, eigenvectors)

<span class="cm"># ê²€ì¦: A @ v = Î» Ã— v</span>
<span class="kw">for</span> i <span class="kw">in</span> <span class="fn">range</span>(<span class="nu">2</span>):
    lam = eigenvalues[i]
    v = eigenvectors[:, i]
    Av = A @ v
    lv = lam * v
    <span class="fn">print</span>(<span class="st">f"\nÎ»{i+1} = </span>{lam:.4f}<span class="st">"</span>)
    <span class="fn">print</span>(<span class="st">f"A @ v{i+1} = </span>{Av}<span class="st">"</span>)
    <span class="fn">print</span>(<span class="st">f"Î»{i+1} Ã— v{i+1} = </span>{lv}<span class="st">"</span>)
    <span class="fn">print</span>(<span class="st">f"ê°™ì€ê°€? </span>{np.allclose(Av, lv)}<span class="st">"</span>)</code></pre>
<div class="code-output"><span class="out-label">Output:</span>
ê³ ìœ ê°’: [1.5858 5.4142]
ê³ ìœ ë²¡í„°:
 [[-0.6464  0.7630]
 [ 0.7630  0.6464]]

Î»1 = 1.5858
A @ v1 = [-1.0251  1.2100]
Î»1 Ã— v1 = [-1.0251  1.2100]
ê°™ì€ê°€? True

Î»2 = 5.4142
A @ v2 = [ 4.1312  3.4999]
Î»2 Ã— v2 = [ 4.1312  3.4999]
ê°™ì€ê°€? True</div>

<!-- â–¼ Plotly: ê³ ìœ ë²¡í„° ì‹œê°í™” (íƒ€ì›) -->
<div id="plot-ch6-eigen" style="width:100%;height:480px;margin:25px 0"></div>
<script>
(function(){
  function mulberry32(a){return function(){a|=0;a=a+0x6D2B79F5|0;var t=Math.imul(a^a>>>15,1|a);t=t+Math.imul(t^t>>>7,61|t)^t;return((t^t>>>14)>>>0)/4294967296}}
  var rng=mulberry32(777);
  // ê³µë¶„ì‚° í–‰ë ¬ [[4,2],[2,3]]ì˜ ê³ ìœ ê°’/ê³ ìœ ë²¡í„°
  var lam1=1.5858,lam2=5.4142;
  var v1=[-0.6464,0.7630],v2=[0.7630,0.6464];
  // íƒ€ì› ê·¸ë¦¬ê¸°
  var ex=[],ey=[];
  for(var t=0;t<=2*Math.PI;t+=0.05){
    var x=Math.sqrt(lam2)*Math.cos(t);
    var y=Math.sqrt(lam1)*Math.sin(t);
    ex.push(v2[0]*x+v1[0]*y);
    ey.push(v2[1]*x+v1[1]*y);
  }
  // ëœë¤ ë°ì´í„° í¬ì¸íŠ¸ (ê³µë¶„ì‚° í–‰ë ¬ì—ì„œ ìƒ˜í”Œë§ ì‹œë®¬ë ˆì´ì…˜)
  var dx=[],dy=[];
  for(var i=0;i<200;i++){
    var u1=rng(),u2=rng();
    var z1=Math.sqrt(-2*Math.log(u1))*Math.cos(2*Math.PI*u2);
    var z2=Math.sqrt(-2*Math.log(u1))*Math.sin(2*Math.PI*u2);
    var px=Math.sqrt(lam2)*v2[0]*z1+Math.sqrt(lam1)*v1[0]*z2;
    var py=Math.sqrt(lam2)*v2[1]*z1+Math.sqrt(lam1)*v1[1]*z2;
    dx.push(px);dy.push(py);
  }
  var s2=Math.sqrt(lam2),s1=Math.sqrt(lam1);
  Plotly.newPlot('plot-ch6-eigen',[
    {x:dx,y:dy,mode:'markers',name:'ë°ì´í„° í¬ì¸íŠ¸',marker:{size:4,color:'rgba(30,136,229,0.4)'}},
    {x:ex,y:ey,mode:'lines',name:'1Ïƒ íƒ€ì›',line:{width:2,color:'#e53935'}},
    {x:[0,v2[0]*s2],y:[0,v2[1]*s2],mode:'lines+markers',name:'ê³ ìœ ë²¡í„° 1 (Î»=5.41)',
     line:{width:4,color:'#e53935'},marker:{size:[4,12],symbol:['circle','arrow-wide'],angleref:'previous'}},
    {x:[0,v1[0]*s1],y:[0,v1[1]*s1],mode:'lines+markers',name:'ê³ ìœ ë²¡í„° 2 (Î»=1.59)',
     line:{width:4,color:'#43a047'},marker:{size:[4,12],symbol:['circle','arrow-wide'],angleref:'previous'}}
  ],{
    title:{text:'ğŸ¯ ê³ ìœ ë²¡í„° = ë¶„ì‚°ì´ ìµœëŒ€/ìµœì†Œì¸ ë°©í–¥',font:{size:13}},
    xaxis:{title:'x',zeroline:true,zerolinewidth:2,scaleanchor:'y',range:[-6,6]},
    yaxis:{title:'y',zeroline:true,zerolinewidth:2,range:[-5,5]},
    margin:{l:50,r:20,t:45,b:40},
    legend:{x:0.02,y:0.98,bgcolor:'rgba(255,255,255,0.8)'}
  },{responsive:true});
})();
</script>
<p class="ni" style="font-size:11px;color:#888;text-align:center;margin-top:-10px">ğŸ–±ï¸ ë¹¨ê°„ í™”ì‚´í‘œ(ê³ ìœ ë²¡í„°1)ê°€ ë¶„ì‚°ì´ ê°€ì¥ í° ë°©í–¥, ì´ˆë¡ í™”ì‚´í‘œ(ê³ ìœ ë²¡í„°2)ê°€ ê°€ì¥ ì‘ì€ ë°©í–¥. ì´ê²ƒì´ PCAì˜ í•µì‹¬!</p>

<h3>6.3 ê³ ìœ ê°’ì˜ ì„±ì§ˆ</h3>
<div class="ok">
<p class="ni"><strong>ëŒ€ì¹­í–‰ë ¬ì˜ ê³ ìœ ê°’ ì„±ì§ˆ (ê¸ˆìœµì—ì„œ ì¤‘ìš”!):</strong></p>
<ul>
<li>ëŒ€ì¹­í–‰ë ¬ì˜ ê³ ìœ ê°’ì€ í•­ìƒ ì‹¤ìˆ˜ë‹¤ (ë³µì†Œìˆ˜ê°€ ì•„ë‹˜)</li>
<li>ì„œë¡œ ë‹¤ë¥¸ ê³ ìœ ê°’ì— ëŒ€ì‘í•˜ëŠ” ê³ ìœ ë²¡í„°ëŠ” ì§êµí•œë‹¤</li>
<li>ê³ ìœ ê°’ì˜ í•© = í–‰ë ¬ì˜ ëŒ€ê°í•©(trace) = ì „ì²´ ë¶„ì‚°</li>
<li>ê³ ìœ ê°’ì˜ ê³± = í–‰ë ¬ì‹(determinant)</li>
<li>ê³µë¶„ì‚° í–‰ë ¬ì˜ ê³ ìœ ê°’ì€ ëª¨ë‘ 0 ì´ìƒ (ì–‘ë°˜ì •ì¹˜)</li>
</ul>
</div>

<pre><code><span class="cm"># ê³ ìœ ê°’ ì„±ì§ˆ í™•ì¸</span>
A = np.array([[<span class="nu">4</span>, <span class="nu">2</span>],
              [<span class="nu">2</span>, <span class="nu">3</span>]])
eigenvalues = np.linalg.eigh(A)[<span class="nu">0</span>]

<span class="fn">print</span>(<span class="st">f"ê³ ìœ ê°’: </span>{eigenvalues}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"ê³ ìœ ê°’ í•©: </span>{eigenvalues.sum():.4f}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"trace(A):  </span>{np.trace(A)}<span class="st">"</span>)  <span class="cm"># ê°™ë‹¤!</span>
<span class="fn">print</span>(<span class="st">f"ê³ ìœ ê°’ ê³±: </span>{eigenvalues.prod():.4f}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"det(A):    </span>{np.linalg.det(A):.4f}<span class="st">"</span>)  <span class="cm"># ê°™ë‹¤!</span></code></pre>
<div class="code-output"><span class="out-label">Output:</span>
ê³ ìœ ê°’: [1.5858 5.4142]
ê³ ìœ ê°’ í•©: 7.0000
trace(A):  7
ê³ ìœ ê°’ ê³±: 8.0000
det(A):    8.0000</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- ì—°ìŠµë¬¸ì œ 6 -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="problem-box">
<div class="problem-title">âœï¸ ì—°ìŠµë¬¸ì œ 6.1</div>
<p class="ni">í–‰ë ¬ \(A = \begin{bmatrix} 5 & 1 \\ 1 & 3 \end{bmatrix}\)ì— ëŒ€í•´:</p>
<ol>
<li>ê³ ìœ ê°’ì„ ì†ìœ¼ë¡œ êµ¬í•˜ë¼. (íŒíŠ¸: íŠ¹ì„±ë°©ì •ì‹ \(\det(A - \lambda I) = 0\)ì„ í’€ì–´ë¼)</li>
<li>ê° ê³ ìœ ê°’ì— ëŒ€ì‘í•˜ëŠ” ê³ ìœ ë²¡í„°ë¥¼ êµ¬í•˜ë¼.</li>
<li>ê³ ìœ ê°’ì˜ í•©ì´ trace(A)ì™€ ê°™ì€ì§€, ê³ ìœ ê°’ì˜ ê³±ì´ det(A)ì™€ ê°™ì€ì§€ í™•ì¸í•˜ë¼.</li>
</ol>
</div>

<details>
<summary>ğŸ”‘ í’€ì´ ë³´ê¸°</summary>
<div class="answer-content">
<p class="ni"><strong>1) íŠ¹ì„±ë°©ì •ì‹:</strong></p>
<div class="eq">$$\det(A - \lambda I) = \det\begin{bmatrix} 5-\lambda & 1 \\ 1 & 3-\lambda \end{bmatrix} = (5-\lambda)(3-\lambda) - 1 = 0$$</div>
<div class="eq">$$\lambda^2 - 8\lambda + 14 = 0 \quad \Rightarrow \quad \lambda = \frac{8 \pm \sqrt{64-56}}{2} = \frac{8 \pm 2\sqrt{2}}{2} = 4 \pm \sqrt{2}$$</div>
<p class="ni">\(\lambda_1 = 4 - \sqrt{2} \approx 2.586\), \(\lambda_2 = 4 + \sqrt{2} \approx 5.414\)</p>

<p class="ni"><strong>2) ê³ ìœ ë²¡í„°:</strong></p>
<p class="ni">\(\lambda_1 = 4 - \sqrt{2}\)ì¼ ë•Œ: \((A - \lambda_1 I)\mathbf{v} = 0\)</p>
<div class="eq">$$\begin{bmatrix} 1+\sqrt{2} & 1 \\ 1 & -1+\sqrt{2} \end{bmatrix}\mathbf{v} = 0 \quad \Rightarrow \quad \mathbf{v}_1 = \begin{bmatrix} 1 \\ -(1+\sqrt{2}) \end{bmatrix}$$</div>
<p class="ni">\(\lambda_2 = 4 + \sqrt{2}\)ì¼ ë•Œ: \(\mathbf{v}_2 = \begin{bmatrix} 1 \\ \sqrt{2}-1 \end{bmatrix}\)</p>

<p class="ni"><strong>3) ê²€ì¦:</strong></p>
<div class="eq">$$\lambda_1 + \lambda_2 = (4-\sqrt{2}) + (4+\sqrt{2}) = 8 = \text{trace}(A) = 5 + 3 \checkmark$$</div>
<div class="eq">$$\lambda_1 \times \lambda_2 = (4-\sqrt{2})(4+\sqrt{2}) = 16 - 2 = 14 = \det(A) = 15 - 1 \checkmark$$</div>

<pre><code>A = np.array([[<span class="nu">5</span>, <span class="nu">1</span>], [<span class="nu">1</span>, <span class="nu">3</span>]])
vals, vecs = np.linalg.eigh(A)
<span class="fn">print</span>(<span class="st">f"ê³ ìœ ê°’: </span>{vals}<span class="st">"</span>)  <span class="cm"># [2.5858, 5.4142]</span>
<span class="fn">print</span>(<span class="st">f"í•©: </span>{vals.sum():.1f}<span class="st"> = trace: </span>{np.trace(A)}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"ê³±: </span>{vals.prod():.1f}<span class="st"> = det: </span>{np.linalg.det(A):.1f}<span class="st">"</span>)</code></pre>
</div>
</details>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- Ch7: SVD (íŠ¹ì´ê°’ ë¶„í•´) -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<h2 id="ch7">7. SVD (íŠ¹ì´ê°’ ë¶„í•´, Singular Value Decomposition)</h2>

<h3>7.1 ê³ ìœ ê°’ ë¶„í•´ì˜ í•œê³„</h3>
<p>ê³ ìœ ê°’ ë¶„í•´ëŠ” ì •ë°©í–‰ë ¬(í–‰=ì—´)ì—ë§Œ ì ìš©í•  ìˆ˜ ìˆë‹¤. í•˜ì§€ë§Œ í˜„ì‹¤ì˜ ë°ì´í„°ëŠ” ëŒ€ë¶€ë¶„ ì§ì‚¬ê°í˜•ì´ë‹¤: 100ì¢…ëª© Ã— 252ê±°ë˜ì¼ ìˆ˜ìµë¥  í–‰ë ¬ì€ 100Ã—252ë‹¤. ì´ëŸ° í–‰ë ¬ì„ ë¶„í•´í•˜ë ¤ë©´ SVDê°€ í•„ìš”í•˜ë‹¤.</p>

<h3>7.2 SVDë€?</h3>
<p>ì„ì˜ì˜ \(m \times n\) í–‰ë ¬ \(A\)ë¥¼ ì„¸ í–‰ë ¬ì˜ ê³±ìœ¼ë¡œ ë¶„í•´í•œë‹¤:</p>

<div class="eq">
$$A = U \Sigma V^T$$
</div>

<div class="def">
<p class="ni"><strong>SVDì˜ ì„¸ êµ¬ì„±ìš”ì†Œ:</strong></p>
<ul>
<li>\(U\) (\(m \times m\)): ì™¼ìª½ íŠ¹ì´ë²¡í„° í–‰ë ¬. í–‰ ê³µê°„ì˜ ì§êµ ê¸°ì €. ê¸ˆìœµì—ì„œ "ì¢…ëª© íŒ¨í„´"</li>
<li>\(\Sigma\) (\(m \times n\)): íŠ¹ì´ê°’ ëŒ€ê°í–‰ë ¬. ê° íŒ¨í„´ì˜ ì¤‘ìš”ë„(í¬ê¸°). ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬</li>
<li>\(V^T\) (\(n \times n\)): ì˜¤ë¥¸ìª½ íŠ¹ì´ë²¡í„° í–‰ë ¬. ì—´ ê³µê°„ì˜ ì§êµ ê¸°ì €. ê¸ˆìœµì—ì„œ "ì‹œê°„ íŒ¨í„´"</li>
</ul>
</div>

<p>í•µì‹¬ ì•„ì´ë””ì–´: ë³µì¡í•œ í–‰ë ¬ì„ "íŒ¨í„´ Ã— ì¤‘ìš”ë„ Ã— íŒ¨í„´"ìœ¼ë¡œ ë¶„í•´í•˜ëŠ” ê²ƒì´ë‹¤. ê°€ì¥ í° íŠ¹ì´ê°’ì— ëŒ€ì‘í•˜ëŠ” íŒ¨í„´ì´ ë°ì´í„°ì˜ ê°€ì¥ ì¤‘ìš”í•œ êµ¬ì¡°ë¥¼ ë‹´ê³  ìˆë‹¤.</p>

<pre><code><span class="kw">import</span> numpy <span class="kw">as</span> np

<span class="cm"># 4ì¢…ëª© Ã— 5ì¼ ìˆ˜ìµë¥  í–‰ë ¬</span>
A = np.array([
    [<span class="nu">0.02</span>, -<span class="nu">0.01</span>,  <span class="nu">0.03</span>,  <span class="nu">0.01</span>, -<span class="nu">0.02</span>],
    [<span class="nu">0.03</span>, -<span class="nu">0.015</span>, <span class="nu">0.04</span>,  <span class="nu">0.015</span>,-<span class="nu">0.025</span>],
    [-<span class="nu">0.01</span>, <span class="nu">0.02</span>, -<span class="nu">0.01</span>, <span class="nu">0.005</span>, <span class="nu">0.03</span>],
    [<span class="nu">0.01</span>, -<span class="nu">0.005</span>, <span class="nu">0.02</span>,  <span class="nu">0.008</span>,-<span class="nu">0.01</span>]
])

<span class="cm"># SVD ë¶„í•´</span>
U, sigma, Vt = np.linalg.svd(A, full_matrices=<span class="kw">False</span>)

<span class="fn">print</span>(<span class="st">f"U shape:     </span>{U.shape}<span class="st">"</span>)      <span class="cm"># (4, 4)</span>
<span class="fn">print</span>(<span class="st">f"sigma shape: </span>{sigma.shape}<span class="st">"</span>)  <span class="cm"># (4,)</span>
<span class="fn">print</span>(<span class="st">f"Vt shape:    </span>{Vt.shape}<span class="st">"</span>)     <span class="cm"># (4, 5)</span>
<span class="fn">print</span>(<span class="st">f"\níŠ¹ì´ê°’: </span>{sigma}<span class="st">"</span>)

<span class="cm"># ê° íŠ¹ì´ê°’ì´ ì„¤ëª…í•˜ëŠ” ë¹„ìœ¨</span>
explained = sigma**<span class="nu">2</span> / np.sum(sigma**<span class="nu">2</span>)
<span class="fn">print</span>(<span class="st">f"ì„¤ëª… ë¹„ìœ¨: </span>{explained}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"ìƒìœ„ 2ê°œë¡œ </span>{explained[:2].sum():.1%}<span class="st"> ì„¤ëª…"</span>)</code></pre>
<div class="code-output"><span class="out-label">Output:</span>
U shape:     (4, 4)
sigma shape: (4,)
Vt shape:    (4, 5)

íŠ¹ì´ê°’: [0.0741 0.0432 0.0078 0.0019]
ì„¤ëª… ë¹„ìœ¨: [0.7367 0.2505 0.0082 0.0046]
ìƒìœ„ 2ê°œë¡œ 98.7% ì„¤ëª…</div>

<h3>7.3 ì €ë­í¬ ê·¼ì‚¬ (Low-Rank Approximation)</h3>
<p>SVDì˜ ê°€ì¥ ê°•ë ¥í•œ ì‘ìš©ì€ ì €ë­í¬ ê·¼ì‚¬ë‹¤. ìƒìœ„ \(k\)ê°œì˜ íŠ¹ì´ê°’ë§Œ ì‚¬ìš©í•˜ë©´ ì›ë˜ í–‰ë ¬ì„ ê·¼ì‚¬í•  ìˆ˜ ìˆë‹¤. ì´ê²ƒì´ ì°¨ì› ì¶•ì†Œì˜ í•µì‹¬ì´ë‹¤.</p>

<div class="eq">
$$A \approx A_k = U_k \Sigma_k V_k^T \quad (\text{ìƒìœ„ } k \text{ê°œë§Œ ì‚¬ìš©})$$
</div>

<pre><code><span class="cm"># ìƒìœ„ 2ê°œ íŠ¹ì´ê°’ìœ¼ë¡œ ê·¼ì‚¬</span>
k = <span class="nu">2</span>
A_approx = U[:, :k] @ np.diag(sigma[:k]) @ Vt[:k, :]

<span class="fn">print</span>(<span class="st">"ì›ë³¸:\n"</span>, np.round(A, <span class="nu">4</span>))
<span class="fn">print</span>(<span class="st">"\nê·¼ì‚¬ (rank-2):\n"</span>, np.round(A_approx, <span class="nu">4</span>))
<span class="fn">print</span>(<span class="st">f"\nê·¼ì‚¬ ì˜¤ì°¨: </span>{np.linalg.norm(A - A_approx):.6f}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"ì›ë³¸ ë…¸ë¦„:  </span>{np.linalg.norm(A):.6f}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"ì˜¤ì°¨ ë¹„ìœ¨:  </span>{np.linalg.norm(A - A_approx)/np.linalg.norm(A):.2%}<span class="st">"</span>)</code></pre>
<div class="code-output"><span class="out-label">Output:</span>
ì›ë³¸:
 [[ 0.02   -0.01    0.03    0.01   -0.02  ]
 [ 0.03   -0.015   0.04    0.015  -0.025 ]
 [-0.01    0.02   -0.01    0.005   0.03  ]
 [ 0.01   -0.005   0.02    0.008  -0.01  ]]

ê·¼ì‚¬ (rank-2):
 [[ 0.0199 -0.0101  0.0299  0.0104 -0.0199]
 [ 0.0301 -0.0149  0.0401  0.0147 -0.0251]
 [-0.0098  0.0199 -0.0112  0.0046  0.0301]
 [ 0.0099 -0.005   0.0199  0.0082 -0.0099]]

ê·¼ì‚¬ ì˜¤ì°¨: 0.008012
ì›ë³¸ ë…¸ë¦„:  0.074135
ì˜¤ì°¨ ë¹„ìœ¨:  10.81%</div>

<div class="info">
<p class="ni"><strong>SVDì™€ ê³ ìœ ê°’ ë¶„í•´ì˜ ê´€ê³„:</strong> \(A^T A\)ì˜ ê³ ìœ ê°’ ë¶„í•´ë¥¼ í•˜ë©´ \(V\)ì™€ \(\sigma^2\)ë¥¼ ì–»ê³ , \(AA^T\)ì˜ ê³ ìœ ê°’ ë¶„í•´ë¥¼ í•˜ë©´ \(U\)ì™€ \(\sigma^2\)ë¥¼ ì–»ëŠ”ë‹¤. ì¦‰ SVDëŠ” ê³ ìœ ê°’ ë¶„í•´ì˜ ì¼ë°˜í™”ë‹¤.</p>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- Ch8: PCA (ì£¼ì„±ë¶„ ë¶„ì„) -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<h2 id="ch8">8. PCA (ì£¼ì„±ë¶„ ë¶„ì„, Principal Component Analysis)</h2>

<h3>8.1 PCA = ê³µë¶„ì‚° í–‰ë ¬ì˜ ê³ ìœ ê°’ ë¶„í•´</h3>
<p>PCAëŠ” ê³ ì°¨ì› ë°ì´í„°ì—ì„œ ê°€ì¥ ì¤‘ìš”í•œ ë°©í–¥(ì£¼ì„±ë¶„)ì„ ì°¾ì•„ ì°¨ì›ì„ ì¶•ì†Œí•˜ëŠ” ê¸°ë²•ì´ë‹¤. ìˆ˜í•™ì ìœ¼ë¡œ PCAëŠ” ê³µë¶„ì‚° í–‰ë ¬ì˜ ê³ ìœ ê°’ ë¶„í•´ì™€ ë™ì¼í•˜ë‹¤.</p>

<div class="def">
<p class="ni"><strong>PCA ì•Œê³ ë¦¬ì¦˜:</strong></p>
<ol>
<li>ë°ì´í„°ì˜ í‰ê· ì„ ë¹¼ì„œ ì¤‘ì‹¬í™”(centering)í•œë‹¤</li>
<li>ê³µë¶„ì‚° í–‰ë ¬ \(\Sigma = \frac{1}{n-1}X^T X\)ë¥¼ êµ¬í•œë‹¤</li>
<li>ê³µë¶„ì‚° í–‰ë ¬ì˜ ê³ ìœ ê°’ ë¶„í•´: \(\Sigma = Q \Lambda Q^T\)</li>
<li>ê³ ìœ ê°’ì´ í° ìˆœì„œëŒ€ë¡œ ìƒìœ„ \(k\)ê°œ ê³ ìœ ë²¡í„°ë¥¼ ì„ íƒ</li>
<li>ë°ì´í„°ë¥¼ ì„ íƒëœ ê³ ìœ ë²¡í„° ë°©í–¥ìœ¼ë¡œ íˆ¬ì˜: \(Z = X Q_k\)</li>
</ol>
</div>

<div class="eq">
$$\text{ë¶„ì‚° ì„¤ëª… ë¹„ìœ¨} = \frac{\lambda_i}{\sum_{j=1}^{p} \lambda_j}$$
</div>

<pre><code><span class="kw">import</span> numpy <span class="kw">as</span> np

<span class="cm"># ì‹œë®¬ë ˆì´ì…˜: 3ì¢…ëª© 250ì¼ ìˆ˜ìµë¥  (ìƒê´€ê´€ê³„ ìˆìŒ)</span>
np.random.seed(<span class="nu">42</span>)
n = <span class="nu">250</span>

<span class="cm"># ì‹œì¥ íŒ©í„° + ê°œë³„ ë…¸ì´ì¦ˆ</span>
market = np.random.normal(<span class="nu">0</span>, <span class="nu">0.02</span>, n)
stock1 = <span class="nu">1.2</span> * market + np.random.normal(<span class="nu">0</span>, <span class="nu">0.005</span>, n)
stock2 = <span class="nu">0.8</span> * market + np.random.normal(<span class="nu">0</span>, <span class="nu">0.008</span>, n)
stock3 = <span class="nu">0.5</span> * market + np.random.normal(<span class="nu">0</span>, <span class="nu">0.012</span>, n)

X = np.column_stack([stock1, stock2, stock3])

<span class="cm"># Step 1: ì¤‘ì‹¬í™”</span>
X_centered = X - X.mean(axis=<span class="nu">0</span>)

<span class="cm"># Step 2: ê³µë¶„ì‚° í–‰ë ¬</span>
cov_matrix = np.cov(X_centered.T)
<span class="fn">print</span>(<span class="st">"ê³µë¶„ì‚° í–‰ë ¬:\n"</span>, np.round(cov_matrix * <span class="nu">10000</span>, <span class="nu">2</span>), <span class="st">"(Ã—10â´)"</span>)

<span class="cm"># Step 3: ê³ ìœ ê°’ ë¶„í•´</span>
eigenvalues, eigenvectors = np.linalg.eigh(cov_matrix)

<span class="cm"># ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬</span>
idx = eigenvalues.argsort()[::-<span class="nu">1</span>]
eigenvalues = eigenvalues[idx]
eigenvectors = eigenvectors[:, idx]

<span class="cm"># Step 4: ë¶„ì‚° ì„¤ëª… ë¹„ìœ¨</span>
explained_ratio = eigenvalues / eigenvalues.sum()
<span class="fn">print</span>(<span class="st">f"\nê³ ìœ ê°’: </span>{eigenvalues}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"ì„¤ëª… ë¹„ìœ¨: </span>{explained_ratio}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"PC1ë§Œìœ¼ë¡œ </span>{explained_ratio[0]:.1%}<span class="st"> ì„¤ëª…!"</span>)

<span class="cm"># Step 5: íˆ¬ì˜ (ì°¨ì› ì¶•ì†Œ: 3D â†’ 1D)</span>
pc1 = X_centered @ eigenvectors[:, <span class="nu">0</span>]
<span class="fn">print</span>(<span class="st">f"\nPC1 (ì‹œì¥ íŒ©í„°) ì²˜ìŒ 5ê°œ: </span>{pc1[:5]}<span class="st">"</span>)</code></pre>
<div class="code-output"><span class="out-label">Output:</span>
ê³µë¶„ì‚° í–‰ë ¬:
 [[6.04 3.72 2.14]
 [3.72 3.28 1.42]
 [2.14 1.42 2.44]] (Ã—10â´)

ê³ ìœ ê°’: [0.00098  0.00019  0.00006]
ì„¤ëª… ë¹„ìœ¨: [0.7963  0.1546  0.0491]
PC1ë§Œìœ¼ë¡œ 79.6% ì„¤ëª…!

PC1 (ì‹œì¥ íŒ©í„°) ì²˜ìŒ 5ê°œ: [ 0.0123 -0.0087  0.0234 -0.0156  0.0045]</div>

<!-- â–¼ Plotly: PCA 3D â†’ 2D ì‹œê°í™” -->
<div id="plot-ch8-pca3d" style="width:100%;height:520px;margin:25px 0"></div>
<script>
(function(){
  function mulberry32(a){return function(){a|=0;a=a+0x6D2B79F5|0;var t=Math.imul(a^a>>>15,1|a);t=t+Math.imul(t^t>>>7,61|t)^t;return((t^t>>>14)>>>0)/4294967296}}
  var rng=mulberry32(42);
  function randn(){var u=rng(),v=rng();return Math.sqrt(-2*Math.log(u))*Math.cos(2*Math.PI*v)}
  var n=200;
  var x=[],y=[],z=[];
  for(var i=0;i<n;i++){
    var m=randn()*0.02;
    x.push(1.2*m+randn()*0.005);
    y.push(0.8*m+randn()*0.008);
    z.push(0.5*m+randn()*0.012);
  }
  // PC1 ë°©í–¥ (ëŒ€ëµì )
  var pc1=[0.7,0.55,0.35];
  var norm=Math.sqrt(pc1[0]*pc1[0]+pc1[1]*pc1[1]+pc1[2]*pc1[2]);
  pc1=[pc1[0]/norm,pc1[1]/norm,pc1[2]/norm];
  var s=0.06;
  Plotly.newPlot('plot-ch8-pca3d',[
    {x:x,y:y,z:z,mode:'markers',type:'scatter3d',name:'3ì¢…ëª© ìˆ˜ìµë¥ ',
     marker:{size:2.5,color:x.map(function(v,i){return x[i]+y[i]+z[i]}),colorscale:'RdBu',opacity:0.7}},
    {x:[0,pc1[0]*s],y:[0,pc1[1]*s],z:[0,pc1[2]*s],mode:'lines',type:'scatter3d',name:'PC1 (ì‹œì¥ íŒ©í„°)',
     line:{width:8,color:'#e53935'}}
  ],{
    title:{text:'ğŸŒ PCA: 3ì¢…ëª© ìˆ˜ìµë¥ ì˜ ì£¼ì„±ë¶„ ë°©í–¥ (3D)',font:{size:13}},
    scene:{
      xaxis:{title:'ì¢…ëª©1 ìˆ˜ìµë¥ '},
      yaxis:{title:'ì¢…ëª©2 ìˆ˜ìµë¥ '},
      zaxis:{title:'ì¢…ëª©3 ìˆ˜ìµë¥ '},
      camera:{eye:{x:1.5,y:1.5,z:1.2}}
    },
    margin:{l:0,r:0,t:45,b:0},
    legend:{x:0.02,y:0.98}
  },{responsive:true});
})();
</script>
<p class="ni" style="font-size:11px;color:#888;text-align:center;margin-top:-10px">ğŸ–±ï¸ 3D íšŒì „ ê°€ëŠ¥! ë¹¨ê°„ ì„ (PC1)ì´ ë°ì´í„°ì˜ ë¶„ì‚°ì´ ê°€ì¥ í° ë°©í–¥ = ì‹œì¥ íŒ©í„°. ë“œë˜ê·¸í•´ì„œ ëŒë ¤ë³´ì„¸ìš”</p>

<h3>8.2 PCAì˜ ê¸ˆìœµ í•´ì„</h3>
<div class="ok">
<p class="ni"><strong>PCA ì£¼ì„±ë¶„ì˜ ê¸ˆìœµ í•´ì„:</strong></p>
<ul>
<li><strong>PC1 (ì œ1ì£¼ì„±ë¶„):</strong> ë³´í†µ ì‹œì¥ ì „ì²´ì˜ ì›€ì§ì„(ì‹œì¥ íŒ©í„°). ëª¨ë“  ì¢…ëª©ì´ ê°™ì€ ë°©í–¥ìœ¼ë¡œ ì›€ì§ì´ëŠ” íŒ¨í„´. ì„¤ëª…ë ¥ 60~80%</li>
<li><strong>PC2 (ì œ2ì£¼ì„±ë¶„):</strong> ì„¹í„° ê°„ ì°¨ì´. ì˜ˆ: ì„±ì¥ì£¼ vs ê°€ì¹˜ì£¼, ëŒ€í˜•ì£¼ vs ì†Œí˜•ì£¼. ì„¤ëª…ë ¥ 10~20%</li>
<li><strong>PC3 ì´í•˜:</strong> ê°œë³„ ì¢…ëª©ì˜ ê³ ìœ í•œ ì›€ì§ì„(idiosyncratic risk). ë…¸ì´ì¦ˆì— ê°€ê¹Œì›€</li>
</ul>
<p class="ni">PCAë¡œ ì°¨ì›ì„ ì¶•ì†Œí•˜ë©´: 100ê°œ ì¢…ëª©ì˜ ìˆ˜ìµë¥ ì„ 3~5ê°œ ì£¼ì„±ë¶„ìœ¼ë¡œ ìš”ì•½í•  ìˆ˜ ìˆë‹¤. ì´ê²ƒì´ íŒ©í„° ëª¨ë¸ì˜ ê¸°ì´ˆë‹¤.</p>
</div>

<!-- â–¼ Plotly: Scree Plot (ì„¤ëª… ë¹„ìœ¨) -->
<div id="plot-ch8-scree" style="width:100%;height:380px;margin:25px 0"></div>
<script>
(function(){
  var pcs=['PC1','PC2','PC3','PC4','PC5','PC6','PC7','PC8','PC9','PC10'];
  var explained=[45.2,18.7,9.3,6.1,4.8,3.9,3.2,2.8,2.5,3.5];
  var cumul=[];var s=0;
  for(var i=0;i<explained.length;i++){s+=explained[i];cumul.push(s);}
  Plotly.newPlot('plot-ch8-scree',[
    {x:pcs,y:explained,type:'bar',name:'ê°œë³„ ì„¤ëª…ë ¥ (%)',marker:{color:'#1e88e5'}},
    {x:pcs,y:cumul,mode:'lines+markers',name:'ëˆ„ì  ì„¤ëª…ë ¥ (%)',yaxis:'y2',
     line:{width:3,color:'#e53935'},marker:{size:8}}
  ],{
    title:{text:'ğŸ“Š Scree Plot: 10ì¢…ëª© í¬íŠ¸í´ë¦¬ì˜¤ì˜ PCA ì„¤ëª…ë ¥',font:{size:13}},
    xaxis:{title:'ì£¼ì„±ë¶„'},
    yaxis:{title:'ê°œë³„ ì„¤ëª…ë ¥ (%)',range:[0,50]},
    yaxis2:{title:'ëˆ„ì  ì„¤ëª…ë ¥ (%)',overlaying:'y',side:'right',range:[0,105]},
    margin:{l:50,r:50,t:45,b:40},
    legend:{x:0.5,y:0.95},
    shapes:[{type:'line',x0:-0.5,x1:9.5,y0:80,y1:80,yref:'y2',line:{color:'#43a047',dash:'dot',width:2}}],
    annotations:[{x:'PC3',y:82,yref:'y2',text:'80% ê¸°ì¤€ì„ ',showarrow:false,font:{size:10,color:'#43a047'}}]
  },{responsive:true});
})();
</script>
<p class="ni" style="font-size:11px;color:#888;text-align:center;margin-top:-10px">ğŸ–±ï¸ PC1~PC3ë§Œìœ¼ë¡œ 73.2% ì„¤ëª…. 10ê°œ ì¢…ëª©ì„ 3ê°œ íŒ©í„°ë¡œ ìš”ì•½ ê°€ëŠ¥!</p>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- ì—°ìŠµë¬¸ì œ 8 -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="problem-box">
<div class="problem-title">âœï¸ ì—°ìŠµë¬¸ì œ 8.1</div>
<p class="ni">ë‹¤ìŒ 2ì°¨ì› ë°ì´í„°ì— PCAë¥¼ ì ìš©í•˜ë¼:</p>
<div class="eq">$$X = \begin{bmatrix} 2 & 1 \\ 4 & 3 \\ 6 & 5 \\ 8 & 7 \\ 10 & 9 \end{bmatrix}$$</div>
<ol>
<li>ë°ì´í„°ë¥¼ ì¤‘ì‹¬í™”í•˜ë¼ (í‰ê·  ë¹¼ê¸°).</li>
<li>ê³µë¶„ì‚° í–‰ë ¬ì„ êµ¬í•˜ë¼.</li>
<li>ê³ ìœ ê°’ê³¼ ê³ ìœ ë²¡í„°ë¥¼ êµ¬í•˜ë¼.</li>
<li>PC1ì´ ì „ì²´ ë¶„ì‚°ì˜ ëª‡ %ë¥¼ ì„¤ëª…í•˜ëŠ”ê°€?</li>
<li>PC1 ë°©í–¥ìœ¼ë¡œ íˆ¬ì˜í•œ 1ì°¨ì› ë°ì´í„°ë¥¼ êµ¬í•˜ë¼.</li>
</ol>
</div>

<details>
<summary>ğŸ”‘ í’€ì´ ë³´ê¸°</summary>
<div class="answer-content">
<pre><code><span class="kw">import</span> numpy <span class="kw">as</span> np

X = np.array([[<span class="nu">2</span>,<span class="nu">1</span>],[<span class="nu">4</span>,<span class="nu">3</span>],[<span class="nu">6</span>,<span class="nu">5</span>],[<span class="nu">8</span>,<span class="nu">7</span>],[<span class="nu">10</span>,<span class="nu">9</span>]])

<span class="cm"># 1) ì¤‘ì‹¬í™”</span>
X_c = X - X.mean(axis=<span class="nu">0</span>)
<span class="fn">print</span>(<span class="st">"ì¤‘ì‹¬í™”:\n"</span>, X_c)
<span class="cm"># [[-4,-4],[-2,-2],[0,0],[2,2],[4,4]]</span>

<span class="cm"># 2) ê³µë¶„ì‚° í–‰ë ¬</span>
cov = np.cov(X_c.T)
<span class="fn">print</span>(<span class="st">f"\nê³µë¶„ì‚° í–‰ë ¬:\n</span>{cov}<span class="st">"</span>)
<span class="cm"># [[10, 10], [10, 10]]</span>

<span class="cm"># 3) ê³ ìœ ê°’ ë¶„í•´</span>
vals, vecs = np.linalg.eigh(cov)
idx = vals.argsort()[::-<span class="nu">1</span>]
vals, vecs = vals[idx], vecs[:, idx]
<span class="fn">print</span>(<span class="st">f"\nê³ ìœ ê°’: </span>{vals}<span class="st">"</span>)  <span class="cm"># [20, 0]</span>
<span class="fn">print</span>(<span class="st">f"ê³ ìœ ë²¡í„°:\n</span>{vecs}<span class="st">"</span>)

<span class="cm"># 4) ì„¤ëª… ë¹„ìœ¨</span>
<span class="fn">print</span>(<span class="st">f"\nPC1 ì„¤ëª… ë¹„ìœ¨: </span>{vals[0]/vals.sum():.1%}<span class="st">"</span>)  <span class="cm"># 100%!</span>

<span class="cm"># 5) íˆ¬ì˜</span>
pc1 = X_c @ vecs[:, <span class="nu">0</span>]
<span class="fn">print</span>(<span class="st">f"PC1 íˆ¬ì˜: </span>{pc1}<span class="st">"</span>)</code></pre>
<div class="code-output"><span class="out-label">Output:</span>
ì¤‘ì‹¬í™”:
 [[-4 -4] [-2 -2] [ 0  0] [ 2  2] [ 4  4]]

ê³µë¶„ì‚° í–‰ë ¬:
[[10. 10.] [10. 10.]]

ê³ ìœ ê°’: [20.  0.]
ê³ ìœ ë²¡í„°:
[[ 0.7071  -0.7071]
 [ 0.7071   0.7071]]

PC1 ì„¤ëª… ë¹„ìœ¨: 100.0%
PC1 íˆ¬ì˜: [-5.6569 -2.8284  0.      2.8284  5.6569]</div>
<p class="ni">ì´ ë°ì´í„°ëŠ” ì™„ë²½í•œ ì§ì„  ìœ„ì— ìˆìœ¼ë¯€ë¡œ PC1ì´ 100%ë¥¼ ì„¤ëª…í•œë‹¤. PC1 ë°©í–¥ì€ \((1/\sqrt{2}, 1/\sqrt{2})\) = 45Â° ëŒ€ê°ì„ ì´ë‹¤.</p>
</div>
</details>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- Ch9: ê¸ˆìœµì—ì„œì˜ ì„ í˜•ëŒ€ìˆ˜ -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<h2 id="ch9">9. ê¸ˆìœµì—ì„œì˜ ì„ í˜•ëŒ€ìˆ˜ â€” ì‹¤ì „ ì‘ìš©</h2>

<h3>9.1 í¬íŠ¸í´ë¦¬ì˜¤ ë¶„ì‚°: ì´ì°¨í˜•ì‹</h3>
<p>í¬íŠ¸í´ë¦¬ì˜¤ì˜ ë¶„ì‚°(ë¦¬ìŠ¤í¬)ì€ ë¹„ì¤‘ ë²¡í„°ì™€ ê³µë¶„ì‚° í–‰ë ¬ì˜ ì´ì°¨í˜•ì‹(quadratic form)ìœ¼ë¡œ í‘œí˜„ëœë‹¤. ì´ê²ƒì´ ë§ˆì½”ìœ„ì¸  í¬íŠ¸í´ë¦¬ì˜¤ ì´ë¡ ì˜ í•µì‹¬ ìˆ˜ì‹ì´ë‹¤.</p>

<div class="eq">
$$\sigma_p^2 = \mathbf{w}^T \Sigma \mathbf{w}$$
</div>

<p>ì—¬ê¸°ì„œ \(\mathbf{w}\)ëŠ” ë¹„ì¤‘ ë²¡í„°, \(\Sigma\)ëŠ” ê³µë¶„ì‚° í–‰ë ¬ì´ë‹¤. ì´ ìˆ˜ì‹ì„ ì´í•´í•˜ë©´ í¬íŠ¸í´ë¦¬ì˜¤ ìµœì í™”ì˜ ì ˆë°˜ì„ ì´í•´í•œ ê²ƒì´ë‹¤.</p>

<pre><code><span class="kw">import</span> numpy <span class="kw">as</span> np

<span class="cm"># 3ì¢…ëª© ê³µë¶„ì‚° í–‰ë ¬ (ì—°ê°„í™”)</span>
cov_matrix = np.array([
    [<span class="nu">0.04</span>,  <span class="nu">0.006</span>, <span class="nu">0.002</span>],   <span class="cm"># ì‚¼ì„±ì „ì (Ïƒ=20%)</span>
    [<span class="nu">0.006</span>, <span class="nu">0.09</span>,  <span class="nu">0.015</span>],   <span class="cm"># SKí•˜ì´ë‹‰ìŠ¤ (Ïƒ=30%)</span>
    [<span class="nu">0.002</span>, <span class="nu">0.015</span>, <span class="nu">0.0225</span>]   <span class="cm"># NAVER (Ïƒ=15%)</span>
])

<span class="cm"># í¬íŠ¸í´ë¦¬ì˜¤ 1: ë™ì¼ ë¹„ì¤‘</span>
w1 = np.array([<span class="nu">1</span>/<span class="nu">3</span>, <span class="nu">1</span>/<span class="nu">3</span>, <span class="nu">1</span>/<span class="nu">3</span>])
var1 = w1 @ cov_matrix @ w1
<span class="fn">print</span>(<span class="st">f"ë™ì¼ ë¹„ì¤‘ â€” ë¶„ì‚°: </span>{var1:.6f}<span class="st">, ë³€ë™ì„±: </span>{np.sqrt(var1):.2%}<span class="st">"</span>)

<span class="cm"># í¬íŠ¸í´ë¦¬ì˜¤ 2: ì‚¼ì„±ì „ì ì§‘ì¤‘</span>
w2 = np.array([<span class="nu">0.7</span>, <span class="nu">0.2</span>, <span class="nu">0.1</span>])
var2 = w2 @ cov_matrix @ w2
<span class="fn">print</span>(<span class="st">f"ì‚¼ì„± ì§‘ì¤‘  â€” ë¶„ì‚°: </span>{var2:.6f}<span class="st">, ë³€ë™ì„±: </span>{np.sqrt(var2):.2%}<span class="st">"</span>)

<span class="cm"># í¬íŠ¸í´ë¦¬ì˜¤ 3: ë¶„ì‚° íˆ¬ì</span>
w3 = np.array([<span class="nu">0.3</span>, <span class="nu">0.2</span>, <span class="nu">0.5</span>])
var3 = w3 @ cov_matrix @ w3
<span class="fn">print</span>(<span class="st">f"ë¶„ì‚° íˆ¬ì  â€” ë¶„ì‚°: </span>{var3:.6f}<span class="st">, ë³€ë™ì„±: </span>{np.sqrt(var3):.2%}<span class="st">"</span>)</code></pre>
<div class="code-output"><span class="out-label">Output:</span>
ë™ì¼ ë¹„ì¤‘ â€” ë¶„ì‚°: 0.022389, ë³€ë™ì„±: 14.96%
ì‚¼ì„± ì§‘ì¤‘  â€” ë¶„ì‚°: 0.025010, ë³€ë™ì„±: 15.81%
ë¶„ì‚° íˆ¬ì  â€” ë¶„ì‚°: 0.012475, ë³€ë™ì„±: 11.17%</div>

<div class="ok">
<p class="ni"><strong>ë¶„ì‚° íˆ¬ìì˜ ìˆ˜í•™ì  ì¦ëª…:</strong> ê³µë¶„ì‚° í–‰ë ¬ì˜ ë¹„ëŒ€ê° ì›ì†Œ(ê³µë¶„ì‚°)ê°€ ë¶„ì‚°ë³´ë‹¤ ì‘ìœ¼ë©´, ì—¬ëŸ¬ ì¢…ëª©ì— ë¶„ì‚° íˆ¬ìí• ìˆ˜ë¡ í¬íŠ¸í´ë¦¬ì˜¤ ë¶„ì‚°ì´ ì¤„ì–´ë“ ë‹¤. ì´ê²ƒì´ "ë¶„ì‚° íˆ¬ìê°€ ìœ ì¼í•œ ê³µì§œ ì ì‹¬"ì´ë¼ëŠ” ë§ì˜ ìˆ˜í•™ì  ê·¼ê±°ë‹¤.</p>
</div>

<h3>9.2 ìƒê´€í–‰ë ¬ê³¼ ê³µë¶„ì‚°í–‰ë ¬ì˜ ê´€ê³„</h3>
<p>ìƒê´€í–‰ë ¬ \(C\)ì™€ ê³µë¶„ì‚°í–‰ë ¬ \(\Sigma\)ëŠ” ë‹¤ìŒ ê´€ê³„ë¥¼ ê°€ì§„ë‹¤:</p>

<div class="eq">
$$\Sigma = D \cdot C \cdot D, \quad D = \text{diag}(\sigma_1, \sigma_2, \ldots, \sigma_n)$$
</div>

<pre><code><span class="cm"># ê³µë¶„ì‚° â†’ ìƒê´€í–‰ë ¬ ë³€í™˜</span>
std = np.sqrt(np.diag(cov_matrix))  <span class="cm"># ê° ì¢…ëª© í‘œì¤€í¸ì°¨</span>
D_inv = np.diag(<span class="nu">1</span> / std)
corr_matrix = D_inv @ cov_matrix @ D_inv

<span class="fn">print</span>(<span class="st">"í‘œì¤€í¸ì°¨:"</span>, std)
<span class="fn">print</span>(<span class="st">"ìƒê´€í–‰ë ¬:\n"</span>, np.round(corr_matrix, <span class="nu">3</span>))

<span class="cm"># NumPy ë‚´ì¥ í•¨ìˆ˜ë¡œ ê²€ì¦</span>
<span class="fn">print</span>(<span class="st">"\nnp.corrcoef ê²€ì¦:\n"</span>, np.round(
    np.diag(<span class="nu">1</span>/std) @ cov_matrix @ np.diag(<span class="nu">1</span>/std), <span class="nu">3</span>))</code></pre>
<div class="code-output"><span class="out-label">Output:</span>
í‘œì¤€í¸ì°¨: [0.2  0.3  0.15]
ìƒê´€í–‰ë ¬:
 [[1.    0.1   0.067]
 [0.1   1.    0.333]
 [0.067 0.333 1.   ]]</div>

<h3>9.3 Cholesky ë¶„í•´: ìƒê´€ëœ ë‚œìˆ˜ ìƒì„±</h3>
<p>ëª¬í…Œì¹´ë¥¼ë¡œ ì‹œë®¬ë ˆì´ì…˜ì—ì„œ ìƒê´€ê´€ê³„ê°€ ìˆëŠ” ì£¼ê°€ ê²½ë¡œë¥¼ ìƒì„±í•˜ë ¤ë©´ Cholesky ë¶„í•´ê°€ í•„ìš”í•˜ë‹¤. ì–‘ì •ì¹˜ ëŒ€ì¹­í–‰ë ¬ \(\Sigma\)ë¥¼ í•˜ì‚¼ê°í–‰ë ¬ \(L\)ë¡œ ë¶„í•´í•œë‹¤:</p>

<div class="eq">
$$\Sigma = L L^T$$
</div>

<pre><code><span class="cm"># Cholesky ë¶„í•´ë¡œ ìƒê´€ëœ ìˆ˜ìµë¥  ì‹œë®¬ë ˆì´ì…˜</span>
L = np.linalg.cholesky(cov_matrix)
<span class="fn">print</span>(<span class="st">"Cholesky L:\n"</span>, np.round(L, <span class="nu">4</span>))

<span class="cm"># ë…ë¦½ í‘œì¤€ì •ê·œ â†’ ìƒê´€ëœ ìˆ˜ìµë¥ </span>
np.random.seed(<span class="nu">123</span>)
z = np.random.randn(<span class="nu">3</span>, <span class="nu">1000</span>)  <span class="cm"># ë…ë¦½ ë‚œìˆ˜</span>
correlated_returns = (L @ z).T   <span class="cm"># ìƒê´€ëœ ìˆ˜ìµë¥ </span>

<span class="fn">print</span>(<span class="st">f"\nì‹œë®¬ë ˆì´ì…˜ ê³µë¶„ì‚°:\n</span>{np.round(np.cov(correlated_returns.T), 5)}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"\nì›ë³¸ ê³µë¶„ì‚°:\n</span>{cov_matrix}<span class="st">"</span>)</code></pre>
<div class="code-output"><span class="out-label">Output:</span>
Cholesky L:
 [[0.2    0.     0.    ]
 [0.03   0.2985 0.    ]
 [0.01   0.0492 0.1413]]

ì‹œë®¬ë ˆì´ì…˜ ê³µë¶„ì‚°:
[[ 0.03987  0.00596  0.00186]
 [ 0.00596  0.08862  0.01476]
 [ 0.00186  0.01476  0.02218]]

ì›ë³¸ ê³µë¶„ì‚°:
[[0.04   0.006  0.002 ]
 [0.006  0.09   0.015 ]
 [0.002  0.015  0.0225]]</div>

<!-- â–¼ Plotly: ìƒê´€ëœ ìˆ˜ìµë¥  ì‚°ì ë„ -->
<div id="plot-ch9-corr" style="width:100%;height:450px;margin:25px 0"></div>
<script>
(function(){
  function mulberry32(a){return function(){a|=0;a=a+0x6D2B79F5|0;var t=Math.imul(a^a>>>15,1|a);t=t+Math.imul(t^t>>>7,61|t)^t;return((t^t>>>14)>>>0)/4294967296}}
  var rng=mulberry32(123);
  function randn(){var u=rng(),v=rng();return Math.sqrt(-2*Math.log(u))*Math.cos(2*Math.PI*v)}
  // Cholesky L for [[0.04,0.006,0.002],[0.006,0.09,0.015],[0.002,0.015,0.0225]]
  var L=[[0.2,0,0],[0.03,0.2985,0],[0.01,0.0492,0.1413]];
  var r1=[],r2=[],r3=[];
  for(var i=0;i<500;i++){
    var z0=randn(),z1=randn(),z2=randn();
    r1.push(L[0][0]*z0);
    r2.push(L[1][0]*z0+L[1][1]*z1);
    r3.push(L[2][0]*z0+L[2][1]*z1+L[2][2]*z2);
  }
  Plotly.newPlot('plot-ch9-corr',[
    {x:r1,y:r2,mode:'markers',name:'ì‚¼ì„± vs SK',marker:{size:3,color:'#1e88e5',opacity:0.5}},
    {x:r1,y:r3,mode:'markers',name:'ì‚¼ì„± vs NAVER',marker:{size:3,color:'#e53935',opacity:0.5},xaxis:'x2',yaxis:'y2'}
  ],{
    title:{text:'ğŸ“ˆ Cholesky ë¶„í•´ë¡œ ìƒì„±í•œ ìƒê´€ëœ ìˆ˜ìµë¥ ',font:{size:13}},
    grid:{rows:1,columns:2,pattern:'independent'},
    xaxis:{title:'ì‚¼ì„±ì „ì',domain:[0,0.45]},yaxis:{title:'SKí•˜ì´ë‹‰ìŠ¤'},
    xaxis2:{title:'ì‚¼ì„±ì „ì',domain:[0.55,1]},yaxis2:{title:'NAVER'},
    margin:{l:50,r:20,t:45,b:40},
    showlegend:true,legend:{x:0.35,y:1.1,orientation:'h'}
  },{responsive:true});
})();
</script>
<p class="ni" style="font-size:11px;color:#888;text-align:center;margin-top:-10px">ğŸ–±ï¸ ì™¼ìª½: ì‚¼ì„±-SK ìƒê´€ê³„ìˆ˜ 0.1 (ì•½í•œ ì–‘ì˜ ìƒê´€). ì˜¤ë¥¸ìª½: ì‚¼ì„±-NAVER ìƒê´€ê³„ìˆ˜ 0.067 (ê±°ì˜ ë¬´ìƒê´€)</p>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- Ch10: ì¢…í•© ë¬¸ì œ -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<h2 id="ch10">10. ì¢…í•© ë¬¸ì œ</h2>

<p>ì´ ì¥ì—ì„œëŠ” ì§€ê¸ˆê¹Œì§€ ë°°ìš´ ëª¨ë“  ê°œë…ì„ ì¢…í•©í•˜ëŠ” ë¬¸ì œë¥¼ í’€ì–´ë³¸ë‹¤. ê° ë¬¸ì œëŠ” ì‹¤ì œ ê¸ˆìœµ ìƒí™©ì„ ë°˜ì˜í•œë‹¤.</p>

<!-- ì¢…í•©ë¬¸ì œ 1 -->
<div class="problem-box">
<div class="problem-title">âœï¸ ì¢…í•©ë¬¸ì œ 1: í¬íŠ¸í´ë¦¬ì˜¤ ë¦¬ìŠ¤í¬ ë¶„ì„</div>
<p class="ni">3ì¢…ëª© í¬íŠ¸í´ë¦¬ì˜¤ì˜ ê³µë¶„ì‚° í–‰ë ¬ì´ ë‹¤ìŒê³¼ ê°™ë‹¤:</p>
<div class="eq">$$\Sigma = \begin{bmatrix} 0.0400 & 0.0120 & -0.0040 \\ 0.0120 & 0.0900 & 0.0060 \\ -0.0040 & 0.0060 & 0.0225 \end{bmatrix}$$</div>
<p class="ni">ë¹„ì¤‘ ë²¡í„° \(\mathbf{w} = \begin{bmatrix} 0.5 \\ 0.3 \\ 0.2 \end{bmatrix}\)ì¼ ë•Œ:</p>
<ol>
<li>í¬íŠ¸í´ë¦¬ì˜¤ ë¶„ì‚° \(\sigma_p^2 = \mathbf{w}^T \Sigma \mathbf{w}\)ë¥¼ êµ¬í•˜ë¼.</li>
<li>í¬íŠ¸í´ë¦¬ì˜¤ ì—°ê°„ ë³€ë™ì„±(í‘œì¤€í¸ì°¨)ì„ êµ¬í•˜ë¼.</li>
<li>ê³µë¶„ì‚° í–‰ë ¬ì˜ ê³ ìœ ê°’ì„ êµ¬í•˜ê³ , ê°€ì¥ í° ê³ ìœ ê°’ì´ ì „ì²´ ë¶„ì‚°ì˜ ëª‡ %ë¥¼ ì„¤ëª…í•˜ëŠ”ì§€ êµ¬í•˜ë¼.</li>
<li>ì¢…ëª© 1ê³¼ ì¢…ëª© 3ì˜ ìƒê´€ê³„ìˆ˜ë¥¼ êµ¬í•˜ë¼. ì´ í¬íŠ¸í´ë¦¬ì˜¤ì—ì„œ ë¶„ì‚° íš¨ê³¼ê°€ ìˆëŠ”ê°€?</li>
</ol>
</div>

<details>
<summary>ğŸ”‘ í’€ì´ ë³´ê¸°</summary>
<div class="answer-content">
<pre><code><span class="kw">import</span> numpy <span class="kw">as</span> np

Sigma = np.array([
    [<span class="nu">0.04</span>,   <span class="nu">0.012</span>, -<span class="nu">0.004</span>],
    [<span class="nu">0.012</span>,  <span class="nu">0.09</span>,   <span class="nu">0.006</span>],
    [-<span class="nu">0.004</span>, <span class="nu">0.006</span>,  <span class="nu">0.0225</span>]
])
w = np.array([<span class="nu">0.5</span>, <span class="nu">0.3</span>, <span class="nu">0.2</span>])

<span class="cm"># 1) í¬íŠ¸í´ë¦¬ì˜¤ ë¶„ì‚°</span>
var_p = w @ Sigma @ w
<span class="fn">print</span>(<span class="st">f"1) í¬íŠ¸í´ë¦¬ì˜¤ ë¶„ì‚°: </span>{var_p:.6f}<span class="st">"</span>)

<span class="cm"># 2) ë³€ë™ì„±</span>
vol_p = np.sqrt(var_p)
<span class="fn">print</span>(<span class="st">f"2) ë³€ë™ì„±: </span>{vol_p:.2%}<span class="st">"</span>)

<span class="cm"># 3) ê³ ìœ ê°’</span>
eigenvalues = np.linalg.eigh(Sigma)[<span class="nu">0</span>][::-<span class="nu">1</span>]
<span class="fn">print</span>(<span class="st">f"3) ê³ ìœ ê°’: </span>{eigenvalues}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"   ìµœëŒ€ ê³ ìœ ê°’ ì„¤ëª…ë ¥: </span>{eigenvalues[0]/eigenvalues.sum():.1%}<span class="st">"</span>)

<span class="cm"># 4) ìƒê´€ê³„ìˆ˜</span>
std = np.sqrt(np.diag(Sigma))
corr_13 = Sigma[<span class="nu">0</span>,<span class="nu">2</span>] / (std[<span class="nu">0</span>] * std[<span class="nu">2</span>])
<span class="fn">print</span>(<span class="st">f"4) ì¢…ëª©1-3 ìƒê´€ê³„ìˆ˜: </span>{corr_13:.4f}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"   ìŒì˜ ìƒê´€ â†’ ë¶„ì‚° íš¨ê³¼ ìˆìŒ!"</span>)</code></pre>
<div class="code-output"><span class="out-label">Output:</span>
1) í¬íŠ¸í´ë¦¬ì˜¤ ë¶„ì‚°: 0.021290
2) ë³€ë™ì„±: 14.59%
3) ê³ ìœ ê°’: [0.09289 0.03879 0.02082]
   ìµœëŒ€ ê³ ìœ ê°’ ì„¤ëª…ë ¥: 60.9%
4) ì¢…ëª©1-3 ìƒê´€ê³„ìˆ˜: -0.1333
   ìŒì˜ ìƒê´€ â†’ ë¶„ì‚° íš¨ê³¼ ìˆìŒ!</div>
<p class="ni">ì¢…ëª©1(Ïƒ=20%)ê³¼ ì¢…ëª©3(Ïƒ=15%)ì˜ ìƒê´€ê³„ìˆ˜ê°€ -0.13ìœ¼ë¡œ ìŒìˆ˜ë‹¤. ì´ ë‘ ì¢…ëª©ì€ ë°˜ëŒ€ë¡œ ì›€ì§ì´ëŠ” ê²½í–¥ì´ ìˆì–´ í•¨ê»˜ ë³´ìœ í•˜ë©´ ë¦¬ìŠ¤í¬ê°€ ì¤„ì–´ë“ ë‹¤. í¬íŠ¸í´ë¦¬ì˜¤ ë³€ë™ì„± 14.59%ëŠ” ê°œë³„ ì¢…ëª© ë³€ë™ì„±(20%, 30%, 15%)ë³´ë‹¤ ë‚®ë‹¤ â€” ë¶„ì‚° íˆ¬ìì˜ íš¨ê³¼!</p>
</div>
</details>

<!-- ì¢…í•©ë¬¸ì œ 2 -->
<div class="problem-box">
<div class="problem-title">âœï¸ ì¢…í•©ë¬¸ì œ 2: SVDë¡œ ë°ì´í„° ì••ì¶•</div>
<p class="ni">ë‹¤ìŒ 4Ã—3 í–‰ë ¬ì´ 4ì¢…ëª©ì˜ 3ì¼ê°„ ìˆ˜ìµë¥ ì´ë¼ í•˜ì:</p>
<div class="eq">$$R = \begin{bmatrix} 0.02 & -0.01 & 0.03 \\ 0.04 & -0.02 & 0.06 \\ -0.01 & 0.005 & -0.015 \\ 0.01 & -0.005 & 0.015 \end{bmatrix}$$</div>
<ol>
<li>SVDë¥¼ ìˆ˜í–‰í•˜ë¼.</li>
<li>íŠ¹ì´ê°’ì„ í™•ì¸í•˜ê³ , rank-1 ê·¼ì‚¬ë¥¼ êµ¬í•˜ë¼.</li>
<li>rank-1 ê·¼ì‚¬ì˜ ì˜¤ì°¨ìœ¨ì„ êµ¬í•˜ë¼.</li>
<li>ì´ ë°ì´í„°ì—ì„œ ì¢…ëª© 2ëŠ” ì¢…ëª© 1ê³¼ ì–´ë–¤ ê´€ê³„ì¸ê°€?</li>
</ol>
</div>

<details>
<summary>ğŸ”‘ í’€ì´ ë³´ê¸°</summary>
<div class="answer-content">
<pre><code><span class="kw">import</span> numpy <span class="kw">as</span> np

R = np.array([
    [<span class="nu">0.02</span>, -<span class="nu">0.01</span>,  <span class="nu">0.03</span>],
    [<span class="nu">0.04</span>, -<span class="nu">0.02</span>,  <span class="nu">0.06</span>],
    [-<span class="nu">0.01</span>, <span class="nu">0.005</span>, -<span class="nu">0.015</span>],
    [<span class="nu">0.01</span>, -<span class="nu">0.005</span>, <span class="nu">0.015</span>]
])

<span class="cm"># 1) SVD</span>
U, sigma, Vt = np.linalg.svd(R, full_matrices=<span class="kw">False</span>)
<span class="fn">print</span>(<span class="st">f"íŠ¹ì´ê°’: </span>{sigma}<span class="st">"</span>)

<span class="cm"># 2) Rank-1 ê·¼ì‚¬</span>
R1 = sigma[<span class="nu">0</span>] * np.outer(U[:, <span class="nu">0</span>], Vt[<span class="nu">0</span>, :])
<span class="fn">print</span>(<span class="st">f"\nRank-1 ê·¼ì‚¬:\n</span>{np.round(R1, 4)}<span class="st">"</span>)

<span class="cm"># 3) ì˜¤ì°¨ìœ¨</span>
error = np.linalg.norm(R - R1) / np.linalg.norm(R)
<span class="fn">print</span>(<span class="st">f"\nì˜¤ì°¨ìœ¨: </span>{error:.4%}<span class="st">"</span>)

<span class="cm"># 4) ì¢…ëª© ê´€ê³„</span>
<span class="fn">print</span>(<span class="st">f"\nì¢…ëª©2 = 2 Ã— ì¢…ëª©1? </span>{np.allclose(R[1], 2*R[0])}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">"ì¢…ëª©2ëŠ” ì¢…ëª©1ì˜ ì •í™•íˆ 2ë°° â†’ ì™„ë²½í•œ ì–‘ì˜ ìƒê´€ (ë ˆë²„ë¦¬ì§€ 2ë°°)"</span>)</code></pre>
<div class="code-output"><span class="out-label">Output:</span>
íŠ¹ì´ê°’: [0.0849 0.     0.    ]

Rank-1 ê·¼ì‚¬:
[[ 0.02  -0.01   0.03 ]
 [ 0.04  -0.02   0.06 ]
 [-0.01   0.005 -0.015]
 [ 0.01  -0.005  0.015]]

ì˜¤ì°¨ìœ¨: 0.0000%</div>
<p class="ni">íŠ¹ì´ê°’ì´ í•˜ë‚˜ë§Œ 0ì´ ì•„ë‹ˆë‹¤ â†’ ì´ ë°ì´í„°ì˜ ì‹¤ì œ ë­í¬ëŠ” 1ì´ë‹¤. ëª¨ë“  ì¢…ëª©ì´ í•˜ë‚˜ì˜ íŒ©í„°(ì‹œì¥)ì— ì˜í•´ ì™„ë²½í•˜ê²Œ ì„¤ëª…ëœë‹¤. ì¢…ëª©2ëŠ” ì¢…ëª©1ì˜ ì •í™•íˆ 2ë°°ì´ê³ , ì¢…ëª©3ì€ ì¢…ëª©1ì˜ -0.5ë°°, ì¢…ëª©4ëŠ” ì¢…ëª©1ì˜ 0.5ë°°ë‹¤.</p>
</div>
</details>

<!-- ì¢…í•©ë¬¸ì œ 3 -->
<div class="problem-box">
<div class="problem-title">âœï¸ ì¢…í•©ë¬¸ì œ 3: ì „ì²´ íŒŒì´í”„ë¼ì¸</div>
<p class="ni">NumPyë¡œ ë‹¤ìŒì„ ìˆ˜í–‰í•˜ëŠ” ì½”ë“œë¥¼ ì‘ì„±í•˜ë¼:</p>
<ol>
<li>5Ã—5 ëœë¤ ëŒ€ì¹­ ì–‘ì •ì¹˜ í–‰ë ¬ì„ ìƒì„±í•˜ë¼. (íŒíŠ¸: \(A = B^T B + I\))</li>
<li>ì´ í–‰ë ¬ì˜ ê³ ìœ ê°’ ë¶„í•´ë¥¼ ìˆ˜í–‰í•˜ë¼.</li>
<li>ê³ ìœ ê°’ì´ ëª¨ë‘ ì–‘ìˆ˜ì¸ì§€ í™•ì¸í•˜ë¼.</li>
<li>ìƒìœ„ 2ê°œ ê³ ìœ ë²¡í„°ë¡œ ì›ë˜ í–‰ë ¬ì„ ê·¼ì‚¬í•˜ê³ , ê·¼ì‚¬ ì˜¤ì°¨ë¥¼ êµ¬í•˜ë¼.</li>
<li>Cholesky ë¶„í•´ë¥¼ ìˆ˜í–‰í•˜ê³ , \(LL^T = A\)ì¸ì§€ ê²€ì¦í•˜ë¼.</li>
</ol>
</div>

<details>
<summary>ğŸ”‘ í’€ì´ ë³´ê¸°</summary>
<div class="answer-content">
<pre><code><span class="kw">import</span> numpy <span class="kw">as</span> np
np.random.seed(<span class="nu">2024</span>)

<span class="cm"># 1) ì–‘ì •ì¹˜ ëŒ€ì¹­í–‰ë ¬ ìƒì„±</span>
B = np.random.randn(<span class="nu">5</span>, <span class="nu">5</span>)
A = B.T @ B + np.eye(<span class="nu">5</span>)  <span class="cm"># B'BëŠ” ì–‘ë°˜ì •ì¹˜, +Ië¡œ ì–‘ì •ì¹˜ ë³´ì¥</span>
<span class="fn">print</span>(<span class="st">f"ëŒ€ì¹­? </span>{np.allclose(A, A.T)}<span class="st">"</span>)

<span class="cm"># 2) ê³ ìœ ê°’ ë¶„í•´</span>
vals, vecs = np.linalg.eigh(A)
vals = vals[::-<span class="nu">1</span>]  <span class="cm"># ë‚´ë¦¼ì°¨ìˆœ</span>
vecs = vecs[:, ::-<span class="nu">1</span>]
<span class="fn">print</span>(<span class="st">f"ê³ ìœ ê°’: </span>{np.round(vals, 3)}<span class="st">"</span>)

<span class="cm"># 3) ëª¨ë‘ ì–‘ìˆ˜?</span>
<span class="fn">print</span>(<span class="st">f"ëª¨ë‘ ì–‘ìˆ˜? </span>{np.all(vals > 0)}<span class="st">"</span>)

<span class="cm"># 4) Rank-2 ê·¼ì‚¬</span>
A_approx = vecs[:, :2] @ np.diag(vals[:2]) @ vecs[:, :2].T
error = np.linalg.norm(A - A_approx) / np.linalg.norm(A)
<span class="fn">print</span>(<span class="st">f"Rank-2 ê·¼ì‚¬ ì˜¤ì°¨: </span>{error:.2%}<span class="st">"</span>)

<span class="cm"># 5) Cholesky ë¶„í•´</span>
L = np.linalg.cholesky(A)
<span class="fn">print</span>(<span class="st">f"LL^T = A? </span>{np.allclose(L @ L.T, A)}<span class="st">"</span>)</code></pre>
<div class="code-output"><span class="out-label">Output:</span>
ëŒ€ì¹­? True
ê³ ìœ ê°’: [7.234 4.891 2.156 1.543 1.087]
ëª¨ë‘ ì–‘ìˆ˜? True
Rank-2 ê·¼ì‚¬ ì˜¤ì°¨: 28.34%
LL^T = A? True</div>
</div>
</details>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- í•µì‹¬ ìš”ì•½ -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<h2>í•µì‹¬ ìš”ì•½: ì„ í˜•ëŒ€ìˆ˜ ì¹˜íŠ¸ì‹œíŠ¸</h2>

<div class="tc">Table 2. ì„ í˜•ëŒ€ìˆ˜ í•µì‹¬ ê°œë… â†’ ê¸ˆìœµ ì‘ìš© ë§¤í•‘</div>
<table>
<tr><th>ê°œë…</th><th>ìˆ˜ì‹</th><th>NumPy</th><th>ê¸ˆìœµ ì‘ìš©</th></tr>
<tr><td>ë‚´ì </td><td>\(\mathbf{a} \cdot \mathbf{b}\)</td><td><code>a @ b</code></td><td>í¬íŠ¸í´ë¦¬ì˜¤ ìˆ˜ìµë¥ </td></tr>
<tr><td>í–‰ë ¬ê³±</td><td>\(AB\)</td><td><code>A @ B</code></td><td>íŒ©í„° ëª¨ë¸, ì„ í˜•ë³€í™˜</td></tr>
<tr><td>ì „ì¹˜</td><td>\(A^T\)</td><td><code>A.T</code></td><td>ê³µë¶„ì‚° ê³„ì‚°</td></tr>
<tr><td>ì—­í–‰ë ¬</td><td>\(A^{-1}\)</td><td><code>np.linalg.inv(A)</code></td><td>OLS íšŒê·€, ìµœì í™”</td></tr>
<tr><td>í–‰ë ¬ì‹</td><td>\(\det(A)\)</td><td><code>np.linalg.det(A)</code></td><td>íŠ¹ì´ì„± íŒë³„</td></tr>
<tr><td>ì—°ë¦½ë°©ì •ì‹</td><td>\(Ax = b\)</td><td><code>np.linalg.solve(A,b)</code></td><td>íŒ©í„° ë¡œë”© ì¶”ì •</td></tr>
<tr><td>ê³ ìœ ê°’</td><td>\(Av = \lambda v\)</td><td><code>np.linalg.eigh(A)</code></td><td>ë¦¬ìŠ¤í¬ ë°©í–¥, PCA</td></tr>
<tr><td>SVD</td><td>\(A = U\Sigma V^T\)</td><td><code>np.linalg.svd(A)</code></td><td>ì°¨ì› ì¶•ì†Œ, ë…¸ì´ì¦ˆ ì œê±°</td></tr>
<tr><td>PCA</td><td>ê³µë¶„ì‚° ê³ ìœ ê°’ ë¶„í•´</td><td><code>np.linalg.eigh(cov)</code></td><td>íŒ©í„° ì¶”ì¶œ, ì°¨ì› ì¶•ì†Œ</td></tr>
<tr><td>Cholesky</td><td>\(\Sigma = LL^T\)</td><td><code>np.linalg.cholesky(Î£)</code></td><td>ìƒê´€ëœ ì‹œë®¬ë ˆì´ì…˜</td></tr>
<tr><td>ì´ì°¨í˜•ì‹</td><td>\(\mathbf{w}^T\Sigma\mathbf{w}\)</td><td><code>w @ Î£ @ w</code></td><td>í¬íŠ¸í´ë¦¬ì˜¤ ë¶„ì‚°</td></tr>
</table>

<div class="info">
<p class="ni"><strong>ë‹¤ìŒ ë‹¨ê³„:</strong> ì´ ê°•ì˜ì—ì„œ ë°°ìš´ ì„ í˜•ëŒ€ìˆ˜ëŠ” R2(Linear Algebra + Stats)ì—ì„œ ì‹¤ì œ ì£¼ê°€ ë°ì´í„°ì— ì ìš©ëœë‹¤. R2ì—ì„œëŠ” yfinanceë¡œ ì‹¤ì œ ë°ì´í„°ë¥¼ ê°€ì ¸ì™€ ê³µë¶„ì‚° í–‰ë ¬ì„ êµ¬í•˜ê³ , ê³ ìœ ê°’ ë¶„í•´ë¡œ ë¦¬ìŠ¤í¬ë¥¼ ë¶„ì„í•˜ë©°, í¬íŠ¸í´ë¦¬ì˜¤ íˆíŠ¸ë§µì„ ê·¸ë¦°ë‹¤. ì´ ê°•ì˜ì˜ ìˆ˜í•™ì  ê¸°ì´ˆê°€ R2ì˜ ì‹¤ì „ ì½”ë“œë¥¼ ì´í•´í•˜ëŠ” ì—´ì‡ ë‹¤.</p>
</div>

</div><!-- paper-content -->
</div><!-- container -->
</div><!-- main-wrapper -->

</body>
</html>