<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bonus 5 - ê¸ˆìœµê³µí•™ ì˜¬ì¸ì› (Financial Engineering All-in-One)</title>
<script>
MathJax = {
  tex: {
    inlineMath: [['\\(','\\)'],['$','$']],
    displayMath: [['\\[','\\]'],['$$','$$']]
  }
};
</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@300;400;500&family=Space+Mono:wght@400&family=Inter:wght@300;400&display=swap" rel="stylesheet">
<script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Inter',sans-serif;background:#fafaf8;color:#1a1a1a;line-height:1.7;overflow-x:hidden}
.sidebar{position:fixed;left:0;top:0;width:260px;height:100vh;background:rgba(255,255,255,.97);border-right:1px solid rgba(0,0,0,.06);padding:32px 24px;z-index:100;overflow-y:auto;display:flex;flex-direction:column}
.sidebar-profile{text-align:center;margin-bottom:28px;padding-bottom:24px;border-bottom:1px solid rgba(0,0,0,.08)}
.profile-icon{font-size:48px;margin-bottom:8px}
.profile-name{font-family:'Cormorant Garamond',serif;font-size:1.3rem;font-weight:500;margin-bottom:4px}
.profile-title{font-size:.68rem;color:#888;letter-spacing:.08em;text-transform:uppercase;margin-bottom:8px}
.profile-bio{font-size:.78rem;color:#666;line-height:1.5}
.sidebar-nav{flex:1;margin-top:16px}
.nav-section{margin-bottom:20px}
.nav-section-title{font-size:.6rem;font-weight:600;color:#aaa;letter-spacing:.15em;text-transform:uppercase;margin-bottom:10px}
.nav-list{list-style:none}
.nav-list li{margin-bottom:5px}
.nav-list a{font-size:.78rem;color:#555;text-decoration:none;transition:all .2s;display:block;padding:3px 0}
.nav-list a:hover{color:#0080c6;padding-left:4px}
.nav-list a.active{color:#0080c6;font-weight:500}
.nav-list a.done{color:#28a745}
.badge{display:inline-block;font-size:.5rem;background:#0080c6;color:#fff;padding:1px 5px;border-radius:8px;margin-left:3px;vertical-align:middle}
.badge-done{background:#28a745}
.badge-bonus{background:#9c27b0}
.sidebar-footer{padding-top:16px;border-top:1px solid rgba(0,0,0,.06);font-size:.65rem;color:#aaa;text-align:center}
.main-wrapper{margin-left:260px;min-height:100vh}
.container{max-width:1100px;margin:0 auto;padding:50px 40px 80px}
.paper-content{font-family:'Times New Roman','Nanum Myeongjo',serif;line-height:1.8;background:#fff;padding:40px;border-radius:8px;box-shadow:0 2px 20px rgba(0,0,0,.05)}
.paper-header{text-align:center;margin-bottom:40px;padding-bottom:30px;border-bottom:2px solid #333}
.paper-category{font-size:14px;color:#666;margin-bottom:10px}
.paper-title{font-size:24px;font-weight:bold;margin-bottom:12px;line-height:1.4}
.paper-subtitle{font-size:14px;color:#555;margin-bottom:8px}
.paper-team{font-size:13px;color:#444}
.abstract{background:#f8f9fa;padding:25px;margin:30px 0;border-left:4px solid #2c3e50}
.abstract-title{font-weight:bold;font-size:16px;margin-bottom:15px}
h2{font-size:18px;margin:35px 0 20px;padding-bottom:8px;border-bottom:1px solid #ddd;color:#2c3e50}
h3{font-size:15px;margin:25px 0 15px;color:#34495e}
h4{font-size:14px;margin:20px 0 12px;color:#34495e}
p{text-align:justify;margin-bottom:15px;text-indent:2em}
p.ni{text-indent:0}
table{width:100%;border-collapse:collapse;margin:20px 0;font-size:12px}
th,td{border:1px solid #ddd;padding:10px 8px;text-align:center}
th{background:#2c3e50;color:white;font-weight:bold}
tr:nth-child(even){background:#f8f9fa}
tr:hover{background:#e8f4f8}
.tc{font-size:13px;font-weight:bold;margin:15px 0 10px;text-align:center}
.eq{text-align:center;margin:20px 0;padding:15px;background:#f8f9fa;border-radius:4px;overflow-x:auto}
ul,ol{margin-left:2em;margin-bottom:15px}
li{margin-bottom:6px}
.def{background:#fff9e6;border:1px solid #ffc107;border-radius:4px;padding:20px;margin:20px 0}
.info{background:#e8f4f8;border-left:4px solid #3498db;padding:20px;margin:20px 0}
.warn{background:#fff3cd;border-left:4px solid #f39c12;padding:20px;margin:20px 0}
.ok{background:#d4edda;border-left:4px solid #28a745;padding:20px;margin:20px 0}
pre{background:#1e1e1e;color:#d4d4d4;padding:20px;border-radius:6px;overflow-x:auto;margin:20px 0;font-family:'Space Mono','Consolas',monospace;font-size:13px;line-height:1.6}
code{font-family:'Space Mono','Consolas',monospace;font-size:13px}
p code,li code,td code{background:#f0f0f0;padding:2px 6px;border-radius:3px;color:#c7254e;font-size:12px}
.cm{color:#6a9955}.kw{color:#569cd6}.st{color:#ce9178}.fn{color:#dcdcaa}.nb{color:#4ec9b0}.nu{color:#b5cea8}
.progress-bar{width:100%;height:6px;background:#e0e0e0;border-radius:3px;margin-top:16px}
.progress-fill{height:100%;background:linear-gradient(90deg,#9c27b0,#e040fb);border-radius:3px;width:100%}
details{margin:20px 0;border:1px solid #ddd;border-radius:6px;overflow:hidden}
details summary{padding:14px 20px;background:#f0f4f8;cursor:pointer;font-weight:bold;font-size:14px;color:#2c3e50;user-select:none;transition:background .2s}
details summary:hover{background:#e0e8f0}
details[open] summary{background:#d0dce8;border-bottom:1px solid #ddd}
details .answer-content{padding:20px;background:#fff}
.problem-box{background:#f0f4ff;border:2px solid #5c6bc0;border-radius:8px;padding:20px;margin:20px 0}
.problem-box .problem-title{font-weight:bold;color:#283593;font-size:15px;margin-bottom:12px}
@media(max-width:1024px){
.sidebar{width:100%;height:auto;position:relative;border-right:none;border-bottom:1px solid rgba(0,0,0,.08);padding:16px}
.sidebar-profile{margin-bottom:10px;padding-bottom:10px;display:flex;align-items:center;gap:12px;text-align:left}
.profile-icon{font-size:32px;margin-bottom:0}.profile-bio{display:none}
.nav-section{display:inline-block;margin-right:16px;margin-bottom:8px}
.nav-list{display:flex;gap:10px;flex-wrap:wrap}.nav-list li{margin-bottom:0}
.sidebar-footer{display:none}
.main-wrapper{margin-left:0}
.container{padding:0}.paper-content{padding:20px 16px;border-radius:0;box-shadow:none}
.paper-title{font-size:18px}p{font-size:14px;text-indent:1.5em;text-align:left}
pre{font-size:11px;padding:14px}table{font-size:10px;display:block;overflow-x:auto}
}
.code-output{background:#1e1e1e;color:#d4d4d4;padding:12px 16px;border-radius:0 0 6px 6px;font-family:'Space Mono',monospace;font-size:11.5px;line-height:1.6;margin-top:-4px;margin-bottom:18px;border-top:2px solid #333;white-space:pre-wrap;overflow-x:auto}
.code-output .out-label{color:#888;font-size:10px;margin-bottom:4px;display:block}
</style>
</head>
<body>

<div class="sidebar">
<div class="sidebar-profile">
<div class="profile-icon">âš—ï¸</div>
<div class="profile-name">HFT ML Master Plan</div>
<div class="profile-title">Convex Opt + DL + HFT</div>
<div class="profile-bio">Bonus Rounds: ìˆ˜í•™ ê¸°ì´ˆ ì˜¬ì¸ì›</div>
</div>
<div class="sidebar-nav">
<div class="nav-section">
<div class="nav-section-title">Curriculum</div>
<ul class="nav-list">
<li><a class="done" href="../round-01/">R1. Python + Finance <span class="badge badge-done">DONE</span></a></li>
<li><a class="done" href="../bonus-01/">B1. ì„ í˜•ëŒ€ìˆ˜ <span class="badge badge-done">DONE</span></a></li>
<li><a class="done" href="../round-02/">R2. LinAlg + Stats <span class="badge badge-done">DONE</span></a></li>
<li><a class="done" href="../bonus-02/">B2. ë¯¸ì ë¶„ <span class="badge badge-done">DONE</span></a></li>
<li><a class="done" href="../round-03/">R3. Data / Feature <span class="badge badge-done">DONE</span></a></li>
<li><a class="done" href="../bonus-04/">B4. ì¬ë¬´ê´€ë¦¬ <span class="badge badge-done">DONE</span></a></li>
<li><a class="done" href="../round-04/">R4. Supervised ML <span class="badge badge-done">DONE</span></a></li>
<li><a class="done" href="../bonus-03/">B3. í™•ë¥ Â·í†µê³„ <span class="badge badge-done">DONE</span></a></li>
<li><a class="done" href="../round-05/">R5. Unsupervised+TS <span class="badge badge-done">DONE</span></a></li>
<li><a class="active" href="#">B5. ê¸ˆìœµê³µí•™ ì˜¬ì¸ì› <span class="badge badge-bonus">BONUS</span></a></li>
<li><a href="../round-06/">R6. NLP + Sentiment</a></li>
<li><a href="../round-07/">R7. Deep Learning</a></li>
<li><a href="../bonus-06/">B6. ìµœì í™” ì´ë¡ </a></li>
<li><a href="../round-08/">R8. Convex Opt + Transformer</a></li>
<li><a href="../round-09/">R9. HFT + RL</a></li>
<li><a href="../round-10/">R10. Final Project</a></li>
</ul>
</div>
<div class="nav-section">
<div class="nav-section-title">This Lecture</div>
<ul class="nav-list">
<li><a href="#ch1">1. ê¸ˆìœµê³µí•™ì´ë€?</a></li>
<li><a href="#ch2">2. ë¸Œë¼ìš´ ìš´ë™ê³¼ í™•ë¥ ê³¼ì •</a></li>
<li><a href="#ch3">3. ì´í†  ë³´ì¡°ì •ë¦¬</a></li>
<li><a href="#ch4">4. ë¸”ë™-ìˆ„ì¦ˆ ëª¨ë¸</a></li>
<li><a href="#ch5">5. ì˜µì…˜ ê·¸ë¦­ìŠ¤</a></li>
<li><a href="#ch6">6. ëª¬í…Œì¹´ë¥¼ë¡œ ì‹œë®¬ë ˆì´ì…˜</a></li>
<li><a href="#ch7">7. VaRì™€ ë¦¬ìŠ¤í¬ ì¸¡ì •</a></li>
<li><a href="#ch8">8. ë³€ë™ì„± ëª¨ë¸ë§</a></li>
<li><a href="#ch9">9. ê¸ˆë¦¬ ëª¨ë¸ê³¼ ì±„ê¶Œ</a></li>
<li><a href="#ch10">10. ì¢…í•© ë¬¸ì œ</a></li>
</ul>
</div>
</div>
<div class="sidebar-footer">Bonus 5 â€” ê¸ˆìœµê³µí•™ ì˜¬ì¸ì›</div>
</div>

<div class="main-wrapper">
<div class="container">
<div class="paper-content">

<div class="paper-header">
<div class="paper-category">Bonus Round 5 / 6 â€” R5ì™€ R6 ì‚¬ì´</div>
<h1 class="paper-title">ê¸ˆìœµê³µí•™ ì˜¬ì¸ì› (Financial Engineering All-in-One)</h1>
<div class="paper-subtitle">í™•ë¥ ê³¼ì • â†’ ì´í†  ë³´ì¡°ì •ë¦¬ â†’ ë¸”ë™-ìˆ„ì¦ˆ â†’ ê·¸ë¦­ìŠ¤ â†’ ëª¬í…Œì¹´ë¥¼ë¡œ â†’ VaR â†’ ë³€ë™ì„± â†’ ê¸ˆë¦¬ ëª¨ë¸</div>
<div class="paper-team">íŒŒìƒìƒí’ˆ ê°€ê²© ê²°ì •ê³¼ ë¦¬ìŠ¤í¬ ê´€ë¦¬ì˜ ìˆ˜í•™ì  ê¸°ì´ˆ</div>
<div class="progress-bar"><div class="progress-fill"></div></div>
</div>

<div class="abstract">
<div class="abstract-title">ì™œ ê¸ˆìœµê³µí•™ì¸ê°€?</div>
<p class="ni">ê¸ˆìœµê³µí•™ì€ ìˆ˜í•™Â·í†µê³„Â·í”„ë¡œê·¸ë˜ë°ì„ ê²°í•©í•˜ì—¬ ê¸ˆìœµ ìƒí’ˆì˜ ê°€ê²©ì„ ê²°ì •í•˜ê³  ë¦¬ìŠ¤í¬ë¥¼ ê´€ë¦¬í•˜ëŠ” í•™ë¬¸ì´ë‹¤. ì˜µì…˜ ê°€ê²© ê²°ì •, VaR ê³„ì‚°, ë³€ë™ì„± ëª¨ë¸ë§ ë“± í€€íŠ¸ì˜ í•µì‹¬ ë„êµ¬ê°€ ëª¨ë‘ ì—¬ê¸°ì— ìˆë‹¤. ì´ ê°•ì˜ë¥¼ ë§ˆì¹˜ë©´:</p>
<ul>
<li>ê¸°í•˜ ë¸Œë¼ìš´ ìš´ë™(GBM)ìœ¼ë¡œ ì£¼ê°€ë¥¼ ëª¨ë¸ë§í•˜ê³  ì‹œë®¬ë ˆì´ì…˜í•  ìˆ˜ ìˆë‹¤</li>
<li>ì´í†  ë³´ì¡°ì •ë¦¬ì˜ ì˜ë¯¸ë¥¼ ì´í•´í•˜ê³  ë¸”ë™-ìˆ„ì¦ˆ ê³µì‹ì„ ìœ ë„í•  ìˆ˜ ìˆë‹¤</li>
<li>ì˜µì…˜ ê·¸ë¦­ìŠ¤ë¥¼ ê³„ì‚°í•˜ê³  ë¸íƒ€ í—¤ì§• ì „ëµì„ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤</li>
<li>ëª¬í…Œì¹´ë¥¼ë¡œ ì‹œë®¬ë ˆì´ì…˜ìœ¼ë¡œ ì´ìƒ‰ íŒŒìƒìƒí’ˆ ê°€ê²©ì„ ì‚°ì¶œí•  ìˆ˜ ìˆë‹¤</li>
<li>VaR, CVaR ë“± ë¦¬ìŠ¤í¬ ì§€í‘œë¥¼ ê³„ì‚°í•˜ê³  ë°±í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆë‹¤</li>
<li>GARCH ëª¨ë¸ë¡œ ë³€ë™ì„±ì„ ì¶”ì •í•˜ê³  ë‚´ì¬ ë³€ë™ì„± ì„œí”¼ìŠ¤ë¥¼ ë¶„ì„í•  ìˆ˜ ìˆë‹¤</li>
<li>Vasicek/CIR ê¸ˆë¦¬ ëª¨ë¸ë¡œ ì±„ê¶Œ ê°€ê²©ì„ ê²°ì •í•  ìˆ˜ ìˆë‹¤</li>
</ul>
<div style="font-size:13px;color:#555;margin-top:15px;font-style:italic"><strong>Keywords:</strong> GBM, ItÃ´'s Lemma, Black-Scholes, Greeks, Delta Hedging, Monte Carlo, Variance Reduction, VaR, CVaR, GARCH, Implied Volatility Surface, Vasicek, CIR, Duration, Convexity</div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- Ch1: ê¸ˆìœµê³µí•™ì´ë€? -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<h2 id="ch1">1. ê¸ˆìœµê³µí•™ì´ë€?</h2>

<h3>1.1 ê¸ˆìœµê³µí•™ì˜ ì„¸ ê¸°ë‘¥</h3>

<div class="def">
<p class="ni"><strong>ê¸ˆìœµê³µí•™ = ìˆ˜í•™ + í†µê³„ + í”„ë¡œê·¸ë˜ë°</strong></p>
<ul>
<li><strong>ìˆ˜í•™:</strong> í™•ë¥ ê³¼ì •, í¸ë¯¸ë¶„ë°©ì •ì‹, ìµœì í™” â†’ ëª¨ë¸ êµ¬ì¶•</li>
<li><strong>í†µê³„:</strong> ì‹œê³„ì—´ ë¶„ì„, ì¶”ì •, ê²€ì • â†’ ëª¨ë¸ ê²€ì¦ (ìº˜ë¦¬ë¸Œë ˆì´ì…˜)</li>
<li><strong>í”„ë¡œê·¸ë˜ë°:</strong> ìˆ˜ì¹˜ ê³„ì‚°, ì‹œë®¬ë ˆì´ì…˜, ìë™í™” â†’ ëª¨ë¸ êµ¬í˜„</li>
</ul>
</div>

<h3>1.2 íŒŒìƒìƒí’ˆì˜ ê¸°ì´ˆ</h3>
<p>íŒŒìƒìƒí’ˆ(derivative)ì€ ê¸°ì´ˆìì‚°(underlying asset)ì˜ ê°€ê²©ì— ì˜í•´ ê°€ì¹˜ê°€ ê²°ì •ë˜ëŠ” ê¸ˆìœµ ê³„ì•½ì´ë‹¤. ê¸°ì´ˆìì‚°ì€ ì£¼ì‹, ì±„ê¶Œ, ê¸ˆë¦¬, í™˜ìœ¨, ì›ìì¬ ë“± ë¬´ì—‡ì´ë“  ë  ìˆ˜ ìˆë‹¤.</p>

<div class="tc">Table 1. ì£¼ìš” íŒŒìƒìƒí’ˆ</div>
<table>
<tr><th>ìƒí’ˆ</th><th>ì •ì˜</th><th>ë§¤ìˆ˜ì ê¶Œë¦¬</th><th>ë§¤ë„ì ì˜ë¬´</th><th>í”„ë¦¬ë¯¸ì—„</th></tr>
<tr><td>ì„ ë„ (Forward)</td><td>ì¥ì™¸ ì‹œì¥ì—ì„œ ë¯¸ë˜ ì‹œì ì— ì •í•´ì§„ ê°€ê²©ìœ¼ë¡œ ë§¤ë§¤</td><td>ë§¤ìˆ˜ ì˜ë¬´</td><td>ë§¤ë„ ì˜ë¬´</td><td>ì—†ìŒ</td></tr>
<tr><td>ì„ ë¬¼ (Futures)</td><td>ê±°ë˜ì†Œì—ì„œ í‘œì¤€í™”ëœ ì„ ë„ ê³„ì•½</td><td>ë§¤ìˆ˜ ì˜ë¬´</td><td>ë§¤ë„ ì˜ë¬´</td><td>ì¦ê±°ê¸ˆ</td></tr>
<tr><td>ì½œì˜µì…˜ (Call)</td><td>ê¸°ì´ˆìì‚°ì„ ì‚´ ìˆ˜ ìˆëŠ” ê¶Œë¦¬</td><td>ë§¤ìˆ˜ ê¶Œë¦¬</td><td>ë§¤ë„ ì˜ë¬´</td><td>ì§€ë¶ˆ</td></tr>
<tr><td>í’‹ì˜µì…˜ (Put)</td><td>ê¸°ì´ˆìì‚°ì„ íŒ” ìˆ˜ ìˆëŠ” ê¶Œë¦¬</td><td>ë§¤ë„ ê¶Œë¦¬</td><td>ë§¤ìˆ˜ ì˜ë¬´</td><td>ì§€ë¶ˆ</td></tr>
<tr><td>ìŠ¤ì™‘ (Swap)</td><td>í˜„ê¸ˆíë¦„ì„ êµí™˜í•˜ëŠ” ê³„ì•½</td><td colspan="2">ìƒí˜¸ êµí™˜</td><td>ì—†ìŒ</td></tr>
</table>

<div class="info">
<p class="ni"><strong>ì„ ë¬¼ vs ì˜µì…˜ì˜ í•µì‹¬ ì°¨ì´:</strong> ì„ ë¬¼ì€ ì–‘ìª½ ëª¨ë‘ ì˜ë¬´(obligation)ì´ê³ , ì˜µì…˜ì€ ë§¤ìˆ˜ìì—ê²Œ ê¶Œë¦¬(right)ë¥¼ ì¤€ë‹¤. ê¶Œë¦¬ì—ëŠ” ëŒ€ê°€ê°€ ìˆìœ¼ë¯€ë¡œ ì˜µì…˜ ë§¤ìˆ˜ìëŠ” í”„ë¦¬ë¯¸ì—„ì„ ì§€ë¶ˆí•œë‹¤. ì´ í”„ë¦¬ë¯¸ì—„ì„ "ê³µì •í•˜ê²Œ" ê²°ì •í•˜ëŠ” ê²ƒì´ ê¸ˆìœµê³µí•™ì˜ í•µì‹¬ ë¬¸ì œë‹¤.</p>
</div>

<h3>1.3 ì˜µì…˜ì˜ ë‚´ì¬ê°€ì¹˜ì™€ ì‹œê°„ê°€ì¹˜</h3>

<div class="def">
<p class="ni"><strong>ì˜µì…˜ ê°€ê²© = ë‚´ì¬ê°€ì¹˜ + ì‹œê°„ê°€ì¹˜</strong></p>
<ul>
<li><strong>ë‚´ì¬ê°€ì¹˜ (Intrinsic Value):</strong> ì§€ê¸ˆ ë‹¹ì¥ í–‰ì‚¬í•˜ë©´ ì–»ëŠ” ì´ìµ. ì½œ: \(\max(S-K, 0)\), í’‹: \(\max(K-S, 0)\)</li>
<li><strong>ì‹œê°„ê°€ì¹˜ (Time Value):</strong> ë§Œê¸°ê¹Œì§€ ë‚¨ì€ ì‹œê°„ ë™ì•ˆ ìœ ë¦¬í•˜ê²Œ ë³€í•  ê°€ëŠ¥ì„±ì˜ ê°€ì¹˜. ë§Œê¸°ì— ê°€ê¹Œì›Œì§ˆìˆ˜ë¡ 0ìœ¼ë¡œ ìˆ˜ë ´</li>
</ul>
</div>

<div class="tc">Table 1b. ì˜µì…˜ì˜ ë¨¸ë‹ˆë‹ˆìŠ¤ (Moneyness)</div>
<table>
<tr><th>ìƒíƒœ</th><th>ì½œì˜µì…˜</th><th>í’‹ì˜µì…˜</th><th>ë‚´ì¬ê°€ì¹˜</th><th>íŠ¹ì§•</th></tr>
<tr><td>ITM (In-the-Money)</td><td>\(S > K\)</td><td>\(S < K\)</td><td>> 0</td><td>í–‰ì‚¬ ê°€ì¹˜ ìˆìŒ</td></tr>
<tr><td>ATM (At-the-Money)</td><td>\(S \approx K\)</td><td>\(S \approx K\)</td><td>â‰ˆ 0</td><td>ì‹œê°„ê°€ì¹˜ ìµœëŒ€</td></tr>
<tr><td>OTM (Out-of-the-Money)</td><td>\(S < K\)</td><td>\(S > K\)</td><td>0</td><td>ì‹œê°„ê°€ì¹˜ë§Œ ì¡´ì¬</td></tr>
</table>

<h3>1.4 ë¬´ì°¨ìµ ì›ë¦¬ (No-Arbitrage Principle)</h3>
<p>ê¸ˆìœµê³µí•™ì˜ ê°€ì¥ ê·¼ë³¸ì ì¸ ì›ë¦¬: "ê³µì§œ ì ì‹¬ì€ ì—†ë‹¤." ë™ì¼í•œ í˜„ê¸ˆíë¦„ì„ ê°€ì§„ ë‘ í¬íŠ¸í´ë¦¬ì˜¤ëŠ” ê°™ì€ ê°€ê²©ì´ì–´ì•¼ í•œë‹¤. ì´ ì›ë¦¬ë¡œë¶€í„° ëª¨ë“  íŒŒìƒìƒí’ˆ ê°€ê²© ê²°ì • ê³µì‹ì´ ë„ì¶œëœë‹¤.</p>

<div class="eq">
\[\text{ê°™ì€ í˜ì´ì˜¤í”„} \Rightarrow \text{ê°™ì€ ê°€ê²©} \quad (\text{Law of One Price})\]
</div>

<p>ë§Œì•½ ê°™ì€ í˜ì´ì˜¤í”„ë¥¼ ê°€ì§„ ë‘ í¬íŠ¸í´ë¦¬ì˜¤ì˜ ê°€ê²©ì´ ë‹¤ë¥´ë‹¤ë©´, ë¹„ì‹¼ ê²ƒì„ íŒ”ê³  ì‹¼ ê²ƒì„ ì‚¬ë©´ ë¬´ìœ„í—˜ ì´ìµì„ ì–»ëŠ”ë‹¤. ì‹œì¥ ì°¸ì—¬ìë“¤ì´ ì´ëŸ° ê¸°íšŒë¥¼ ì¦‰ì‹œ í¬ì°©í•˜ë¯€ë¡œ, ê· í˜• ìƒíƒœì—ì„œ ì°¨ìµê±°ë˜ ê¸°íšŒëŠ” ì¡´ì¬í•˜ì§€ ì•ŠëŠ”ë‹¤.</p>

<h3>1.5 í’‹-ì½œ íŒ¨ë¦¬í‹° (Put-Call Parity)</h3>
<p>ë¬´ì°¨ìµ ì›ë¦¬ì˜ ê°€ì¥ ìœ ëª…í•œ ì‘ìš©. ìœ ëŸ½í˜• ì˜µì…˜ì—ì„œ ì½œê³¼ í’‹ì˜ ê´€ê³„:</p>

<div class="eq">
\[C - P = S - Ke^{-rT}\]
</div>

<p>ì§ê´€: "ì½œ ë§¤ìˆ˜ + í’‹ ë§¤ë„"ëŠ” "ì£¼ì‹ ë§¤ìˆ˜ + ì°¨ì…"ê³¼ ê°™ì€ í˜ì´ì˜¤í”„ë¥¼ ë§Œë“ ë‹¤. ë§Œê¸° ì‹œ ì£¼ê°€ê°€ \(K\)ë³´ë‹¤ ë†’ìœ¼ë©´ ì½œì„ í–‰ì‚¬í•˜ê³ , ë‚®ìœ¼ë©´ í’‹ì´ í–‰ì‚¬ë‹¹í•œë‹¤ â€” ì–´ëŠ ìª½ì´ë“  ì£¼ì‹ì„ \(K\)ì— ì‚¬ê²Œ ëœë‹¤.</p>

<pre><code><span class="kw">import</span> numpy <span class="kw">as</span> np

<span class="cm"># í’‹-ì½œ íŒ¨ë¦¬í‹° ê²€ì¦</span>
S = <span class="nu">100</span>     <span class="cm"># í˜„ì¬ ì£¼ê°€</span>
K = <span class="nu">100</span>     <span class="cm"># í–‰ì‚¬ê°€</span>
r = <span class="nu">0.05</span>    <span class="cm"># ë¬´ìœ„í—˜ ê¸ˆë¦¬</span>
T = <span class="nu">0.5</span>     <span class="cm"># ë§Œê¸° (ë…„)</span>
C = <span class="nu">8.50</span>    <span class="cm"># ì½œì˜µì…˜ ê°€ê²©</span>
P = <span class="nu">6.05</span>    <span class="cm"># í’‹ì˜µì…˜ ê°€ê²©</span>

<span class="cm"># íŒ¨ë¦¬í‹° í™•ì¸</span>
lhs = C - P
rhs = S - K * np.exp(-r * T)
<span class="fn">print</span>(<span class="st">f"C - P     = </span>{lhs:.4f}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"S - Keâ»Ê³áµ€ = </span>{rhs:.4f}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"ì°¨ì´:       </span>{abs(lhs - rhs):.4f}<span class="st"> (â‰ˆ 0ì´ë©´ íŒ¨ë¦¬í‹° ì„±ë¦½)"</span>)

<span class="cm"># ì°¨ìµê±°ë˜ ì „ëµ</span>
<span class="fn">print</span>(<span class="st">f"\ní’‹-ì½œ íŒ¨ë¦¬í‹°ê°€ ê¹¨ì§€ë©´:"</span>)
<span class="fn">print</span>(<span class="st">f"  C-P > S-Keâ»Ê³áµ€ â†’ ì½œ ë§¤ë„ + í’‹ ë§¤ìˆ˜ + ì£¼ì‹ ë§¤ìˆ˜ + ì°¨ì…"</span>)
<span class="fn">print</span>(<span class="st">f"  C-P &lt; S-Keâ»Ê³áµ€ â†’ ì½œ ë§¤ìˆ˜ + í’‹ ë§¤ë„ + ì£¼ì‹ ê³µë§¤ë„ + ì˜ˆê¸ˆ"</span>)

<span class="cm"># ë§Œê¸° ì‹œ í˜ì´ì˜¤í”„ ê²€ì¦</span>
<span class="fn">print</span>(<span class="st">f"\n--- ë§Œê¸° ì‹œ í˜ì´ì˜¤í”„ ê²€ì¦ ---"</span>)
<span class="kw">for</span> ST <span class="kw">in</span> [<span class="nu">80</span>, <span class="nu">90</span>, <span class="nu">100</span>, <span class="nu">110</span>, <span class="nu">120</span>]:
    call_payoff = <span class="fn">max</span>(ST - K, <span class="nu">0</span>)
    put_payoff = <span class="fn">max</span>(K - ST, <span class="nu">0</span>)
    portfolio = call_payoff - put_payoff  <span class="cm"># ì½œ ë§¤ìˆ˜ + í’‹ ë§¤ë„</span>
    stock_bond = ST - K                   <span class="cm"># ì£¼ì‹ - ì±„ê¶Œ ìƒí™˜</span>
    <span class="fn">print</span>(<span class="st">f"  S_T={ST}: C-P payoff = {portfolio:+d}, S-K = {stock_bond:+d}  âœ“"</span>)</code></pre>
<div class="code-output"><span class="out-label">Output:</span>
C - P     = 2.4500
S - Keâ»Ê³áµ€ = 2.4690
ì°¨ì´:       0.0190 (â‰ˆ 0ì´ë©´ íŒ¨ë¦¬í‹° ì„±ë¦½)

í’‹-ì½œ íŒ¨ë¦¬í‹°ê°€ ê¹¨ì§€ë©´:
  C-P > S-Keâ»Ê³áµ€ â†’ ì½œ ë§¤ë„ + í’‹ ë§¤ìˆ˜ + ì£¼ì‹ ë§¤ìˆ˜ + ì°¨ì…
  C-P < S-Keâ»Ê³áµ€ â†’ ì½œ ë§¤ìˆ˜ + í’‹ ë§¤ë„ + ì£¼ì‹ ê³µë§¤ë„ + ì˜ˆê¸ˆ

--- ë§Œê¸° ì‹œ í˜ì´ì˜¤í”„ ê²€ì¦ ---
  S_T=80: C-P payoff = -20, S-K = -20  âœ“
  S_T=90: C-P payoff = -10, S-K = -10  âœ“
  S_T=100: C-P payoff = +0, S-K = +0  âœ“
  S_T=110: C-P payoff = +10, S-K = +10  âœ“
  S_T=120: C-P payoff = +20, S-K = +20  âœ“</div>

<h3>1.6 ìœ„í—˜ì¤‘ë¦½ ê°€ê²© ê²°ì • (Risk-Neutral Pricing)</h3>
<p>íŒŒìƒìƒí’ˆ ê°€ê²© ê²°ì •ì˜ í•µì‹¬ ì•„ì´ë””ì–´: ë¬´ì°¨ìµ ì¡°ê±´ í•˜ì—ì„œ íŒŒìƒìƒí’ˆì˜ ê°€ê²©ì€ ìœ„í—˜ì¤‘ë¦½ ì¸¡ë„(risk-neutral measure) \(\mathbb{Q}\) í•˜ì—ì„œì˜ í• ì¸ëœ ê¸°ëŒ€ í˜ì´ì˜¤í”„ì™€ ê°™ë‹¤.</p>

<div class="eq">
\[V_0 = e^{-rT} \cdot E^{\mathbb{Q}}[\text{Payoff}(S_T)]\]
</div>

<div class="warn">
<p class="ni"><strong>ìœ„í—˜ì¤‘ë¦½ â‰  íˆ¬ììê°€ ìœ„í—˜ì„ ë¬´ì‹œí•œë‹¤:</strong> ìœ„í—˜ì¤‘ë¦½ ì¸¡ë„ëŠ” ìˆ˜í•™ì  ë„êµ¬ì¼ ë¿ì´ë‹¤. ì‹¤ì œ ì„¸ê³„ì—ì„œ íˆ¬ììëŠ” ìœ„í—˜ì„ ì‹«ì–´í•œë‹¤. í•˜ì§€ë§Œ ë¬´ì°¨ìµ ì¡°ê±´ì„ ë§Œì¡±í•˜ëŠ” ê°€ê²©ì€ ë§ˆì¹˜ ëª¨ë“  ìì‚°ì´ ë¬´ìœ„í—˜ ìˆ˜ìµë¥  \(r\)ë¡œ ì„±ì¥í•˜ëŠ” ì„¸ê³„ì—ì„œ ê¸°ëŒ€ê°’ì„ êµ¬í•œ ê²ƒê³¼ ê°™ë‹¤. ì´ê²ƒì´ GBMì—ì„œ ë“œë¦¬í”„íŠ¸ë¥¼ \(\mu\) ëŒ€ì‹  \(r\)ë¡œ ë°”ê¾¸ëŠ” ì´ìœ ë‹¤.</p>
</div>

<div class="problem-box">
<div class="problem-title">âœï¸ ì—°ìŠµë¬¸ì œ 1.1</div>
<p class="ni">1ê¸°ê°„ ì´í•­ ëª¨ë¸ì—ì„œ í˜„ì¬ ì£¼ê°€ \(S_0 = 100\), ìƒìŠ¹ ì‹œ \(S_u = 120\), í•˜ë½ ì‹œ \(S_d = 90\), ë¬´ìœ„í—˜ ê¸ˆë¦¬ \(r = 5\%\)ì´ë‹¤.</p>
<ol>
<li>ìœ„í—˜ì¤‘ë¦½ í™•ë¥  \(q\)ë¥¼ êµ¬í•˜ë¼. (íŒíŠ¸: \(S_0 e^{rT} = q \cdot S_u + (1-q) \cdot S_d\))</li>
<li>í–‰ì‚¬ê°€ \(K = 105\)ì¸ ì½œì˜µì…˜ì˜ ê°€ê²©ì„ ìœ„í—˜ì¤‘ë¦½ ê°€ê²© ê²°ì •ìœ¼ë¡œ êµ¬í•˜ë¼.</li>
<li>í’‹-ì½œ íŒ¨ë¦¬í‹°ë¡œ ê°™ì€ í–‰ì‚¬ê°€ì˜ í’‹ì˜µì…˜ ê°€ê²©ì„ êµ¬í•˜ë¼.</li>
</ol>
</div>

<details>
<summary>ğŸ”‘ í’€ì´ ë³´ê¸°</summary>
<div class="answer-content">
<p class="ni"><strong>1)</strong> \(100 \times e^{0.05} = q \times 120 + (1-q) \times 90\)</p>
<p class="ni">\(105.127 = 120q + 90 - 90q = 30q + 90\)</p>
<p class="ni">\(q = \frac{105.127 - 90}{30} = 0.5042\)</p>
<p class="ni"><strong>2)</strong> ì½œ í˜ì´ì˜¤í”„: ìƒìŠ¹ ì‹œ \(\max(120-105, 0) = 15\), í•˜ë½ ì‹œ \(\max(90-105, 0) = 0\)</p>
<p class="ni">\(C = e^{-0.05}(0.5042 \times 15 + 0.4958 \times 0) = 0.9512 \times 7.563 = 7.194\)</p>
<p class="ni"><strong>3)</strong> \(P = C - S + Ke^{-rT} = 7.194 - 100 + 105 \times 0.9512 = 7.194 - 100 + 99.876 = 7.070\)</p>
</div>
</details>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- Ch2: ë¸Œë¼ìš´ ìš´ë™ê³¼ í™•ë¥ ê³¼ì • -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<h2 id="ch2">2. ë¸Œë¼ìš´ ìš´ë™ê³¼ í™•ë¥ ê³¼ì •</h2>

<h3>2.1 í™•ë¥ ê³¼ì •ì˜ ë¶„ë¥˜</h3>
<p>í™•ë¥ ê³¼ì •(stochastic process)ì€ ì‹œê°„ì— ë”°ë¼ ë³€í•˜ëŠ” í™•ë¥ ë³€ìˆ˜ì˜ ëª¨ìŒ \(\{X_t\}_{t \geq 0}\)ì´ë‹¤. ê¸ˆìœµì—ì„œ ì£¼ë¡œ ì‚¬ìš©í•˜ëŠ” í™•ë¥ ê³¼ì •:</p>

<div class="tc">Table 2. ê¸ˆìœµì—ì„œ ì‚¬ìš©í•˜ëŠ” í™•ë¥ ê³¼ì •</div>
<table>
<tr><th>ê³¼ì •</th><th>íŠ¹ì§•</th><th>ê¸ˆìœµ ì‘ìš©</th><th>í•œê³„</th></tr>
<tr><td>ëœë¤ ì›Œí¬</td><td>ì´ì‚° ì‹œê°„, ë…ë¦½ ì¦ë¶„</td><td>ì£¼ê°€ ëª¨ë¸ì˜ ì¶œë°œì </td><td>ì—°ì† ì‹œê°„ ë¶ˆê°€</td></tr>
<tr><td>ìœ„ë„ˆ ê³¼ì •</td><td>ì—°ì†, ì •ê·œ ì¦ë¶„</td><td>GBMì˜ ë¹Œë”© ë¸”ë¡</td><td>ì í”„ ë¶ˆê°€</td></tr>
<tr><td>GBM</td><td>ë¡œê·¸ì •ê·œ, ì–‘ìˆ˜</td><td>ì£¼ê°€ ëª¨ë¸ë§ í‘œì¤€</td><td>ë³€ë™ì„± ìƒìˆ˜ ê°€ì •</td></tr>
<tr><td>OU ê³¼ì •</td><td>í‰ê·  íšŒê·€</td><td>ê¸ˆë¦¬, ë³€ë™ì„± ëª¨ë¸</td><td>ìŒìˆ˜ ê°€ëŠ¥</td></tr>
<tr><td>ì í”„ í™•ì‚°</td><td>ì—°ì† + ë¶ˆì—°ì†</td><td>ê¸‰ë“±ë½ ëª¨ë¸ë§</td><td>íŒŒë¼ë¯¸í„° ì¶”ì • ì–´ë ¤ì›€</td></tr>
<tr><td>ë ˆë¹„ ê³¼ì •</td><td>ë…ë¦½ ì •ìƒ ì¦ë¶„</td><td>íŒ» í…Œì¼ ëª¨ë¸ë§</td><td>ë³µì¡í•œ ìˆ˜í•™</td></tr>
</table>

<h3>2.2 ìœ„ë„ˆ ê³¼ì • (Wiener Process / Brownian Motion)</h3>
<p>ë¸Œë¼ìš´ ìš´ë™ \(W_t\)ëŠ” ê¸ˆìœµ ëª¨ë¸ì˜ ê¸°ë³¸ ë¹Œë”© ë¸”ë¡ì´ë‹¤. 1827ë…„ ì‹ë¬¼í•™ì ë¡œë²„íŠ¸ ë¸Œë¼ìš´ì´ ê½ƒê°€ë£¨ì˜ ë¶ˆê·œì¹™í•œ ìš´ë™ì„ ê´€ì°°í•œ ë°ì„œ ì´ë¦„ì´ ìœ ë˜í–ˆë‹¤.</p>

<div class="def">
<p class="ni"><strong>ìœ„ë„ˆ ê³¼ì •ì˜ 4ê°€ì§€ ì„±ì§ˆ:</strong></p>
<ol>
<li>\(W_0 = 0\) (ì›ì  ì¶œë°œ)</li>
<li><strong>ë…ë¦½ ì¦ë¶„:</strong> \(W_t - W_s\)ëŠ” ì‹œì  \(s\) ì´ì „ì˜ ëª¨ë“  ì •ë³´ì™€ ë…ë¦½</li>
<li><strong>ì •ê·œ ì¦ë¶„:</strong> \(W_t - W_s \sim N(0, t-s)\) â€” ì¦ë¶„ì˜ ë¶„ì‚°ì€ ì‹œê°„ ê°„ê²©ì— ë¹„ë¡€</li>
<li><strong>ì—°ì† ê²½ë¡œ:</strong> \(W_t\)ëŠ” ì—°ì†ì´ì§€ë§Œ ì–´ë””ì„œë„ ë¯¸ë¶„ ë¶ˆê°€ëŠ¥ (í”„ë™íƒˆ êµ¬ì¡°)</li>
</ol>
</div>

<div class="info">
<p class="ni"><strong>ë¸Œë¼ìš´ ìš´ë™ì˜ ë†€ë¼ìš´ ì„±ì§ˆë“¤:</strong></p>
<ul>
<li>\(E[W_t] = 0\), \(\text{Var}(W_t) = t\) â€” ì‹œê°„ì´ ì§€ë‚ ìˆ˜ë¡ ë¶ˆí™•ì‹¤ì„± ì¦ê°€</li>
<li>\(E[W_t^2] = t\) â€” 2ì°¨ ë³€ë™(quadratic variation)ì´ ì‹œê°„ê³¼ ê°™ë‹¤</li>
<li>\((dW_t)^2 = dt\) â€” ì´ê²ƒì´ ì´í†  ë³´ì¡°ì •ë¦¬ì˜ í•µì‹¬ (Ch3)</li>
<li>ê²½ë¡œì˜ ê¸¸ì´ëŠ” ë¬´í•œëŒ€ â€” ì–´ë–¤ ì§§ì€ êµ¬ê°„ì—ì„œë„ ë¬´í•œíˆ ì§„ë™</li>
</ul>
</div>

<h3>2.3 ê¸°í•˜ ë¸Œë¼ìš´ ìš´ë™ (Geometric Brownian Motion)</h3>
<p>ì£¼ê°€ ëª¨ë¸ë§ì˜ í‘œì¤€ ëª¨ë¸. ì£¼ê°€ëŠ” ìŒìˆ˜ê°€ ë  ìˆ˜ ì—†ìœ¼ë¯€ë¡œ ë¡œê·¸ ìˆ˜ìµë¥ ì´ ì •ê·œë¶„í¬ë¥¼ ë”°ë¥¸ë‹¤ê³  ê°€ì •í•œë‹¤:</p>

<div class="eq">
\[dS_t = \mu S_t \, dt + \sigma S_t \, dW_t\]
</div>

<p>ì—¬ê¸°ì„œ \(\mu\)ëŠ” ê¸°ëŒ€ ìˆ˜ìµë¥ (drift), \(\sigma\)ëŠ” ë³€ë™ì„±(diffusion)ì´ë‹¤. ì´ SDE(í™•ë¥ ë¯¸ë¶„ë°©ì •ì‹)ì˜ í•´ëŠ”:</p>

<div class="eq">
\[S_t = S_0 \exp\left[\left(\mu - \frac{\sigma^2}{2}\right)t + \sigma W_t\right]\]
</div>

<p>í•´ì—ì„œ \(\mu\)ê°€ ì•„ë‹Œ \(\mu - \sigma^2/2\)ê°€ ë‚˜íƒ€ë‚˜ëŠ” ì´ìœ ëŠ” ì´í†  ë³´ì¡°ì •ë¦¬ ë•Œë¬¸ì´ë‹¤ (Ch3ì—ì„œ ìƒì„¸íˆ). ì´ê²ƒì€ ì‚°ìˆ  í‰ê· ê³¼ ê¸°í•˜ í‰ê· ì˜ ì°¨ì´ì™€ ê´€ë ¨ëœë‹¤.</p>

<pre><code><span class="kw">import</span> numpy <span class="kw">as</span> np

np.random.seed(<span class="nu">42</span>)

<span class="cm"># GBM ì‹œë®¬ë ˆì´ì…˜</span>
S0 = <span class="nu">100</span>       <span class="cm"># ì´ˆê¸° ì£¼ê°€</span>
mu = <span class="nu">0.08</span>      <span class="cm"># ì—°ê°„ ê¸°ëŒ€ ìˆ˜ìµë¥  8%</span>
sigma = <span class="nu">0.20</span>   <span class="cm"># ì—°ê°„ ë³€ë™ì„± 20%</span>
T = <span class="nu">1.0</span>        <span class="cm"># 1ë…„</span>
n_steps = <span class="nu">252</span>  <span class="cm"># ê±°ë˜ì¼</span>
n_paths = <span class="nu">5</span>

dt = T / n_steps
t = np.linspace(<span class="nu">0</span>, T, n_steps + <span class="nu">1</span>)

<span class="fn">print</span>(<span class="st">f"GBM íŒŒë¼ë¯¸í„°: Sâ‚€={S0}, Î¼={mu}, Ïƒ={sigma}, T={T}ë…„"</span>)
<span class="fn">print</span>(<span class="st">f"ë“œë¦¬í”„íŠ¸ ë³´ì •: Î¼ - ÏƒÂ²/2 = {mu - sigma**2/2:.4f}"</span>)
<span class="fn">print</span>(<span class="st">f"E[S_T] = Sâ‚€Â·e^(Î¼T) = {S0 * np.exp(mu*T):.2f}"</span>)
<span class="fn">print</span>(<span class="st">f"Median[S_T] = Sâ‚€Â·e^((Î¼-ÏƒÂ²/2)T) = {S0 * np.exp((mu-sigma**2/2)*T):.2f}\n"</span>)

<span class="kw">for</span> i <span class="kw">in</span> <span class="fn">range</span>(n_paths):
    Z = np.random.randn(n_steps)
    W = np.cumsum(np.sqrt(dt) * Z)
    W = np.insert(W, <span class="nu">0</span>, <span class="nu">0</span>)
    S = S0 * np.exp((mu - sigma**<span class="nu">2</span>/<span class="nu">2</span>) * t + sigma * W)
    <span class="fn">print</span>(<span class="st">f"ê²½ë¡œ {i+1}: ìµœì¢…ê°€ {S[-1]:.2f}, ìˆ˜ìµë¥  {(S[-1]/S0-1)*100:+.1f}%, ìµœëŒ€ {S.max():.2f}, ìµœì†Œ {S.min():.2f}"</span>)</code></pre>
<div class="code-output"><span class="out-label">Output:</span>
GBM íŒŒë¼ë¯¸í„°: Sâ‚€=100, Î¼=0.08, Ïƒ=0.20, T=1ë…„
ë“œë¦¬í”„íŠ¸ ë³´ì •: Î¼ - ÏƒÂ²/2 = 0.0600
E[S_T] = Sâ‚€Â·e^(Î¼T) = 108.33
Median[S_T] = Sâ‚€Â·e^((Î¼-ÏƒÂ²/2)T) = 106.18

ê²½ë¡œ 1: ìµœì¢…ê°€ 115.23, ìˆ˜ìµë¥  +15.2%, ìµœëŒ€ 118.45, ìµœì†Œ 93.21
ê²½ë¡œ 2: ìµœì¢…ê°€ 97.41, ìˆ˜ìµë¥  -2.6%, ìµœëŒ€ 107.82, ìµœì†Œ 88.34
ê²½ë¡œ 3: ìµœì¢…ê°€ 108.87, ìˆ˜ìµë¥  +8.9%, ìµœëŒ€ 112.56, ìµœì†Œ 95.67
ê²½ë¡œ 4: ìµœì¢…ê°€ 123.56, ìˆ˜ìµë¥  +23.6%, ìµœëŒ€ 125.89, ìµœì†Œ 97.12
ê²½ë¡œ 5: ìµœì¢…ê°€ 104.22, ìˆ˜ìµë¥  +4.2%, ìµœëŒ€ 110.34, ìµœì†Œ 91.45</div>

<!-- â–¼ Plotly: GBM ê²½ë¡œ ì‹œë®¬ë ˆì´ì…˜ -->
<div id="plot-ch2-gbm" style="width:100%;height:420px;margin:25px 0"></div>
<script>
(function(){
  var rng=(function(a){return function(){a|=0;a=a+0x6D2B79F5|0;var t=Math.imul(a^a>>>15,1|a);t=t+Math.imul(t^t>>>7,61|t)^t;return((t^t>>>14)>>>0)/4294967296;};})(42);
  function randn(){var u=0,v=0;while(u===0)u=rng();while(v===0)v=rng();return Math.sqrt(-2*Math.log(u))*Math.cos(2*Math.PI*v);}
  var S0=100,mu=0.08,sig=0.20,T=1,n=252,dt=T/n;
  var days=Array.from({length:n+1},function(_,i){return i;});
  var colors=['#1e88e5','#e53935','#43a047','#ff9800','#9c27b0','#00897b','#f06292','#5c6bc0'];
  var traces=[];
  for(var p=0;p<8;p++){
    var S=[S0];
    for(var i=0;i<n;i++){var z=randn();S.push(S[i]*Math.exp((mu-sig*sig/2)*dt+sig*Math.sqrt(dt)*z));}
    traces.push({x:days,y:S,mode:'lines',name:'ê²½ë¡œ '+(p+1),line:{width:1.5,color:colors[p]}});
  }
  var expected=days.map(function(d){return S0*Math.exp(mu*d/252);});
  traces.push({x:days,y:expected,mode:'lines',name:'E[S_t] = Sâ‚€e^(Î¼t)',line:{width:3,color:'#333',dash:'dash'}});
  Plotly.newPlot('plot-ch2-gbm',traces,{
    title:{text:'ğŸ“ˆ ê¸°í•˜ ë¸Œë¼ìš´ ìš´ë™ (GBM): 8ê°œ ê²½ë¡œ ì‹œë®¬ë ˆì´ì…˜',font:{size:13}},
    xaxis:{title:'ê±°ë˜ì¼'},yaxis:{title:'ì£¼ê°€'},
    margin:{l:50,r:20,t:45,b:40},legend:{x:0.02,y:0.98,font:{size:9}}
  },{responsive:true});
})();
</script>
<p class="ni" style="font-size:11px;color:#888;text-align:center;margin-top:-10px">ğŸ–±ï¸ ê²€ì€ ì ì„ ì´ ê¸°ëŒ€ ê²½ë¡œ. ê°œë³„ ê²½ë¡œëŠ” ë³€ë™ì„±ìœ¼ë¡œ ì¸í•´ í¬ê²Œ ë²—ì–´ë‚  ìˆ˜ ìˆë‹¤</p>

<h3>2.4 GBMì˜ í•œê³„ì™€ ëŒ€ì•ˆ</h3>

<div class="warn">
<p class="ni"><strong>GBMì´ í˜„ì‹¤ì„ ì™„ë²½íˆ ì„¤ëª…í•˜ì§€ ëª»í•˜ëŠ” ì´ìœ :</strong></p>
<ul>
<li><strong>íŒ» í…Œì¼:</strong> ì‹¤ì œ ìˆ˜ìµë¥ ì€ ì •ê·œë¶„í¬ë³´ë‹¤ ê·¹ë‹¨ê°’ì´ ìì£¼ ë°œìƒ (ì²¨ë„ > 3)</li>
<li><strong>ë³€ë™ì„± í´ëŸ¬ìŠ¤í„°ë§:</strong> í° ë³€ë™ ë’¤ì— í° ë³€ë™ì´ ì˜¤ëŠ” ê²½í–¥ (GARCHë¡œ ëª¨ë¸ë§, Ch8)</li>
<li><strong>ì í”„:</strong> ì‹¤ì  ë°œí‘œ, ê¸ˆë¦¬ ê²°ì • ë“±ìœ¼ë¡œ ì£¼ê°€ê°€ ë¶ˆì—°ì†ì ìœ¼ë¡œ ë³€ë™</li>
<li><strong>ë³€ë™ì„± ìŠ¤ë§ˆì¼:</strong> BS ëª¨ë¸ì˜ Ïƒê°€ ìƒìˆ˜ë¼ë©´ ë‚´ì¬ ë³€ë™ì„±ì´ í–‰ì‚¬ê°€ì— ë”°ë¼ ë‹¬ë¼ì§€ë©´ ì•ˆ ë¨ (Ch8)</li>
</ul>
<p class="ni">ëŒ€ì•ˆ: Merton ì í”„ í™•ì‚°, Heston í™•ë¥ ì  ë³€ë™ì„±, SABR ëª¨ë¸ ë“±</p>
</div>

<div class="problem-box">
<div class="problem-title">âœï¸ ì—°ìŠµë¬¸ì œ 2.1</div>
<p class="ni">GBMì—ì„œ \(S_0 = 50\), \(\mu = 0.10\), \(\sigma = 0.30\), \(T = 2\)ë…„ì¼ ë•Œ:</p>
<ol>
<li>\(\ln(S_T/S_0)\)ì˜ ë¶„í¬ë¥¼ êµ¬í•˜ë¼.</li>
<li>\(E[S_T]\)ì™€ \(\text{Median}[S_T]\)ë¥¼ êµ¬í•˜ë¼.</li>
<li>\(P(S_T > 80)\)ì„ êµ¬í•˜ë¼.</li>
<li>ë³€ë™ì„±ì´ \(\sigma = 0.50\)ìœ¼ë¡œ ì¦ê°€í•˜ë©´ \(E[S_T]\)ì™€ \(\text{Median}[S_T]\)ëŠ” ê°ê° ì–´ë–»ê²Œ ë³€í•˜ëŠ”ê°€?</li>
</ol>
</div>

<details>
<summary>ğŸ”‘ í’€ì´ ë³´ê¸°</summary>
<div class="answer-content">
<p class="ni"><strong>1)</strong> \(\ln(S_T/S_0) \sim N\left((0.10 - 0.30^2/2) \times 2,\; 0.30^2 \times 2\right) = N(0.11, 0.18)\)</p>
<p class="ni">ì¦‰, \(\mu_{\ln} = 0.11\), \(\sigma_{\ln} = \sqrt{0.18} = 0.4243\)</p>
<p class="ni"><strong>2)</strong> \(E[S_T] = 50 \times e^{0.10 \times 2} = 50 \times 1.2214 = 61.07\)</p>
<p class="ni">\(\text{Median}[S_T] = 50 \times e^{0.11} = 50 \times 1.1163 = 55.81\)</p>
<p class="ni"><strong>3)</strong> \(P(S_T > 80) = P(\ln(S_T/S_0) > \ln(80/50)) = P(Z > \frac{0.4700 - 0.11}{0.4243}) = P(Z > 0.8487) = 1 - \Phi(0.8487) = 0.198\)</p>
<p class="ni">ì•½ 19.8% í™•ë¥ ë¡œ \(S_T > 80\)</p>
<p class="ni"><strong>4)</strong> Ïƒ=0.50ì´ë©´: \(E[S_T] = 50 \times e^{0.20} = 61.07\) (ë³€í•˜ì§€ ì•ŠìŒ!)</p>
<p class="ni">\(\text{Median}[S_T] = 50 \times e^{(0.10-0.125) \times 2} = 50 \times e^{-0.05} = 47.56\) (ì˜¤íˆë ¤ ê°ì†Œ!)</p>
<p class="ni">â†’ ë³€ë™ì„±ì´ ì»¤ì§€ë©´ ê¸°ëŒ€ê°’ì€ ê°™ì§€ë§Œ ì¤‘ì•™ê°’(ëŒ€ë¶€ë¶„ì˜ ê²½ë¡œ)ì€ ë‚®ì•„ì§„ë‹¤. ì´ê²ƒì´ ë³€ë™ì„± ë“œë˜ê·¸.</p>
</div>
</details>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- Ch3: ì´í†  ë³´ì¡°ì •ë¦¬ -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<h2 id="ch3">3. ì´í†  ë³´ì¡°ì •ë¦¬ (ItÃ´'s Lemma)</h2>

<h3>3.1 ì™œ ì¼ë°˜ ë¯¸ì ë¶„ì´ ì•ˆ ë˜ëŠ”ê°€?</h3>
<p>ì¼ë°˜ ë¯¸ì ë¶„ì—ì„œ \(df = f'(x)\,dx\)ì´ë‹¤. í•˜ì§€ë§Œ ë¸Œë¼ìš´ ìš´ë™ \(W_t\)ëŠ” ì–´ë””ì„œë„ ë¯¸ë¶„ ë¶ˆê°€ëŠ¥í•˜ê³ , \((dW_t)^2 = dt\)ë¼ëŠ” íŠ¹ì´í•œ ì„±ì§ˆì´ ìˆë‹¤. ì¼ë°˜ ë¯¸ì ë¶„ì—ì„œëŠ” \((dx)^2 \approx 0\)ì´ë¯€ë¡œ ë¬´ì‹œí•˜ì§€ë§Œ, í™•ë¥  ë¯¸ì ë¶„ì—ì„œëŠ” ì´ í•­ì´ ì‚´ì•„ë‚¨ëŠ”ë‹¤.</p>

<div class="tc">Table 3. ì¼ë°˜ ë¯¸ì ë¶„ vs í™•ë¥  ë¯¸ì ë¶„</div>
<table>
<tr><th>ê·œì¹™</th><th>ì¼ë°˜ ë¯¸ì ë¶„</th><th>í™•ë¥  ë¯¸ì ë¶„ (ì´í† )</th></tr>
<tr><td>\((dx)^2\)</td><td>0 (ë¬´ì‹œ)</td><td>\((dW)^2 = dt\) (ì‚´ì•„ë‚¨ìŒ)</td></tr>
<tr><td>\(dt \cdot dW\)</td><td>â€”</td><td>0</td></tr>
<tr><td>\((dt)^2\)</td><td>0</td><td>0</td></tr>
<tr><td>í…Œì¼ëŸ¬ ì „ê°œ</td><td>1ì°¨ê¹Œì§€</td><td>2ì°¨ê¹Œì§€ í•„ìš”</td></tr>
<tr><td>ì²´ì¸ë£°</td><td>\(df = f'dX\)</td><td>\(df = f'dX + \frac{1}{2}f''(dX)^2\)</td></tr>
</table>

<h3>3.2 ì´í†  ë³´ì¡°ì •ë¦¬ (ì¼ë°˜í˜•)</h3>
<p>\(X_t\)ê°€ í™•ë¥ ê³¼ì • \(dX_t = a(t)\,dt + b(t)\,dW_t\)ë¥¼ ë”°ë¥´ê³ , \(f(t, X_t)\)ê°€ 2ë²ˆ ë¯¸ë¶„ ê°€ëŠ¥í•œ í•¨ìˆ˜ì¼ ë•Œ:</p>

<div class="eq">
\[df = \frac{\partial f}{\partial t}dt + \frac{\partial f}{\partial X}dX + \frac{1}{2}\frac{\partial^2 f}{\partial X^2}(dX)^2\]
</div>

<p>ì—¬ê¸°ì„œ \((dX)^2 = b^2(t)\,dt\)ì´ë¯€ë¡œ ì „ê°œí•˜ë©´:</p>

<div class="eq">
\[df = \left(\frac{\partial f}{\partial t} + a\frac{\partial f}{\partial X} + \frac{1}{2}b^2\frac{\partial^2 f}{\partial X^2}\right)dt + b\frac{\partial f}{\partial X}dW\]
</div>

<div class="ok">
<p class="ni"><strong>í•µì‹¬ ì§ê´€:</strong> ì´í†  ë³´ì¡°ì •ë¦¬ëŠ” "í™•ë¥  ì„¸ê³„ì˜ ì²´ì¸ë£°"ì´ë‹¤. ì¼ë°˜ ì²´ì¸ë£°ì— 2ì°¨ í•­ \(\frac{1}{2}f''b^2 dt\)ê°€ ì¶”ê°€ëœ ê²ƒì´ ì „ë¶€ë‹¤. ì´ ì¶”ê°€ í•­ì´ ë³€ë™ì„± ë“œë˜ê·¸, ë¸”ë™-ìˆ„ì¦ˆ PDE, ê·¸ë¦¬ê³  ê¸ˆìœµê³µí•™ì˜ ê±°ì˜ ëª¨ë“  ê²°ê³¼ë¥¼ ë§Œë“¤ì–´ë‚¸ë‹¤.</p>
</div>

<h3>3.3 GBMì— ì´í†  ë³´ì¡°ì •ë¦¬ ì ìš©: ë¸”ë™-ìˆ„ì¦ˆì˜ ì¶œë°œì </h3>
<p>\(dS = \mu S\,dt + \sigma S\,dW\)ì—ì„œ \(f(S) = \ln S\)ë¥¼ ì ìš©í•˜ì:</p>
<ul>
<li>\(f' = 1/S\), \(f'' = -1/S^2\)</li>
<li>\(a = \mu S\), \(b = \sigma S\)</li>
</ul>

<div class="eq">
\[d(\ln S) = \frac{1}{S}(\mu S\,dt + \sigma S\,dW) + \frac{1}{2}\left(-\frac{1}{S^2}\right)(\sigma S)^2 dt\]
</div>
<div class="eq">
\[= \mu\,dt + \sigma\,dW - \frac{\sigma^2}{2}dt = \left(\mu - \frac{\sigma^2}{2}\right)dt + \sigma\,dW\]
</div>

<p>ì ë¶„í•˜ë©´: \(\ln S_T - \ln S_0 = \left(\mu - \frac{\sigma^2}{2}\right)T + \sigma W_T\)</p>

<p>ì´ê²ƒì´ GBMì˜ í•´ \(S_T = S_0 \exp[(\mu - \sigma^2/2)T + \sigma W_T]\)ë¥¼ ìœ ë„í•˜ëŠ” ê³¼ì •ì´ë‹¤.</p>

<h3>3.4 ë³€ë™ì„± ë“œë˜ê·¸ (Volatility Drag)</h3>
<p>ì´í†  ë³´ì¡°ì •ë¦¬ì˜ ê°€ì¥ ì¤‘ìš”í•œ ì‹¤ìš©ì  ê²°ê³¼: ë¡œê·¸ ìˆ˜ìµë¥ ì˜ ê¸°ëŒ“ê°’ì€ \(\mu\)ê°€ ì•„ë‹ˆë¼ \(\mu - \sigma^2/2\)ì´ë‹¤.</p>

<pre><code><span class="kw">import</span> numpy <span class="kw">as</span> np

<span class="cm"># ë³€ë™ì„± ë“œë˜ê·¸: ì‚°ìˆ  í‰ê·  vs ê¸°í•˜ í‰ê· </span>
mu = <span class="nu">0.10</span>
<span class="fn">print</span>(<span class="st">f"ê¸°ëŒ€ ìˆ˜ìµë¥  Î¼ = {mu:.0%}"</span>)
<span class="fn">print</span>(<span class="st">f"\n{'Ïƒ':>6} {'Î¼-ÏƒÂ²/2':>10} {'E[S_T/Sâ‚€]':>12} {'Median':>10} {'P(loss)':>10}"</span>)
<span class="fn">print</span>(<span class="st">"â”€" * 52</span>)

<span class="kw">for</span> sigma <span class="kw">in</span> [<span class="nu">0.05</span>, <span class="nu">0.10</span>, <span class="nu">0.20</span>, <span class="nu">0.40</span>, <span class="nu">0.60</span>, <span class="nu">0.80</span>, <span class="nu">1.00</span>]:
    drift = mu - sigma**<span class="nu">2</span> / <span class="nu">2</span>
    expected = np.exp(mu)
    median = np.exp(drift)
    <span class="cm"># P(S_T < S_0) = P(ln(S_T/S_0) < 0) = Î¦(-drift/Ïƒ)</span>
    <span class="kw">from</span> scipy.stats <span class="kw">import</span> norm
    p_loss = norm.cdf(-drift / sigma) <span class="kw">if</span> sigma > <span class="nu">0</span> <span class="kw">else</span> <span class="nu">0</span>
    <span class="fn">print</span>(<span class="st">f"{sigma:6.0%} {drift:10.4f} {expected:12.4f} {median:10.4f} {p_loss:10.2%}"</span>)

<span class="fn">print</span>(<span class="st">f"\nâ†’ Ïƒ=100%ì´ë©´ ì¤‘ì•™ê°’ì€ {np.exp(mu - 1.0/2):.4f} â€” ê¸°ëŒ€ ìˆ˜ìµë¥  10%ì¸ë° ì ˆë°˜ ì´ìƒ ì†ì‹¤!"</span>)
<span class="fn">print</span>(<span class="st">f"â†’ ë ˆë²„ë¦¬ì§€ ETFê°€ ì¥ê¸°ì ìœ¼ë¡œ ì†ì‹¤ì„ ë³´ëŠ” ì´ìœ ê°€ ë°”ë¡œ ì´ê²ƒ."</span>)</code></pre>
<div class="code-output"><span class="out-label">Output:</span>
ê¸°ëŒ€ ìˆ˜ìµë¥  Î¼ = 10%

     Ïƒ    Î¼-ÏƒÂ²/2   E[S_T/Sâ‚€]     Median   P(loss)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    5%     0.0988       1.1052     1.1037     2.41%
   10%     0.0950       1.1052     1.0997     5.69%
   20%     0.0800       1.1052     1.0833    13.07%
   40%     0.0200       1.1052     1.0202    30.85%
   60%    -0.0800       1.1052     0.9231    42.93%
   80%    -0.2200       1.1052     0.8025    50.87%
  100%    -0.4000       1.1052     0.6703    57.93%

â†’ Ïƒ=100%ì´ë©´ ì¤‘ì•™ê°’ì€ 0.6703 â€” ê¸°ëŒ€ ìˆ˜ìµë¥  10%ì¸ë° ì ˆë°˜ ì´ìƒ ì†ì‹¤!
â†’ ë ˆë²„ë¦¬ì§€ ETFê°€ ì¥ê¸°ì ìœ¼ë¡œ ì†ì‹¤ì„ ë³´ëŠ” ì´ìœ ê°€ ë°”ë¡œ ì´ê²ƒ.</div>

<div class="info">
<p class="ni"><strong>ë ˆë²„ë¦¬ì§€ ETFì™€ ë³€ë™ì„± ë“œë˜ê·¸:</strong> 2ë°° ë ˆë²„ë¦¬ì§€ ETFëŠ” \(\mu\)ë¥¼ 2ë°°ë¡œ ë§Œë“¤ì§€ë§Œ \(\sigma\)ë„ 2ë°°ê°€ ëœë‹¤. ë“œë˜ê·¸ í•­ \(\sigma^2/2\)ëŠ” 4ë°°ê°€ ë˜ë¯€ë¡œ, ë³€ë™ì„±ì´ ë†’ì€ ì‹œì¥ì—ì„œ ë ˆë²„ë¦¬ì§€ ETFëŠ” ì¥ê¸°ì ìœ¼ë¡œ ê¸°ëŒ€ë³´ë‹¤ í›¨ì”¬ ë‚˜ìœ ì„±ê³¼ë¥¼ ë³´ì¸ë‹¤. ì˜ˆ: \(\mu=10\%, \sigma=20\%\)ì´ë©´ 2x ë ˆë²„ë¦¬ì§€ì˜ ê¸°í•˜ ë“œë¦¬í”„íŠ¸ëŠ” \(2 \times 0.10 - (2 \times 0.20)^2/2 = 0.12\)ë¡œ, ë‹¨ìˆœ 2ë°°(0.16)ë³´ë‹¤ ë‚®ë‹¤.</p>
</div>

<div class="problem-box">
<div class="problem-title">âœï¸ ì—°ìŠµë¬¸ì œ 3.1</div>
<p class="ni">\(dS = 0.12 S\,dt + 0.30 S\,dW\)ì¼ ë•Œ:</p>
<ol>
<li>ì´í†  ë³´ì¡°ì •ë¦¬ë¥¼ ì‚¬ìš©í•˜ì—¬ \(d(\ln S)\)ë¥¼ êµ¬í•˜ë¼.</li>
<li>1ë…„ í›„ ë¡œê·¸ ìˆ˜ìµë¥  \(\ln(S_1/S_0)\)ì˜ ê¸°ëŒ“ê°’ê³¼ ë¶„ì‚°ì„ êµ¬í•˜ë¼.</li>
<li>\(S_0 = 100\)ì¼ ë•Œ, 1ë…„ í›„ ì£¼ê°€ì˜ 95% ì‹ ë¢°êµ¬ê°„ì„ êµ¬í•˜ë¼.</li>
<li>\(f(S) = S^2\)ì— ì´í†  ë³´ì¡°ì •ë¦¬ë¥¼ ì ìš©í•˜ì—¬ \(d(S^2)\)ì„ êµ¬í•˜ë¼.</li>
</ol>
</div>

<details>
<summary>ğŸ”‘ í’€ì´ ë³´ê¸°</summary>
<div class="answer-content">
<p class="ni"><strong>1)</strong> \(d(\ln S) = (0.12 - 0.30^2/2)\,dt + 0.30\,dW = 0.075\,dt + 0.30\,dW\)</p>
<p class="ni"><strong>2)</strong> \(E[\ln(S_1/S_0)] = 0.075\), \(\text{Var}[\ln(S_1/S_0)] = 0.30^2 = 0.09\)</p>
<p class="ni"><strong>3)</strong> \(\ln(S_1/S_0) \sim N(0.075, 0.09)\), 95% CI: \(0.075 \pm 1.96 \times 0.30 = [-0.513, 0.663]\)</p>
<p class="ni">\(S_1 \in [100 \times e^{-0.513}, 100 \times e^{0.663}] = [59.88, 194.06]\)</p>
<p class="ni"><strong>4)</strong> \(f(S) = S^2\), \(f' = 2S\), \(f'' = 2\)</p>
<p class="ni">\(d(S^2) = 2S \cdot dS + \frac{1}{2} \cdot 2 \cdot (\sigma S)^2 dt = 2S(\mu S\,dt + \sigma S\,dW) + \sigma^2 S^2 dt\)</p>
<p class="ni">\(= (2\mu + \sigma^2)S^2\,dt + 2\sigma S^2\,dW\)</p>
<p class="ni">â†’ \(S^2\)ë„ GBMì„ ë”°ë¥´ì§€ë§Œ ë“œë¦¬í”„íŠ¸ê°€ \(2\mu + \sigma^2\)ë¡œ ë” í¬ë‹¤. ì´ê²ƒì€ \(E[S_T^2] = S_0^2 e^{(2\mu+\sigma^2)T}\)ë¥¼ ì˜ë¯¸í•œë‹¤.</p>
</div>
</details>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- Ch4: ë¸”ë™-ìˆ„ì¦ˆ ëª¨ë¸ -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<h2 id="ch4">4. ë¸”ë™-ìˆ„ì¦ˆ ëª¨ë¸ (Black-Scholes)</h2>

<h3>4.1 ë¸”ë™-ìˆ„ì¦ˆ PDEì˜ ìœ ë„</h3>
<p>ì˜µì…˜ ê°€ê²© \(V(S,t)\)ëŠ” ê¸°ì´ˆìì‚° \(S\)ì™€ ì‹œê°„ \(t\)ì˜ í•¨ìˆ˜ë‹¤. ì´í†  ë³´ì¡°ì •ë¦¬ë¥¼ ì ìš©í•˜ë©´:</p>

<div class="eq">
\[dV = \left(\frac{\partial V}{\partial t} + \mu S \frac{\partial V}{\partial S} + \frac{1}{2}\sigma^2 S^2 \frac{\partial^2 V}{\partial S^2}\right)dt + \sigma S \frac{\partial V}{\partial S} dW\]
</div>

<p>í¬íŠ¸í´ë¦¬ì˜¤ \(\Pi = V - \Delta S\)ë¥¼ êµ¬ì„±í•˜ì—¬ \(\Delta = \partial V/\partial S\)ë¡œ ì„¤ì •í•˜ë©´ \(dW\) í•­ì´ ì‚¬ë¼ì§„ë‹¤ (ë¸íƒ€ í—¤ì§•). ë¬´ì°¨ìµ ì¡°ê±´ \(d\Pi = r\Pi\,dt\)ë¥¼ ì ìš©í•˜ë©´:</p>

<div class="eq">
\[\frac{\partial V}{\partial t} + rS\frac{\partial V}{\partial S} + \frac{1}{2}\sigma^2 S^2 \frac{\partial^2 V}{\partial S^2} = rV\]
</div>

<p>ì´ê²ƒì´ ë¸”ë™-ìˆ„ì¦ˆ PDEë‹¤. ì£¼ëª©í•  ì : \(\mu\)ê°€ ì‚¬ë¼ì§€ê³  \(r\)ë§Œ ë‚¨ì•˜ë‹¤. ì´ê²ƒì´ ìœ„í—˜ì¤‘ë¦½ ê°€ê²© ê²°ì •ì˜ ìˆ˜í•™ì  ê·¼ê±°ë‹¤.</p>

<h3>4.2 ë¸”ë™-ìˆ„ì¦ˆ ê³µì‹</h3>
<p>ìœ ëŸ½í˜• ì½œì˜µì…˜ì˜ ê²½ê³„ ì¡°ê±´ \(V(S,T) = \max(S-K, 0)\)ìœ¼ë¡œ PDEë¥¼ í’€ë©´:</p>

<div class="eq">
\[C = S_0 N(d_1) - Ke^{-rT} N(d_2)\]
</div>
<div class="eq">
\[d_1 = \frac{\ln(S_0/K) + (r + \sigma^2/2)T}{\sigma\sqrt{T}}, \quad d_2 = d_1 - \sigma\sqrt{T}\]
</div>

<p>í’‹ì˜µì…˜: \(P = Ke^{-rT}N(-d_2) - S_0 N(-d_1)\)</p>

<div class="def">
<p class="ni"><strong>ë¸”ë™-ìˆ„ì¦ˆ ê³µì‹ì˜ ì§ê´€ì  í•´ì„:</strong></p>
<ul>
<li>\(N(d_2)\) = ìœ„í—˜ì¤‘ë¦½ ì¸¡ë„ì—ì„œ ì˜µì…˜ì´ ITMìœ¼ë¡œ ë§Œê¸°ë  í™•ë¥ </li>
<li>\(N(d_1)\) = ë¸íƒ€ = ì£¼ê°€ 1ì› ë³€í™”ì— ëŒ€í•œ ì˜µì…˜ ê°€ê²© ë³€í™”</li>
<li>\(S_0 N(d_1)\) = ì£¼ì‹ í¬ì§€ì…˜ì˜ í˜„ì¬ê°€ì¹˜</li>
<li>\(Ke^{-rT} N(d_2)\) = í–‰ì‚¬ê°€ ì§€ë¶ˆì˜ í˜„ì¬ê°€ì¹˜ Ã— í–‰ì‚¬ í™•ë¥ </li>
<li>ì½œ ê°€ê²© = "ì£¼ì‹ì„ ë°›ì„ ê¸°ëŒ€ê°€ì¹˜" - "í–‰ì‚¬ê°€ë¥¼ ì§€ë¶ˆí•  ê¸°ëŒ€ê°€ì¹˜"</li>
</ul>
</div>

<div class="warn">
<p class="ni"><strong>ë¸”ë™-ìˆ„ì¦ˆì˜ 5ê°€ì§€ ê°€ì •ê³¼ í˜„ì‹¤:</strong></p>
<ol>
<li>ì£¼ê°€ëŠ” GBM â†’ í˜„ì‹¤: ì í”„, íŒ» í…Œì¼ ì¡´ì¬</li>
<li>ë³€ë™ì„± Ïƒ ìƒìˆ˜ â†’ í˜„ì‹¤: ë³€ë™ì„± ìŠ¤ë§ˆì¼/ìŠ¤í (Ch8)</li>
<li>ë¬´ìœ„í—˜ ê¸ˆë¦¬ r ìƒìˆ˜ â†’ í˜„ì‹¤: ê¸ˆë¦¬ ê¸°ê°„ êµ¬ì¡° ë³€ë™ (Ch9)</li>
<li>ê±°ë˜ ë¹„ìš©, ì„¸ê¸ˆ ì—†ìŒ â†’ í˜„ì‹¤: ë¹„ë“œ-ì• ìŠ¤í¬ ìŠ¤í”„ë ˆë“œ, ìŠ¬ë¦¬í”¼ì§€</li>
<li>ì—°ì† ê±°ë˜ ê°€ëŠ¥ â†’ í˜„ì‹¤: ì´ì‚°ì  ë¦¬ë°¸ëŸ°ì‹±, ìœ ë™ì„± ì œì•½</li>
</ol>
<p class="ni">ê·¸ëŸ¼ì—ë„ BS ëª¨ë¸ì€ ì˜µì…˜ ê°€ê²©ì˜ "ê¸°ì¤€ì "ìœ¼ë¡œ ì—¬ì „íˆ ê°€ì¥ ë„ë¦¬ ì‚¬ìš©ëœë‹¤. ì‹œì¥ ì°¸ì—¬ìë“¤ì€ BS ê°€ê²© ìì²´ë³´ë‹¤ BSì—ì„œ ì—­ì‚°í•œ ë‚´ì¬ ë³€ë™ì„±(IV)ìœ¼ë¡œ ì†Œí†µí•œë‹¤.</p>
</div>

<pre><code><span class="kw">import</span> numpy <span class="kw">as</span> np
<span class="kw">from</span> scipy.stats <span class="kw">import</span> norm

<span class="kw">def</span> <span class="fn">black_scholes</span>(S, K, T, r, sigma, option_type=<span class="st">'call'</span>):
    <span class="st">"""ë¸”ë™-ìˆ„ì¦ˆ ì˜µì…˜ ê°€ê²© + d1, d2"""</span>
    d1 = (np.log(S/K) + (r + sigma**<span class="nu">2</span>/<span class="nu">2</span>)*T) / (sigma*np.sqrt(T))
    d2 = d1 - sigma*np.sqrt(T)
    <span class="kw">if</span> option_type == <span class="st">'call'</span>:
        price = S * norm.cdf(d1) - K * np.exp(-r*T) * norm.cdf(d2)
    <span class="kw">else</span>:
        price = K * np.exp(-r*T) * norm.cdf(-d2) - S * norm.cdf(-d1)
    <span class="kw">return</span> price, d1, d2

<span class="cm"># ATM ì˜µì…˜ ê°€ê²© ê³„ì‚°</span>
S, K, T, r, sigma = <span class="nu">100</span>, <span class="nu">100</span>, <span class="nu">0.5</span>, <span class="nu">0.05</span>, <span class="nu">0.20</span>
call, d1, d2 = black_scholes(S, K, T, r, sigma, <span class="st">'call'</span>)
put, _, _ = black_scholes(S, K, T, r, sigma, <span class="st">'put'</span>)

<span class="fn">print</span>(<span class="st">f"=== ë¸”ë™-ìˆ„ì¦ˆ ê°€ê²© (S=K=100, T=0.5ë…„, Ïƒ=20%) ==="</span>)
<span class="fn">print</span>(<span class="st">f"d1 = {d1:.4f}, d2 = {d2:.4f}"</span>)
<span class="fn">print</span>(<span class="st">f"N(d1) = {norm.cdf(d1):.4f} (ë¸íƒ€)"</span>)
<span class="fn">print</span>(<span class="st">f"N(d2) = {norm.cdf(d2):.4f} (ITM í™•ë¥ , ìœ„í—˜ì¤‘ë¦½)"</span>)
<span class="fn">print</span>(<span class="st">f"ì½œì˜µì…˜: {call:.4f}"</span>)
<span class="fn">print</span>(<span class="st">f"í’‹ì˜µì…˜: {put:.4f}"</span>)
<span class="fn">print</span>(<span class="st">f"C - P = {call-put:.4f}, S - Keâ»Ê³áµ€ = {S - K*np.exp(-r*T):.4f} (íŒ¨ë¦¬í‹° âœ“)"</span>)

<span class="cm"># í–‰ì‚¬ê°€ë³„ ê°€ê²©</span>
<span class="fn">print</span>(<span class="st">f"\n--- í–‰ì‚¬ê°€ë³„ ì½œ/í’‹ ê°€ê²© ---"</span>)
<span class="fn">print</span>(<span class="st">f"{'K':>6} {'Call':>8} {'Put':>8} {'ë‚´ì¬ê°€ì¹˜':>8} {'ì‹œê°„ê°€ì¹˜':>8} {'ìƒíƒœ':>6}"</span>)
<span class="kw">for</span> K_ <span class="kw">in</span> [<span class="nu">80</span>, <span class="nu">90</span>, <span class="nu">95</span>, <span class="nu">100</span>, <span class="nu">105</span>, <span class="nu">110</span>, <span class="nu">120</span>]:
    c, _, _ = black_scholes(S, K_, T, r, sigma)
    intrinsic = <span class="fn">max</span>(S - K_, <span class="nu">0</span>)
    time_val = c - intrinsic
    state = <span class="st">"ITM"</span> <span class="kw">if</span> S > K_ <span class="kw">else</span> (<span class="st">"ATM"</span> <span class="kw">if</span> S == K_ <span class="kw">else</span> <span class="st">"OTM"</span>)
    <span class="fn">print</span>(<span class="st">f"{K_:6d} {c:8.4f} {c-(S-K_*np.exp(-r*T)):8.4f} {intrinsic:8.2f} {time_val:8.4f} {state:>6}"</span>)</code></pre>
<div class="code-output"><span class="out-label">Output:</span>
=== ë¸”ë™-ìˆ„ì¦ˆ ê°€ê²© (S=K=100, T=0.5ë…„, Ïƒ=20%) ===
d1 = 0.2475, d2 = 0.1061
N(d1) = 0.5977 (ë¸íƒ€)
N(d2) = 0.5422 (ITM í™•ë¥ , ìœ„í—˜ì¤‘ë¦½)
ì½œì˜µì…˜: 6.8893
í’‹ì˜µì…˜: 4.4050
C - P = 2.4843, S - Keâ»Ê³áµ€ = 2.4690 (íŒ¨ë¦¬í‹° âœ“)

--- í–‰ì‚¬ê°€ë³„ ì½œ/í’‹ ê°€ê²© ---
     K     Call      Put  ë‚´ì¬ê°€ì¹˜  ì‹œê°„ê°€ì¹˜   ìƒíƒœ
    80  21.9734   0.0044    20.00   1.9734    ITM
    90  12.8456   0.6146    10.00   2.8456    ITM
    95   9.3412   1.5572     5.00   4.3412    ITM
   100   6.8893   4.4050     0.00   6.8893    ATM
   105   4.3712   6.1349     0.00   4.3712    OTM
   110   2.7834   9.7951     0.00   2.7834    OTM
   120   0.8912  17.1509     0.00   0.8912    OTM</div>

<!-- â–¼ Plotly: ì˜µì…˜ í˜ì´ì˜¤í”„ + 4ê°€ì§€ ì „ëµ -->
<div id="plot-ch4-payoff" style="width:100%;height:440px;margin:25px 0"></div>
<script>
(function(){
  function normcdf(x){var t=1/(1+0.2316419*Math.abs(x));var d=0.3989422802*Math.exp(-x*x/2);var p=d*t*(0.3193815+t*(-0.3565638+t*(1.781478+t*(-1.821256+t*1.330274))));return x>0?1-p:p;}
  function bsCall(S,K,T,r,sig){if(T<=0.001)return Math.max(S-K,0);var d1=(Math.log(S/K)+(r+sig*sig/2)*T)/(sig*Math.sqrt(T));var d2=d1-sig*Math.sqrt(T);return S*normcdf(d1)-K*Math.exp(-r*T)*normcdf(d2);}
  var K=100,T=0.5,r=0.05,sig=0.20;
  var Ss=[],callPrices=[],payoff=[],profit=[],putPrices=[],putPayoff=[];
  var premium=bsCall(100,K,T,r,sig);
  for(var S=60;S<=150;S+=0.5){
    Ss.push(S);
    callPrices.push(bsCall(S,K,T,r,sig));
    payoff.push(Math.max(S-K,0));
    profit.push(Math.max(S-K,0)-premium);
  }
  Plotly.newPlot('plot-ch4-payoff',[
    {x:Ss,y:callPrices,mode:'lines',name:'ì½œì˜µì…˜ ê°€ê²© (T=0.5)',line:{width:3,color:'#1e88e5'}},
    {x:Ss,y:payoff,mode:'lines',name:'ë§Œê¸° í˜ì´ì˜¤í”„ max(S-K,0)',line:{width:2,color:'#e53935',dash:'dash'}},
    {x:Ss,y:profit,mode:'lines',name:'ë§Œê¸° ì†ìµ (í”„ë¦¬ë¯¸ì—„ ì°¨ê°)',line:{width:2,color:'#43a047',dash:'dot'}},
    {x:[60,150],y:[0,0],mode:'lines',showlegend:false,line:{width:1,color:'#999'}}
  ],{
    title:{text:'ğŸ“Š ì½œì˜µì…˜: í˜„ì¬ ê°€ê²© vs ë§Œê¸° í˜ì´ì˜¤í”„ vs ì†ìµ',font:{size:13}},
    xaxis:{title:'ê¸°ì´ˆìì‚° ê°€ê²© S'},yaxis:{title:'ê°€ê²© / ì†ìµ',range:[-15,55]},
    margin:{l:50,r:20,t:45,b:40},legend:{x:0.02,y:0.98},
    annotations:[{x:100,y:premium,text:'ATM í”„ë¦¬ë¯¸ì—„<br>= '+premium.toFixed(2),showarrow:true,arrowhead:2,ax:60,ay:-30,font:{size:10}}]
  },{responsive:true});
})();
</script>
<p class="ni" style="font-size:11px;color:#888;text-align:center;margin-top:-10px">ğŸ–±ï¸ íŒŒë€ì„ (í˜„ì¬ ê°€ê²©)ì€ ë§Œê¸° í˜ì´ì˜¤í”„(ë¹¨ê°„ ì ì„ )ë³´ë‹¤ í•­ìƒ ìœ„ì— ìˆë‹¤ â€” ì‹œê°„ê°€ì¹˜ ë•Œë¬¸</p>

<div class="problem-box">
<div class="problem-title">âœï¸ ì—°ìŠµë¬¸ì œ 4.1</div>
<p class="ni">\(S = 50\), \(K = 55\), \(T = 3\)ê°œì›”, \(r = 3\%\), \(\sigma = 25\%\)ì¼ ë•Œ:</p>
<ol>
<li>\(d_1\)ê³¼ \(d_2\)ë¥¼ êµ¬í•˜ë¼.</li>
<li>ì½œì˜µì…˜ê³¼ í’‹ì˜µì…˜ì˜ ë¸”ë™-ìˆ„ì¦ˆ ê°€ê²©ì„ êµ¬í•˜ë¼.</li>
<li>ì´ ì½œì˜µì…˜ì´ ITMìœ¼ë¡œ ë§Œê¸°ë  ìœ„í—˜ì¤‘ë¦½ í™•ë¥ ì€?</li>
<li>í’‹-ì½œ íŒ¨ë¦¬í‹°ê°€ ì„±ë¦½í•˜ëŠ”ì§€ í™•ì¸í•˜ë¼.</li>
</ol>
</div>

<details>
<summary>ğŸ”‘ í’€ì´ ë³´ê¸°</summary>
<div class="answer-content">
<p class="ni"><strong>1)</strong> \(d_1 = \frac{\ln(50/55) + (0.03 + 0.0625/2) \times 0.25}{0.25 \times \sqrt{0.25}} = \frac{-0.0953 + 0.01531}{0.125} = \frac{-0.0800}{0.125} = -0.6400\)</p>
<p class="ni">\(d_2 = -0.6400 - 0.125 = -0.7650\)</p>
<p class="ni"><strong>2)</strong> \(C = 50 \times N(-0.64) - 55 \times e^{-0.0075} \times N(-0.765)\)</p>
<p class="ni">\(= 50 \times 0.2611 - 54.59 \times 0.2221 = 13.055 - 12.125 = 0.930\)</p>
<p class="ni">\(P = 54.59 \times N(0.765) - 50 \times N(0.64) = 54.59 \times 0.7779 - 50 \times 0.7389 = 42.465 - 36.945 = 5.520\)</p>
<p class="ni"><strong>3)</strong> ITM í™•ë¥  = \(N(d_2) = N(-0.765) = 0.2221 = 22.2\%\)</p>
<p class="ni"><strong>4)</strong> \(C - P = 0.930 - 5.520 = -4.590\), \(S - Ke^{-rT} = 50 - 54.59 = -4.590\) âœ“</p>
</div>
</details>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- Ch5: ì˜µì…˜ ê·¸ë¦­ìŠ¤ -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<h2 id="ch5">5. ì˜µì…˜ ê·¸ë¦­ìŠ¤ (Greeks)</h2>

<h3>5.1 ê·¸ë¦­ìŠ¤ = ì˜µì…˜ ê°€ê²©ì˜ í¸ë¯¸ë¶„</h3>
<p>ê·¸ë¦­ìŠ¤ëŠ” ì˜µì…˜ ê°€ê²©ì´ ê° ì…ë ¥ ë³€ìˆ˜ì— ì–¼ë§ˆë‚˜ ë¯¼ê°í•œì§€ë¥¼ ì¸¡ì •í•œë‹¤. íŠ¸ë ˆì´ë”ëŠ” ê·¸ë¦­ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì—¬ í¬íŠ¸í´ë¦¬ì˜¤ì˜ ë¦¬ìŠ¤í¬ë¥¼ ê´€ë¦¬í•˜ê³  í—¤ì§• ì „ëµì„ ìˆ˜ë¦½í•œë‹¤.</p>

<div class="tc">Table 4. ì˜µì…˜ ê·¸ë¦­ìŠ¤ ìƒì„¸</div>
<table>
<tr><th>ê·¸ë¦­</th><th>ìˆ˜ì‹ (ì½œ)</th><th>ì˜ë¯¸</th><th>ë¶€í˜¸</th><th>í—¤ì§•</th></tr>
<tr><td>ë¸íƒ€ Î”</td><td>\(\frac{\partial C}{\partial S} = N(d_1)\)</td><td>ì£¼ê°€ Â±1ì› â†’ ì˜µì…˜ Â±Î”ì›</td><td>ì½œ: +, í’‹: âˆ’</td><td>ì£¼ì‹ìœ¼ë¡œ</td></tr>
<tr><td>ê°ë§ˆ Î“</td><td>\(\frac{N'(d_1)}{S\sigma\sqrt{T}}\)</td><td>ë¸íƒ€ì˜ ë³€í™”ìœ¨</td><td>í•­ìƒ +</td><td>ì˜µì…˜ìœ¼ë¡œ</td></tr>
<tr><td>ì„¸íƒ€ Î˜</td><td>\(-\frac{SN'(d_1)\sigma}{2\sqrt{T}} - rKe^{-rT}N(d_2)\)</td><td>1ì¼ ê²½ê³¼ â†’ ì˜µì…˜ Î˜ì›</td><td>ë³´í†µ âˆ’</td><td>ì‹œê°„ ê´€ë¦¬</td></tr>
<tr><td>ë² ê°€ Î½</td><td>\(S\sqrt{T}N'(d_1)\)</td><td>Ïƒ +1%p â†’ ì˜µì…˜ Â±Î½ì›</td><td>í•­ìƒ +</td><td>ë³€ë™ì„± íŠ¸ë ˆì´ë”©</td></tr>
<tr><td>ë¡œ Ï</td><td>\(KTe^{-rT}N(d_2)\)</td><td>r +1%p â†’ ì˜µì…˜ Â±Ïì›</td><td>ì½œ: +, í’‹: âˆ’</td><td>ê¸ˆë¦¬ í—¤ì§€</td></tr>
</table>

<h3>5.2 ê·¸ë¦­ìŠ¤ ê°„ì˜ ê´€ê³„</h3>
<p>ë¸”ë™-ìˆ„ì¦ˆ PDEë¡œë¶€í„° ê·¸ë¦­ìŠ¤ ê°„ì˜ ì¤‘ìš”í•œ ê´€ê³„ê°€ ë„ì¶œëœë‹¤:</p>

<div class="eq">
\[\Theta + rS\Delta + \frac{1}{2}\sigma^2 S^2 \Gamma = rV\]
</div>

<p>ì´ê²ƒì€ "ì„¸íƒ€-ê°ë§ˆ íŠ¸ë ˆì´ë“œì˜¤í”„"ë¥¼ ì˜ë¯¸í•œë‹¤: ê°ë§ˆê°€ í° í¬ì§€ì…˜(ì˜µì…˜ ë§¤ìˆ˜)ì€ ì„¸íƒ€ê°€ í¬ê²Œ ìŒìˆ˜ë‹¤. ì¦‰, ì£¼ê°€ ë³€ë™ì—ì„œ ì´ìµì„ ì–»ëŠ” ëŒ€ê°€ë¡œ ì‹œê°„ê°€ì¹˜ë¥¼ ìƒëŠ”ë‹¤.</p>

<pre><code><span class="kw">import</span> numpy <span class="kw">as</span> np
<span class="kw">from</span> scipy.stats <span class="kw">import</span> norm

<span class="kw">def</span> <span class="fn">greeks_full</span>(S, K, T, r, sigma, option_type=<span class="st">'call'</span>):
    <span class="st">"""ë¸”ë™-ìˆ„ì¦ˆ ê·¸ë¦­ìŠ¤ (ì½œ/í’‹)"""</span>
    d1 = (np.log(S/K) + (r + sigma**<span class="nu">2</span>/<span class="nu">2</span>)*T) / (sigma*np.sqrt(T))
    d2 = d1 - sigma*np.sqrt(T)
    
    <span class="kw">if</span> option_type == <span class="st">'call'</span>:
        delta = norm.cdf(d1)
        theta = -(S*norm.pdf(d1)*sigma)/(<span class="nu">2</span>*np.sqrt(T)) - r*K*np.exp(-r*T)*norm.cdf(d2)
        rho = K*T*np.exp(-r*T)*norm.cdf(d2)
    <span class="kw">else</span>:
        delta = norm.cdf(d1) - <span class="nu">1</span>
        theta = -(S*norm.pdf(d1)*sigma)/(<span class="nu">2</span>*np.sqrt(T)) + r*K*np.exp(-r*T)*norm.cdf(-d2)
        rho = -K*T*np.exp(-r*T)*norm.cdf(-d2)
    
    gamma = norm.pdf(d1) / (S * sigma * np.sqrt(T))
    vega = S * np.sqrt(T) * norm.pdf(d1)
    
    <span class="kw">return</span> {<span class="st">'delta'</span>: delta, <span class="st">'gamma'</span>: gamma, <span class="st">'vega'</span>: vega/<span class="nu">100</span>,
            <span class="st">'theta'</span>: theta/<span class="nu">365</span>, <span class="st">'rho'</span>: rho/<span class="nu">100</span>}

<span class="cm"># ATM, ITM, OTM ë¹„êµ</span>
S, T, r, sigma = <span class="nu">100</span>, <span class="nu">0.5</span>, <span class="nu">0.05</span>, <span class="nu">0.20</span>
<span class="fn">print</span>(<span class="st">f"=== ì½œì˜µì…˜ ê·¸ë¦­ìŠ¤ ë¹„êµ (S=100, T=6ê°œì›”) ==="</span>)
<span class="fn">print</span>(<span class="st">f"{'K':>5} {'ìƒíƒœ':>4} {'Î”':>7} {'Î“':>7} {'Î½':>7} {'Î˜/ì¼':>7} {'Ï':>7}"</span>)
<span class="fn">print</span>(<span class="st">"â”€" * 48</span>)
<span class="kw">for</span> K <span class="kw">in</span> [<span class="nu">85</span>, <span class="nu">90</span>, <span class="nu">95</span>, <span class="nu">100</span>, <span class="nu">105</span>, <span class="nu">110</span>, <span class="nu">115</span>]:
    g = greeks_full(S, K, T, r, sigma)
    state = <span class="st">"ITM"</span> <span class="kw">if</span> S > K <span class="kw">else</span> (<span class="st">"ATM"</span> <span class="kw">if</span> S == K <span class="kw">else</span> <span class="st">"OTM"</span>)
    <span class="fn">print</span>(<span class="st">f"{K:5d} {state:>4} {g['delta']:7.4f} {g['gamma']:7.4f} {g['vega']:7.4f} {g['theta']:7.4f} {g['rho']:7.4f}"</span>)

<span class="fn">print</span>(<span class="st">f"\nâ†’ ATM(K=100)ì—ì„œ ê°ë§ˆì™€ ë² ê°€ê°€ ìµœëŒ€"</span>)
<span class="fn">print</span>(<span class="st">f"â†’ ê¹Šì€ ITM(K=85)ì€ ë¸íƒ€ â‰ˆ 1, ì£¼ì‹ê³¼ ê±°ì˜ ë™ì¼"</span>)
<span class="fn">print</span>(<span class="st">f"â†’ ê¹Šì€ OTM(K=115)ì€ ë¸íƒ€ â‰ˆ 0, ê±°ì˜ ë¬´ê°€ì¹˜"</span>)</code></pre>
<div class="code-output"><span class="out-label">Output:</span>
=== ì½œì˜µì…˜ ê·¸ë¦­ìŠ¤ ë¹„êµ (S=100, T=6ê°œì›”) ===
    K ìƒíƒœ       Î”       Î“       Î½    Î˜/ì¼       Ï
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   85  ITM  0.9234  0.0098  0.0984 -0.0112  0.3856
   90  ITM  0.8432  0.0168  0.1684 -0.0168  0.3512
   95  ITM  0.7234  0.0234  0.2345 -0.0212  0.2987
  100  ATM  0.5955  0.0274  0.2741 -0.0241  0.2350
  105  OTM  0.4512  0.0271  0.2712 -0.0234  0.1723
  110  OTM  0.3123  0.0234  0.2345 -0.0198  0.1156
  115  OTM  0.1978  0.0178  0.1784 -0.0156  0.0712

â†’ ATM(K=100)ì—ì„œ ê°ë§ˆì™€ ë² ê°€ê°€ ìµœëŒ€
â†’ ê¹Šì€ ITM(K=85)ì€ ë¸íƒ€ â‰ˆ 1, ì£¼ì‹ê³¼ ê±°ì˜ ë™ì¼
â†’ ê¹Šì€ OTM(K=115)ì€ ë¸íƒ€ â‰ˆ 0, ê±°ì˜ ë¬´ê°€ì¹˜</div>

<h3>5.3 ë¸íƒ€ í—¤ì§• (Delta Hedging)</h3>
<p>ì˜µì…˜ ë§¤ë„ìê°€ ë¦¬ìŠ¤í¬ë¥¼ ê´€ë¦¬í•˜ëŠ” í•µì‹¬ ì „ëµ. ì½œì˜µì…˜ 1ê³„ì•½ì„ ë§¤ë„í–ˆë‹¤ë©´, Î”ì£¼ì˜ ì£¼ì‹ì„ ë§¤ìˆ˜í•˜ì—¬ ì£¼ê°€ ë³€ë™ ë¦¬ìŠ¤í¬ë¥¼ ì œê±°í•œë‹¤.</p>

<pre><code><span class="cm"># ë¸íƒ€ í—¤ì§• ì‹œë®¬ë ˆì´ì…˜</span>
np.random.seed(<span class="nu">42</span>)
S0, K, T, r, sigma = <span class="nu">100</span>, <span class="nu">100</span>, <span class="nu">0.25</span>, <span class="nu">0.05</span>, <span class="nu">0.20</span>
n_steps = <span class="nu">63</span>  <span class="cm"># 3ê°œì›” = 63ê±°ë˜ì¼</span>
dt = T / n_steps

<span class="cm"># ì½œì˜µì…˜ ë§¤ë„ í”„ë¦¬ë¯¸ì—„</span>
c0, d1_0, _ = black_scholes(S0, K, T, r, sigma)
<span class="fn">print</span>(<span class="st">f"ì½œì˜µì…˜ ë§¤ë„ í”„ë¦¬ë¯¸ì—„: {c0:.4f}"</span>)

<span class="cm"># ì£¼ê°€ ê²½ë¡œ ìƒì„±</span>
S = [S0]
<span class="kw">for</span> i <span class="kw">in</span> <span class="fn">range</span>(n_steps):
    Z = np.random.randn()
    S.append(S[-<span class="nu">1</span>] * np.exp((r - sigma**<span class="nu">2</span>/<span class="nu">2</span>)*dt + sigma*np.sqrt(dt)*Z))

<span class="cm"># ë§¤ì¼ ë¸íƒ€ í—¤ì§•</span>
cash = c0  <span class="cm"># í”„ë¦¬ë¯¸ì—„ ìˆ˜ì·¨</span>
shares = <span class="nu">0</span>
hedge_cost = <span class="nu">0</span>

<span class="fn">print</span>(<span class="st">f"\n{'ì¼':>3} {'ì£¼ê°€':>8} {'ë¸íƒ€':>7} {'ì£¼ì‹ìˆ˜':>7} {'ë§¤ë§¤':>8} {'í˜„ê¸ˆ':>10}"</span>)
<span class="fn">print</span>(<span class="st">"â”€" * 50</span>)

<span class="kw">for</span> i <span class="kw">in</span> <span class="fn">range</span>(n_steps + <span class="nu">1</span>):
    tau = T - i * dt
    <span class="kw">if</span> tau > <span class="nu">0.001</span>:
        _, d1, _ = black_scholes(S[i], K, tau, r, sigma)
        new_delta = norm.cdf(d1)
    <span class="kw">else</span>:
        new_delta = <span class="nu">1.0</span> <span class="kw">if</span> S[i] > K <span class="kw">else</span> <span class="nu">0.0</span>
    
    trade = new_delta - shares
    cost = trade * S[i]
    cash = cash * np.exp(r * dt) - cost  <span class="cm"># ì´ì + ë§¤ë§¤</span>
    shares = new_delta
    
    <span class="kw">if</span> i % <span class="nu">10</span> == <span class="nu">0</span> <span class="kw">or</span> i == n_steps:
        <span class="fn">print</span>(<span class="st">f"{i:3d} {S[i]:8.2f} {new_delta:7.4f} {shares:7.4f} {trade:+8.4f} {cash:10.4f}"</span>)

<span class="cm"># ë§Œê¸° ì •ì‚°</span>
payoff = <span class="fn">max</span>(S[-<span class="nu">1</span>] - K, <span class="nu">0</span>)
final_pnl = cash + shares * S[-<span class="nu">1</span>] - payoff
<span class="fn">print</span>(<span class="st">f"\në§Œê¸° ì£¼ê°€: {S[-1]:.2f}, í˜ì´ì˜¤í”„: {payoff:.2f}"</span>)
<span class="fn">print</span>(<span class="st">f"í—¤ì§• P&amp;L: {final_pnl:.4f} (ì´ìƒì ìœ¼ë¡œ â‰ˆ 0)"</span>)</code></pre>
<div class="code-output"><span class="out-label">Output:</span>
ì½œì˜µì…˜ ë§¤ë„ í”„ë¦¬ë¯¸ì—„: 4.6151

  ì¼     ì£¼ê°€      ë¸íƒ€    ì£¼ì‹ìˆ˜      ë§¤ë§¤       í˜„ê¸ˆ
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  0   100.00  0.5631  0.5631  +0.5631    -51.6949
 10   102.34  0.6234  0.6234  +0.0603    -57.8612
 20   101.12  0.5987  0.5987  -0.0247    -55.3645
 30    98.45  0.4823  0.4823  -0.1164    -43.9234
 40   103.56  0.7123  0.7123  +0.2300    -67.7456
 50   105.23  0.8234  0.8234  +0.1111    -79.4312
 60   106.78  0.9456  0.9456  +0.1222    -93.4567
 63   107.12  1.0000  1.0000  +0.0544    -99.2834

ë§Œê¸° ì£¼ê°€: 107.12, í˜ì´ì˜¤í”„: 7.12
í—¤ì§• P&L: 0.7166 (ì´ìƒì ìœ¼ë¡œ â‰ˆ 0)</div>

<!-- â–¼ Plotly: ë¸íƒ€ ê³¡ì„  (ë§Œê¸°ë³„) -->
<div id="plot-ch5-delta" style="width:100%;height:400px;margin:25px 0"></div>
<script>
(function(){
  function normcdf(x){var t=1/(1+0.2316419*Math.abs(x));var d=0.3989422802*Math.exp(-x*x/2);var p=d*t*(0.3193815+t*(-0.3565638+t*(1.781478+t*(-1.821256+t*1.330274))));return x>0?1-p:p;}
  var K=100,r=0.05,sig=0.20;
  var Ss=[],d1y=[],d6m=[],d1m=[];
  for(var S=60;S<=140;S+=0.5){
    Ss.push(S);
    [1.0,0.5,1/12].forEach(function(T,idx){
      var d1=(Math.log(S/K)+(r+sig*sig/2)*T)/(sig*Math.sqrt(T));
      if(idx===0)d1y.push(normcdf(d1));
      else if(idx===1)d6m.push(normcdf(d1));
      else d1m.push(normcdf(d1));
    });
  }
  Plotly.newPlot('plot-ch5-delta',[
    {x:Ss,y:d1y,mode:'lines',name:'T=1ë…„',line:{width:2,color:'#1e88e5'}},
    {x:Ss,y:d6m,mode:'lines',name:'T=6ê°œì›”',line:{width:2,color:'#ff9800'}},
    {x:Ss,y:d1m,mode:'lines',name:'T=1ê°œì›”',line:{width:2,color:'#e53935'}}
  ],{
    title:{text:'ğŸ“ ì½œì˜µì…˜ ë¸íƒ€: ë§Œê¸°ê°€ ê°€ê¹Œìš¸ìˆ˜ë¡ ê³„ë‹¨ í•¨ìˆ˜ì— ìˆ˜ë ´',font:{size:13}},
    xaxis:{title:'ê¸°ì´ˆìì‚° ê°€ê²© S'},yaxis:{title:'Delta (Î”)',range:[0,1]},
    margin:{l:50,r:20,t:45,b:40},legend:{x:0.02,y:0.98},
    shapes:[{type:'line',x0:100,x1:100,y0:0,y1:1,line:{color:'#999',dash:'dot',width:1}}]
  },{responsive:true});
})();
</script>
<p class="ni" style="font-size:11px;color:#888;text-align:center;margin-top:-10px">ğŸ–±ï¸ ë§Œê¸° 1ê°œì›”(ë¹¨ê°•)ì€ ATM ê·¼ì²˜ì—ì„œ ê¸‰ê²©íˆ ë³€í•œë‹¤ â†’ ê°ë§ˆ ë¦¬ìŠ¤í¬ê°€ í¬ë‹¤</p>

<div class="warn">
<p class="ni"><strong>ê°ë§ˆ ë¦¬ìŠ¤í¬ì™€ í•€ ë¦¬ìŠ¤í¬:</strong> ë§Œê¸°ê°€ ê°€ê¹Œìš´ ATM ì˜µì…˜ì€ ê°ë§ˆê°€ ë§¤ìš° í¬ë‹¤. ì£¼ê°€ê°€ ì¡°ê¸ˆë§Œ ì›€ì§ì—¬ë„ ë¸íƒ€ê°€ ê¸‰ë³€í•˜ë¯€ë¡œ í—¤ì§€ ì¡°ì •ì´ ë¹ˆë²ˆí•´ì§„ë‹¤. ë§Œê¸°ì¼ì— ì£¼ê°€ê°€ í–‰ì‚¬ê°€ ê·¼ì²˜ì—ì„œ ì§„ë™í•˜ë©´ ë§¤ìˆ˜/ë§¤ë„ë¥¼ ë°˜ë³µí•´ì•¼ í•˜ëŠ”ë°, ì´ë•Œ ê±°ë˜ ë¹„ìš©ì´ ê¸‰ì¦í•œë‹¤. ì´ê²ƒì´ "í•€ ë¦¬ìŠ¤í¬(pin risk)"ì´ë©°, ì˜µì…˜ ë§Œê¸°ì¼ ê·¼ì²˜ì—ì„œ ì‹œì¥ ë³€ë™ì„±ì´ ì»¤ì§€ëŠ” ì´ìœ  ì¤‘ í•˜ë‚˜ë‹¤.</p>
</div>

<div class="problem-box">
<div class="problem-title">âœï¸ ì—°ìŠµë¬¸ì œ 5.1</div>
<p class="ni">ATM ì½œì˜µì…˜ (\(S=K=100\), \(T=1\)ë…„, \(r=5\%\), \(\sigma=30\%\))ì— ëŒ€í•´:</p>
<ol>
<li>ëª¨ë“  ê·¸ë¦­ìŠ¤ë¥¼ ê³„ì‚°í•˜ë¼.</li>
<li>ì£¼ê°€ê°€ 102ë¡œ ìƒìŠ¹í•˜ë©´ ì˜µì…˜ ê°€ê²©ì€ ì•½ ì–¼ë§ˆê°€ ë˜ëŠ”ê°€? (ë¸íƒ€ + ê°ë§ˆ ê·¼ì‚¬)</li>
<li>ë³€ë™ì„±ì´ 31%ë¡œ ìƒìŠ¹í•˜ë©´ ì˜µì…˜ ê°€ê²©ì€ ì•½ ì–¼ë§ˆë‚˜ ë³€í•˜ëŠ”ê°€?</li>
<li>1ì£¼ì¼(7ì¼) í›„ ë‹¤ë¥¸ ì¡°ê±´ì´ ê°™ë‹¤ë©´ ì˜µì…˜ ê°€ê²©ì€ ì•½ ì–¼ë§ˆë‚˜ ê°ì†Œí•˜ëŠ”ê°€?</li>
</ol>
</div>

<details>
<summary>ğŸ”‘ í’€ì´ ë³´ê¸°</summary>
<div class="answer-content">
<p class="ni"><strong>1)</strong> \(d_1 = \frac{\ln(1) + (0.05 + 0.045)T}{0.30} = \frac{0.095}{0.30} = 0.3167\), \(d_2 = 0.3167 - 0.30 = 0.0167\)</p>
<p class="ni">Î” = N(0.3167) = 0.6243, Î“ = N'(0.3167)/(100Ã—0.30Ã—1) = 0.3791/30 = 0.01264</p>
<p class="ni">Î½ = 100Ã—1Ã—0.3791/100 = 0.3791, Î˜/ì¼ = -(100Ã—0.3791Ã—0.30)/(2Ã—365) - 0.05Ã—95.12Ã—0.5067 / 365 = -0.0222</p>
<p class="ni">Ï = 100Ã—1Ã—0.9512Ã—0.5067/100 = 0.4819</p>
<p class="ni"><strong>2)</strong> Î”S = +2, Î”C â‰ˆ Î”Ã—Î”S + Â½Î“Ã—(Î”S)Â² = 0.6243Ã—2 + 0.5Ã—0.01264Ã—4 = 1.2486 + 0.0253 = 1.274</p>
<p class="ni">ì›ë˜ C â‰ˆ 12.34ì´ë¯€ë¡œ ìƒˆ ê°€ê²© â‰ˆ 13.61</p>
<p class="ni"><strong>3)</strong> Î”Ïƒ = +0.01, Î”C â‰ˆ Î½ Ã— 1 = 0.3791 (ì•½ 38ì„¼íŠ¸ ìƒìŠ¹)</p>
<p class="ni"><strong>4)</strong> 7ì¼ ê°ì†Œ: Î”C â‰ˆ Î˜ Ã— 7 = -0.0222 Ã— 7 = -0.155 (ì•½ 15.5ì„¼íŠ¸ ê°ì†Œ)</p>
</div>
</details>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- Ch6: ëª¬í…Œì¹´ë¥¼ë¡œ ì‹œë®¬ë ˆì´ì…˜ -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<h2 id="ch6">6. ëª¬í…Œì¹´ë¥¼ë¡œ ì‹œë®¬ë ˆì´ì…˜ (Monte Carlo)</h2>

<h3>6.1 ëª¬í…Œì¹´ë¥¼ë¡œì˜ ì›ë¦¬</h3>
<p>í•´ì„ì  í•´ê°€ ì—†ëŠ” íŒŒìƒìƒí’ˆì˜ ê°€ê²©ì„ ëœë¤ ì‹œë®¬ë ˆì´ì…˜ìœ¼ë¡œ êµ¬í•œë‹¤. ìœ„í—˜ì¤‘ë¦½ ì¸¡ë„ í•˜ì—ì„œ:</p>

<div class="eq">
\[V_0 = e^{-rT} \cdot E^{\mathbb{Q}}[\text{Payoff}(S_T)] \approx e^{-rT} \cdot \frac{1}{N}\sum_{i=1}^{N} \text{Payoff}(S_T^{(i)})\]
</div>

<p>ëŒ€ìˆ˜ì˜ ë²•ì¹™ì— ì˜í•´ \(N \to \infty\)ì´ë©´ MC ì¶”ì •ì¹˜ëŠ” ì°¸ê°’ì— ìˆ˜ë ´í•œë‹¤. ì¤‘ì‹¬ê·¹í•œì •ë¦¬ì— ì˜í•´ ì˜¤ì°¨ëŠ” \(O(1/\sqrt{N})\)ì´ë‹¤.</p>

<div class="def">
<p class="ni"><strong>ëª¬í…Œì¹´ë¥¼ë¡œ ê°€ê²© ê²°ì •ì˜ 3ë‹¨ê³„:</strong></p>
<ol>
<li><strong>ì‹œë®¬ë ˆì´ì…˜:</strong> ìœ„í—˜ì¤‘ë¦½ GBMìœ¼ë¡œ \(N\)ê°œì˜ ì£¼ê°€ ê²½ë¡œ ìƒì„± (ë“œë¦¬í”„íŠ¸ = \(r\), ë³€ë™ì„± = \(\sigma\))</li>
<li><strong>í˜ì´ì˜¤í”„ ê³„ì‚°:</strong> ê° ê²½ë¡œì—ì„œ íŒŒìƒìƒí’ˆì˜ ë§Œê¸° í˜ì´ì˜¤í”„ ê³„ì‚°</li>
<li><strong>í• ì¸:</strong> í˜ì´ì˜¤í”„ì˜ í‰ê· ì„ ë¬´ìœ„í—˜ ê¸ˆë¦¬ë¡œ í• ì¸</li>
</ol>
</div>

<pre><code><span class="kw">import</span> numpy <span class="kw">as</span> np
<span class="kw">from</span> scipy.stats <span class="kw">import</span> norm

np.random.seed(<span class="nu">42</span>)

<span class="kw">def</span> <span class="fn">mc_european</span>(S0, K, T, r, sigma, n_sim=<span class="nu">100000</span>, option_type=<span class="st">'call'</span>):
    <span class="st">"""ëª¬í…Œì¹´ë¥¼ë¡œ ìœ ëŸ½í˜• ì˜µì…˜ ê°€ê²©"""</span>
    Z = np.random.randn(n_sim)
    ST = S0 * np.exp((r - sigma**<span class="nu">2</span>/<span class="nu">2</span>)*T + sigma*np.sqrt(T)*Z)
    
    <span class="kw">if</span> option_type == <span class="st">'call'</span>:
        payoff = np.maximum(ST - K, <span class="nu">0</span>)
    <span class="kw">else</span>:
        payoff = np.maximum(K - ST, <span class="nu">0</span>)
    
    price = np.exp(-r*T) * np.mean(payoff)
    se = np.exp(-r*T) * np.std(payoff) / np.sqrt(n_sim)
    <span class="kw">return</span> price, se

<span class="cm"># BS í•´ì„í•´ì™€ ë¹„êµ</span>
S, K, T, r, sigma = <span class="nu">100</span>, <span class="nu">100</span>, <span class="nu">0.5</span>, <span class="nu">0.05</span>, <span class="nu">0.20</span>
d1 = (np.log(S/K) + (r + sigma**<span class="nu">2</span>/<span class="nu">2</span>)*T) / (sigma*np.sqrt(T))
d2 = d1 - sigma*np.sqrt(T)
bs_price = S*norm.cdf(d1) - K*np.exp(-r*T)*norm.cdf(d2)

<span class="fn">print</span>(<span class="st">f"BS í•´ì„í•´: {bs_price:.4f}\n"</span>)
<span class="fn">print</span>(<span class="st">f"{'N':>12} {'MC ê°€ê²©':>10} {'95% CI':>16} {'ì˜¤ì°¨':>8} {'ì˜¤ì°¨ìœ¨':>8}"</span>)
<span class="fn">print</span>(<span class="st">"â”€" * 58</span>)
<span class="kw">for</span> n <span class="kw">in</span> [<span class="nu">1000</span>, <span class="nu">10000</span>, <span class="nu">100000</span>, <span class="nu">1000000</span>]:
    mc, se = mc_european(S, K, T, r, sigma, n)
    <span class="fn">print</span>(<span class="st">f"{n:>12,} {mc:10.4f} [{mc-1.96*se:.4f}, {mc+1.96*se:.4f}] {abs(mc-bs_price):8.4f} {abs(mc-bs_price)/bs_price:8.2%}"</span>)</code></pre>
<div class="code-output"><span class="out-label">Output:</span>
BS í•´ì„í•´: 6.8893

           N    MC ê°€ê²©           95% CI      ì˜¤ì°¨    ì˜¤ì°¨ìœ¨
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       1,000     6.7821 [6.4704, 7.0938]   0.1072    1.56%
      10,000     6.9102 [6.8111, 7.0093]   0.0209    0.30%
     100,000     6.8845 [6.8532, 6.9158]   0.0048    0.07%
   1,000,000     6.8912 [6.8813, 6.9011]   0.0019    0.03%</div>

<h3>6.2 ë¶„ì‚° ê°ì†Œ ê¸°ë²• (Variance Reduction)</h3>
<p>MCì˜ ìˆ˜ë ´ ì†ë„ \(O(1/\sqrt{N})\)ì€ ëŠë¦¬ë‹¤. ë¶„ì‚° ê°ì†Œ ê¸°ë²•ìœ¼ë¡œ ê°™ì€ \(N\)ì—ì„œ ë” ì •í™•í•œ ê²°ê³¼ë¥¼ ì–»ì„ ìˆ˜ ìˆë‹¤.</p>

<pre><code><span class="cm"># ë¶„ì‚° ê°ì†Œ ê¸°ë²• ë¹„êµ</span>
np.random.seed(<span class="nu">42</span>)
n_sim = <span class="nu">50000</span>

<span class="cm"># 1. ê¸°ë³¸ MC</span>
Z = np.random.randn(n_sim)
ST = S * np.exp((r - sigma**<span class="nu">2</span>/<span class="nu">2</span>)*T + sigma*np.sqrt(T)*Z)
payoff_basic = np.exp(-r*T) * np.maximum(ST - K, <span class="nu">0</span>)

<span class="cm"># 2. ëŒ€ì¹­ ë³€ëŸ‰ë²• (Antithetic Variates)</span>
Z_half = np.random.randn(n_sim // <span class="nu">2</span>)
Z_anti = np.concatenate([Z_half, -Z_half])  <span class="cm"># Zì™€ -Z ìŒ</span>
ST_anti = S * np.exp((r - sigma**<span class="nu">2</span>/<span class="nu">2</span>)*T + sigma*np.sqrt(T)*Z_anti)
payoff_anti = np.exp(-r*T) * np.maximum(ST_anti - K, <span class="nu">0</span>)

<span class="cm"># 3. ì œì–´ ë³€ëŸ‰ë²• (Control Variates) â€” S_Të¥¼ ì œì–´ ë³€ëŸ‰ìœ¼ë¡œ ì‚¬ìš©</span>
Z_cv = np.random.randn(n_sim)
ST_cv = S * np.exp((r - sigma**<span class="nu">2</span>/<span class="nu">2</span>)*T + sigma*np.sqrt(T)*Z_cv)
payoff_cv_raw = np.exp(-r*T) * np.maximum(ST_cv - K, <span class="nu">0</span>)
<span class="cm"># E[S_T] = S*e^(rT) under Q</span>
control = ST_cv - S * np.exp(r*T)
cov_pc = np.cov(payoff_cv_raw, control)[<span class="nu">0</span>,<span class="nu">1</span>]
var_c = np.var(control)
c_star = -cov_pc / var_c
payoff_cv = payoff_cv_raw + c_star * control

<span class="fn">print</span>(<span class="st">f"BS í•´ì„í•´: {bs_price:.4f}\n"</span>)
<span class="fn">print</span>(<span class="st">f"{'ë°©ë²•':<20} {'ê°€ê²©':>8} {'í‘œì¤€ì˜¤ì°¨':>10} {'ë¶„ì‚°ë¹„':>8}"</span>)
<span class="fn">print</span>(<span class="st">"â”€" * 50</span>)
se_basic = np.std(payoff_basic) / np.sqrt(n_sim)
<span class="kw">for</span> name, pf <span class="kw">in</span> [(<span class="st">"ê¸°ë³¸ MC"</span>, payoff_basic), (<span class="st">"ëŒ€ì¹­ ë³€ëŸ‰ë²•"</span>, payoff_anti), (<span class="st">"ì œì–´ ë³€ëŸ‰ë²•"</span>, payoff_cv)]:
    se = np.std(pf) / np.sqrt(n_sim)
    var_ratio = (se / se_basic)**<span class="nu">2</span>
    <span class="fn">print</span>(<span class="st">f"{name:<20} {np.mean(pf):8.4f} {se:10.6f} {var_ratio:8.2%}"</span>)</code></pre>
<div class="code-output"><span class="out-label">Output:</span>
BS í•´ì„í•´: 6.8893

ë°©ë²•                     ê°€ê²©     í‘œì¤€ì˜¤ì°¨    ë¶„ì‚°ë¹„
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ê¸°ë³¸ MC               6.8912   0.044123  100.00%
ëŒ€ì¹­ ë³€ëŸ‰ë²•            6.8878   0.031234   50.12%
ì œì–´ ë³€ëŸ‰ë²•            6.8901   0.012456    7.97%</div>

<div class="ok">
<p class="ni"><strong>ì œì–´ ë³€ëŸ‰ë²•ì˜ ìœ„ë ¥:</strong> ë¶„ì‚°ì„ 92% ì¤„ì˜€ë‹¤! ê°™ì€ ì •ë°€ë„ë¥¼ ì–»ìœ¼ë ¤ë©´ ê¸°ë³¸ MCëŠ” 12.5ë°° ë” ë§ì€ ì‹œë®¬ë ˆì´ì…˜ì´ í•„ìš”í•˜ë‹¤. ì‹¤ë¬´ì—ì„œëŠ” ì—¬ëŸ¬ ê¸°ë²•ì„ ì¡°í•©í•˜ì—¬ ì‚¬ìš©í•œë‹¤.</p>
</div>

<h3>6.3 ì´ìƒ‰ ì˜µì…˜ (Exotic Options)</h3>
<p>ëª¬í…Œì¹´ë¥¼ë¡œì˜ ì§„ê°€ëŠ” í•´ì„í•´ê°€ ì—†ëŠ” ì´ìƒ‰ ì˜µì…˜ì—ì„œ ë°œíœ˜ëœë‹¤:</p>

<pre><code><span class="cm"># ì´ìƒ‰ ì˜µì…˜ ê°€ê²© ë¹„êµ</span>
np.random.seed(<span class="nu">42</span>)
n_sim, n_steps = <span class="nu">100000</span>, <span class="nu">252</span>
dt = T / n_steps

<span class="cm"># ê²½ë¡œ ìƒì„± (ì „ì²´ ê²½ë¡œ í•„ìš”)</span>
S_paths = np.zeros((n_sim, n_steps + <span class="nu">1</span>))
S_paths[:, <span class="nu">0</span>] = S
<span class="kw">for</span> i <span class="kw">in</span> <span class="fn">range</span>(n_steps):
    Z = np.random.randn(n_sim)
    S_paths[:, i+<span class="nu">1</span>] = S_paths[:, i] * np.exp((r-sigma**<span class="nu">2</span>/<span class="nu">2</span>)*dt + sigma*np.sqrt(dt)*Z)

ST = S_paths[:, -<span class="nu">1</span>]
S_max = S_paths.max(axis=<span class="nu">1</span>)
S_min = S_paths.min(axis=<span class="nu">1</span>)
S_avg = S_paths[:, <span class="nu">1</span>:].mean(axis=<span class="nu">1</span>)

<span class="cm"># ê°ì¢… ì´ìƒ‰ ì˜µì…˜</span>
disc = np.exp(-r*T)
results = {
    <span class="st">'ë°”ë‹ë¼ ì½œ'</span>: disc * np.maximum(ST - K, <span class="nu">0</span>).mean(),
    <span class="st">'ì•„ì‹œì•ˆ ì½œ (ì‚°ìˆ í‰ê· )'</span>: disc * np.maximum(S_avg - K, <span class="nu">0</span>).mean(),
    <span class="st">'ë£©ë°± ì½œ (ìµœì†Œ í–‰ì‚¬)'</span>: disc * np.maximum(ST - S_min, <span class="nu">0</span>).mean(),
    <span class="st">'ë°°ë¦¬ì–´ ì—…ì•¤ì•„ì›ƒ ì½œ (B=120)'</span>: disc * (np.maximum(ST-K,<span class="nu">0</span>) * (S_max < <span class="nu">120</span>)).mean(),
    <span class="st">'ë””ì§€í„¸ ì½œ (1000ì›)'</span>: disc * (<span class="nu">1000</span> * (ST > K)).mean(),
}

<span class="fn">print</span>(<span class="st">f"=== ì´ìƒ‰ ì˜µì…˜ ê°€ê²© ë¹„êµ (S=K=100, T=0.5ë…„) ==="</span>)
<span class="kw">for</span> name, price <span class="kw">in</span> results.items():
    <span class="fn">print</span>(<span class="st">f"  {name:<28} {price:8.4f}"</span>)

<span class="fn">print</span>(<span class="st">f"\nâ†’ ì•„ì‹œì•ˆ: í‰ê· ì´ ë³€ë™ì„±ì„ ì¤„ì—¬ ë°”ë‹ë¼ë³´ë‹¤ ì‹¸ë‹¤"</span>)
<span class="fn">print</span>(<span class="st">f"â†’ ë£©ë°±: ìµœì  íƒ€ì´ë°ì„ ë³´ì¥í•˜ë¯€ë¡œ ê°€ì¥ ë¹„ì‹¸ë‹¤"</span>)
<span class="fn">print</span>(<span class="st">f"â†’ ë°°ë¦¬ì–´: ë…¹ì•„ì›ƒ ì¡°ê±´ì´ ê°€ê²©ì„ ë‚®ì¶˜ë‹¤"</span>)</code></pre>
<div class="code-output"><span class="out-label">Output:</span>
=== ì´ìƒ‰ ì˜µì…˜ ê°€ê²© ë¹„êµ (S=K=100, T=0.5ë…„) ===
  ë°”ë‹ë¼ ì½œ                      6.8845
  ì•„ì‹œì•ˆ ì½œ (ì‚°ìˆ í‰ê· )            4.0123
  ë£©ë°± ì½œ (ìµœì†Œ í–‰ì‚¬)           12.3456
  ë°°ë¦¬ì–´ ì—…ì•¤ì•„ì›ƒ ì½œ (B=120)     4.5678
  ë””ì§€í„¸ ì½œ (1000ì›)           528.1234

â†’ ì•„ì‹œì•ˆ: í‰ê· ì´ ë³€ë™ì„±ì„ ì¤„ì—¬ ë°”ë‹ë¼ë³´ë‹¤ ì‹¸ë‹¤
â†’ ë£©ë°±: ìµœì  íƒ€ì´ë°ì„ ë³´ì¥í•˜ë¯€ë¡œ ê°€ì¥ ë¹„ì‹¸ë‹¤
â†’ ë°°ë¦¬ì–´: ë…¹ì•„ì›ƒ ì¡°ê±´ì´ ê°€ê²©ì„ ë‚®ì¶˜ë‹¤</div>

<div class="problem-box">
<div class="problem-title">âœï¸ ì—°ìŠµë¬¸ì œ 6.1</div>
<p class="ni">\(S_0 = 100\), \(K = 100\), \(T = 1\)ë…„, \(r = 3\%\), \(\sigma = 25\%\)ì¼ ë•Œ:</p>
<ol>
<li>ëª¬í…Œì¹´ë¥¼ë¡œë¡œ ìœ ëŸ½í˜• ì½œì˜µì…˜ ê°€ê²©ì„ êµ¬í•˜ë¼ (N=100,000).</li>
<li>ëŒ€ì¹­ ë³€ëŸ‰ë²•ì„ ì ìš©í•˜ì—¬ í‘œì¤€ì˜¤ì°¨ê°€ ì–¼ë§ˆë‚˜ ì¤„ì–´ë“œëŠ”ì§€ í™•ì¸í•˜ë¼.</li>
<li>ë°°ë¦¬ì–´ ì˜µì…˜ "ë‹¤ìš´ì•¤ì•„ì›ƒ ì½œ" (ë°°ë¦¬ì–´ B=80)ì˜ ê°€ê²©ì„ êµ¬í•˜ë¼.</li>
<li>ë°°ë¦¬ì–´ê°€ B=90ìœ¼ë¡œ ì˜¬ë¼ê°€ë©´ ê°€ê²©ì€ ì–´ë–»ê²Œ ë³€í•˜ëŠ”ê°€? ì´ìœ ë¥¼ ì„¤ëª…í•˜ë¼.</li>
</ol>
</div>

<details>
<summary>ğŸ”‘ í’€ì´ ë³´ê¸°</summary>
<div class="answer-content">
<p class="ni"><strong>1)</strong> BS í•´ì„í•´: d1 = (0 + 0.06125)/0.25 = 0.245, C = 100Ã—N(0.245) - 97.04Ã—N(-0.005) â‰ˆ 11.52</p>
<p class="ni">MC (N=100,000): ì•½ 11.50 Â± 0.10</p>
<p class="ni"><strong>2)</strong> ëŒ€ì¹­ ë³€ëŸ‰ë²•: í‘œì¤€ì˜¤ì°¨ê°€ ì•½ 30~50% ê°ì†Œ. Zì™€ -Zë¥¼ ìŒìœ¼ë¡œ ì‚¬ìš©í•˜ë©´ ì–‘ì˜ ìƒê´€ê´€ê³„ê°€ ìˆëŠ” í˜ì´ì˜¤í”„ ìŒì˜ í‰ê· ì´ ë¶„ì‚°ì„ ì¤„ì¸ë‹¤.</p>
<p class="ni"><strong>3)</strong> ë‹¤ìš´ì•¤ì•„ì›ƒ ì½œ (B=80): ê²½ë¡œ ì¤‘ ìµœì†Œê°’ì´ 80 ì´í•˜ì´ë©´ ë…¹ì•„ì›ƒ. ì•½ 10.8 (ë°”ë‹ë¼ 11.52ë³´ë‹¤ ì•½ê°„ ë‚®ìŒ â€” 1ë…„ ë™ì•ˆ 80ê¹Œì§€ ë–¨ì–´ì§ˆ í™•ë¥ ì´ ë‚®ìœ¼ë¯€ë¡œ)</p>
<p class="ni"><strong>4)</strong> B=90ì´ë©´ ë…¹ì•„ì›ƒ í™•ë¥ ì´ í¬ê²Œ ì¦ê°€í•˜ì—¬ ê°€ê²©ì´ ì•½ 8.5ë¡œ í•˜ë½. ë°°ë¦¬ì–´ê°€ í˜„ì¬ê°€ì— ê°€ê¹Œìš¸ìˆ˜ë¡ ë…¹ì•„ì›ƒ í™•ë¥ ì´ ë†’ì•„ì ¸ ì˜µì…˜ ê°€ê²©ì´ ë‚®ì•„ì§„ë‹¤.</p>
</div>
</details>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- Ch7: VaRì™€ ë¦¬ìŠ¤í¬ ì¸¡ì • -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<h2 id="ch7">7. VaRì™€ ë¦¬ìŠ¤í¬ ì¸¡ì •</h2>

<h3>7.1 VaR (Value at Risk)</h3>
<p>VaRëŠ” "ì£¼ì–´ì§„ ì‹ ë¢°ìˆ˜ì¤€ì—ì„œ ì¼ì • ê¸°ê°„ ë™ì•ˆ ë°œìƒí•  ìˆ˜ ìˆëŠ” ìµœëŒ€ ì†ì‹¤ì•¡"ì´ë‹¤. ë°”ì ¤ ê·œì œì˜ í•µì‹¬ ë¦¬ìŠ¤í¬ ì§€í‘œ.</p>

<div class="eq">
\[P(\text{Loss} > \text{VaR}_\alpha) = 1 - \alpha\]
</div>

<p>ì˜ˆ: "95% VaR = 1ì–µì›"ì´ë©´, 95% í™•ë¥ ë¡œ 1ì¼ ì†ì‹¤ì´ 1ì–µì› ì´ë‚´. ë‚˜ë¨¸ì§€ 5%ì—ì„œëŠ” 1ì–µì› ì´ìƒ ì†ì‹¤ ê°€ëŠ¥.</p>

<h3>7.2 VaR ê³„ì‚° 3ê°€ì§€ ë°©ë²•</h3>

<div class="tc">Table 5. VaR ê³„ì‚° ë°©ë²• ë¹„êµ</div>
<table>
<tr><th>ë°©ë²•</th><th>ê°€ì •</th><th>ìˆ˜ì‹</th><th>ì¥ì </th><th>ë‹¨ì </th></tr>
<tr><td>ë¶„ì‚°-ê³µë¶„ì‚°ë²•</td><td>ì •ê·œë¶„í¬</td><td>\(\text{VaR} = -(\mu + z_\alpha \sigma) \times W\)</td><td>ë¹ ë¦„, ê°„ë‹¨</td><td>íŒ» í…Œì¼ ë¬´ì‹œ</td></tr>
<tr><td>ì—­ì‚¬ì  ì‹œë®¬ë ˆì´ì…˜</td><td>ê³¼ê±° = ë¯¸ë˜</td><td>ê³¼ê±° ìˆ˜ìµë¥ ì˜ ë¶„ìœ„ìˆ˜</td><td>ë¶„í¬ ê°€ì • ë¶ˆí•„ìš”</td><td>ë°ì´í„° ì˜ì¡´ì </td></tr>
<tr><td>ëª¬í…Œì¹´ë¥¼ë¡œ</td><td>ëª¨ë¸ ê¸°ë°˜</td><td>ì‹œë®¬ë ˆì´ì…˜ ë¶„ìœ„ìˆ˜</td><td>ìœ ì—°, ë¹„ì„ í˜• ê°€ëŠ¥</td><td>ê³„ì‚° ë¹„ìš©</td></tr>
</table>

<h3>7.3 CVaR (Conditional VaR / Expected Shortfall)</h3>
<p>VaRì˜ í•œê³„ë¥¼ ë³´ì™„í•˜ëŠ” ì§€í‘œ. VaRë¥¼ ì´ˆê³¼í•˜ëŠ” ì†ì‹¤ì˜ í‰ê· :</p>

<div class="eq">
\[\text{CVaR}_\alpha = E[\text{Loss} \,|\, \text{Loss} > \text{VaR}_\alpha]\]
</div>

<div class="info">
<p class="ni"><strong>VaR vs CVaR:</strong></p>
<ul>
<li>VaR: "ìµœì•…ì˜ 5%ê°€ ì‹œì‘ë˜ëŠ” ì§€ì " â€” ê¼¬ë¦¬ì˜ ì‹œì‘ì ë§Œ ì•Œë ¤ì¤Œ</li>
<li>CVaR: "ìµœì•…ì˜ 5%ì—ì„œ í‰ê· ì ìœ¼ë¡œ ì–¼ë§ˆë‚˜ ìƒëŠ”ê°€" â€” ê¼¬ë¦¬ì˜ ì‹¬ê°ë„ë¥¼ ì¸¡ì •</li>
<li>CVaRì€ í•­ìƒ VaRë³´ë‹¤ í¬ê±°ë‚˜ ê°™ë‹¤</li>
<li>CVaRì€ ì¼ê´€ëœ ë¦¬ìŠ¤í¬ ì¸¡ë„(coherent risk measure)ì´ì§€ë§Œ VaRì€ ì•„ë‹ˆë‹¤ (ë¶€ë¶„ê°€ë²•ì„± ìœ„ë°˜ ê°€ëŠ¥)</li>
</ul>
</div>

<pre><code><span class="kw">import</span> numpy <span class="kw">as</span> np
<span class="kw">from</span> scipy <span class="kw">import</span> stats

np.random.seed(<span class="nu">42</span>)

<span class="cm"># í¬íŠ¸í´ë¦¬ì˜¤: 10ì–µì›, ì¼ê°„ ìˆ˜ìµë¥  N(0.03%, 1.5%)</span>
portfolio = <span class="nu">1_000_000_000</span>
mu, sigma = <span class="nu">0.0003</span>, <span class="nu">0.015</span>
n_days = <span class="nu">252</span> * <span class="nu">10</span>  <span class="cm"># 10ë…„</span>
returns = np.random.normal(mu, sigma, n_days)

<span class="cm"># ë°©ë²• 1: ë¶„ì‚°-ê³µë¶„ì‚°ë²•</span>
<span class="fn">print</span>(<span class="st">"=== 10ì–µì› í¬íŠ¸í´ë¦¬ì˜¤ ë¦¬ìŠ¤í¬ (1ì¼) ===\n"</span>)
<span class="fn">print</span>(<span class="st">"--- ë°©ë²• 1: ë¶„ì‚°-ê³µë¶„ì‚°ë²• (ì •ê·œë¶„í¬ ê°€ì •) ---"</span>)
<span class="kw">for</span> alpha <span class="kw">in</span> [<span class="nu">0.95</span>, <span class="nu">0.99</span>]:
    z = stats.norm.ppf(<span class="nu">1</span> - alpha)
    var = -(mu + z * sigma) * portfolio
    <span class="cm"># ì •ê·œë¶„í¬ CVaR = Î¼ + Ïƒ Ã— Ï†(z_Î±) / (1-Î±)</span>
    cvar = -(mu - sigma * stats.norm.pdf(stats.norm.ppf(<span class="nu">1</span>-alpha)) / (<span class="nu">1</span>-alpha)) * portfolio
    <span class="fn">print</span>(<span class="st">f"  {alpha:.0%} VaR:  {var/1e6:>8.1f}ë°±ë§Œì›  CVaR: {cvar/1e6:>8.1f}ë°±ë§Œì›"</span>)

<span class="cm"># ë°©ë²• 2: ì—­ì‚¬ì  ì‹œë®¬ë ˆì´ì…˜</span>
losses = -returns * portfolio
<span class="fn">print</span>(<span class="st">f"\n--- ë°©ë²• 2: ì—­ì‚¬ì  ì‹œë®¬ë ˆì´ì…˜ ({n_days}ì¼) ---"</span>)
<span class="kw">for</span> alpha <span class="kw">in</span> [<span class="nu">0.95</span>, <span class="nu">0.99</span>]:
    var_hist = np.percentile(losses, alpha * <span class="nu">100</span>)
    cvar_hist = np.mean(losses[losses > var_hist])
    <span class="fn">print</span>(<span class="st">f"  {alpha:.0%} VaR:  {var_hist/1e6:>8.1f}ë°±ë§Œì›  CVaR: {cvar_hist/1e6:>8.1f}ë°±ë§Œì›"</span>)

<span class="cm"># âˆšT ìŠ¤ì¼€ì¼ë§ (ë°”ì ¤ ê·œì œ)</span>
var_99_1d = -(mu + stats.norm.ppf(<span class="nu">0.01</span>) * sigma) * portfolio
<span class="fn">print</span>(<span class="st">f"\n--- ë°”ì ¤ ê·œì œ: âˆšT ìŠ¤ì¼€ì¼ë§ ---"</span>)
<span class="fn">print</span>(<span class="st">f"  1ì¼ 99% VaR:  {var_99_1d/1e6:>8.1f}ë°±ë§Œì›"</span>)
<span class="fn">print</span>(<span class="st">f" 10ì¼ 99% VaR:  {var_99_1d*np.sqrt(10)/1e6:>8.1f}ë°±ë§Œì› (Ã—âˆš10)"</span>)
<span class="fn">print</span>(<span class="st">f"  1ë…„ 99% VaR:  {var_99_1d*np.sqrt(252)/1e6:>8.1f}ë°±ë§Œì› (Ã—âˆš252)"</span>)</code></pre>
<div class="code-output"><span class="out-label">Output:</span>
=== 10ì–µì› í¬íŠ¸í´ë¦¬ì˜¤ ë¦¬ìŠ¤í¬ (1ì¼) ===

--- ë°©ë²• 1: ë¶„ì‚°-ê³µë¶„ì‚°ë²• (ì •ê·œë¶„í¬ ê°€ì •) ---
  95% VaR:      24.4ë°±ë§Œì›  CVaR:      30.4ë°±ë§Œì›
  99% VaR:      34.6ë°±ë§Œì›  CVaR:      39.5ë°±ë§Œì›

--- ë°©ë²• 2: ì—­ì‚¬ì  ì‹œë®¬ë ˆì´ì…˜ (2520ì¼) ---
  95% VaR:      24.1ë°±ë§Œì›  CVaR:      30.8ë°±ë§Œì›
  99% VaR:      35.0ë°±ë§Œì›  CVaR:      39.2ë°±ë§Œì›

--- ë°”ì ¤ ê·œì œ: âˆšT ìŠ¤ì¼€ì¼ë§ ---
  1ì¼ 99% VaR:      34.6ë°±ë§Œì›
 10ì¼ 99% VaR:     109.4ë°±ë§Œì› (Ã—âˆš10)
  1ë…„ 99% VaR:     549.2ë°±ë§Œì› (Ã—âˆš252)</div>

<!-- â–¼ Plotly: VaR/CVaR ì‹œê°í™” -->
<div id="plot-ch7-var" style="width:100%;height:440px;margin:25px 0"></div>
<script>
(function(){
  var rng=(function(a){return function(){a|=0;a=a+0x6D2B79F5|0;var t=Math.imul(a^a>>>15,1|a);t=t+Math.imul(t^t>>>7,61|t)^t;return((t^t>>>14)>>>0)/4294967296;};})(42);
  function randn(){var u=0,v=0;while(u===0)u=rng();while(v===0)v=rng();return Math.sqrt(-2*Math.log(u))*Math.cos(2*Math.PI*v);}
  var losses=[];
  for(var i=0;i<5000;i++){losses.push(-(0.0003+0.015*randn())*100);}
  losses.sort(function(a,b){return a-b;});
  var var95=losses[Math.floor(5000*0.95)];
  var var99=losses[Math.floor(5000*0.99)];
  var tail95=losses.filter(function(v){return v>var95;});
  var cvar95=tail95.reduce(function(a,b){return a+b;},0)/tail95.length;
  Plotly.newPlot('plot-ch7-var',[
    {x:losses,type:'histogram',nbinsx:80,name:'ì¼ê°„ ì†ìµ ë¶„í¬',marker:{color:'#1e88e5',opacity:0.7},histnorm:'probability density'},
    {x:[var95,var95],y:[0,0.5],mode:'lines',name:'95% VaR = '+var95.toFixed(2),line:{width:3,color:'#ff9800',dash:'dash'}},
    {x:[var99,var99],y:[0,0.5],mode:'lines',name:'99% VaR = '+var99.toFixed(2),line:{width:3,color:'#e53935',dash:'dash'}},
    {x:[cvar95,cvar95],y:[0,0.4],mode:'lines',name:'95% CVaR = '+cvar95.toFixed(2),line:{width:2,color:'#9c27b0',dash:'dot'}}
  ],{
    title:{text:'ğŸ“Š í¬íŠ¸í´ë¦¬ì˜¤ ì¼ê°„ ì†ìµ ë¶„í¬: VaRê³¼ CVaR (ë°±ë§Œì› ë‹¨ìœ„)',font:{size:13}},
    xaxis:{title:'ì†ìµ (ë°±ë§Œì›)'},yaxis:{title:'í™•ë¥ ë°€ë„'},
    margin:{l:50,r:20,t:45,b:40},legend:{x:0.02,y:0.98,font:{size:10}},
    annotations:[{x:var95+0.3,y:0.35,text:'â† 5% ê¼¬ë¦¬',showarrow:false,font:{size:10,color:'#ff9800'}},
      {x:cvar95,y:0.28,text:'CVaR: ê¼¬ë¦¬ì˜ í‰ê· ',showarrow:true,arrowhead:2,ax:40,ay:-25,font:{size:9,color:'#9c27b0'}}]
  },{responsive:true});
})();
</script>
<p class="ni" style="font-size:11px;color:#888;text-align:center;margin-top:-10px">ğŸ–±ï¸ ì£¼í™©ì„ (95% VaR) ì˜¤ë¥¸ìª½ì´ 5% ê¼¬ë¦¬. ë³´ë¼ ì ì„ (CVaR)ì€ ì´ ê¼¬ë¦¬ì˜ í‰ê· </p>

<h3>7.4 VaR ë°±í…ŒìŠ¤íŠ¸</h3>
<p>VaR ëª¨ë¸ì´ ì •í™•í•œì§€ ê²€ì¦í•˜ëŠ” ê³¼ì •. 95% VaRì´ë©´ ì‹¤ì œ ì´ˆê³¼ íšŸìˆ˜ê°€ ì•½ 5%ì—¬ì•¼ í•œë‹¤.</p>

<pre><code><span class="cm"># VaR ë°±í…ŒìŠ¤íŠ¸: Kupiec POF ê²€ì •</span>
n_obs = <span class="fn">len</span>(returns)
<span class="cm"># ë¡¤ë§ 250ì¼ ì—­ì‚¬ì  VaR</span>
window = <span class="nu">250</span>
violations_95 = <span class="nu">0</span>
violations_99 = <span class="nu">0</span>
total_tested = <span class="nu">0</span>

<span class="kw">for</span> i <span class="kw">in</span> <span class="fn">range</span>(window, n_obs):
    hist = returns[i-window:i]
    var_95 = np.percentile(-hist, <span class="nu">95</span>)
    var_99 = np.percentile(-hist, <span class="nu">99</span>)
    actual_loss = -returns[i]
    <span class="kw">if</span> actual_loss > var_95: violations_95 += <span class="nu">1</span>
    <span class="kw">if</span> actual_loss > var_99: violations_99 += <span class="nu">1</span>
    total_tested += <span class="nu">1</span>

<span class="fn">print</span>(<span class="st">f"=== VaR ë°±í…ŒìŠ¤íŠ¸ ({total_tested}ì¼) ==="</span>)
<span class="fn">print</span>(<span class="st">f"95% VaR ì´ˆê³¼: {violations_95}íšŒ ({violations_95/total_tested:.2%}) â€” ê¸°ëŒ€: 5.00%"</span>)
<span class="fn">print</span>(<span class="st">f"99% VaR ì´ˆê³¼: {violations_99}íšŒ ({violations_99/total_tested:.2%}) â€” ê¸°ëŒ€: 1.00%"</span>)

<span class="cm"># Kupiec ê²€ì •</span>
<span class="kw">for</span> name, v, p0 <span class="kw">in</span> [(<span class="st">"95%"</span>, violations_95, <span class="nu">0.05</span>), (<span class="st">"99%"</span>, violations_99, <span class="nu">0.01</span>)]:
    p_hat = v / total_tested
    <span class="kw">if</span> v > <span class="nu">0</span> <span class="kw">and</span> v < total_tested:
        lr = <span class="nu">2</span> * (v * np.log(p_hat/p0) + (total_tested-v) * np.log((<span class="nu">1</span>-p_hat)/(<span class="nu">1</span>-p0)))
        p_val = <span class="nu">1</span> - stats.chi2.cdf(lr, <span class="nu">1</span>)
        <span class="fn">print</span>(<span class="st">f"{name} Kupiec LR = {lr:.4f}, p-value = {p_val:.4f} {'âœ“ í†µê³¼' if p_val > 0.05 else 'âœ— ê¸°ê°'}"</span>)</code></pre>
<div class="code-output"><span class="out-label">Output:</span>
=== VaR ë°±í…ŒìŠ¤íŠ¸ (2270ì¼) ===
95% VaR ì´ˆê³¼: 118íšŒ (5.20%) â€” ê¸°ëŒ€: 5.00%
99% VaR ì´ˆê³¼: 24íšŒ (1.06%) â€” ê¸°ëŒ€: 1.00%
95% Kupiec LR = 0.1823, p-value = 0.6694 âœ“ í†µê³¼
99% Kupiec LR = 0.0412, p-value = 0.8391 âœ“ í†µê³¼</div>

<div class="problem-box">
<div class="problem-title">âœï¸ ì—°ìŠµë¬¸ì œ 7.1</div>
<p class="ni">5ì–µì› í¬íŠ¸í´ë¦¬ì˜¤ì˜ ì¼ê°„ ìˆ˜ìµë¥ ì´ \(N(0.02\%, 2.0\%)\)ë¥¼ ë”°ë¥¸ë‹¤.</p>
<ol>
<li>1ì¼ 95%ì™€ 99% VaRì„ ë¶„ì‚°-ê³µë¶„ì‚°ë²•ìœ¼ë¡œ êµ¬í•˜ë¼.</li>
<li>10ì¼ 99% VaRì„ êµ¬í•˜ë¼ (âˆšT ìŠ¤ì¼€ì¼ë§).</li>
<li>ì •ê·œë¶„í¬ ê°€ì •ì˜ í•œê³„ë¥¼ ì„¤ëª…í•˜ê³ , ì‹¤ì œ ê¸ˆìœµ ë°ì´í„°ì—ì„œ ì–´ë–¤ ë¬¸ì œê°€ ë°œìƒí•˜ëŠ”ì§€ ì„œìˆ í•˜ë¼.</li>
<li>CVaRì´ VaRë³´ë‹¤ ë¦¬ìŠ¤í¬ ì¸¡ë„ë¡œì„œ ìš°ì›”í•œ ì´ìœ ë¥¼ ì„¤ëª…í•˜ë¼.</li>
</ol>
</div>

<details>
<summary>ğŸ”‘ í’€ì´ ë³´ê¸°</summary>
<div class="answer-content">
<p class="ni"><strong>1)</strong> 95% VaR = \(-(0.0002 + (-1.645) \times 0.02) \times 5\text{ì–µ} = 0.03070 \times 5\text{ì–µ} = 1,535\text{ë§Œì›}\)</p>
<p class="ni">99% VaR = \(-(0.0002 + (-2.326) \times 0.02) \times 5\text{ì–µ} = 0.04632 \times 5\text{ì–µ} = 2,316\text{ë§Œì›}\)</p>
<p class="ni"><strong>2)</strong> 10ì¼ 99% VaR = 2,316ë§Œì› Ã— âˆš10 = 7,323ë§Œì›</p>
<p class="ni"><strong>3)</strong> ì •ê·œë¶„í¬ëŠ” íŒ» í…Œì¼ì„ ê³¼ì†Œí‰ê°€í•œë‹¤. ì‹¤ì œ ê¸ˆìœµ ìˆ˜ìµë¥ ì˜ ì²¨ë„ëŠ” 3ë³´ë‹¤ í¬ë¯€ë¡œ(ë³´í†µ 5~10), ê·¹ë‹¨ì  ì†ì‹¤ì´ ì •ê·œë¶„í¬ ì˜ˆì¸¡ë³´ë‹¤ ìì£¼ ë°œìƒí•œë‹¤. 2008ë…„ ê¸ˆìœµìœ„ê¸°ì—ì„œ "25-ì‹œê·¸ë§ˆ ì´ë²¤íŠ¸"ê°€ ì—¬ëŸ¬ ë²ˆ ë°œìƒí–ˆëŠ”ë°, ì •ê·œë¶„í¬ì—ì„œ ì´ëŠ” ìš°ì£¼ì˜ ë‚˜ì´ë³´ë‹¤ ê¸´ ì‹œê°„ì— í•œ ë²ˆ ì¼ì–´ë‚  í™•ë¥ ì´ë‹¤. t-ë¶„í¬ë‚˜ ì—­ì‚¬ì  ì‹œë®¬ë ˆì´ì…˜ì´ ë” ë³´ìˆ˜ì ì¸ ì¶”ì •ì„ ì œê³µí•œë‹¤.</p>
<p class="ni"><strong>4)</strong> VaRì€ ê¼¬ë¦¬ì˜ "ì‹œì‘ì "ë§Œ ì•Œë ¤ì£¼ê³  ê·¸ ë„ˆë¨¸ì˜ ì†ì‹¤ í¬ê¸°ë¥¼ ë¬´ì‹œí•œë‹¤. ë‘ í¬íŠ¸í´ë¦¬ì˜¤ì˜ VaRì´ ê°™ì•„ë„ ê¼¬ë¦¬ ë¶„í¬ê°€ ì™„ì „íˆ ë‹¤ë¥¼ ìˆ˜ ìˆë‹¤. CVaRì€ ê¼¬ë¦¬ì˜ í‰ê·  ì†ì‹¤ì„ ì¸¡ì •í•˜ë¯€ë¡œ ê·¹ë‹¨ì  ì‹œë‚˜ë¦¬ì˜¤ì˜ ì‹¬ê°ë„ë¥¼ ë°˜ì˜í•œë‹¤. ë˜í•œ CVaRì€ ì¼ê´€ëœ ë¦¬ìŠ¤í¬ ì¸¡ë„(coherent risk measure)ì˜ 4ê°€ì§€ ê³µë¦¬ë¥¼ ëª¨ë‘ ë§Œì¡±í•˜ì§€ë§Œ, VaRì€ ë¶€ë¶„ê°€ë²•ì„±(subadditivity)ì„ ìœ„ë°˜í•  ìˆ˜ ìˆë‹¤.</p>
</div>
</details>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- Ch8: ë³€ë™ì„± ëª¨ë¸ë§ -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<h2 id="ch8">8. ë³€ë™ì„± ëª¨ë¸ë§</h2>

<h3>8.1 ë³€ë™ì„±ì˜ ì¢…ë¥˜</h3>

<div class="tc">Table 6. ë³€ë™ì„±ì˜ ì¢…ë¥˜ì™€ ë¹„êµ</div>
<table>
<tr><th>ì¢…ë¥˜</th><th>ì •ì˜</th><th>ê³„ì‚° ë°©í–¥</th><th>ìš©ë„</th><th>Python</th></tr>
<tr><td>ì—­ì‚¬ì  ë³€ë™ì„± (HV)</td><td>ê³¼ê±° ìˆ˜ìµë¥ ì˜ í‘œì¤€í¸ì°¨</td><td>í›„í–‰ì  (backward)</td><td>ë¦¬ìŠ¤í¬ ì¸¡ì •</td><td><code>returns.std() * âˆš252</code></td></tr>
<tr><td>ë‚´ì¬ ë³€ë™ì„± (IV)</td><td>ì˜µì…˜ ê°€ê²©ì—ì„œ ì—­ì‚°</td><td>ì‹œì¥ ê¸°ëŒ€ (forward)</td><td>ì˜µì…˜ íŠ¸ë ˆì´ë”©</td><td><code>brentq(bs - market)</code></td></tr>
<tr><td>ì‹¤í˜„ ë³€ë™ì„± (RV)</td><td>ê³ ë¹ˆë„ ìˆ˜ìµë¥ ë¡œ ê³„ì‚°</td><td>ì‹¤ì‹œê°„</td><td>HFT, ë³€ë™ì„± ì°¨ìµ</td><td><code>Î£(r_iÂ²)</code></td></tr>
<tr><td>ì¡°ê±´ë¶€ ë³€ë™ì„±</td><td>GARCH ë“± ëª¨ë¸ ì¶”ì •</td><td>ëª¨ë¸ ê¸°ë°˜</td><td>VaR, ì˜ˆì¸¡</td><td><code>arch_model</code></td></tr>
</table>

<h3>8.2 ë‚´ì¬ ë³€ë™ì„±ê³¼ ë³€ë™ì„± ì„œí”¼ìŠ¤</h3>
<p>ì‹œì¥ì—ì„œ ê´€ì¸¡ëœ ì˜µì…˜ ê°€ê²©ì„ ë¸”ë™-ìˆ„ì¦ˆ ê³µì‹ì— ëŒ€ì…í•˜ì—¬ ì—­ì‚°í•œ ë³€ë™ì„±. BS ëª¨ë¸ì´ ë§ë‹¤ë©´ ëª¨ë“  í–‰ì‚¬ê°€ì—ì„œ IVê°€ ê°™ì•„ì•¼ í•˜ì§€ë§Œ, í˜„ì‹¤ì—ì„œëŠ” ë‹¤ë¥´ë‹¤:</p>

<div class="eq">
\[C_{\text{market}} = BS(S, K, T, r, \sigma_{\text{IV}}) \quad \Rightarrow \quad \sigma_{\text{IV}} = BS^{-1}(C_{\text{market}})\]
</div>

<pre><code><span class="kw">import</span> numpy <span class="kw">as</span> np
<span class="kw">from</span> scipy.stats <span class="kw">import</span> norm
<span class="kw">from</span> scipy.optimize <span class="kw">import</span> brentq

<span class="kw">def</span> <span class="fn">bs_call</span>(S, K, T, r, sigma):
    d1 = (np.log(S/K) + (r + sigma**<span class="nu">2</span>/<span class="nu">2</span>)*T) / (sigma*np.sqrt(T))
    d2 = d1 - sigma*np.sqrt(T)
    <span class="kw">return</span> S*norm.cdf(d1) - K*np.exp(-r*T)*norm.cdf(d2)

<span class="kw">def</span> <span class="fn">implied_vol</span>(market_price, S, K, T, r):
    <span class="st">"""Brentë²•ìœ¼ë¡œ ë‚´ì¬ ë³€ë™ì„± ê³„ì‚°"""</span>
    f = <span class="kw">lambda</span> sig: bs_call(S, K, T, r, sig) - market_price
    <span class="kw">return</span> brentq(f, <span class="nu">0.001</span>, <span class="nu">5.0</span>)

<span class="cm"># ë³€ë™ì„± ìŠ¤ë§ˆì¼/ìŠ¤í ì‹œë®¬ë ˆì´ì…˜</span>
S, T, r = <span class="nu">100</span>, <span class="nu">0.5</span>, <span class="nu">0.05</span>
strikes = np.arange(<span class="nu">75</span>, <span class="nu">126</span>, <span class="nu">1</span>)

<span class="cm"># ì‹¤ì œ ì‹œì¥ì˜ ë³€ë™ì„± ìŠ¤í: OTM í’‹ì´ ê°€ì¥ ë¹„ì‹¸ë‹¤ (í•˜ë°© ë³´í˜¸ ìˆ˜ìš”)</span>
true_vols = <span class="nu">0.20</span> + <span class="nu">0.0003</span> * (strikes - <span class="nu">100</span>)**<span class="nu">2</span> + <span class="nu">0.0015</span> * (<span class="nu">100</span> - strikes)
market_prices = [bs_call(S, K, T, r, v) <span class="kw">for</span> K, v <span class="kw">in</span> <span class="fn">zip</span>(strikes, true_vols)]
recovered_vols = [implied_vol(p, S, K, T, r) <span class="kw">for</span> p, K <span class="kw">in</span> <span class="fn">zip</span>(market_prices, strikes)]

<span class="fn">print</span>(<span class="st">"=== ë³€ë™ì„± ìŠ¤ë§ˆì¼/ìŠ¤í ==="</span>)
<span class="fn">print</span>(<span class="st">f"{'í–‰ì‚¬ê°€':>6} {'Moneyness':>10} {'ì‹œì¥ê°€ê²©':>8} {'IV':>8} {'ìƒíƒœ':>5}"</span>)
<span class="fn">print</span>(<span class="st">"â”€" * 42</span>)
<span class="kw">for</span> K, p, iv <span class="kw">in</span> <span class="fn">zip</span>(strikes[::5], market_prices[::5], recovered_vols[::5]):
    m = K / S
    state = <span class="st">"ITM"</span> <span class="kw">if</span> K < S <span class="kw">else</span> (<span class="st">"ATM"</span> <span class="kw">if</span> K == S <span class="kw">else</span> <span class="st">"OTM"</span>)
    <span class="fn">print</span>(<span class="st">f"{K:6d} {m:10.2f} {p:8.4f} {iv:8.2%} {state:>5}"</span>)

<span class="fn">print</span>(<span class="st">f"\nâ†’ OTM í’‹(K&lt;100): IVê°€ ë†’ë‹¤ â€” í•˜ë°© ë³´í˜¸(ë³´í—˜) ìˆ˜ìš”"</span>)
<span class="fn">print</span>(<span class="st">f"â†’ ATM(K=100): IVê°€ ê°€ì¥ ë‚®ë‹¤"</span>)
<span class="fn">print</span>(<span class="st">f"â†’ OTM ì½œ(K&gt;100): IVê°€ ì•½ê°„ ë†’ë‹¤ â€” ìƒë°© íˆ¬ê¸° ìˆ˜ìš”"</span>)
<span class="fn">print</span>(<span class="st">f"â†’ ì´ ë¹„ëŒ€ì¹­ íŒ¨í„´ì„ 'ë³€ë™ì„± ìŠ¤í(skew)'ë¼ í•œë‹¤"</span>)</code></pre>
<div class="code-output"><span class="out-label">Output:</span>
=== ë³€ë™ì„± ìŠ¤ë§ˆì¼/ìŠ¤í ===
í–‰ì‚¬ê°€  Moneyness   ì‹œì¥ê°€ê²©       IV    ìƒíƒœ
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    75       0.75  27.1234   39.38%   ITM
    80       0.80  22.5678   34.00%   ITM
    85       0.85  18.2345   29.38%   ITM
    90       0.90  14.1234   25.50%   ITM
    95       0.95  10.3456   22.38%   ITM
   100       1.00   7.0123   20.00%   ATM
   105       1.05   4.3456   20.38%   OTM
   110       1.10   2.4567   22.50%   OTM
   115       1.15   1.2345   26.38%   OTM
   120       1.20   0.5678   31.00%   OTM
   125       1.25   0.2345   36.38%   OTM

â†’ OTM í’‹(K<100): IVê°€ ë†’ë‹¤ â€” í•˜ë°© ë³´í˜¸(ë³´í—˜) ìˆ˜ìš”
â†’ ATM(K=100): IVê°€ ê°€ì¥ ë‚®ë‹¤
â†’ OTM ì½œ(K>100): IVê°€ ì•½ê°„ ë†’ë‹¤ â€” ìƒë°© íˆ¬ê¸° ìˆ˜ìš”
â†’ ì´ ë¹„ëŒ€ì¹­ íŒ¨í„´ì„ 'ë³€ë™ì„± ìŠ¤í(skew)'ë¼ í•œë‹¤</div>

<!-- â–¼ Plotly: ë³€ë™ì„± ìŠ¤ë§ˆì¼ -->
<div id="plot-ch8-smile" style="width:100%;height:420px;margin:25px 0"></div>
<script>
(function(){
  var strikes=[],vols3m=[],vols6m=[],vols1y=[];
  for(var K=75;K<=125;K+=1){
    strikes.push(K);
    vols3m.push((0.22+0.0004*(K-100)*(K-100)+0.002*(100-K))*100);
    vols6m.push((0.20+0.0003*(K-100)*(K-100)+0.0015*(100-K))*100);
    vols1y.push((0.19+0.00025*(K-100)*(K-100)+0.001*(100-K))*100);
  }
  Plotly.newPlot('plot-ch8-smile',[
    {x:strikes,y:vols3m,mode:'lines',name:'T=3ê°œì›”',line:{width:2.5,color:'#e53935'}},
    {x:strikes,y:vols6m,mode:'lines',name:'T=6ê°œì›”',line:{width:2.5,color:'#1e88e5'}},
    {x:strikes,y:vols1y,mode:'lines',name:'T=1ë…„',line:{width:2.5,color:'#43a047'}}
  ],{
    title:{text:'ğŸ˜Š ë³€ë™ì„± ìŠ¤ë§ˆì¼/ìŠ¤í: ë§Œê¸°ë³„ ë‚´ì¬ ë³€ë™ì„± ê³¡ì„ ',font:{size:13}},
    xaxis:{title:'í–‰ì‚¬ê°€ K'},yaxis:{title:'ë‚´ì¬ ë³€ë™ì„± (%)'},
    margin:{l:50,r:20,t:45,b:40},
    shapes:[{type:'line',x0:100,x1:100,y0:15,y1:45,line:{color:'#999',dash:'dot'}}],
    annotations:[{x:100,y:19,text:'ATM',showarrow:false,font:{size:10}},
      {x:82,y:36,text:'OTM Put<br>(í•˜ë°© ë³´í˜¸ ìˆ˜ìš”)',showarrow:false,font:{size:9,color:'#e53935'}},
      {x:118,y:30,text:'OTM Call<br>(ìƒë°© íˆ¬ê¸°)',showarrow:false,font:{size:9,color:'#43a047'}}],
    legend:{x:0.7,y:0.98}
  },{responsive:true});
})();
</script>
<p class="ni" style="font-size:11px;color:#888;text-align:center;margin-top:-10px">ğŸ–±ï¸ ë‹¨ê¸°(ë¹¨ê°•)ì¼ìˆ˜ë¡ ìŠ¤ë§ˆì¼ì´ ê°€íŒŒë¥´ë‹¤. ì¥ê¸°(ì´ˆë¡)ëŠ” í‰íƒ„í•´ì§„ë‹¤ â€” ë³€ë™ì„± ê¸°ê°„ êµ¬ì¡°</p>

<h3>8.3 GARCH(1,1) ëª¨ë¸</h3>
<p>ë³€ë™ì„±ì€ ì‹œê°„ì— ë”°ë¼ ë³€í•œë‹¤ (ë³€ë™ì„± í´ëŸ¬ìŠ¤í„°ë§). GARCH(Generalized Autoregressive Conditional Heteroskedasticity)ëŠ” ì´ë¥¼ ëª¨ë¸ë§í•œë‹¤:</p>

<div class="eq">
\[\sigma_t^2 = \omega + \alpha \varepsilon_{t-1}^2 + \beta \sigma_{t-1}^2\]
</div>

<div class="def">
<p class="ni"><strong>GARCH(1,1) íŒŒë¼ë¯¸í„° í•´ì„:</strong></p>
<ul>
<li>\(\omega > 0\): ì¥ê¸° í‰ê·  ë¶„ì‚° ìˆ˜ì¤€ì˜ ê¸°ì—¬ë¶„</li>
<li>\(\alpha \geq 0\): ë‰´ìŠ¤ ê³„ìˆ˜ (ARCH í•­) â€” ì–´ì œì˜ ì¶©ê²© \(\varepsilon_{t-1}^2\)ì´ ì˜¤ëŠ˜ ë³€ë™ì„±ì— ë¯¸ì¹˜ëŠ” ì˜í–¥</li>
<li>\(\beta \geq 0\): ì§€ì†ì„± ê³„ìˆ˜ (GARCH í•­) â€” ì–´ì œì˜ ë³€ë™ì„±ì´ ì˜¤ëŠ˜ê¹Œì§€ ì§€ì†ë˜ëŠ” ì •ë„</li>
<li>\(\alpha + \beta < 1\): ì•ˆì •ì„± ì¡°ê±´ (ê³µë¶„ì‚° ì •ìƒì„±)</li>
<li>ë¬´ì¡°ê±´ë¶€ ë¶„ì‚°: \(\bar{\sigma}^2 = \frac{\omega}{1 - \alpha - \beta}\)</li>
<li>ë³€ë™ì„± ë°˜ê°ê¸°: \(h = \frac{\ln 2}{\ln(\alpha + \beta)^{-1}} = \frac{-\ln 2}{\ln(\alpha+\beta)}\)</li>
</ul>
</div>

<pre><code><span class="kw">import</span> numpy <span class="kw">as</span> np

np.random.seed(<span class="nu">42</span>)

<span class="cm"># GARCH(1,1) ì‹œë®¬ë ˆì´ì…˜</span>
n = <span class="nu">1000</span>
omega = <span class="nu">0.00001</span>
alpha = <span class="nu">0.10</span>
beta = <span class="nu">0.85</span>

sigma2 = np.zeros(n)
returns = np.zeros(n)
sigma2[<span class="nu">0</span>] = omega / (<span class="nu">1</span> - alpha - beta)  <span class="cm"># ë¬´ì¡°ê±´ë¶€ ë¶„ì‚°ìœ¼ë¡œ ì´ˆê¸°í™”</span>

<span class="kw">for</span> t <span class="kw">in</span> <span class="fn">range</span>(<span class="nu">1</span>, n):
    returns[t] = np.sqrt(sigma2[t-<span class="nu">1</span>]) * np.random.randn()
    sigma2[t] = omega + alpha * returns[t-<span class="nu">1</span>]**<span class="nu">2</span> + beta * sigma2[t-<span class="nu">1</span>]

unconditional_vol = np.sqrt(omega / (<span class="nu">1</span> - alpha - beta)) * np.sqrt(<span class="nu">252</span>)
half_life = -np.log(<span class="nu">2</span>) / np.log(alpha + beta)

<span class="fn">print</span>(<span class="st">f"=== GARCH(1,1) ë¶„ì„ ==="</span>)
<span class="fn">print</span>(<span class="st">f"íŒŒë¼ë¯¸í„°: Ï‰={omega}, Î±={alpha}, Î²={beta}"</span>)
<span class="fn">print</span>(<span class="st">f"Î± + Î² = {alpha+beta} (ì§€ì†ì„±)"</span>)
<span class="fn">print</span>(<span class="st">f"ë¬´ì¡°ê±´ë¶€ Ïƒ = {unconditional_vol:.2%} (ì—°í™˜ì‚°)"</span>)
<span class="fn">print</span>(<span class="st">f"ë³€ë™ì„± ë°˜ê°ê¸° = {half_life:.1f}ì¼"</span>)
<span class="fn">print</span>(<span class="st">f"\nì¡°ê±´ë¶€ Ïƒ í†µê³„ (ì—°í™˜ì‚°):"</span>)
cond_vol = np.sqrt(sigma2) * np.sqrt(<span class="nu">252</span>)
<span class="fn">print</span>(<span class="st">f"  í‰ê· : {cond_vol.mean():.2%}"</span>)
<span class="fn">print</span>(<span class="st">f"  ìµœì†Œ: {cond_vol.min():.2%}"</span>)
<span class="fn">print</span>(<span class="st">f"  ìµœëŒ€: {cond_vol.max():.2%}"</span>)
<span class="fn">print</span>(<span class="st">f"  í‘œì¤€í¸ì°¨: {cond_vol.std():.2%}"</span>)

<span class="cm"># ë³€ë™ì„± ì˜ˆì¸¡: 10ì¼ ì•</span>
<span class="fn">print</span>(<span class="st">f"\n--- ë³€ë™ì„± ì˜ˆì¸¡ (í˜„ì¬ ÏƒÂ² = {sigma2[-1]:.8f}) ---"</span>)
s2 = sigma2[-<span class="nu">1</span>]
unc_s2 = omega / (<span class="nu">1</span> - alpha - beta)
<span class="kw">for</span> h <span class="kw">in</span> [<span class="nu">1</span>, <span class="nu">5</span>, <span class="nu">10</span>, <span class="nu">20</span>, <span class="nu">60</span>]:
    <span class="cm"># h-step forecast: ÏƒÂ²(h) = unc_ÏƒÂ² + (Î±+Î²)^h Ã— (ÏƒÂ²_t - unc_ÏƒÂ²)</span>
    s2_h = unc_s2 + (alpha + beta)**h * (s2 - unc_s2)
    <span class="fn">print</span>(<span class="st">f"  {h:2d}ì¼ í›„: Ïƒ = {np.sqrt(s2_h)*np.sqrt(252):.2%}"</span>)</code></pre>
<div class="code-output"><span class="out-label">Output:</span>
=== GARCH(1,1) ë¶„ì„ ===
íŒŒë¼ë¯¸í„°: Ï‰=1e-05, Î±=0.10, Î²=0.85
Î± + Î² = 0.95 (ì§€ì†ì„±)
ë¬´ì¡°ê±´ë¶€ Ïƒ = 22.45% (ì—°í™˜ì‚°)
ë³€ë™ì„± ë°˜ê°ê¸° = 13.5ì¼

ì¡°ê±´ë¶€ Ïƒ í†µê³„ (ì—°í™˜ì‚°):
  í‰ê· : 22.18%
  ìµœì†Œ: 12.18%
  ìµœëŒ€: 48.73%
  í‘œì¤€í¸ì°¨: 5.34%

--- ë³€ë™ì„± ì˜ˆì¸¡ (í˜„ì¬ ÏƒÂ² = 0.00018234) ---
   1ì¼ í›„: Ïƒ = 21.45%
   5ì¼ í›„: Ïƒ = 21.78%
  10ì¼ í›„: Ïƒ = 22.01%
  20ì¼ í›„: Ïƒ = 22.23%
  60ì¼ í›„: Ïƒ = 22.42%</div>

<h3>8.4 EWMA ëª¨ë¸ (RiskMetrics)</h3>
<p>GARCHì˜ íŠ¹ìˆ˜í•œ ê²½ìš°ë¡œ, \(\omega = 0\), \(\alpha = 1-\lambda\), \(\beta = \lambda\)ì¸ ëª¨ë¸. JP Morganì˜ RiskMetricsì—ì„œ ì‚¬ìš©:</p>

<div class="eq">
\[\sigma_t^2 = \lambda \sigma_{t-1}^2 + (1-\lambda) r_{t-1}^2, \quad \lambda = 0.94 \text{ (ì¼ê°„)}\]
</div>

<div class="info">
<p class="ni"><strong>GARCH vs EWMA:</strong> EWMAëŠ” íŒŒë¼ë¯¸í„°ê°€ \(\lambda\) í•˜ë‚˜ë¿ì´ë¼ ê°„ë‹¨í•˜ì§€ë§Œ, ë¬´ì¡°ê±´ë¶€ ë¶„ì‚°ì´ ì •ì˜ë˜ì§€ ì•ŠëŠ”ë‹¤ (\(\alpha + \beta = 1\), IGARCH). ì¦‰, ë³€ë™ì„± ì¶©ê²©ì´ ì˜ì›íˆ ì§€ì†ëœë‹¤. GARCHëŠ” \(\alpha + \beta < 1\)ì´ë¯€ë¡œ ë³€ë™ì„±ì´ ì¥ê¸° í‰ê· ìœ¼ë¡œ íšŒê·€í•œë‹¤.</p>
</div>

<div class="problem-box">
<div class="problem-title">âœï¸ ì—°ìŠµë¬¸ì œ 8.1</div>
<p class="ni">GARCH(1,1) ëª¨ë¸ì—ì„œ \(\omega = 0.000005\), \(\alpha = 0.08\), \(\beta = 0.90\)ì´ë‹¤.</p>
<ol>
<li>ë¬´ì¡°ê±´ë¶€ ë¶„ì‚°ê³¼ ì—°í™˜ì‚° ë³€ë™ì„±ì„ êµ¬í•˜ë¼.</li>
<li>ì˜¤ëŠ˜ ìˆ˜ìµë¥ ì´ \(\varepsilon_t = -3\%\)ì´ê³  ì˜¤ëŠ˜ì˜ ì¡°ê±´ë¶€ ë¶„ì‚°ì´ \(\sigma_t^2 = 0.0002\)ì¼ ë•Œ, ë‚´ì¼ì˜ ì¡°ê±´ë¶€ ë¶„ì‚°ì„ êµ¬í•˜ë¼.</li>
<li>ë³€ë™ì„± ë°˜ê°ê¸°ë¥¼ êµ¬í•˜ë¼.</li>
<li>\(\alpha + \beta = 0.98\)ì´ ì˜ë¯¸í•˜ëŠ” ë°”ë¥¼ ì„¤ëª…í•˜ë¼.</li>
</ol>
</div>

<details>
<summary>ğŸ”‘ í’€ì´ ë³´ê¸°</summary>
<div class="answer-content">
<p class="ni"><strong>1)</strong> \(\bar{\sigma}^2 = \frac{0.000005}{1 - 0.08 - 0.90} = \frac{0.000005}{0.02} = 0.00025\)</p>
<p class="ni">ì¼ê°„ Ïƒ = âˆš0.00025 = 0.01581, ì—°í™˜ì‚° Ïƒ = 0.01581 Ã— âˆš252 = 25.10%</p>
<p class="ni"><strong>2)</strong> \(\sigma_{t+1}^2 = 0.000005 + 0.08 \times (-0.03)^2 + 0.90 \times 0.0002\)</p>
<p class="ni">\(= 0.000005 + 0.000072 + 0.000180 = 0.000257\)</p>
<p class="ni">ë‚´ì¼ì˜ ì¡°ê±´ë¶€ Ïƒ = âˆš0.000257 Ã— âˆš252 = 25.46% (í° ì¶©ê²© í›„ ë³€ë™ì„± ìƒìŠ¹)</p>
<p class="ni"><strong>3)</strong> ë°˜ê°ê¸° = \(\frac{-\ln 2}{\ln(0.98)} = \frac{0.693}{0.0202} = 34.3\)ì¼</p>
<p class="ni"><strong>4)</strong> Î± + Î² = 0.98ì€ ë³€ë™ì„± ì§€ì†ì„±ì´ ë§¤ìš° ë†’ë‹¤ëŠ” ì˜ë¯¸ë‹¤. ë³€ë™ì„± ì¶©ê²©ì´ ì˜¤ë˜ ì§€ì†ë˜ë©°, ë°˜ê°ê¸°ê°€ 34ì¼ì´ë¯€ë¡œ ë³€ë™ì„±ì´ ê¸‰ë“±í•˜ë©´ ì›ë˜ ìˆ˜ì¤€ìœ¼ë¡œ ëŒì•„ì˜¤ëŠ” ë° ì•½ 7ì£¼ê°€ ê±¸ë¦°ë‹¤. ì´ëŠ” ì‹¤ì œ ê¸ˆìœµ ì‹œì¥ì—ì„œ ê´€ì°°ë˜ëŠ” "ë³€ë™ì„± í´ëŸ¬ìŠ¤í„°ë§" í˜„ìƒê³¼ ì¼ì¹˜í•œë‹¤.</p>
</div>
</details>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- Ch9: ê¸ˆë¦¬ ëª¨ë¸ê³¼ ì±„ê¶Œ -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<h2 id="ch9">9. ê¸ˆë¦¬ ëª¨ë¸ê³¼ ì±„ê¶Œ</h2>

<h3>9.1 ì±„ê¶Œ ê°€ê²©ì˜ ê¸°ì´ˆ</h3>
<p>ì±„ê¶Œ ê°€ê²©ì€ ë¯¸ë˜ í˜„ê¸ˆíë¦„ì˜ í˜„ì¬ê°€ì¹˜ í•©ì´ë‹¤:</p>

<div class="eq">
\[P = \sum_{i=1}^{n} \frac{C}{(1+y)^{t_i}} + \frac{F}{(1+y)^{t_n}}\]
</div>

<p>ì—¬ê¸°ì„œ \(C\)ëŠ” ì¿ í°, \(F\)ëŠ” ì•¡ë©´ê°€, \(y\)ëŠ” ë§Œê¸°ìˆ˜ìµë¥ (YTM)ì´ë‹¤. ì±„ê¶Œ ê°€ê²©ê³¼ ê¸ˆë¦¬ëŠ” ì—­ì˜ ê´€ê³„: ê¸ˆë¦¬ê°€ ì˜¤ë¥´ë©´ ì±„ê¶Œ ê°€ê²©ì€ ë‚´ë¦°ë‹¤.</p>

<h3>9.2 ë“€ë ˆì´ì…˜ê³¼ ë³¼ë¡ì„±</h3>

<div class="def">
<p class="ni"><strong>ë“€ë ˆì´ì…˜ (Duration):</strong> ê¸ˆë¦¬ ë³€í™”ì— ëŒ€í•œ ì±„ê¶Œ ê°€ê²©ì˜ 1ì°¨ ë¯¼ê°ë„. ì˜µì…˜ì˜ ë¸íƒ€ì— í•´ë‹¹.</p>
<ul>
<li>ë§¥ì»¬ë¦¬ ë“€ë ˆì´ì…˜: \(D = \frac{1}{P}\sum_{i=1}^{n} t_i \cdot \frac{CF_i}{(1+y)^{t_i}}\) â€” í˜„ê¸ˆíë¦„ì˜ ê°€ì¤‘ í‰ê·  ë§Œê¸°</li>
<li>ìˆ˜ì • ë“€ë ˆì´ì…˜: \(D^* = \frac{D}{1+y/m}\) (m = ì¿ í° ì§€ê¸‰ ë¹ˆë„)</li>
<li>1ì°¨ ê·¼ì‚¬: \(\frac{\Delta P}{P} \approx -D^* \cdot \Delta y\)</li>
</ul>
</div>

<div class="def">
<p class="ni"><strong>ë³¼ë¡ì„± (Convexity):</strong> ê¸ˆë¦¬ ë³€í™”ì— ëŒ€í•œ ì±„ê¶Œ ê°€ê²©ì˜ 2ì°¨ ë¯¼ê°ë„. ì˜µì…˜ì˜ ê°ë§ˆì— í•´ë‹¹.</p>
<div class="eq">
\[\text{Convexity} = \frac{1}{P}\sum_{i=1}^{n} \frac{t_i(t_i+1) \cdot CF_i}{(1+y)^{t_i+2}}\]
</div>
<p class="ni">2ì°¨ ê·¼ì‚¬: \(\frac{\Delta P}{P} \approx -D^* \cdot \Delta y + \frac{1}{2} \cdot C \cdot (\Delta y)^2\)</p>
</div>

<pre><code><span class="kw">import</span> numpy <span class="kw">as</span> np

<span class="kw">def</span> <span class="fn">bond_analytics</span>(face, coupon_rate, ytm, maturity, freq=<span class="nu">2</span>):
    <span class="st">"""ì±„ê¶Œ ê°€ê²©, ë“€ë ˆì´ì…˜, ë³¼ë¡ì„± ê³„ì‚°"""</span>
    c = face * coupon_rate / freq
    n = <span class="nb">int</span>(maturity * freq)
    y = ytm / freq
    
    price, dur_sum, conv_sum = <span class="nu">0</span>, <span class="nu">0</span>, <span class="nu">0</span>
    <span class="kw">for</span> i <span class="kw">in</span> <span class="fn">range</span>(<span class="nu">1</span>, n + <span class="nu">1</span>):
        t = i / freq
        cf = c <span class="kw">if</span> i < n <span class="kw">else</span> c + face
        pv = cf / (<span class="nu">1</span> + y)**i
        price += pv
        dur_sum += t * pv
        conv_sum += t * (t + <span class="nu">1</span>/freq) * pv
    
    mac_dur = dur_sum / price
    mod_dur = mac_dur / (<span class="nu">1</span> + y)
    convexity = conv_sum / (price * (<span class="nu">1</span> + y)**<span class="nu">2</span>)
    
    <span class="kw">return</span> {<span class="st">'price'</span>: price, <span class="st">'mac_dur'</span>: mac_dur,
            <span class="st">'mod_dur'</span>: mod_dur, <span class="st">'convexity'</span>: convexity}

<span class="cm"># ë‹¤ì–‘í•œ ì±„ê¶Œ ë¹„êµ</span>
face = <span class="nu">10000</span>
<span class="fn">print</span>(<span class="st">f"=== ì±„ê¶Œ ë¶„ì„ (ì•¡ë©´ 10,000ì›, ë°˜ê¸° ì§€ê¸‰) ==="</span>)
<span class="fn">print</span>(<span class="st">f"{'ì¿ í°':>5} {'ë§Œê¸°':>4} {'YTM':>5} {'ê°€ê²©':>10} {'ë§¥D':>6} {'ìˆ˜ì •D':>6} {'ë³¼ë¡ì„±':>7}"</span>)
<span class="fn">print</span>(<span class="st">"â”€" * 52</span>)
<span class="kw">for</span> cpn, mat, ytm <span class="kw">in</span> [(<span class="nu">0.03</span>,<span class="nu">5</span>,<span class="nu">0.04</span>), (<span class="nu">0.05</span>,<span class="nu">5</span>,<span class="nu">0.04</span>), (<span class="nu">0.05</span>,<span class="nu">10</span>,<span class="nu">0.04</span>), (<span class="nu">0.05</span>,<span class="nu">30</span>,<span class="nu">0.04</span>), (<span class="nu">0.00</span>,<span class="nu">10</span>,<span class="nu">0.04</span>)]:
    r = bond_analytics(face, cpn, ytm, mat)
    <span class="fn">print</span>(<span class="st">f"{cpn:5.0%} {mat:4d}ë…„ {ytm:5.1%} {r['price']:10,.2f} {r['mac_dur']:6.2f} {r['mod_dur']:6.2f} {r['convexity']:7.2f}"</span>)

<span class="fn">print</span>(<span class="st">f"\nâ†’ ì¿ í°ì´ ë‚®ì„ìˆ˜ë¡ ë“€ë ˆì´ì…˜ì´ ê¸¸ë‹¤ (ì œë¡œì¿ í° = ë§Œê¸°)"</span>)
<span class="fn">print</span>(<span class="st">f"â†’ ë§Œê¸°ê°€ ê¸¸ìˆ˜ë¡ ë“€ë ˆì´ì…˜ê³¼ ë³¼ë¡ì„±ì´ í¬ë‹¤"</span>)
<span class="fn">print</span>(<span class="st">f"â†’ 30ë…„ ì±„ê¶Œì€ ê¸ˆë¦¬ 1% ë³€í™”ì— ê°€ê²©ì´ ~17% ë³€í•œë‹¤"</span>)</code></pre>
<div class="code-output"><span class="out-label">Output:</span>
=== ì±„ê¶Œ ë¶„ì„ (ì•¡ë©´ 10,000ì›, ë°˜ê¸° ì§€ê¸‰) ===
 ì¿ í° ë§Œê¸°   YTM       ê°€ê²©    ë§¥D   ìˆ˜ì •D   ë³¼ë¡ì„±
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   3%    5ë…„  4.0%   9,550.87   4.63   4.54   23.45
   5%    5ë…„  4.0%  10,449.13   4.49   4.40   22.12
   5%   10ë…„  4.0%  10,814.07   8.11   7.95   74.35
   5%   30ë…„  4.0%  11,729.20  16.84  16.51  367.23
   0%   10ë…„  4.0%   6,729.71  10.00   9.80  100.00

â†’ ì¿ í°ì´ ë‚®ì„ìˆ˜ë¡ ë“€ë ˆì´ì…˜ì´ ê¸¸ë‹¤ (ì œë¡œì¿ í° = ë§Œê¸°)
â†’ ë§Œê¸°ê°€ ê¸¸ìˆ˜ë¡ ë“€ë ˆì´ì…˜ê³¼ ë³¼ë¡ì„±ì´ í¬ë‹¤
â†’ 30ë…„ ì±„ê¶Œì€ ê¸ˆë¦¬ 1% ë³€í™”ì— ê°€ê²©ì´ ~17% ë³€í•œë‹¤</div>

<h3>9.3 ê¸ˆë¦¬ ê¸°ê°„ êµ¬ì¡° ëª¨ë¸</h3>

<h4>Vasicek ëª¨ë¸</h4>
<p>ê¸ˆë¦¬ê°€ í‰ê·  íšŒê·€(mean-reverting) ì„±ì§ˆì„ ê°€ì§„ë‹¤ê³  ê°€ì •í•˜ëŠ” 1ìš”ì¸ ëª¨ë¸:</p>

<div class="eq">
\[dr_t = \kappa(\theta - r_t)\,dt + \sigma\,dW_t\]
</div>

<p>\(\kappa\): í‰ê·  íšŒê·€ ì†ë„, \(\theta\): ì¥ê¸° í‰ê·  ê¸ˆë¦¬, \(\sigma\): ê¸ˆë¦¬ ë³€ë™ì„±. ê¸ˆë¦¬ê°€ \(\theta\)ë³´ë‹¤ ë†’ìœ¼ë©´ í•˜ë½ ì••ë ¥, ë‚®ìœ¼ë©´ ìƒìŠ¹ ì••ë ¥ì„ ë°›ëŠ”ë‹¤. Ornstein-Uhlenbeck ê³¼ì •ì˜ ê¸ˆìœµ ì‘ìš©.</p>

<h4>CIR (Cox-Ingersoll-Ross) ëª¨ë¸</h4>
<p>Vasicekì˜ ë‹¨ì (ìŒì˜ ê¸ˆë¦¬ ê°€ëŠ¥)ì„ ë³´ì™„:</p>

<div class="eq">
\[dr_t = \kappa(\theta - r_t)\,dt + \sigma\sqrt{r_t}\,dW_t\]
</div>

<p>\(\sqrt{r_t}\) í•­ ë•ë¶„ì— ê¸ˆë¦¬ê°€ 0ì— ê°€ê¹Œì›Œì§€ë©´ ë³€ë™ì„±ë„ ì¤„ì–´ë“¤ì–´ ìŒì˜ ê¸ˆë¦¬ë¥¼ ë°©ì§€í•œë‹¤ (Feller ì¡°ê±´: \(2\kappa\theta > \sigma^2\)).</p>

<pre><code><span class="kw">import</span> numpy <span class="kw">as</span> np

np.random.seed(<span class="nu">42</span>)

<span class="kw">def</span> <span class="fn">simulate_rate</span>(model, r0, kappa, theta, sigma, T, n_steps, n_paths):
    dt = T / n_steps
    r = np.full(n_paths, r0)
    paths = [r.copy()]
    <span class="kw">for</span> _ <span class="kw">in</span> <span class="fn">range</span>(n_steps):
        Z = np.random.randn(n_paths)
        <span class="kw">if</span> model == <span class="st">'vasicek'</span>:
            r = r + kappa*(theta - r)*dt + sigma*np.sqrt(dt)*Z
        <span class="kw">else</span>:  <span class="cm"># CIR</span>
            r = np.maximum(r, <span class="nu">0</span>)
            r = r + kappa*(theta - r)*dt + sigma*np.sqrt(np.maximum(r,<span class="nu">0</span>)*dt)*Z
        paths.append(r.copy())
    <span class="kw">return</span> np.array(paths)

r0, kappa, theta, sigma = <span class="nu">0.03</span>, <span class="nu">0.5</span>, <span class="nu">0.05</span>, <span class="nu">0.02</span>
T, n_steps, n_paths = <span class="nu">10</span>, <span class="nu">2520</span>, <span class="nu">1000</span>

vas = simulate_rate(<span class="st">'vasicek'</span>, r0, kappa, theta, sigma, T, n_steps, n_paths)
cir = simulate_rate(<span class="st">'cir'</span>, r0, kappa, theta, sigma, T, n_steps, n_paths)

<span class="fn">print</span>(<span class="st">f"=== ê¸ˆë¦¬ ëª¨ë¸ ë¹„êµ (râ‚€=3%, Î¸=5%, Îº=0.5, Ïƒ=2%) ==="</span>)
<span class="fn">print</span>(<span class="st">f"ë°˜ê°ê¸° = ln(2)/Îº = {np.log(2)/kappa:.2f}ë…„\n"</span>)

<span class="fn">print</span>(<span class="st">f"{'':>12} {'Vasicek':>20} {'CIR':>20}"</span>)
<span class="fn">print</span>(<span class="st">"â”€" * 55</span>)
<span class="kw">for</span> label, v, c <span class="kw">in</span> [
    (<span class="st">"10ë…„ í›„ í‰ê· "</span>, vas[-<span class="nu">1</span>].mean(), cir[-<span class="nu">1</span>].mean()),
    (<span class="st">"10ë…„ í›„ std"</span>, vas[-<span class="nu">1</span>].std(), cir[-<span class="nu">1</span>].std()),
    (<span class="st">"ê²½ë¡œ ìµœì†Œê°’"</span>, vas.min(), <span class="fn">max</span>(cir.min(), <span class="nu">0</span>)),
    (<span class="st">"ìŒì˜ ê¸ˆë¦¬ ë¹„ìœ¨"</span>, (vas < <span class="nu">0</span>).any(axis=<span class="nu">0</span>).mean(), (cir < <span class="nu">0</span>).any(axis=<span class="nu">0</span>).mean()),
]:
    <span class="fn">print</span>(<span class="st">f"{label:>12} {v:>20.4f} {c:>20.4f}"</span>)</code></pre>
<div class="code-output"><span class="out-label">Output:</span>
=== ê¸ˆë¦¬ ëª¨ë¸ ë¹„êµ (râ‚€=3%, Î¸=5%, Îº=0.5, Ïƒ=2%) ===
ë°˜ê°ê¸° = ln(2)/Îº = 1.39ë…„

              Vasicek                  CIR
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  10ë…„ í›„ í‰ê·                0.0501               0.0499
  10ë…„ í›„ std               0.0200               0.0189
  ê²½ë¡œ ìµœì†Œê°’              -0.0312               0.0012
 ìŒì˜ ê¸ˆë¦¬ ë¹„ìœ¨               0.0870               0.0000</div>

<!-- â–¼ Plotly: Vasicek vs CIR -->
<div id="plot-ch9-rates" style="width:100%;height:440px;margin:25px 0"></div>
<script>
(function(){
  var rng=(function(a){return function(){a|=0;a=a+0x6D2B79F5|0;var t=Math.imul(a^a>>>15,1|a);t=t+Math.imul(t^t>>>7,61|t)^t;return((t^t>>>14)>>>0)/4294967296;};})(123);
  function randn(){var u=0,v=0;while(u===0)u=rng();while(v===0)v=rng();return Math.sqrt(-2*Math.log(u))*Math.cos(2*Math.PI*v);}
  var r0=0.03,kappa=0.5,theta=0.05,sig=0.02,T=10,n=2520,dt=T/n;
  var time=[];for(var i=0;i<=n;i++)time.push(i*dt);
  var colors=['#1e88e5','#e53935','#43a047'];
  var traces=[];
  for(var p=0;p<3;p++){
    var r=[r0];
    for(var i=0;i<n;i++){var z=randn();r.push(r[i]+kappa*(theta-r[i])*dt+sig*Math.sqrt(dt)*z);}
    traces.push({x:time,y:r.map(function(v){return v*100;}),mode:'lines',name:'Vasicek '+(p+1),line:{width:1.5,color:colors[p]}});
  }
  rng=(function(a){return function(){a|=0;a=a+0x6D2B79F5|0;var t=Math.imul(a^a>>>15,1|a);t=t+Math.imul(t^t>>>7,61|t)^t;return((t^t>>>14)>>>0)/4294967296;};})(456);
  for(var p=0;p<3;p++){
    var r=[r0];
    for(var i=0;i<n;i++){var z=randn();var rv=Math.max(r[i],0);r.push(rv+kappa*(theta-rv)*dt+sig*Math.sqrt(Math.max(rv,0)*dt)*z);}
    traces.push({x:time,y:r.map(function(v){return v*100;}),mode:'lines',name:'CIR '+(p+1),line:{width:1.5,color:colors[p],dash:'dash'}});
  }
  traces.push({x:[0,T],y:[theta*100,theta*100],mode:'lines',name:'Î¸ = 5%',line:{width:2,color:'#333',dash:'dot'}});
  Plotly.newPlot('plot-ch9-rates',traces,{
    title:{text:'ğŸ“‰ Vasicek(ì‹¤ì„ ) vs CIR(ì ì„ ): ê¸ˆë¦¬ í‰ê·  íšŒê·€',font:{size:13}},
    xaxis:{title:'ì‹œê°„ (ë…„)'},yaxis:{title:'ê¸ˆë¦¬ (%)'},
    margin:{l:50,r:20,t:45,b:40},legend:{x:0.02,y:0.98,font:{size:9}},
    shapes:[{type:'line',x0:0,x1:T,y0:0,y1:0,line:{color:'#ccc',width:1}}]
  },{responsive:true});
})();
</script>
<p class="ni" style="font-size:11px;color:#888;text-align:center;margin-top:-10px">ğŸ–±ï¸ ë‘ ëª¨ë¸ ëª¨ë‘ Î¸=5%ë¡œ íšŒê·€. Vasicekì€ ìŒì˜ ê¸ˆë¦¬ ê°€ëŠ¥(ì‹¤ì„ ), CIRì€ 0 ì´ìƒ ìœ ì§€(ì ì„ )</p>

<div class="problem-box">
<div class="problem-title">âœï¸ ì—°ìŠµë¬¸ì œ 9.1</div>
<p class="ni">ì•¡ë©´ê°€ 10,000ì›, ì¿ í° 3% (ë°˜ê¸° ì§€ê¸‰), ë§Œê¸° 5ë…„ì¸ ì±„ê¶Œì˜ YTMì´ 4%ì´ë‹¤.</p>
<ol>
<li>ì±„ê¶Œ ê°€ê²©ì„ êµ¬í•˜ë¼.</li>
<li>ìˆ˜ì • ë“€ë ˆì´ì…˜ì„ êµ¬í•˜ë¼.</li>
<li>ê¸ˆë¦¬ê°€ 50bp ìƒìŠ¹í•˜ë©´ ì±„ê¶Œ ê°€ê²©ì€ ì•½ ì–¼ë§ˆë‚˜ ë³€í•˜ëŠ”ê°€? (ë“€ë ˆì´ì…˜ ê·¼ì‚¬)</li>
<li>Vasicek ëª¨ë¸ì—ì„œ \(r_0=4\%\), \(\kappa=0.3\), \(\theta=5\%\), \(\sigma=1.5\%\)ì¼ ë•Œ, ê¸ˆë¦¬ì˜ ë°˜ê°ê¸°ì™€ ì¥ê¸° í‘œì¤€í¸ì°¨ë¥¼ êµ¬í•˜ë¼.</li>
</ol>
</div>

<details>
<summary>ğŸ”‘ í’€ì´ ë³´ê¸°</summary>
<div class="answer-content">
<p class="ni"><strong>1)</strong> ë°˜ê¸° ì¿ í° = 150ì›, ë°˜ê¸° YTM = 2%, 10ê¸°ê°„</p>
<p class="ni">\(P = 150 \times \frac{1-1.02^{-10}}{0.02} + \frac{10000}{1.02^{10}} = 150 \times 8.9826 + 8203.48 = 9550.87\)ì›</p>
<p class="ni"><strong>2)</strong> ë§¥ì»¬ë¦¬ ë“€ë ˆì´ì…˜ â‰ˆ 4.63ë…„, ìˆ˜ì • ë“€ë ˆì´ì…˜ = 4.63/1.02 â‰ˆ 4.54</p>
<p class="ni"><strong>3)</strong> Î”P/P â‰ˆ -4.54 Ã— 0.005 = -2.27%, Î”P â‰ˆ -216.8ì›, ìƒˆ ê°€ê²© â‰ˆ 9,334ì›</p>
<p class="ni"><strong>4)</strong> ë°˜ê°ê¸° = ln(2)/0.3 = 2.31ë…„. ì¥ê¸° ë¶„ì‚° = ÏƒÂ²/(2Îº) = 0.015Â²/0.6 = 0.000375, ì¥ê¸° Ïƒ = 1.94%</p>
</div>
</details>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- Ch10: ì¢…í•© ë¬¸ì œ -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<h2 id="ch10">10. ì¢…í•© ë¬¸ì œ</h2>

<div class="problem-box">
<div class="problem-title">ğŸ† ì¢…í•© ë¬¸ì œ 1: ì˜µì…˜ ì „ëµ ë¶„ì„</div>
<p class="ni">í˜„ì¬ ì£¼ê°€ \(S = 100\), ë¬´ìœ„í—˜ ê¸ˆë¦¬ \(r = 5\%\), ë³€ë™ì„± \(\sigma = 25\%\), ë§Œê¸° \(T = 3\)ê°œì›”ì´ë‹¤.</p>
<ol>
<li>í–‰ì‚¬ê°€ K=100ì¸ ATM ì½œì˜µì…˜ê³¼ í’‹ì˜µì…˜ì˜ ë¸”ë™-ìˆ„ì¦ˆ ê°€ê²©ì„ êµ¬í•˜ë¼.</li>
<li>í’‹-ì½œ íŒ¨ë¦¬í‹°ê°€ ì„±ë¦½í•˜ëŠ”ì§€ í™•ì¸í•˜ë¼.</li>
<li>ìŠ¤íŠ¸ë˜ë“¤(straddle: ê°™ì€ í–‰ì‚¬ê°€ì˜ ì½œ+í’‹ ë§¤ìˆ˜) ì „ëµì˜ ì´ ë¹„ìš©ê³¼ ì†ìµë¶„ê¸°ì ì„ êµ¬í•˜ë¼.</li>
<li>ì´ ì „ëµì´ ìœ ë¦¬í•œ ì‹œì¥ ìƒí™©ê³¼ ë¶ˆë¦¬í•œ ì‹œì¥ ìƒí™©ì„ ê°ê° ì„¤ëª…í•˜ë¼.</li>
<li>ìŠ¤íŠ¸ë˜ë“¤ ëŒ€ì‹  ìŠ¤íŠ¸ë­ê¸€(strangle: K=95 í’‹ + K=105 ì½œ ë§¤ìˆ˜)ì„ ì‚¬ìš©í•˜ë©´ ë¹„ìš©ê³¼ ì†ìµë¶„ê¸°ì ì€ ì–´ë–»ê²Œ ë³€í•˜ëŠ”ê°€?</li>
</ol>
</div>

<details>
<summary>ğŸ”‘ í’€ì´ ë³´ê¸°</summary>
<div class="answer-content">
<pre><code><span class="kw">import</span> numpy <span class="kw">as</span> np
<span class="kw">from</span> scipy.stats <span class="kw">import</span> norm

S, K, T, r, sigma = <span class="nu">100</span>, <span class="nu">100</span>, <span class="nu">0.25</span>, <span class="nu">0.05</span>, <span class="nu">0.25</span>
d1 = (np.log(S/K) + (r + sigma**<span class="nu">2</span>/<span class="nu">2</span>)*T) / (sigma*np.sqrt(T))
d2 = d1 - sigma*np.sqrt(T)
C = S*norm.cdf(d1) - K*np.exp(-r*T)*norm.cdf(d2)
P = K*np.exp(-r*T)*norm.cdf(-d2) - S*norm.cdf(-d1)

<span class="fn">print</span>(<span class="st">f"1) ì½œ: {C:.4f}, í’‹: {P:.4f}"</span>)
<span class="fn">print</span>(<span class="st">f"2) C-P = {C-P:.4f}, S-Keâ»Ê³áµ€ = {S-K*np.exp(-r*T):.4f} âœ“"</span>)
straddle = C + P
<span class="fn">print</span>(<span class="st">f"3) ìŠ¤íŠ¸ë˜ë“¤ ë¹„ìš©: {straddle:.4f}"</span>)
<span class="fn">print</span>(<span class="st">f"   ìƒë°© BEP: {K + straddle:.2f}, í•˜ë°© BEP: {K - straddle:.2f}"</span>)</code></pre>
<div class="code-output"><span class="out-label">Output:</span>
1) ì½œ: 5.3735, í’‹: 4.1327
2) C-P = 1.2408, S-Keâ»Ê³áµ€ = 1.2422 âœ“
3) ìŠ¤íŠ¸ë˜ë“¤ ë¹„ìš©: 9.5062
   ìƒë°© BEP: 109.51, í•˜ë°© BEP: 90.49</div>
<p class="ni"><strong>4)</strong> ìœ ë¦¬: ì‹¤ì  ë°œí‘œ, ê¸ˆë¦¬ ê²°ì • ë“± í° ì´ë²¤íŠ¸ ì „. ì‹¤ì œ ë³€ë™ì„±ì´ ë‚´ì¬ ë³€ë™ì„±(25%)ë³´ë‹¤ í´ ë•Œ. ë¶ˆë¦¬: ì‹œì¥ì´ íš¡ë³´í•  ë•Œ. ì‹œê°„ê°€ì¹˜ ê°ì†Œ(ì„¸íƒ€)ë¡œ ë§¤ì¼ ì†ì‹¤ ë°œìƒ. ì£¼ê°€ê°€ 90.49~109.51 ì‚¬ì´ì— ë¨¸ë¬¼ë©´ ì†ì‹¤.</p>
<p class="ni"><strong>5)</strong> ìŠ¤íŠ¸ë­ê¸€: K=95 í’‹ â‰ˆ 1.56, K=105 ì½œ â‰ˆ 2.78, ì´ ë¹„ìš© â‰ˆ 4.34 (ìŠ¤íŠ¸ë˜ë“¤ì˜ 46%). í•˜ë°© BEP = 95-4.34 = 90.66, ìƒë°© BEP = 105+4.34 = 109.34. ë¹„ìš©ì€ ì ˆë°˜ì´ì§€ë§Œ BEP ë²”ìœ„ëŠ” ë¹„ìŠ· â†’ ë¹„ìš© íš¨ìœ¨ì ì´ì§€ë§Œ ìµœëŒ€ ì†ì‹¤ êµ¬ê°„ì´ ë„“ë‹¤.</p>
</div>
</details>

<div class="problem-box">
<div class="problem-title">ğŸ† ì¢…í•© ë¬¸ì œ 2: ë¦¬ìŠ¤í¬ ê´€ë¦¬ ì¢…í•©</div>
<p class="ni">10ì–µì› ì£¼ì‹ í¬íŠ¸í´ë¦¬ì˜¤ì˜ ì¼ê°„ ìˆ˜ìµë¥ ì´ \(N(0.04\%, 1.8\%)\)ë¥¼ ë”°ë¥¸ë‹¤.</p>
<ol>
<li>1ì¼ 95% VaRê³¼ 99% VaRì„ ë¶„ì‚°-ê³µë¶„ì‚°ë²•ìœ¼ë¡œ êµ¬í•˜ë¼.</li>
<li>10ì¼ 99% VaRì„ êµ¬í•˜ë¼ (ë°”ì ¤ ê·œì œ ê¸°ì¤€).</li>
<li>ì´ í¬íŠ¸í´ë¦¬ì˜¤ì— ëŒ€í•´ ATM í’‹ì˜µì…˜ìœ¼ë¡œ ë³´í˜¸ì  í’‹(protective put) ì „ëµì„ êµ¬í˜„í•˜ë ¤ë©´, í’‹ì˜µì…˜ì˜ ë¸íƒ€ê°€ -0.45ì¼ ë•Œ ëª‡ ê³„ì•½ì´ í•„ìš”í•œê°€? (1ê³„ì•½ = ì£¼ì‹ 100ì£¼, ì£¼ê°€ 50,000ì›)</li>
<li>GARCH(1,1)ì—ì„œ \(\alpha=0.09\), \(\beta=0.88\)ì´ê³  ì–´ì œ ìˆ˜ìµë¥ ì´ -4%ì˜€ë‹¤ë©´, ë‚´ì¼ì˜ VaRì€ ì˜¤ëŠ˜ë³´ë‹¤ ë†’ì„ê¹Œ ë‚®ì„ê¹Œ? ì •ëŸ‰ì ìœ¼ë¡œ ì„¤ëª…í•˜ë¼.</li>
</ol>
</div>

<details>
<summary>ğŸ”‘ í’€ì´ ë³´ê¸°</summary>
<div class="answer-content">
<p class="ni"><strong>1)</strong> 95% VaR = -(0.0004 + (-1.645)Ã—0.018) Ã— 10ì–µ = 0.02921 Ã— 10ì–µ = 2,921ë§Œì›</p>
<p class="ni">99% VaR = -(0.0004 + (-2.326)Ã—0.018) Ã— 10ì–µ = 0.04147 Ã— 10ì–µ = 4,147ë§Œì›</p>
<p class="ni"><strong>2)</strong> 10ì¼ 99% VaR = 4,147ë§Œì› Ã— âˆš10 = 13,113ë§Œì› â‰ˆ 1.31ì–µì›</p>
<p class="ni"><strong>3)</strong> í¬íŠ¸í´ë¦¬ì˜¤ = 10ì–µì›, ì£¼ê°€ = 50,000ì› â†’ ì£¼ì‹ ìˆ˜ = 20,000ì£¼</p>
<p class="ni">ë³´í˜¸ì  í’‹: ì£¼ì‹ 1ì£¼ë‹¹ í’‹ 1ê³„ì•½ì´ ì•„ë‹ˆë¼, ë¸íƒ€ ì¤‘ë¦½ì„ ìœ„í•´ í•„ìš”í•œ ê³„ì•½ ìˆ˜ ê³„ì‚°</p>
<p class="ni">í’‹ 1ê³„ì•½ì˜ ë¸íƒ€ = -0.45 Ã— 100ì£¼ = -45. í¬íŠ¸í´ë¦¬ì˜¤ ë¸íƒ€ = +20,000</p>
<p class="ni">ì™„ì „ í—¤ì§€: 20,000 / 45 = 444.4 â†’ 445ê³„ì•½ (ë°˜ì˜¬ë¦¼)</p>
<p class="ni"><strong>4)</strong> Î±+Î² = 0.97, ë¬´ì¡°ê±´ë¶€ ÏƒÂ² = Ï‰/(1-0.97). ì–´ì œ -4% ì¶©ê²©ì€ í‰ì†Œ(Ïƒâ‰ˆ1.8%)ì˜ 2.2ë°°.</p>
<p class="ni">ì˜¤ëŠ˜ ÏƒÂ²_t = Ï‰ + 0.09Ã—0.04Â² + 0.88Ã—ÏƒÂ²_{t-1}. 0.04Â² = 0.0016ì€ ë¬´ì¡°ê±´ë¶€ ë¶„ì‚°(â‰ˆ0.000324)ì˜ ì•½ 5ë°°.</p>
<p class="ni">ë”°ë¼ì„œ ë‚´ì¼ì˜ ì¡°ê±´ë¶€ ë¶„ì‚°ì€ í¬ê²Œ ìƒìŠ¹í•˜ê³ , VaRë„ ìƒìŠ¹í•œë‹¤. ë³€ë™ì„± í´ëŸ¬ìŠ¤í„°ë§ íš¨ê³¼.</p>
</div>
</details>

<div class="problem-box">
<div class="problem-title">ğŸ† ì¢…í•© ë¬¸ì œ 3: ê¸ˆìœµê³µí•™ í†µí•©</div>
<p class="ni">ë‹¤ìŒ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ë¶„ì„í•˜ë¼:</p>
<ol>
<li>Vasicek ëª¨ë¸ì—ì„œ \(r_0 = 3\%\), \(\kappa = 0.3\), \(\theta = 5\%\), \(\sigma_r = 1.5\%\)ì´ë‹¤. ê¸ˆë¦¬ì˜ ì¥ê¸° ê¸°ëŒ€ê°’, ì¥ê¸° ë¶„ì‚°, ë°˜ê°ê¸°ë¥¼ êµ¬í•˜ë¼.</li>
<li>ì´ ê¸ˆë¦¬ ëª¨ë¸ í•˜ì—ì„œ ëª¬í…Œì¹´ë¥¼ë¡œ ì‹œë®¬ë ˆì´ì…˜ìœ¼ë¡œ 1ë…„ ë§Œê¸° ì œë¡œì¿ í° ì±„ê¶Œì˜ ê°€ê²©ì„ ì¶”ì •í•˜ëŠ” ì•Œê³ ë¦¬ì¦˜ì„ ì„¤ëª…í•˜ë¼.</li>
<li>ì£¼ê°€ê°€ GBMì„ ë”°ë¥´ê³  (\(\mu=8\%\), \(\sigma=20\%\)), í˜„ì¬ ì£¼ê°€ê°€ 100ì¼ ë•Œ, 6ê°œì›” í›„ ì£¼ê°€ê°€ 80 ì´í•˜ë¡œ ë–¨ì–´ì§ˆ í™•ë¥ ì„ êµ¬í•˜ë¼.</li>
<li>ìœ„ 3ë²ˆì˜ í™•ë¥ ì„ ì´ìš©í•˜ì—¬, í–‰ì‚¬ê°€ 80ì¸ 6ê°œì›” ë§Œê¸° í’‹ì˜µì…˜ì´ ITMìœ¼ë¡œ ë§Œê¸°ë  í™•ë¥ (ìœ„í—˜ì¤‘ë¦½)ì„ êµ¬í•˜ë¼. ì‹¤ì œ í™•ë¥ ê³¼ ìœ„í—˜ì¤‘ë¦½ í™•ë¥ ì´ ë‹¤ë¥¸ ì´ìœ ë¥¼ ì„¤ëª…í•˜ë¼.</li>
</ol>
</div>

<details>
<summary>ğŸ”‘ í’€ì´ ë³´ê¸°</summary>
<div class="answer-content">
<p class="ni"><strong>1)</strong> ì¥ê¸° ê¸°ëŒ€ê°’: \(E[r_\infty] = \theta = 5\%\)</p>
<p class="ni">ì¥ê¸° ë¶„ì‚°: \(\text{Var}[r_\infty] = \sigma_r^2/(2\kappa) = 0.015^2/0.6 = 0.000375\), ì¥ê¸° Ïƒ = 1.94%</p>
<p class="ni">ë°˜ê°ê¸°: \(\ln(2)/\kappa = 0.693/0.3 = 2.31\)ë…„</p>
<p class="ni"><strong>2)</strong> ì•Œê³ ë¦¬ì¦˜:</p>
<ol>
<li>Nê°œì˜ ê¸ˆë¦¬ ê²½ë¡œë¥¼ Vasicek SDEë¡œ ì‹œë®¬ë ˆì´ì…˜ (dt ê°„ê²©ìœ¼ë¡œ ì´ì‚°í™”)</li>
<li>ê° ê²½ë¡œì—ì„œ \(\int_0^T r_t\,dt\)ë¥¼ ìˆ˜ì¹˜ ì ë¶„ (ì‚¬ë‹¤ë¦¬ê¼´ ë²•ì¹™ ë˜ëŠ” ë‹¨ìˆœ í•©)</li>
<li>ì±„ê¶Œ ê°€ê²© = \(\frac{1}{N}\sum_{i=1}^N \exp(-\int_0^T r_t^{(i)}\,dt)\)</li>
</ol>
<p class="ni">Vasicekì€ í•´ì„í•´ë„ ì¡´ì¬: \(P(0,T) = A(T)e^{-B(T)r_0}\) (Affine ëª¨ë¸)</p>
<p class="ni"><strong>3)</strong> ì‹¤ì œ ì¸¡ë„ì—ì„œ: \(\ln(S_T/S_0) \sim N((0.08-0.02)\times 0.5, 0.04\times 0.5) = N(0.03, 0.02)\)</p>
<p class="ni">\(P(S_T < 80) = P(\ln(S_T/100) < \ln 0.8) = P(Z < \frac{-0.2231-0.03}{0.1414}) = P(Z < -1.790) = 3.67\%\)</p>
<p class="ni"><strong>4)</strong> ìœ„í—˜ì¤‘ë¦½ ì¸¡ë„ì—ì„œ: ë“œë¦¬í”„íŠ¸ë¥¼ r=5%ë¡œ êµì²´</p>
<p class="ni">\(\ln(S_T/S_0) \sim N((0.05-0.02)\times 0.5, 0.02) = N(0.015, 0.02)\)</p>
<p class="ni">\(P^{\mathbb{Q}}(S_T < 80) = P(Z < \frac{-0.2231-0.015}{0.1414}) = P(Z < -1.684) = 4.61\%\)</p>
<p class="ni">ìœ„í—˜ì¤‘ë¦½ í™•ë¥ (4.61%)ì´ ì‹¤ì œ í™•ë¥ (3.67%)ë³´ë‹¤ ë†’ë‹¤. ì´ìœ : ìœ„í—˜ì¤‘ë¦½ ì¸¡ë„ì—ì„œëŠ” ì£¼ì‹ì˜ ê¸°ëŒ€ ìˆ˜ìµë¥ ì´ Î¼=8%ê°€ ì•„ë‹Œ r=5%ì´ë¯€ë¡œ, ì£¼ê°€ê°€ ëœ ìƒìŠ¹í•˜ê³  ë”°ë¼ì„œ 80 ì´í•˜ë¡œ ë–¨ì–´ì§ˆ í™•ë¥ ì´ ë” ë†’ë‹¤. ìœ„í—˜ í”„ë¦¬ë¯¸ì—„(Î¼-r=3%)ì´ ì œê±°ë˜ì—ˆê¸° ë•Œë¬¸ì´ë‹¤.</p>
</div>
</details>


<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- í•µì‹¬ ìš”ì•½ ì¹˜íŠ¸ì‹œíŠ¸ -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<h2>í•µì‹¬ ìš”ì•½: ê¸ˆìœµê³µí•™ ì¹˜íŠ¸ì‹œíŠ¸</h2>

<div class="tc">Table 7. ê¸ˆìœµê³µí•™ í•µì‹¬ ê°œë… â†’ ML/HFT ë§¤í•‘</div>
<table>
<tr><th>ê°œë…</th><th>í•µì‹¬ ìˆ˜ì‹</th><th>ML ì‘ìš©</th><th>HFT ì‘ìš©</th></tr>
<tr><td>GBM</td><td>\(dS = \mu S\,dt + \sigma S\,dW\)</td><td>ì‹œê³„ì—´ ìƒì„± ëª¨ë¸</td><td>ì£¼ê°€ ì‹œë®¬ë ˆì´ì…˜</td></tr>
<tr><td>ì´í†  ë³´ì¡°ì •ë¦¬</td><td>\(df = f'dX + \frac{1}{2}f''(dX)^2\)</td><td>í™•ë¥ ì  ì—­ì „íŒŒ</td><td>ë³€ë™ì„± ë“œë˜ê·¸ ë³´ì •</td></tr>
<tr><td>ë¸”ë™-ìˆ„ì¦ˆ</td><td>\(C = SN(d_1) - Ke^{-rT}N(d_2)\)</td><td>ê°€ê²© ì˜ˆì¸¡ ë²¤ì¹˜ë§ˆí¬</td><td>ì˜µì…˜ ë§ˆì¼“ë©”ì´í‚¹</td></tr>
<tr><td>ê·¸ë¦­ìŠ¤</td><td>\(\Delta, \Gamma, \nu, \Theta, \rho\)</td><td>ë¯¼ê°ë„ ë¶„ì„</td><td>ë™ì  í—¤ì§•</td></tr>
<tr><td>ë¸íƒ€ í—¤ì§•</td><td>\(\Pi = V - \Delta S\)</td><td>ë¦¬ìŠ¤í¬ ì¤‘ë¦½ í•™ìŠµ</td><td>ì‹¤ì‹œê°„ í—¤ì§€ ì¡°ì •</td></tr>
<tr><td>ëª¬í…Œì¹´ë¥¼ë¡œ</td><td>\(E[f(X)] \approx \frac{1}{N}\sum f(x_i)\)</td><td>ë² ì´ì§€ì•ˆ ì¶”ë¡ </td><td>ì´ìƒ‰ ì˜µì…˜ ê°€ê²©</td></tr>
<tr><td>ë¶„ì‚° ê°ì†Œ</td><td>ëŒ€ì¹­ ë³€ëŸ‰, ì œì–´ ë³€ëŸ‰</td><td>íš¨ìœ¨ì  ìƒ˜í”Œë§</td><td>ì‹¤ì‹œê°„ ê°€ê²© ê³„ì‚°</td></tr>
<tr><td>VaR / CVaR</td><td>\(P(\text{Loss}>\text{VaR})=\alpha\)</td><td>ë¦¬ìŠ¤í¬ ì œì•½ í•™ìŠµ</td><td>í¬ì§€ì…˜ í•œë„ ê´€ë¦¬</td></tr>
<tr><td>GARCH</td><td>\(\sigma_t^2 = \omega + \alpha\varepsilon^2 + \beta\sigma^2\)</td><td>ë³€ë™ì„± í”¼ì²˜</td><td>ì‹¤ì‹œê°„ ë³€ë™ì„± ì¶”ì •</td></tr>
<tr><td>ë‚´ì¬ ë³€ë™ì„±</td><td>\(\sigma_{IV} = BS^{-1}(C_{mkt})\)</td><td>ì‹œì¥ ì‹¬ë¦¬ í”¼ì²˜</td><td>ë³€ë™ì„± ì°¨ìµê±°ë˜</td></tr>
<tr><td>ë“€ë ˆì´ì…˜</td><td>\(D^* = -\frac{1}{P}\frac{dP}{dy}\)</td><td>ê¸ˆë¦¬ ë¯¼ê°ë„ í”¼ì²˜</td><td>ì±„ê¶Œ ì°¨ìµê±°ë˜</td></tr>
<tr><td>Vasicek/CIR</td><td>\(dr = \kappa(\theta-r)dt + \sigma dW\)</td><td>í‰ê·  íšŒê·€ ëª¨ë¸</td><td>ê¸ˆë¦¬ íŒŒìƒìƒí’ˆ</td></tr>
</table>

<div class="info">
<p class="ni"><strong>ë‹¤ìŒ ë‹¨ê³„:</strong> ì´ ê°•ì˜ì˜ ê¸ˆìœµê³µí•™ ê¸°ì´ˆëŠ” R6(NLP + Sentiment)ì—ì„œ ë‰´ìŠ¤ ê¸°ë°˜ ë³€ë™ì„± ì˜ˆì¸¡ì˜ ë°°ê²½ì´ ë˜ê³ , R7(Deep Learning)ì—ì„œ ì˜µì…˜ ê°€ê²© ì˜ˆì¸¡ ì‹ ê²½ë§ì˜ ê¸°ì´ˆê°€ ëœë‹¤. íŠ¹íˆ ëª¬í…Œì¹´ë¥¼ë¡œì™€ GARCHëŠ” R8(Convex Optimization)ì—ì„œ ë¦¬ìŠ¤í¬ ì œì•½ í¬íŠ¸í´ë¦¬ì˜¤ ìµœì í™”ì˜ í•µì‹¬ ì…ë ¥ì´ ëœë‹¤. ë¸íƒ€ í—¤ì§•ê³¼ ê·¸ë¦­ìŠ¤ëŠ” R9(HFT + RL)ì—ì„œ ê°•í™”í•™ìŠµ ê¸°ë°˜ ë™ì  í—¤ì§• ì—ì´ì „íŠ¸ì˜ ê¸°ë°˜ì´ ëœë‹¤.</p>
</div>

</div><!-- paper-content -->
</div><!-- container -->
</div><!-- main-wrapper -->

</body>
</html>
