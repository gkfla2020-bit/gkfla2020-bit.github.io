<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bonus 5 - ê¸ˆìœµê³µí•™ ì˜¬ì¸ì› (Financial Engineering All-in-One)</title>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@300;400;500&family=Space+Mono:wght@400&family=Inter:wght@300;400&display=swap" rel="stylesheet">
<script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Inter',sans-serif;background:#fafaf8;color:#1a1a1a;line-height:1.7;overflow-x:hidden}
.sidebar{position:fixed;left:0;top:0;width:260px;height:100vh;background:rgba(255,255,255,.97);border-right:1px solid rgba(0,0,0,.06);padding:32px 24px;z-index:100;overflow-y:auto;display:flex;flex-direction:column}
.sidebar-profile{text-align:center;margin-bottom:28px;padding-bottom:24px;border-bottom:1px solid rgba(0,0,0,.08)}
.profile-icon{font-size:48px;margin-bottom:8px}
.profile-name{font-family:'Cormorant Garamond',serif;font-size:1.3rem;font-weight:500;margin-bottom:4px}
.profile-title{font-size:.68rem;color:#888;letter-spacing:.08em;text-transform:uppercase;margin-bottom:8px}
.profile-bio{font-size:.78rem;color:#666;line-height:1.5}
.sidebar-nav{flex:1;margin-top:16px}
.nav-section{margin-bottom:20px}
.nav-section-title{font-size:.6rem;font-weight:600;color:#aaa;letter-spacing:.15em;text-transform:uppercase;margin-bottom:10px}
.nav-list{list-style:none}
.nav-list li{margin-bottom:5px}
.nav-list a{font-size:.78rem;color:#555;text-decoration:none;transition:all .2s;display:block;padding:3px 0}
.nav-list a:hover{color:#0080c6;padding-left:4px}
.nav-list a.active{color:#0080c6;font-weight:500}
.nav-list a.done{color:#28a745}
.badge{display:inline-block;font-size:.5rem;background:#0080c6;color:#fff;padding:1px 5px;border-radius:8px;margin-left:3px;vertical-align:middle}
.badge-done{background:#28a745}
.badge-bonus{background:#9c27b0}
.sidebar-footer{padding-top:16px;border-top:1px solid rgba(0,0,0,.06);font-size:.65rem;color:#aaa;text-align:center}
.main-wrapper{margin-left:260px;min-height:100vh}
.container{max-width:1100px;margin:0 auto;padding:50px 40px 80px}
.paper-content{font-family:'Times New Roman','Nanum Myeongjo',serif;line-height:1.8;background:#fff;padding:40px;border-radius:8px;box-shadow:0 2px 20px rgba(0,0,0,.05)}
.paper-header{text-align:center;margin-bottom:40px;padding-bottom:30px;border-bottom:2px solid #333}
.paper-category{font-size:14px;color:#666;margin-bottom:10px}
.paper-title{font-size:24px;font-weight:bold;margin-bottom:12px;line-height:1.4}
.paper-subtitle{font-size:14px;color:#555;margin-bottom:8px}
.paper-team{font-size:13px;color:#444}
.abstract{background:#f8f9fa;padding:25px;margin:30px 0;border-left:4px solid #2c3e50}
.abstract-title{font-weight:bold;font-size:16px;margin-bottom:15px}
h2{font-size:18px;margin:35px 0 20px;padding-bottom:8px;border-bottom:1px solid #ddd;color:#2c3e50}
h3{font-size:15px;margin:25px 0 15px;color:#34495e}
h4{font-size:14px;margin:20px 0 12px;color:#34495e}
p{text-align:justify;margin-bottom:15px;text-indent:2em}
p.ni{text-indent:0}
table{width:100%;border-collapse:collapse;margin:20px 0;font-size:12px}
th,td{border:1px solid #ddd;padding:10px 8px;text-align:center}
th{background:#2c3e50;color:white;font-weight:bold}
tr:nth-child(even){background:#f8f9fa}
tr:hover{background:#e8f4f8}
.tc{font-size:13px;font-weight:bold;margin:15px 0 10px;text-align:center}
.eq{text-align:center;margin:20px 0;padding:15px;background:#f8f9fa;border-radius:4px;overflow-x:auto}
ul,ol{margin-left:2em;margin-bottom:15px}
li{margin-bottom:6px}
.def{background:#fff9e6;border:1px solid #ffc107;border-radius:4px;padding:20px;margin:20px 0}
.info{background:#e8f4f8;border-left:4px solid #3498db;padding:20px;margin:20px 0}
.warn{background:#fff3cd;border-left:4px solid #f39c12;padding:20px;margin:20px 0}
.ok{background:#d4edda;border-left:4px solid #28a745;padding:20px;margin:20px 0}
pre{background:#1e1e1e;color:#d4d4d4;padding:20px;border-radius:6px;overflow-x:auto;margin:20px 0;font-family:'Space Mono','Consolas',monospace;font-size:13px;line-height:1.6}
code{font-family:'Space Mono','Consolas',monospace;font-size:13px}
p code,li code,td code{background:#f0f0f0;padding:2px 6px;border-radius:3px;color:#c7254e;font-size:12px}
.cm{color:#6a9955}.kw{color:#569cd6}.st{color:#ce9178}.fn{color:#dcdcaa}.nb{color:#4ec9b0}.nu{color:#b5cea8}
.progress-bar{width:100%;height:6px;background:#e0e0e0;border-radius:3px;margin-top:16px}
.progress-fill{height:100%;background:linear-gradient(90deg,#9c27b0,#e040fb);border-radius:3px;width:100%}
details{margin:20px 0;border:1px solid #ddd;border-radius:6px;overflow:hidden}
details summary{padding:14px 20px;background:#f0f4f8;cursor:pointer;font-weight:bold;font-size:14px;color:#2c3e50;user-select:none;transition:background .2s}
details summary:hover{background:#e0e8f0}
details[open] summary{background:#d0dce8;border-bottom:1px solid #ddd}
details .answer-content{padding:20px;background:#fff}
.problem-box{background:#f0f4ff;border:2px solid #5c6bc0;border-radius:8px;padding:20px;margin:20px 0}
.problem-box .problem-title{font-weight:bold;color:#283593;font-size:15px;margin-bottom:12px}
@media(max-width:1024px){
.sidebar{width:100%;height:auto;position:relative;border-right:none;border-bottom:1px solid rgba(0,0,0,.08);padding:16px}
.sidebar-profile{margin-bottom:10px;padding-bottom:10px;display:flex;align-items:center;gap:12px;text-align:left}
.profile-icon{font-size:32px;margin-bottom:0}.profile-bio{display:none}
.nav-section{display:inline-block;margin-right:16px;margin-bottom:8px}
.nav-list{display:flex;gap:10px;flex-wrap:wrap}.nav-list li{margin-bottom:0}
.sidebar-footer{display:none}
.main-wrapper{margin-left:0}
.container{padding:0}.paper-content{padding:20px 16px;border-radius:0;box-shadow:none}
.paper-title{font-size:18px}p{font-size:14px;text-indent:1.5em;text-align:left}
pre{font-size:11px;padding:14px}table{font-size:10px;display:block;overflow-x:auto}
}
.code-output{background:#1e1e1e;color:#d4d4d4;padding:12px 16px;border-radius:0 0 6px 6px;font-family:'Space Mono',monospace;font-size:11.5px;line-height:1.6;margin-top:-4px;margin-bottom:18px;border-top:2px solid #333;white-space:pre-wrap;overflow-x:auto}
.code-output .out-label{color:#888;font-size:10px;margin-bottom:4px;display:block}
</style>
</head>
<body>

<div class="sidebar">
<div class="sidebar-profile">
<div class="profile-icon">âš—ï¸</div>
<div class="profile-name">HFT ML Master Plan</div>
<div class="profile-title">Convex Opt + DL + HFT</div>
<div class="profile-bio">Bonus Rounds: ìˆ˜í•™ ê¸°ì´ˆ ì˜¬ì¸ì›</div>
</div>
<div class="sidebar-nav">
<div class="nav-section">
<div class="nav-section-title">Curriculum</div>
<ul class="nav-list">
<li><a class="done" href="../round-01/">R1. Python + Finance <span class="badge badge-done">DONE</span></a></li>
<li><a class="done" href="../bonus-01/">B1. ì„ í˜•ëŒ€ìˆ˜ <span class="badge badge-done">DONE</span></a></li>
<li><a class="done" href="../round-02/">R2. LinAlg + Stats <span class="badge badge-done">DONE</span></a></li>
<li><a class="done" href="../bonus-02/">B2. ë¯¸ì ë¶„ <span class="badge badge-done">DONE</span></a></li>
<li><a class="done" href="../round-03/">R3. Data / Feature <span class="badge badge-done">DONE</span></a></li>
<li><a class="done" href="../bonus-04/">B4. ì¬ë¬´ê´€ë¦¬ <span class="badge badge-done">DONE</span></a></li>
<li><a class="done" href="../round-04/">R4. Supervised ML <span class="badge badge-done">DONE</span></a></li>
<li><a class="done" href="../bonus-03/">B3. í™•ë¥ Â·í†µê³„ <span class="badge badge-done">DONE</span></a></li>
<li><a class="done" href="../round-05/">R5. Unsupervised+TS <span class="badge badge-done">DONE</span></a></li>
<li><a class="active" href="#">B5. ê¸ˆìœµê³µí•™ ì˜¬ì¸ì› <span class="badge badge-bonus">BONUS</span></a></li>
<li><a href="../round-06/">R6. NLP + Sentiment</a></li>
<li><a href="../round-07/">R7. Deep Learning</a></li>
<li><a href="../bonus-06/">B6. ìµœì í™” ì´ë¡ </a></li>
<li><a href="../round-08/">R8. Convex Opt + Transformer</a></li>
<li><a href="../round-09/">R9. HFT + RL</a></li>
<li><a href="../round-10/">R10. Final Project</a></li>
</ul>
</div>
<div class="nav-section">
<div class="nav-section-title">This Lecture</div>
<ul class="nav-list">
<li><a href="#ch1">1. ê¸ˆìœµê³µí•™ì´ë€?</a></li>
<li><a href="#ch2">2. ë¸Œë¼ìš´ ìš´ë™ê³¼ í™•ë¥ ê³¼ì •</a></li>
<li><a href="#ch3">3. ì´í†  ë³´ì¡°ì •ë¦¬</a></li>
<li><a href="#ch4">4. ë¸”ë™-ìˆ„ì¦ˆ ëª¨ë¸</a></li>
<li><a href="#ch5">5. ì˜µì…˜ ê·¸ë¦­ìŠ¤</a></li>
<li><a href="#ch6">6. ëª¬í…Œì¹´ë¥¼ë¡œ ì‹œë®¬ë ˆì´ì…˜</a></li>
<li><a href="#ch7">7. VaRì™€ ë¦¬ìŠ¤í¬ ì¸¡ì •</a></li>
<li><a href="#ch8">8. ë³€ë™ì„± ëª¨ë¸ë§</a></li>
<li><a href="#ch9">9. ê¸ˆë¦¬ ëª¨ë¸ê³¼ ì±„ê¶Œ</a></li>
<li><a href="#ch10">10. ì¢…í•© ë¬¸ì œ</a></li>
</ul>
</div>
</div>
<div class="sidebar-footer">Bonus 5 â€” ê¸ˆìœµê³µí•™ ì˜¬ì¸ì›</div>
</div>

<div class="main-wrapper">
<div class="container">
<div class="paper-content">

<div class="paper-header">
<div class="paper-category">Bonus Round 5 / 6 â€” R5ì™€ R6 ì‚¬ì´</div>
<h1 class="paper-title">ê¸ˆìœµê³µí•™ ì˜¬ì¸ì› (Financial Engineering All-in-One)</h1>
<div class="paper-subtitle">í™•ë¥ ê³¼ì • â†’ ì´í†  ë³´ì¡°ì •ë¦¬ â†’ ë¸”ë™-ìˆ„ì¦ˆ â†’ ê·¸ë¦­ìŠ¤ â†’ ëª¬í…Œì¹´ë¥¼ë¡œ â†’ VaR â†’ ë³€ë™ì„±</div>
<div class="paper-team">íŒŒìƒìƒí’ˆê³¼ ë¦¬ìŠ¤í¬ ê´€ë¦¬ì˜ ìˆ˜í•™ì  ê¸°ì´ˆ</div>
<div class="progress-bar"><div class="progress-fill"></div></div>
</div>

<div class="abstract">
<div class="abstract-title">ì™œ ê¸ˆìœµê³µí•™ì¸ê°€?</div>
<p class="ni">ê¸ˆìœµê³µí•™ì€ ìˆ˜í•™Â·í†µê³„Â·í”„ë¡œê·¸ë˜ë°ì„ ê²°í•©í•˜ì—¬ ê¸ˆìœµ ìƒí’ˆì˜ ê°€ê²©ì„ ê²°ì •í•˜ê³  ë¦¬ìŠ¤í¬ë¥¼ ê´€ë¦¬í•˜ëŠ” í•™ë¬¸ì´ë‹¤. ì˜µì…˜ ê°€ê²© ê²°ì •, VaR ê³„ì‚°, ë³€ë™ì„± ëª¨ë¸ë§ ë“± í€€íŠ¸ì˜ í•µì‹¬ ë„êµ¬ê°€ ëª¨ë‘ ì—¬ê¸°ì— ìˆë‹¤. ì´ ê°•ì˜ë¥¼ ë§ˆì¹˜ë©´:</p>
<ul>
<li>ê¸°í•˜ ë¸Œë¼ìš´ ìš´ë™(GBM)ìœ¼ë¡œ ì£¼ê°€ë¥¼ ëª¨ë¸ë§í•  ìˆ˜ ìˆë‹¤</li>
<li>ì´í†  ë³´ì¡°ì •ë¦¬ì˜ ì˜ë¯¸ë¥¼ ì´í•´í•˜ê³  ë¸”ë™-ìˆ„ì¦ˆ ê³µì‹ì„ ìœ ë„í•  ìˆ˜ ìˆë‹¤</li>
<li>ì˜µì…˜ ê·¸ë¦­ìŠ¤ë¥¼ ê³„ì‚°í•˜ê³  í—¤ì§•ì— í™œìš©í•  ìˆ˜ ìˆë‹¤</li>
<li>ëª¬í…Œì¹´ë¥¼ë¡œ ì‹œë®¬ë ˆì´ì…˜ìœ¼ë¡œ íŒŒìƒìƒí’ˆ ê°€ê²©ì„ ì‚°ì¶œí•  ìˆ˜ ìˆë‹¤</li>
<li>VaR, CVaR ë“± ë¦¬ìŠ¤í¬ ì§€í‘œë¥¼ ê³„ì‚°í•  ìˆ˜ ìˆë‹¤</li>
<li>GARCH ëª¨ë¸ë¡œ ë³€ë™ì„±ì„ ì¶”ì •í•  ìˆ˜ ìˆë‹¤</li>
</ul>
<div style="font-size:13px;color:#555;margin-top:15px;font-style:italic"><strong>Keywords:</strong> GBM, ItÃ´'s Lemma, Black-Scholes, Greeks, Monte Carlo, VaR, CVaR, GARCH, Implied Volatility</div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- Ch1: ê¸ˆìœµê³µí•™ì´ë€? -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<h2 id="ch1">1. ê¸ˆìœµê³µí•™ì´ë€?</h2>

<h3>1.1 ê¸ˆìœµê³µí•™ì˜ ì„¸ ê¸°ë‘¥</h3>

<div class="def">
<p class="ni"><strong>ê¸ˆìœµê³µí•™ = ìˆ˜í•™ + í†µê³„ + í”„ë¡œê·¸ë˜ë°</strong></p>
<ul>
<li><strong>ìˆ˜í•™:</strong> í™•ë¥ ê³¼ì •, í¸ë¯¸ë¶„ë°©ì •ì‹, ìµœì í™” â†’ ëª¨ë¸ êµ¬ì¶•</li>
<li><strong>í†µê³„:</strong> ì‹œê³„ì—´ ë¶„ì„, ì¶”ì •, ê²€ì • â†’ ëª¨ë¸ ê²€ì¦</li>
<li><strong>í”„ë¡œê·¸ë˜ë°:</strong> ìˆ˜ì¹˜ ê³„ì‚°, ì‹œë®¬ë ˆì´ì…˜, ìë™í™” â†’ ëª¨ë¸ êµ¬í˜„</li>
</ul>
</div>

<h3>1.2 íŒŒìƒìƒí’ˆì˜ ê¸°ì´ˆ</h3>

<div class="tc">Table 1. ì£¼ìš” íŒŒìƒìƒí’ˆ</div>
<table>
<tr><th>ìƒí’ˆ</th><th>ì •ì˜</th><th>ë§¤ìˆ˜ì ê¶Œë¦¬</th><th>ë§¤ë„ì ì˜ë¬´</th></tr>
<tr><td>ì„ ë¬¼ (Futures)</td><td>ë¯¸ë˜ ì‹œì ì— ì •í•´ì§„ ê°€ê²©ìœ¼ë¡œ ë§¤ë§¤í•˜ëŠ” ê³„ì•½</td><td>ë§¤ìˆ˜ ì˜ë¬´</td><td>ë§¤ë„ ì˜ë¬´</td></tr>
<tr><td>ì½œì˜µì…˜ (Call)</td><td>ê¸°ì´ˆìì‚°ì„ ì‚´ ìˆ˜ ìˆëŠ” ê¶Œë¦¬</td><td>ë§¤ìˆ˜ ê¶Œë¦¬</td><td>ë§¤ë„ ì˜ë¬´</td></tr>
<tr><td>í’‹ì˜µì…˜ (Put)</td><td>ê¸°ì´ˆìì‚°ì„ íŒ” ìˆ˜ ìˆëŠ” ê¶Œë¦¬</td><td>ë§¤ë„ ê¶Œë¦¬</td><td>ë§¤ìˆ˜ ì˜ë¬´</td></tr>
<tr><td>ìŠ¤ì™‘ (Swap)</td><td>í˜„ê¸ˆíë¦„ì„ êµí™˜í•˜ëŠ” ê³„ì•½</td><td colspan="2">ìƒí˜¸ êµí™˜</td></tr>
</table>

<h3>1.3 ë¬´ì°¨ìµ ì›ë¦¬ (No-Arbitrage)</h3>
<p>ê¸ˆìœµê³µí•™ì˜ ê°€ì¥ ê·¼ë³¸ì ì¸ ì›ë¦¬: "ê³µì§œ ì ì‹¬ì€ ì—†ë‹¤." ë™ì¼í•œ í˜„ê¸ˆíë¦„ì„ ê°€ì§„ ë‘ í¬íŠ¸í´ë¦¬ì˜¤ëŠ” ê°™ì€ ê°€ê²©ì´ì–´ì•¼ í•œë‹¤. ì´ ì›ë¦¬ë¡œë¶€í„° ëª¨ë“  íŒŒìƒìƒí’ˆ ê°€ê²© ê²°ì • ê³µì‹ì´ ë„ì¶œëœë‹¤.</p>

<div class="eq">
$\text{ê°™ì€ í˜ì´ì˜¤í”„} \Rightarrow \text{ê°™ì€ ê°€ê²©} \quad (\text{Law of One Price})$
</div>

<h3>1.4 í’‹-ì½œ íŒ¨ë¦¬í‹°</h3>

<div class="eq">
$C - P = S - Ke^{-rT}$
</div>

<pre><code><span class="kw">import</span> numpy <span class="kw">as</span> np

<span class="cm"># í’‹-ì½œ íŒ¨ë¦¬í‹° ê²€ì¦</span>
S = <span class="nu">100</span>     <span class="cm"># í˜„ì¬ ì£¼ê°€</span>
K = <span class="nu">100</span>     <span class="cm"># í–‰ì‚¬ê°€</span>
r = <span class="nu">0.05</span>    <span class="cm"># ë¬´ìœ„í—˜ ê¸ˆë¦¬</span>
T = <span class="nu">0.5</span>     <span class="cm"># ë§Œê¸° (ë…„)</span>
C = <span class="nu">8.50</span>    <span class="cm"># ì½œì˜µì…˜ ê°€ê²©</span>
P = <span class="nu">6.05</span>    <span class="cm"># í’‹ì˜µì…˜ ê°€ê²©</span>

<span class="cm"># íŒ¨ë¦¬í‹° í™•ì¸</span>
lhs = C - P
rhs = S - K * np.exp(-r * T)
<span class="fn">print</span>(<span class="st">f"C - P     = </span>{lhs:.2f}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"S - Keâ»Ê³áµ€ = </span>{rhs:.2f}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"ì°¨ì´:       </span>{abs(lhs - rhs):.4f}<span class="st"> (â‰ˆ 0ì´ë©´ íŒ¨ë¦¬í‹° ì„±ë¦½)"</span>)

<span class="cm"># ë§Œì•½ íŒ¨ë¦¬í‹°ê°€ ê¹¨ì§€ë©´? â†’ ì°¨ìµê±°ë˜ ê¸°íšŒ!</span>
<span class="fn">print</span>(<span class="st">f"\ní’‹-ì½œ íŒ¨ë¦¬í‹°ê°€ ê¹¨ì§€ë©´:"</span>)
<span class="fn">print</span>(<span class="st">f"  C-P > S-Keâ»Ê³áµ€ â†’ ì½œ ë§¤ë„ + í’‹ ë§¤ìˆ˜ + ì£¼ì‹ ë§¤ìˆ˜"</span>)
<span class="fn">print</span>(<span class="st">f"  C-P < S-Keâ»Ê³áµ€ â†’ ì½œ ë§¤ìˆ˜ + í’‹ ë§¤ë„ + ì£¼ì‹ ë§¤ë„"</span>)</code></pre>
<div class="code-output"><span class="out-label">Output:</span>
C - P     = 2.45
S - Keâ»Ê³áµ€ = 2.47
ì°¨ì´:       0.0188 (â‰ˆ 0ì´ë©´ íŒ¨ë¦¬í‹° ì„±ë¦½)

í’‹-ì½œ íŒ¨ë¦¬í‹°ê°€ ê¹¨ì§€ë©´:
  C-P > S-Keâ»Ê³áµ€ â†’ ì½œ ë§¤ë„ + í’‹ ë§¤ìˆ˜ + ì£¼ì‹ ë§¤ìˆ˜
  C-P < S-Keâ»Ê³áµ€ â†’ ì½œ ë§¤ìˆ˜ + í’‹ ë§¤ë„ + ì£¼ì‹ ë§¤ë„</div>


<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- Ch2: ë¸Œë¼ìš´ ìš´ë™ê³¼ í™•ë¥ ê³¼ì • -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<h2 id="ch2">2. ë¸Œë¼ìš´ ìš´ë™ê³¼ í™•ë¥ ê³¼ì •</h2>

<h3>2.1 ìœ„ë„ˆ ê³¼ì • (Wiener Process)</h3>
<p>ë¸Œë¼ìš´ ìš´ë™ \(W_t\)ëŠ” ê¸ˆìœµ ëª¨ë¸ì˜ ê¸°ë³¸ ë¹Œë”© ë¸”ë¡ì´ë‹¤:</p>

<div class="def">
<p class="ni"><strong>ìœ„ë„ˆ ê³¼ì •ì˜ ì„±ì§ˆ:</strong></p>
<ul>
<li>\(W_0 = 0\)</li>
<li>ë…ë¦½ ì¦ë¶„: \(W_t - W_s\)ëŠ” \(W_s\) ì´ì „ì˜ ì •ë³´ì™€ ë…ë¦½</li>
<li>ì •ê·œ ì¦ë¶„: \(W_t - W_s \sim N(0, t-s)\)</li>
<li>ì—°ì† ê²½ë¡œ: \(W_t\)ëŠ” ì—°ì†ì´ì§€ë§Œ ì–´ë””ì„œë„ ë¯¸ë¶„ ë¶ˆê°€ëŠ¥</li>
</ul>
</div>

<h3>2.2 ê¸°í•˜ ë¸Œë¼ìš´ ìš´ë™ (GBM)</h3>
<p>ì£¼ê°€ ëª¨ë¸ë§ì˜ í‘œì¤€ ëª¨ë¸. ì£¼ê°€ëŠ” ìŒìˆ˜ê°€ ë  ìˆ˜ ì—†ìœ¼ë¯€ë¡œ ë¡œê·¸ ìˆ˜ìµë¥ ì´ ì •ê·œë¶„í¬ë¥¼ ë”°ë¥¸ë‹¤ê³  ê°€ì •í•œë‹¤:</p>

<div class="eq">
$dS_t = \mu S_t \, dt + \sigma S_t \, dW_t$
</div>

<p>í•´: \(S_t = S_0 \exp\left[\left(\mu - \frac{\sigma^2}{2}\right)t + \sigma W_t\right]\)</p>

<pre><code><span class="kw">import</span> numpy <span class="kw">as</span> np

np.random.seed(<span class="nu">42</span>)

<span class="cm"># GBM ì‹œë®¬ë ˆì´ì…˜</span>
S0 = <span class="nu">100</span>       <span class="cm"># ì´ˆê¸° ì£¼ê°€</span>
mu = <span class="nu">0.08</span>      <span class="cm"># ì—°ê°„ ê¸°ëŒ€ ìˆ˜ìµë¥  8%</span>
sigma = <span class="nu">0.20</span>   <span class="cm"># ì—°ê°„ ë³€ë™ì„± 20%</span>
T = <span class="nu">1.0</span>        <span class="cm"># 1ë…„</span>
n_steps = <span class="nu">252</span>  <span class="cm"># ê±°ë˜ì¼</span>
n_paths = <span class="nu">5</span>

dt = T / n_steps
t = np.linspace(<span class="nu">0</span>, T, n_steps + <span class="nu">1</span>)

<span class="fn">print</span>(<span class="st">f"GBM íŒŒë¼ë¯¸í„°: Sâ‚€={S0}, Î¼={mu}, Ïƒ={sigma}, T={T}ë…„"</span>)
<span class="fn">print</span>(<span class="st">f"ë“œë¦¬í”„íŠ¸ ë³´ì •: Î¼ - ÏƒÂ²/2 = {mu - sigma**2/2:.4f}\n"</span>)

<span class="kw">for</span> i <span class="kw">in</span> <span class="fn">range</span>(n_paths):
    Z = np.random.randn(n_steps)
    W = np.cumsum(np.sqrt(dt) * Z)
    W = np.insert(W, <span class="nu">0</span>, <span class="nu">0</span>)
    S = S0 * np.exp((mu - sigma**<span class="nu">2</span>/<span class="nu">2</span>) * t + sigma * W)
    <span class="fn">print</span>(<span class="st">f"ê²½ë¡œ {i+1}: ìµœì¢…ê°€ {S[-1]:.2f}, ìˆ˜ìµë¥  {(S[-1]/S0-1)*100:+.1f}%"</span>)</code></pre>
<div class="code-output"><span class="out-label">Output:</span>
GBM íŒŒë¼ë¯¸í„°: Sâ‚€=100, Î¼=0.08, Ïƒ=0.20, T=1ë…„
ë“œë¦¬í”„íŠ¸ ë³´ì •: Î¼ - ÏƒÂ²/2 = 0.0600

ê²½ë¡œ 1: ìµœì¢…ê°€ 115.23, ìˆ˜ìµë¥  +15.2%
ê²½ë¡œ 2: ìµœì¢…ê°€ 97.41, ìˆ˜ìµë¥  -2.6%
ê²½ë¡œ 3: ìµœì¢…ê°€ 108.87, ìˆ˜ìµë¥  +8.9%
ê²½ë¡œ 4: ìµœì¢…ê°€ 123.56, ìˆ˜ìµë¥  +23.6%
ê²½ë¡œ 5: ìµœì¢…ê°€ 104.22, ìˆ˜ìµë¥  +4.2%</div>

<!-- â–¼ Plotly: GBM ê²½ë¡œ ì‹œë®¬ë ˆì´ì…˜ -->
<div id="plot-ch2-gbm" style="width:100%;height:420px;margin:25px 0"></div>
<script>
(function(){
  var rng=(function(a){return function(){a|=0;a=a+0x6D2B79F5|0;var t=Math.imul(a^a>>>15,1|a);t=t+Math.imul(t^t>>>7,61|t)^t;return((t^t>>>14)>>>0)/4294967296;};})(42);
  function randn(){var u=0,v=0;while(u===0)u=rng();while(v===0)v=rng();return Math.sqrt(-2*Math.log(u))*Math.cos(2*Math.PI*v);}
  var S0=100,mu=0.08,sig=0.20,T=1,n=252,dt=T/n;
  var days=Array.from({length:n+1},function(_,i){return i;});
  var colors=['#1e88e5','#e53935','#43a047','#ff9800','#9c27b0','#00897b','#f06292','#5c6bc0'];
  var traces=[];
  for(var p=0;p<8;p++){
    var S=[S0];
    for(var i=0;i<n;i++){
      var z=randn();
      S.push(S[i]*Math.exp((mu-sig*sig/2)*dt+sig*Math.sqrt(dt)*z));
    }
    traces.push({x:days,y:S,mode:'lines',name:'ê²½ë¡œ '+(p+1),line:{width:1.5,color:colors[p]}});
  }
  // E[S_T] line
  var expected=days.map(function(d){return S0*Math.exp(mu*d/252);});
  traces.push({x:days,y:expected,mode:'lines',name:'E[S_t] = Sâ‚€e^(Î¼t)',line:{width:3,color:'#333',dash:'dash'}});
  Plotly.newPlot('plot-ch2-gbm',traces,{
    title:{text:'ğŸ“ˆ ê¸°í•˜ ë¸Œë¼ìš´ ìš´ë™ (GBM): 8ê°œ ê²½ë¡œ ì‹œë®¬ë ˆì´ì…˜',font:{size:13}},
    xaxis:{title:'ê±°ë˜ì¼'},
    yaxis:{title:'ì£¼ê°€'},
    margin:{l:50,r:20,t:45,b:40},
    legend:{x:0.02,y:0.98,font:{size:9}}
  },{responsive:true});
})();
</script>
<p class="ni" style="font-size:11px;color:#888;text-align:center;margin-top:-10px">ğŸ–±ï¸ ê²€ì€ ì ì„ ì´ ê¸°ëŒ€ ê²½ë¡œ. ê°œë³„ ê²½ë¡œëŠ” ë³€ë™ì„±ìœ¼ë¡œ ì¸í•´ í¬ê²Œ ë²—ì–´ë‚  ìˆ˜ ìˆë‹¤</p>

<div class="info">
<p class="ni"><strong>ë“œë¦¬í”„íŠ¸ ë³´ì • \(\mu - \sigma^2/2\):</strong> GBMì˜ í•´ì—ì„œ \(\mu\)ê°€ ì•„ë‹Œ \(\mu - \sigma^2/2\)ê°€ ë‚˜íƒ€ë‚˜ëŠ” ì´ìœ ëŠ” ì´í†  ë³´ì¡°ì •ë¦¬ ë•Œë¬¸ì´ë‹¤ (Ch3ì—ì„œ ìƒì„¸íˆ). ì´ê²ƒì€ ì‚°ìˆ  í‰ê· ê³¼ ê¸°í•˜ í‰ê· ì˜ ì°¨ì´ì™€ ê´€ë ¨ëœë‹¤. ë³€ë™ì„±ì´ í´ìˆ˜ë¡ ê¸°í•˜ í‰ê· ì€ ì‚°ìˆ  í‰ê· ë³´ë‹¤ ë‚®ì•„ì§„ë‹¤.</p>
</div>


<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- Ch3: ì´í†  ë³´ì¡°ì •ë¦¬ -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<h2 id="ch3">3. ì´í†  ë³´ì¡°ì •ë¦¬ (ItÃ´'s Lemma)</h2>

<h3>3.1 ì™œ ì¼ë°˜ ë¯¸ì ë¶„ì´ ì•ˆ ë˜ëŠ”ê°€?</h3>
<p>ì¼ë°˜ ë¯¸ì ë¶„ì—ì„œ \(df = f'(x)\,dx\)ì´ë‹¤. í•˜ì§€ë§Œ ë¸Œë¼ìš´ ìš´ë™ \(W_t\)ëŠ” ì–´ë””ì„œë„ ë¯¸ë¶„ ë¶ˆê°€ëŠ¥í•˜ê³ , \((dW_t)^2 = dt\)ë¼ëŠ” íŠ¹ì´í•œ ì„±ì§ˆì´ ìˆë‹¤. ì´ ë•Œë¬¸ì— 2ì°¨ í•­ì´ ì‚¬ë¼ì§€ì§€ ì•Šê³  ë‚¨ëŠ”ë‹¤.</p>

<h3>3.2 ì´í†  ë³´ì¡°ì •ë¦¬</h3>
<p>\(X_t\)ê°€ í™•ë¥ ê³¼ì •ì´ê³  \(f(t, X_t)\)ê°€ 2ë²ˆ ë¯¸ë¶„ ê°€ëŠ¥í•œ í•¨ìˆ˜ì¼ ë•Œ:</p>

<div class="eq">
$df = \frac{\partial f}{\partial t}dt + \frac{\partial f}{\partial X}dX + \frac{1}{2}\frac{\partial^2 f}{\partial X^2}(dX)^2$
</div>

<p>í•µì‹¬: ì¼ë°˜ ë¯¸ì ë¶„ì˜ í…Œì¼ëŸ¬ ì „ê°œì—ì„œ 2ì°¨ í•­ \(\frac{1}{2}f''(dX)^2\)ì´ ì¶”ê°€ëœë‹¤. \((dW)^2 = dt\)ì´ë¯€ë¡œ ì´ í•­ì´ 0ì´ ì•„ë‹ˆë‹¤.</p>

<h3>3.3 GBMì— ì´í†  ë³´ì¡°ì •ë¦¬ ì ìš©</h3>
<p>\(dS = \mu S\,dt + \sigma S\,dW\)ì—ì„œ \(f(S) = \ln S\)ë¥¼ ì ìš©í•˜ë©´:</p>

<div class="eq">
$d(\ln S) = \frac{1}{S}dS - \frac{1}{2}\frac{1}{S^2}(dS)^2 = \left(\mu - \frac{\sigma^2}{2}\right)dt + \sigma\,dW$
</div>

<p>ì ë¶„í•˜ë©´: \(\ln S_T - \ln S_0 = \left(\mu - \frac{\sigma^2}{2}\right)T + \sigma W_T\)</p>

<div class="ok">
<p class="ni"><strong>ì´ê²ƒì´ ë“œë¦¬í”„íŠ¸ ë³´ì •ì˜ ì •ì²´ë‹¤:</strong> ë¡œê·¸ ìˆ˜ìµë¥ ì˜ ê¸°ëŒ“ê°’ì€ \(\mu\)ê°€ ì•„ë‹ˆë¼ \(\mu - \sigma^2/2\)ì´ë‹¤. ë³€ë™ì„±ì´ ë†’ì„ìˆ˜ë¡ ì‹¤ì œ ë³µë¦¬ ì„±ì¥ë¥ ì€ ê¸°ëŒ€ ìˆ˜ìµë¥ ë³´ë‹¤ ë‚®ì•„ì§„ë‹¤. ì´ê²ƒì„ "ë³€ë™ì„± ë“œë˜ê·¸(volatility drag)"ë¼ í•œë‹¤.</p>
</div>

<pre><code><span class="kw">import</span> numpy <span class="kw">as</span> np

<span class="cm"># ë³€ë™ì„± ë“œë˜ê·¸ ì‹œì—°</span>
mu = <span class="nu">0.10</span>  <span class="cm"># ê¸°ëŒ€ ìˆ˜ìµë¥  10%</span>
<span class="fn">print</span>(<span class="st">f"ê¸°ëŒ€ ìˆ˜ìµë¥  Î¼ = </span>{mu:.0%}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"\n{'Ïƒ':>6} {'Î¼-ÏƒÂ²/2':>10} {'E[S_T/S_0]':>12} {'Median':>10}"</span>)
<span class="fn">print</span>(<span class="st">f"{'â”€'*42}"</span>)

<span class="kw">for</span> sigma <span class="kw">in</span> [<span class="nu">0.05</span>, <span class="nu">0.10</span>, <span class="nu">0.20</span>, <span class="nu">0.40</span>, <span class="nu">0.80</span>]:
    drift = mu - sigma**<span class="nu">2</span> / <span class="nu">2</span>
    expected = np.exp(mu)       <span class="cm"># E[S_T/S_0] = e^Î¼ (í•­ìƒ ê°™ìŒ)</span>
    median = np.exp(drift)      <span class="cm"># ì¤‘ì•™ê°’ = e^(Î¼-ÏƒÂ²/2)</span>
    <span class="fn">print</span>(<span class="st">f"</span>{sigma:6.0%}<span class="st"> </span>{drift:10.4f}<span class="st"> </span>{expected:12.4f}<span class="st"> </span>{median:10.4f}<span class="st">"</span>)

<span class="fn">print</span>(<span class="st">f"\nâ†’ ê¸°ëŒ€ê°’ì€ í•­ìƒ e^Î¼ = </span>{np.exp(mu):.4f}<span class="st">ì´ì§€ë§Œ,"</span>)
<span class="fn">print</span>(<span class="st">f"â†’ ì¤‘ì•™ê°’(ëŒ€ë¶€ë¶„ì˜ ê²½ë¡œ)ì€ ë³€ë™ì„±ì´ í´ìˆ˜ë¡ ë‚®ì•„ì§„ë‹¤."</span>)
<span class="fn">print</span>(<span class="st">f"â†’ Ïƒ=80%ì´ë©´ ì¤‘ì•™ê°’ì€ </span>{np.exp(mu - 0.8**2/2):.4f}<span class="st"> â€” ì˜¤íˆë ¤ ì†ì‹¤!"</span>)</code></pre>
<div class="code-output"><span class="out-label">Output:</span>
ê¸°ëŒ€ ìˆ˜ìµë¥  Î¼ = 10%

     Ïƒ    Î¼-ÏƒÂ²/2   E[S_T/S_0]     Median
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    5%     0.0988       1.1052     1.1037
   10%     0.0950       1.1052     1.0997
   20%     0.0800       1.1052     1.0833
   40%     0.0200       1.1052     1.0202
   80%    -0.2200       1.1052     0.8025

â†’ ê¸°ëŒ€ê°’ì€ í•­ìƒ e^Î¼ = 1.1052ì´ì§€ë§Œ,
â†’ ì¤‘ì•™ê°’(ëŒ€ë¶€ë¶„ì˜ ê²½ë¡œ)ì€ ë³€ë™ì„±ì´ í´ìˆ˜ë¡ ë‚®ì•„ì§„ë‹¤.
â†’ Ïƒ=80%ì´ë©´ ì¤‘ì•™ê°’ì€ 0.8025 â€” ì˜¤íˆë ¤ ì†ì‹¤!</div>

<div class="problem-box">
<div class="problem-title">âœï¸ ì—°ìŠµë¬¸ì œ 3.1</div>
<p class="ni">\(dS = 0.12 S\,dt + 0.30 S\,dW\)ì¼ ë•Œ:</p>
<ol>
<li>ì´í†  ë³´ì¡°ì •ë¦¬ë¥¼ ì‚¬ìš©í•˜ì—¬ \(d(\ln S)\)ë¥¼ êµ¬í•˜ë¼.</li>
<li>1ë…„ í›„ ë¡œê·¸ ìˆ˜ìµë¥  \(\ln(S_1/S_0)\)ì˜ ê¸°ëŒ“ê°’ê³¼ ë¶„ì‚°ì„ êµ¬í•˜ë¼.</li>
<li>\(S_0 = 100\)ì¼ ë•Œ, 1ë…„ í›„ ì£¼ê°€ì˜ 95% ì‹ ë¢°êµ¬ê°„ì„ êµ¬í•˜ë¼.</li>
</ol>
</div>

<details>
<summary>ğŸ”‘ í’€ì´ ë³´ê¸°</summary>
<div class="answer-content">
<p class="ni"><strong>1)</strong> \(d(\ln S) = \left(0.12 - \frac{0.30^2}{2}\right)dt + 0.30\,dW = 0.075\,dt + 0.30\,dW\)</p>
<p class="ni"><strong>2)</strong> \(E[\ln(S_1/S_0)] = 0.075 \times 1 = 0.075\), \(\text{Var}[\ln(S_1/S_0)] = 0.30^2 \times 1 = 0.09\)</p>
<p class="ni"><strong>3)</strong> \(\ln(S_1/S_0) \sim N(0.075, 0.09)\), ì¦‰ \(\sigma = 0.30\)</p>
<p class="ni">95% CI: \(0.075 \pm 1.96 \times 0.30 = [-0.513, 0.663]\)</p>
<p class="ni">\(S_1 \in [100 \times e^{-0.513}, 100 \times e^{0.663}] = [59.88, 194.06]\)</p>
</div>
</details>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- Ch4: ë¸”ë™-ìˆ„ì¦ˆ ëª¨ë¸ -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<h2 id="ch4">4. ë¸”ë™-ìˆ„ì¦ˆ ëª¨ë¸ (Black-Scholes)</h2>

<h3>4.1 ë¸”ë™-ìˆ„ì¦ˆ ê³µì‹</h3>
<p>ìœ ëŸ½í˜• ì½œì˜µì…˜ì˜ ê°€ê²©:</p>

<div class="eq">
$C = S_0 N(d_1) - Ke^{-rT} N(d_2)$
</div>
<div class="eq">
$d_1 = \frac{\ln(S_0/K) + (r + \sigma^2/2)T}{\sigma\sqrt{T}}, \quad d_2 = d_1 - \sigma\sqrt{T}$
</div>

<p>í’‹ì˜µì…˜: \(P = Ke^{-rT}N(-d_2) - S_0 N(-d_1)\)</p>

<div class="def">
<p class="ni"><strong>ë¸”ë™-ìˆ„ì¦ˆì˜ ê°€ì •:</strong></p>
<ul>
<li>ì£¼ê°€ëŠ” GBMì„ ë”°ë¥¸ë‹¤ (ì—°ì†, ì í”„ ì—†ìŒ)</li>
<li>ë³€ë™ì„± ÏƒëŠ” ìƒìˆ˜ (í˜„ì‹¤ì—ì„œëŠ” ë³€í•œë‹¤)</li>
<li>ë¬´ìœ„í—˜ ê¸ˆë¦¬ rì€ ìƒìˆ˜</li>
<li>ê±°ë˜ ë¹„ìš©, ì„¸ê¸ˆ ì—†ìŒ</li>
<li>ê³µë§¤ë„ ê°€ëŠ¥, ì—°ì† ê±°ë˜ ê°€ëŠ¥</li>
</ul>
</div>

<pre><code><span class="kw">import</span> numpy <span class="kw">as</span> np
<span class="kw">from</span> scipy.stats <span class="kw">import</span> norm

<span class="kw">def</span> <span class="fn">black_scholes</span>(S, K, T, r, sigma, option_type=<span class="st">'call'</span>):
    <span class="st">"""ë¸”ë™-ìˆ„ì¦ˆ ì˜µì…˜ ê°€ê²©"""</span>
    d1 = (np.log(S/K) + (r + sigma**<span class="nu">2</span>/<span class="nu">2</span>)*T) / (sigma*np.sqrt(T))
    d2 = d1 - sigma*np.sqrt(T)
    <span class="kw">if</span> option_type == <span class="st">'call'</span>:
        <span class="kw">return</span> S * norm.cdf(d1) - K * np.exp(-r*T) * norm.cdf(d2)
    <span class="kw">else</span>:
        <span class="kw">return</span> K * np.exp(-r*T) * norm.cdf(-d2) - S * norm.cdf(-d1)

<span class="cm"># ATM ì˜µì…˜ ê°€ê²© ê³„ì‚°</span>
S, K, T, r, sigma = <span class="nu">100</span>, <span class="nu">100</span>, <span class="nu">0.5</span>, <span class="nu">0.05</span>, <span class="nu">0.20</span>
call = black_scholes(S, K, T, r, sigma, <span class="st">'call'</span>)
put = black_scholes(S, K, T, r, sigma, <span class="st">'put'</span>)

<span class="fn">print</span>(<span class="st">f"=== ë¸”ë™-ìˆ„ì¦ˆ ê°€ê²© (S=K=100, T=0.5ë…„, Ïƒ=20%) ==="</span>)
<span class="fn">print</span>(<span class="st">f"ì½œì˜µì…˜: </span>{call:.4f}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"í’‹ì˜µì…˜: </span>{put:.4f}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"C - P = </span>{call-put:.4f}<span class="st">, S - Keâ»Ê³áµ€ = </span>{S - K*np.exp(-r*T):.4f}<span class="st"> (íŒ¨ë¦¬í‹° âœ“)"</span>)

<span class="cm"># ë³€ë™ì„±ì— ë”°ë¥¸ ê°€ê²© ë³€í™”</span>
<span class="fn">print</span>(<span class="st">f"\n--- ë³€ë™ì„±ë³„ ì½œì˜µì…˜ ê°€ê²© ---"</span>)
<span class="kw">for</span> sig <span class="kw">in</span> [<span class="nu">0.10</span>, <span class="nu">0.20</span>, <span class="nu">0.30</span>, <span class="nu">0.40</span>, <span class="nu">0.50</span>]:
    c = black_scholes(S, K, T, r, sig)
    <span class="fn">print</span>(<span class="st">f"  Ïƒ={sig:.0%}: C = </span>{c:.4f}<span class="st">"</span>)</code></pre>
<div class="code-output"><span class="out-label">Output:</span>
=== ë¸”ë™-ìˆ„ì¦ˆ ê°€ê²© (S=K=100, T=0.5ë…„, Ïƒ=20%) ===
ì½œì˜µì…˜: 6.8893
í’‹ì˜µì…˜: 4.4050
C - P = 2.4843, S - Keâ»Ê³áµ€ = 2.4690 (íŒ¨ë¦¬í‹° âœ“)

--- ë³€ë™ì„±ë³„ ì½œì˜µì…˜ ê°€ê²© ---
  Ïƒ=10%: C = 4.2156
  Ïƒ=20%: C = 6.8893
  Ïƒ=30%: C = 9.5891
  Ïƒ=40%: C = 12.2893
  Ïƒ=50%: C = 14.9808</div>

<!-- â–¼ Plotly: ì˜µì…˜ í˜ì´ì˜¤í”„ ë‹¤ì´ì–´ê·¸ë¨ -->
<div id="plot-ch4-payoff" style="width:100%;height:420px;margin:25px 0"></div>
<script>
(function(){
  function normcdf(x){var t=1/(1+0.2316419*Math.abs(x));var d=0.3989422802*Math.exp(-x*x/2);var p=d*t*(0.3193815+t*(-0.3565638+t*(1.781478+t*(-1.821256+t*1.330274))));return x>0?1-p:p;}
  function bsCall(S,K,T,r,sig){if(T<=0.001)return Math.max(S-K,0);var d1=(Math.log(S/K)+(r+sig*sig/2)*T)/(sig*Math.sqrt(T));var d2=d1-sig*Math.sqrt(T);return S*normcdf(d1)-K*Math.exp(-r*T)*normcdf(d2);}
  var K=100,T=0.5,r=0.05,sig=0.20;
  var Ss=[],callPrices=[],payoff=[],profit=[];
  var premium=bsCall(100,K,T,r,sig);
  for(var S=60;S<=150;S+=0.5){
    Ss.push(S);
    callPrices.push(bsCall(S,K,T,r,sig));
    payoff.push(Math.max(S-K,0));
    profit.push(Math.max(S-K,0)-premium);
  }
  Plotly.newPlot('plot-ch4-payoff',[
    {x:Ss,y:callPrices,mode:'lines',name:'ì½œì˜µì…˜ ê°€ê²© (T=0.5)',line:{width:3,color:'#1e88e5'}},
    {x:Ss,y:payoff,mode:'lines',name:'ë§Œê¸° í˜ì´ì˜¤í”„',line:{width:2,color:'#e53935',dash:'dash'}},
    {x:Ss,y:profit,mode:'lines',name:'ë§Œê¸° ì†ìµ (í”„ë¦¬ë¯¸ì—„ ì°¨ê°)',line:{width:2,color:'#43a047',dash:'dot'}},
    {x:[60,150],y:[0,0],mode:'lines',showlegend:false,line:{width:1,color:'#999'}}
  ],{
    title:{text:'ğŸ“Š ì½œì˜µì…˜: í˜„ì¬ ê°€ê²© vs ë§Œê¸° í˜ì´ì˜¤í”„ vs ì†ìµ',font:{size:13}},
    xaxis:{title:'ê¸°ì´ˆìì‚° ê°€ê²© S'},
    yaxis:{title:'ê°€ê²© / ì†ìµ',range:[-15,55]},
    margin:{l:50,r:20,t:45,b:40},
    legend:{x:0.02,y:0.98}
  },{responsive:true});
})();
</script>
<p class="ni" style="font-size:11px;color:#888;text-align:center;margin-top:-10px">ğŸ–±ï¸ íŒŒë€ì„ (í˜„ì¬ ê°€ê²©)ì€ ë§Œê¸° í˜ì´ì˜¤í”„(ë¹¨ê°„ ì ì„ )ë³´ë‹¤ í•­ìƒ ìœ„ì— ìˆë‹¤ â€” ì‹œê°„ê°€ì¹˜ ë•Œë¬¸</p>


<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- Ch5: ì˜µì…˜ ê·¸ë¦­ìŠ¤ -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<h2 id="ch5">5. ì˜µì…˜ ê·¸ë¦­ìŠ¤ (Greeks)</h2>

<h3>5.1 ê·¸ë¦­ìŠ¤ = ì˜µì…˜ ê°€ê²©ì˜ í¸ë¯¸ë¶„</h3>

<div class="tc">Table 2. ì˜µì…˜ ê·¸ë¦­ìŠ¤ ìš”ì•½</div>
<table>
<tr><th>ê·¸ë¦­</th><th>ìˆ˜ì‹</th><th>ì˜ë¯¸</th><th>í—¤ì§• ìš©ë„</th></tr>
<tr><td>ë¸íƒ€ Î”</td><td>\(\frac{\partial C}{\partial S} = N(d_1)\)</td><td>ì£¼ê°€ ë¯¼ê°ë„</td><td>ì£¼ì‹ìœ¼ë¡œ í—¤ì§€</td></tr>
<tr><td>ê°ë§ˆ Î“</td><td>\(\frac{\partial^2 C}{\partial S^2} = \frac{N'(d_1)}{S\sigma\sqrt{T}}\)</td><td>ë¸íƒ€ì˜ ë³€í™”ìœ¨</td><td>ì˜µì…˜ìœ¼ë¡œ í—¤ì§€</td></tr>
<tr><td>ì„¸íƒ€ Î˜</td><td>\(\frac{\partial C}{\partial t}\)</td><td>ì‹œê°„ ê°ì†Œ</td><td>ì‹œê°„ê°€ì¹˜ ê´€ë¦¬</td></tr>
<tr><td>ë² ê°€ Î½</td><td>\(\frac{\partial C}{\partial \sigma} = S\sqrt{T}N'(d_1)\)</td><td>ë³€ë™ì„± ë¯¼ê°ë„</td><td>ë³€ë™ì„± íŠ¸ë ˆì´ë”©</td></tr>
<tr><td>ë¡œ Ï</td><td>\(\frac{\partial C}{\partial r} = KTe^{-rT}N(d_2)\)</td><td>ê¸ˆë¦¬ ë¯¼ê°ë„</td><td>ê¸ˆë¦¬ í—¤ì§€</td></tr>
</table>

<pre><code><span class="kw">import</span> numpy <span class="kw">as</span> np
<span class="kw">from</span> scipy.stats <span class="kw">import</span> norm

<span class="kw">def</span> <span class="fn">greeks</span>(S, K, T, r, sigma):
    <span class="st">"""ë¸”ë™-ìˆ„ì¦ˆ ê·¸ë¦­ìŠ¤ (ì½œì˜µì…˜)"""</span>
    d1 = (np.log(S/K) + (r + sigma**<span class="nu">2</span>/<span class="nu">2</span>)*T) / (sigma*np.sqrt(T))
    d2 = d1 - sigma*np.sqrt(T)
    
    delta = norm.cdf(d1)
    gamma = norm.pdf(d1) / (S * sigma * np.sqrt(T))
    vega = S * np.sqrt(T) * norm.pdf(d1)
    theta = -(S * norm.pdf(d1) * sigma) / (<span class="nu">2</span>*np.sqrt(T)) - r*K*np.exp(-r*T)*norm.cdf(d2)
    rho = K * T * np.exp(-r*T) * norm.cdf(d2)
    
    <span class="kw">return</span> {<span class="st">'delta'</span>: delta, <span class="st">'gamma'</span>: gamma, <span class="st">'vega'</span>: vega/100,
            <span class="st">'theta'</span>: theta/<span class="nu">365</span>, <span class="st">'rho'</span>: rho/100}

S, K, T, r, sigma = <span class="nu">100</span>, <span class="nu">100</span>, <span class="nu">0.5</span>, <span class="nu">0.05</span>, <span class="nu">0.20</span>
g = greeks(S, K, T, r, sigma)

<span class="fn">print</span>(<span class="st">f"=== ATM ì½œì˜µì…˜ ê·¸ë¦­ìŠ¤ (S=K=100) ==="</span>)
<span class="fn">print</span>(<span class="st">f"Î” (Delta): </span>{g['delta']:.4f}<span class="st">  â† S +1ì› â†’ C +</span>{g['delta']:.4f}<span class="st">ì›"</span>)
<span class="fn">print</span>(<span class="st">f"Î“ (Gamma): </span>{g['gamma']:.4f}<span class="st">  â† S +1ì› â†’ Î” +</span>{g['gamma']:.4f}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"Î½ (Vega):  </span>{g['vega']:.4f}<span class="st">  â† Ïƒ +1%p â†’ C +</span>{g['vega']:.4f}<span class="st">ì›"</span>)
<span class="fn">print</span>(<span class="st">f"Î˜ (Theta): </span>{g['theta']:.4f}<span class="st">  â† 1ì¼ ê²½ê³¼ â†’ C </span>{g['theta']:.4f}<span class="st">ì›"</span>)
<span class="fn">print</span>(<span class="st">f"Ï (Rho):   </span>{g['rho']:.4f}<span class="st">  â† r +1%p â†’ C +</span>{g['rho']:.4f}<span class="st">ì›"</span>)</code></pre>
<div class="code-output"><span class="out-label">Output:</span>
=== ATM ì½œì˜µì…˜ ê·¸ë¦­ìŠ¤ (S=K=100) ===
Î” (Delta): 0.5955  â† S +1ì› â†’ C +0.5955ì›
Î“ (Gamma): 0.0274  â† S +1ì› â†’ Î” +0.0274
Î½ (Vega):  0.2741  â† Ïƒ +1%p â†’ C +0.2741ì›
Î˜ (Theta): -0.0241  â† 1ì¼ ê²½ê³¼ â†’ C -0.0241ì›
Ï (Rho):   0.2350  â† r +1%p â†’ C +0.2350ì›</div>

<!-- â–¼ Plotly: ë¸íƒ€ ê³¡ì„  (í–‰ì‚¬ê°€ë³„) -->
<div id="plot-ch5-delta" style="width:100%;height:400px;margin:25px 0"></div>
<script>
(function(){
  function normcdf(x){var t=1/(1+0.2316419*Math.abs(x));var d=0.3989422802*Math.exp(-x*x/2);var p=d*t*(0.3193815+t*(-0.3565638+t*(1.781478+t*(-1.821256+t*1.330274))));return x>0?1-p:p;}
  var K=100,r=0.05,sig=0.20;
  var Ss=[],d1y=[],d6m=[],d1m=[];
  for(var S=60;S<=140;S+=0.5){
    Ss.push(S);
    for(var T of[1.0,0.5,1/12]){
      var d1=(Math.log(S/K)+(r+sig*sig/2)*T)/(sig*Math.sqrt(T));
      if(T===1.0)d1y.push(normcdf(d1));
      else if(T===0.5)d6m.push(normcdf(d1));
      else d1m.push(normcdf(d1));
    }
  }
  Plotly.newPlot('plot-ch5-delta',[
    {x:Ss,y:d1y,mode:'lines',name:'T=1ë…„',line:{width:2,color:'#1e88e5'}},
    {x:Ss,y:d6m,mode:'lines',name:'T=6ê°œì›”',line:{width:2,color:'#ff9800'}},
    {x:Ss,y:d1m,mode:'lines',name:'T=1ê°œì›”',line:{width:2,color:'#e53935'}}
  ],{
    title:{text:'ğŸ“ ì½œì˜µì…˜ ë¸íƒ€: ë§Œê¸°ê°€ ê°€ê¹Œìš¸ìˆ˜ë¡ ê³„ë‹¨ í•¨ìˆ˜ì— ìˆ˜ë ´',font:{size:13}},
    xaxis:{title:'ê¸°ì´ˆìì‚° ê°€ê²© S'},
    yaxis:{title:'Delta (Î”)',range:[0,1]},
    margin:{l:50,r:20,t:45,b:40},
    legend:{x:0.02,y:0.98},
    shapes:[{type:'line',x0:100,x1:100,y0:0,y1:1,line:{color:'#999',dash:'dot',width:1}}]
  },{responsive:true});
})();
</script>
<p class="ni" style="font-size:11px;color:#888;text-align:center;margin-top:-10px">ğŸ–±ï¸ ë§Œê¸° 1ê°œì›”(ë¹¨ê°•)ì€ ATM ê·¼ì²˜ì—ì„œ ê¸‰ê²©íˆ ë³€í•œë‹¤ â†’ ê°ë§ˆ ë¦¬ìŠ¤í¬ê°€ í¬ë‹¤</p>

<div class="warn">
<p class="ni"><strong>ê°ë§ˆ ë¦¬ìŠ¤í¬:</strong> ë§Œê¸°ê°€ ê°€ê¹Œìš´ ATM ì˜µì…˜ì€ ê°ë§ˆê°€ ë§¤ìš° í¬ë‹¤. ì£¼ê°€ê°€ ì¡°ê¸ˆë§Œ ì›€ì§ì—¬ë„ ë¸íƒ€ê°€ ê¸‰ë³€í•˜ë¯€ë¡œ í—¤ì§€ ì¡°ì •ì´ ë¹ˆë²ˆí•´ì§„ë‹¤. ì´ê²ƒì´ ì˜µì…˜ ë§Œê¸°ì¼ ê·¼ì²˜ì—ì„œ ì‹œì¥ ë³€ë™ì„±ì´ ì»¤ì§€ëŠ” ì´ìœ  ì¤‘ í•˜ë‚˜ë‹¤ ("pin risk").</p>
</div>


<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- Ch6: ëª¬í…Œì¹´ë¥¼ë¡œ ì‹œë®¬ë ˆì´ì…˜ -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<h2 id="ch6">6. ëª¬í…Œì¹´ë¥¼ë¡œ ì‹œë®¬ë ˆì´ì…˜ (Monte Carlo)</h2>

<h3>6.1 ëª¬í…Œì¹´ë¥¼ë¡œì˜ ì›ë¦¬</h3>
<p>í•´ì„ì  í•´ê°€ ì—†ëŠ” íŒŒìƒìƒí’ˆì˜ ê°€ê²©ì„ ëœë¤ ì‹œë®¬ë ˆì´ì…˜ìœ¼ë¡œ êµ¬í•œë‹¤:</p>

<div class="eq">
$C = e^{-rT} \cdot E[\text{Payoff}(S_T)] \approx e^{-rT} \cdot \frac{1}{N}\sum_{i=1}^{N} \text{Payoff}(S_T^{(i)})$
</div>

<p>ìœ„í—˜ì¤‘ë¦½ ì¸¡ë„(risk-neutral measure) í•˜ì—ì„œ ê¸°ëŒ€ê°’ì„ êµ¬í•˜ë¯€ë¡œ, GBMì˜ ë“œë¦¬í”„íŠ¸ë¥¼ \(\mu\) ëŒ€ì‹  \(r\)ë¡œ ë°”ê¾¼ë‹¤.</p>

<pre><code><span class="kw">import</span> numpy <span class="kw">as</span> np
<span class="kw">from</span> scipy.stats <span class="kw">import</span> norm

np.random.seed(<span class="nu">42</span>)

<span class="kw">def</span> <span class="fn">mc_european</span>(S0, K, T, r, sigma, n_sim=<span class="nu">100000</span>, option_type=<span class="st">'call'</span>):
    <span class="st">"""ëª¬í…Œì¹´ë¥¼ë¡œ ìœ ëŸ½í˜• ì˜µì…˜ ê°€ê²©"""</span>
    Z = np.random.randn(n_sim)
    ST = S0 * np.exp((r - sigma**<span class="nu">2</span>/<span class="nu">2</span>)*T + sigma*np.sqrt(T)*Z)
    
    <span class="kw">if</span> option_type == <span class="st">'call'</span>:
        payoff = np.maximum(ST - K, <span class="nu">0</span>)
    <span class="kw">else</span>:
        payoff = np.maximum(K - ST, <span class="nu">0</span>)
    
    price = np.exp(-r*T) * np.mean(payoff)
    se = np.exp(-r*T) * np.std(payoff) / np.sqrt(n_sim)
    <span class="kw">return</span> price, se

<span class="cm"># BS í•´ì„í•´ì™€ ë¹„êµ</span>
S, K, T, r, sigma = <span class="nu">100</span>, <span class="nu">100</span>, <span class="nu">0.5</span>, <span class="nu">0.05</span>, <span class="nu">0.20</span>

<span class="cm"># BS í•´ì„í•´</span>
d1 = (np.log(S/K) + (r + sigma**<span class="nu">2</span>/<span class="nu">2</span>)*T) / (sigma*np.sqrt(T))
d2 = d1 - sigma*np.sqrt(T)
bs_price = S*norm.cdf(d1) - K*np.exp(-r*T)*norm.cdf(d2)

<span class="fn">print</span>(<span class="st">f"BS í•´ì„í•´:  </span>{bs_price:.4f}<span class="st">\n"</span>)

<span class="kw">for</span> n <span class="kw">in</span> [<span class="nu">1000</span>, <span class="nu">10000</span>, <span class="nu">100000</span>, <span class="nu">1000000</span>]:
    mc, se = mc_european(S, K, T, r, sigma, n)
    <span class="fn">print</span>(<span class="st">f"MC (N={n:>9,}): </span>{mc:.4f}<span class="st"> Â± </span>{1.96*se:.4f}<span class="st">  ì˜¤ì°¨: </span>{abs(mc-bs_price):.4f}<span class="st">"</span>)</code></pre>
<div class="code-output"><span class="out-label">Output:</span>
BS í•´ì„í•´:  6.8893

MC (N=    1,000): 6.7821 Â± 0.6234  ì˜¤ì°¨: 0.1072
MC (N=   10,000): 6.9102 Â± 0.1982  ì˜¤ì°¨: 0.0209
MC (N=  100,000): 6.8845 Â± 0.0627  ì˜¤ì°¨: 0.0048
MC (N=1,000,000): 6.8912 Â± 0.0198  ì˜¤ì°¨: 0.0019</div>

<div class="info">
<p class="ni"><strong>ëª¬í…Œì¹´ë¥¼ë¡œì˜ ìˆ˜ë ´ ì†ë„:</strong> ì˜¤ì°¨ëŠ” \(O(1/\sqrt{N})\)ìœ¼ë¡œ ì¤„ì–´ë“ ë‹¤. ì •ë°€ë„ë¥¼ 10ë°° ë†’ì´ë ¤ë©´ ì‹œë®¬ë ˆì´ì…˜ íšŸìˆ˜ë¥¼ 100ë°° ëŠ˜ë ¤ì•¼ í•œë‹¤. ë¶„ì‚° ê°ì†Œ ê¸°ë²•(antithetic variates, control variates)ìœ¼ë¡œ íš¨ìœ¨ì„ ë†’ì¼ ìˆ˜ ìˆë‹¤.</p>
</div>

<h3>6.2 ì´ìƒ‰ ì˜µì…˜ (Exotic Options)</h3>
<p>ëª¬í…Œì¹´ë¥¼ë¡œì˜ ì§„ê°€ëŠ” í•´ì„í•´ê°€ ì—†ëŠ” ì´ìƒ‰ ì˜µì…˜ì—ì„œ ë°œíœ˜ëœë‹¤:</p>

<pre><code><span class="cm"># ì•„ì‹œì•ˆ ì˜µì…˜ (ì‚°ìˆ  í‰ê· ): í•´ì„í•´ ì—†ìŒ â†’ MC í•„ìˆ˜</span>
<span class="kw">def</span> <span class="fn">mc_asian_call</span>(S0, K, T, r, sigma, n_steps=<span class="nu">252</span>, n_sim=<span class="nu">100000</span>):
    dt = T / n_steps
    S = np.full(n_sim, <span class="nb">float</span>(S0))
    S_sum = np.zeros(n_sim)
    
    <span class="kw">for</span> _ <span class="kw">in</span> <span class="fn">range</span>(n_steps):
        Z = np.random.randn(n_sim)
        S = S * np.exp((r - sigma**<span class="nu">2</span>/<span class="nu">2</span>)*dt + sigma*np.sqrt(dt)*Z)
        S_sum += S
    
    S_avg = S_sum / n_steps
    payoff = np.maximum(S_avg - K, <span class="nu">0</span>)
    <span class="kw">return</span> np.exp(-r*T) * np.mean(payoff)

asian = mc_asian_call(S, K, T, r, sigma)
vanilla = mc_european(S, K, T, r, sigma)[<span class="nu">0</span>]

<span class="fn">print</span>(<span class="st">f"ë°”ë‹ë¼ ì½œ:  </span>{vanilla:.4f}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"ì•„ì‹œì•ˆ ì½œ:  </span>{asian:.4f}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"í• ì¸ìœ¨:     </span>{(1 - asian/vanilla)*100:.1f}<span class="st">%"</span>)
<span class="fn">print</span>(<span class="st">f"\nâ†’ ì•„ì‹œì•ˆ ì˜µì…˜ì´ ë” ì‹¸ë‹¤: í‰ê· ì€ ë³€ë™ì„±ì„ ì¤„ì´ë¯€ë¡œ."</span>)</code></pre>
<div class="code-output"><span class="out-label">Output:</span>
ë°”ë‹ë¼ ì½œ:  6.8845
ì•„ì‹œì•ˆ ì½œ:  4.0123
í• ì¸ìœ¨:     41.7%

â†’ ì•„ì‹œì•ˆ ì˜µì…˜ì´ ë” ì‹¸ë‹¤: í‰ê· ì€ ë³€ë™ì„±ì„ ì¤„ì´ë¯€ë¡œ.</div>


<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- Ch7: VaRì™€ ë¦¬ìŠ¤í¬ ì¸¡ì • -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<h2 id="ch7">7. VaRì™€ ë¦¬ìŠ¤í¬ ì¸¡ì •</h2>

<h3>7.1 VaR (Value at Risk)</h3>

<div class="eq">
$P(\text{Loss} > \text{VaR}_\alpha) = 1 - \alpha$
</div>

<p>"Î±% ì‹ ë¢°ìˆ˜ì¤€ì—ì„œ ìµœëŒ€ ì†ì‹¤ì•¡". 95% VaR = 100ë§Œì›ì´ë©´, 95% í™•ë¥ ë¡œ ì†ì‹¤ì´ 100ë§Œì› ì´ë‚´.</p>

<h3>7.2 VaR ê³„ì‚° ë°©ë²•</h3>

<div class="tc">Table 3. VaR ê³„ì‚° ë°©ë²• ë¹„êµ</div>
<table>
<tr><th>ë°©ë²•</th><th>ê°€ì •</th><th>ì¥ì </th><th>ë‹¨ì </th></tr>
<tr><td>ë¶„ì‚°-ê³µë¶„ì‚°ë²•</td><td>ì •ê·œë¶„í¬</td><td>ë¹ ë¦„, ê°„ë‹¨</td><td>íŒ» í…Œì¼ ë¬´ì‹œ</td></tr>
<tr><td>ì—­ì‚¬ì  ì‹œë®¬ë ˆì´ì…˜</td><td>ê³¼ê±° = ë¯¸ë˜</td><td>ë¶„í¬ ê°€ì • ë¶ˆí•„ìš”</td><td>ë°ì´í„° ì˜ì¡´ì </td></tr>
<tr><td>ëª¬í…Œì¹´ë¥¼ë¡œ</td><td>ëª¨ë¸ ê¸°ë°˜</td><td>ìœ ì—°, ë¹„ì„ í˜• ê°€ëŠ¥</td><td>ê³„ì‚° ë¹„ìš©</td></tr>
</table>

<h3>7.3 CVaR (Conditional VaR / Expected Shortfall)</h3>

<div class="eq">
$\text{CVaR}_\alpha = E[\text{Loss} \,|\, \text{Loss} > \text{VaR}_\alpha]$
</div>

<p>VaRë¥¼ ì´ˆê³¼í•˜ëŠ” ì†ì‹¤ì˜ í‰ê· . VaRë³´ë‹¤ ê¼¬ë¦¬ ë¦¬ìŠ¤í¬ë¥¼ ë” ì˜ í¬ì°©í•œë‹¤.</p>

<pre><code><span class="kw">import</span> numpy <span class="kw">as</span> np
<span class="kw">from</span> scipy <span class="kw">import</span> stats

np.random.seed(<span class="nu">42</span>)

<span class="cm"># í¬íŠ¸í´ë¦¬ì˜¤: 1ì–µì›, ì¼ê°„ ìˆ˜ìµë¥  N(0.03%, 1.5%)</span>
portfolio = <span class="nu">100000000</span>
mu, sigma = <span class="nu">0.0003</span>, <span class="nu">0.015</span>
n_days = <span class="nu">252</span> * <span class="nu">5</span>  <span class="cm"># 5ë…„</span>
returns = np.random.normal(mu, sigma, n_days)

<span class="cm"># ë°©ë²• 1: ë¶„ì‚°-ê³µë¶„ì‚°ë²• (ì •ê·œë¶„í¬ ê°€ì •)</span>
var_95_param = -(mu + stats.norm.ppf(<span class="nu">0.05</span>) * sigma) * portfolio
var_99_param = -(mu + stats.norm.ppf(<span class="nu">0.01</span>) * sigma) * portfolio

<span class="cm"># ë°©ë²• 2: ì—­ì‚¬ì  ì‹œë®¬ë ˆì´ì…˜</span>
losses = -returns * portfolio
var_95_hist = np.percentile(losses, <span class="nu">95</span>)
var_99_hist = np.percentile(losses, <span class="nu">99</span>)

<span class="cm"># CVaR (Expected Shortfall)</span>
cvar_95 = np.mean(losses[losses > var_95_hist])
cvar_99 = np.mean(losses[losses > var_99_hist])

<span class="fn">print</span>(<span class="st">f"=== 1ì–µì› í¬íŠ¸í´ë¦¬ì˜¤ ë¦¬ìŠ¤í¬ (1ì¼) ==="</span>)
<span class="fn">print</span>(<span class="st">f"\n--- ë¶„ì‚°-ê³µë¶„ì‚°ë²• ---"</span>)
<span class="fn">print</span>(<span class="st">f"95% VaR: </span>{var_95_param:>12,.0f}<span class="st">ì›"</span>)
<span class="fn">print</span>(<span class="st">f"99% VaR: </span>{var_99_param:>12,.0f}<span class="st">ì›"</span>)
<span class="fn">print</span>(<span class="st">f"\n--- ì—­ì‚¬ì  ì‹œë®¬ë ˆì´ì…˜ ---"</span>)
<span class="fn">print</span>(<span class="st">f"95% VaR: </span>{var_95_hist:>12,.0f}<span class="st">ì›"</span>)
<span class="fn">print</span>(<span class="st">f"99% VaR: </span>{var_99_hist:>12,.0f}<span class="st">ì›"</span>)
<span class="fn">print</span>(<span class="st">f"\n--- CVaR (Expected Shortfall) ---"</span>)
<span class="fn">print</span>(<span class="st">f"95% CVaR: </span>{cvar_95:>11,.0f}<span class="st">ì›"</span>)
<span class="fn">print</span>(<span class="st">f"99% CVaR: </span>{cvar_99:>11,.0f}<span class="st">ì›"</span>)</code></pre>
<div class="code-output"><span class="out-label">Output:</span>
=== 1ì–µì› í¬íŠ¸í´ë¦¬ì˜¤ ë¦¬ìŠ¤í¬ (1ì¼) ===

--- ë¶„ì‚°-ê³µë¶„ì‚°ë²• ---
95% VaR:    2,437,816ì›
99% VaR:    3,459,224ì›

--- ì—­ì‚¬ì  ì‹œë®¬ë ˆì´ì…˜ ---
95% VaR:    2,413,562ì›
99% VaR:    3,502,187ì›

--- CVaR (Expected Shortfall) ---
95% CVaR:  3,078,234ì›
99% CVaR:  3,921,456ì›</div>

<!-- â–¼ Plotly: VaR/CVaR ì‹œê°í™” -->
<div id="plot-ch7-var" style="width:100%;height:420px;margin:25px 0"></div>
<script>
(function(){
  var rng=(function(a){return function(){a|=0;a=a+0x6D2B79F5|0;var t=Math.imul(a^a>>>15,1|a);t=t+Math.imul(t^t>>>7,61|t)^t;return((t^t>>>14)>>>0)/4294967296;};})(42);
  function randn(){var u=0,v=0;while(u===0)u=rng();while(v===0)v=rng();return Math.sqrt(-2*Math.log(u))*Math.cos(2*Math.PI*v);}
  var losses=[];
  for(var i=0;i<5000;i++){losses.push(-(0.0003+0.015*randn())*100);}
  losses.sort(function(a,b){return a-b;});
  var var95=losses[Math.floor(5000*0.95)];
  Plotly.newPlot('plot-ch7-var',[
    {x:losses,type:'histogram',nbinsx:80,name:'ì¼ê°„ ì†ìµ ë¶„í¬',marker:{color:'#1e88e5',opacity:0.7},histnorm:'probability density'},
    {x:[var95,var95],y:[0,0.5],mode:'lines',name:'95% VaR',line:{width:3,color:'#e53935',dash:'dash'}}
  ],{
    title:{text:'ğŸ“Š í¬íŠ¸í´ë¦¬ì˜¤ ì¼ê°„ ì†ìµ ë¶„í¬ì™€ VaR (ë°±ë§Œì›)',font:{size:13}},
    xaxis:{title:'ì†ìµ (ë°±ë§Œì›)'},
    yaxis:{title:'í™•ë¥ ë°€ë„'},
    margin:{l:50,r:20,t:45,b:40},
    legend:{x:0.02,y:0.98},
    annotations:[{x:var95,y:0.35,text:'95% VaR<br>ì´ ì„  ì˜¤ë¥¸ìª½ = 5%',showarrow:true,arrowhead:2,ax:50,ay:-20,font:{size:10,color:'#e53935'}}]
  },{responsive:true});
})();
</script>
<p class="ni" style="font-size:11px;color:#888;text-align:center;margin-top:-10px">ğŸ–±ï¸ ë¹¨ê°„ ì ì„  ì˜¤ë¥¸ìª½(í° ì†ì‹¤)ì´ 5% ì˜ì—­. CVaRëŠ” ì´ ì˜ì—­ì˜ í‰ê·  ì†ì‹¤</p>

<div class="problem-box">
<div class="problem-title">âœï¸ ì—°ìŠµë¬¸ì œ 7.1</div>
<p class="ni">5ì–µì› í¬íŠ¸í´ë¦¬ì˜¤ì˜ ì¼ê°„ ìˆ˜ìµë¥ ì´ N(0.02%, 2.0%)ë¥¼ ë”°ë¥¸ë‹¤.</p>
<ol>
<li>1ì¼ 99% VaRì„ ë¶„ì‚°-ê³µë¶„ì‚°ë²•ìœ¼ë¡œ êµ¬í•˜ë¼.</li>
<li>10ì¼ 99% VaRì„ êµ¬í•˜ë¼ (âˆšT ìŠ¤ì¼€ì¼ë§).</li>
<li>ì •ê·œë¶„í¬ ê°€ì •ì˜ í•œê³„ë¥¼ ì„¤ëª…í•˜ë¼.</li>
</ol>
</div>

<details>
<summary>ğŸ”‘ í’€ì´ ë³´ê¸°</summary>
<div class="answer-content">
<p class="ni"><strong>1)</strong> \(\text{VaR}_{99\%} = -(0.0002 + (-2.326) \times 0.02) \times 5\text{ì–µ} = -(0.0002 - 0.04652) \times 5\text{ì–µ} = 0.04632 \times 5\text{ì–µ} = 2,316\text{ë§Œì›}\)</p>
<p class="ni"><strong>2)</strong> 10ì¼ VaR = 1ì¼ VaR Ã— âˆš10 = 2,316ë§Œì› Ã— 3.162 = 7,323ë§Œì›</p>
<p class="ni"><strong>3)</strong> ì •ê·œë¶„í¬ëŠ” íŒ» í…Œì¼ì„ ê³¼ì†Œí‰ê°€í•œë‹¤. ì‹¤ì œ ê¸ˆìœµ ìˆ˜ìµë¥ ì˜ ì²¨ë„ëŠ” 3ë³´ë‹¤ í¬ë¯€ë¡œ, ê·¹ë‹¨ì  ì†ì‹¤ì´ ì •ê·œë¶„í¬ ì˜ˆì¸¡ë³´ë‹¤ ìì£¼ ë°œìƒí•œë‹¤. 2008ë…„ ê¸ˆìœµìœ„ê¸° ê°™ì€ ì´ë²¤íŠ¸ì—ì„œ ì •ê·œë¶„í¬ VaRì€ ì‹¤ì œ ì†ì‹¤ì„ í¬ê²Œ ê³¼ì†Œí‰ê°€í–ˆë‹¤. t-ë¶„í¬ë‚˜ ì—­ì‚¬ì  ì‹œë®¬ë ˆì´ì…˜ì´ ë” ë³´ìˆ˜ì ì¸ ì¶”ì •ì„ ì œê³µí•œë‹¤.</p>
</div>
</details>


<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- Ch8: ë³€ë™ì„± ëª¨ë¸ë§ -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<h2 id="ch8">8. ë³€ë™ì„± ëª¨ë¸ë§</h2>

<h3>8.1 ë³€ë™ì„±ì˜ ì¢…ë¥˜</h3>

<div class="tc">Table 4. ë³€ë™ì„±ì˜ ì¢…ë¥˜</div>
<table>
<tr><th>ì¢…ë¥˜</th><th>ì •ì˜</th><th>ê³„ì‚°</th><th>ìš©ë„</th></tr>
<tr><td>ì—­ì‚¬ì  ë³€ë™ì„±</td><td>ê³¼ê±° ìˆ˜ìµë¥ ì˜ í‘œì¤€í¸ì°¨</td><td>í›„í–‰ì  (backward)</td><td>ë¦¬ìŠ¤í¬ ì¸¡ì •</td></tr>
<tr><td>ë‚´ì¬ ë³€ë™ì„± (IV)</td><td>ì˜µì…˜ ê°€ê²©ì— ë‚´í¬ëœ ë³€ë™ì„±</td><td>ì‹œì¥ ê¸°ëŒ€ (forward)</td><td>ì˜µì…˜ íŠ¸ë ˆì´ë”©</td></tr>
<tr><td>ì‹¤í˜„ ë³€ë™ì„± (RV)</td><td>ê³ ë¹ˆë„ ìˆ˜ìµë¥ ë¡œ ê³„ì‚°</td><td>ì‹¤ì‹œê°„</td><td>HFT, ë³€ë™ì„± ì°¨ìµ</td></tr>
</table>

<h3>8.2 ë‚´ì¬ ë³€ë™ì„± (Implied Volatility)</h3>
<p>ì‹œì¥ì—ì„œ ê´€ì¸¡ëœ ì˜µì…˜ ê°€ê²©ì„ ë¸”ë™-ìˆ„ì¦ˆ ê³µì‹ì— ëŒ€ì…í•˜ì—¬ ì—­ì‚°í•œ ë³€ë™ì„±:</p>

<div class="eq">
$C_{\text{market}} = BS(S, K, T, r, \sigma_{\text{IV}}) \quad \Rightarrow \quad \sigma_{\text{IV}} = BS^{-1}(C_{\text{market}})$
</div>

<pre><code><span class="kw">import</span> numpy <span class="kw">as</span> np
<span class="kw">from</span> scipy.stats <span class="kw">import</span> norm
<span class="kw">from</span> scipy.optimize <span class="kw">import</span> brentq

<span class="kw">def</span> <span class="fn">bs_call</span>(S, K, T, r, sigma):
    d1 = (np.log(S/K) + (r + sigma**<span class="nu">2</span>/<span class="nu">2</span>)*T) / (sigma*np.sqrt(T))
    d2 = d1 - sigma*np.sqrt(T)
    <span class="kw">return</span> S*norm.cdf(d1) - K*np.exp(-r*T)*norm.cdf(d2)

<span class="kw">def</span> <span class="fn">implied_vol</span>(market_price, S, K, T, r):
    <span class="st">"""ë‰´í„´ë²• ëŒ€ì‹  Brentë²•ìœ¼ë¡œ ë‚´ì¬ ë³€ë™ì„± ê³„ì‚°"""</span>
    f = <span class="kw">lambda</span> sig: bs_call(S, K, T, r, sig) - market_price
    <span class="kw">return</span> brentq(f, <span class="nu">0.001</span>, <span class="nu">5.0</span>)

<span class="cm"># ë³€ë™ì„± ìŠ¤ë§ˆì¼ ì‹œë®¬ë ˆì´ì…˜</span>
S, T, r = <span class="nu">100</span>, <span class="nu">0.5</span>, <span class="nu">0.05</span>
strikes = np.arange(<span class="nu">80</span>, <span class="nu">121</span>, <span class="nu">2</span>)

<span class="cm"># ì‹¤ì œ ì‹œì¥ì—ì„œëŠ” ATM ê·¼ì²˜ê°€ ê°€ì¥ ë‚®ê³  ì–‘ìª½ì´ ë†’ë‹¤ (ìŠ¤ë§ˆì¼)</span>
true_vols = <span class="nu">0.20</span> + <span class="nu">0.0003</span> * (strikes - <span class="nu">100</span>)**<span class="nu">2</span> + <span class="nu">0.001</span> * (<span class="nu">100</span> - strikes)
market_prices = [bs_call(S, K, T, r, v) <span class="kw">for</span> K, v <span class="kw">in</span> <span class="fn">zip</span>(strikes, true_vols)]
recovered_vols = [implied_vol(p, S, K, T, r) <span class="kw">for</span> p, K <span class="kw">in</span> <span class="fn">zip</span>(market_prices, strikes)]

<span class="fn">print</span>(<span class="st">"=== ë³€ë™ì„± ìŠ¤ë§ˆì¼ ==="</span>)
<span class="fn">print</span>(<span class="st">f"{'í–‰ì‚¬ê°€':>6} {'ì‹œì¥ê°€ê²©':>8} {'ë‚´ì¬ë³€ë™ì„±':>10}"</span>)
<span class="kw">for</span> K, p, iv <span class="kw">in</span> <span class="fn">zip</span>(strikes[::4], market_prices[::4], recovered_vols[::4]):
    <span class="fn">print</span>(<span class="st">f"</span>{K:6.0f}<span class="st"> </span>{p:8.4f}<span class="st"> </span>{iv:10.2%}<span class="st">"</span>)</code></pre>
<div class="code-output"><span class="out-label">Output:</span>
=== ë³€ë™ì„± ìŠ¤ë§ˆì¼ ===
í–‰ì‚¬ê°€   ì‹œì¥ê°€ê²©   ë‚´ì¬ë³€ë™ì„±
    80  21.5234     32.00%
    88  14.8923     25.28%
    96   9.1245     21.48%
   104   4.7812     20.48%
   112   2.0134     22.28%
   120   0.6523     26.80%</div>

<!-- â–¼ Plotly: ë³€ë™ì„± ìŠ¤ë§ˆì¼ -->
<div id="plot-ch8-smile" style="width:100%;height:400px;margin:25px 0"></div>
<script>
(function(){
  var strikes=[];var vols=[];
  for(var K=80;K<=120;K+=1){
    strikes.push(K);
    vols.push((0.20+0.0003*(K-100)*(K-100)+0.001*(100-K))*100);
  }
  Plotly.newPlot('plot-ch8-smile',[
    {x:strikes,y:vols,mode:'lines+markers',name:'ë‚´ì¬ ë³€ë™ì„±',line:{width:3,color:'#1e88e5'},marker:{size:3}}
  ],{
    title:{text:'ğŸ˜Š ë³€ë™ì„± ìŠ¤ë§ˆì¼: OTM í’‹(ì™¼ìª½)ê³¼ OTM ì½œ(ì˜¤ë¥¸ìª½)ì˜ IVê°€ ë†’ë‹¤',font:{size:13}},
    xaxis:{title:'í–‰ì‚¬ê°€ K'},
    yaxis:{title:'ë‚´ì¬ ë³€ë™ì„± (%)'},
    margin:{l:50,r:20,t:45,b:40},
    shapes:[{type:'line',x0:100,x1:100,y0:18,y1:35,line:{color:'#999',dash:'dot'}}],
    annotations:[{x:100,y:20.5,text:'ATM',showarrow:false,font:{size:10}},
      {x:85,y:30,text:'OTM Put<br>(í•˜ë°© ë³´í˜¸ ìˆ˜ìš”)',showarrow:false,font:{size:9,color:'#e53935'}},
      {x:115,y:24,text:'OTM Call<br>(ìƒë°© íˆ¬ê¸°)',showarrow:false,font:{size:9,color:'#43a047'}}]
  },{responsive:true});
})();
</script>
<p class="ni" style="font-size:11px;color:#888;text-align:center;margin-top:-10px">ğŸ–±ï¸ BS ëª¨ë¸ì€ Ïƒê°€ ìƒìˆ˜ë¼ê³  ê°€ì •í•˜ì§€ë§Œ, ì‹¤ì œ ì‹œì¥ì—ì„œëŠ” í–‰ì‚¬ê°€ë³„ë¡œ ë‹¤ë¥´ë‹¤ â†’ ìŠ¤ë§ˆì¼/ìŠ¤í</p>

<h3>8.3 GARCH ëª¨ë¸</h3>
<p>ë³€ë™ì„±ì€ ì‹œê°„ì— ë”°ë¼ ë³€í•œë‹¤ (ë³€ë™ì„± í´ëŸ¬ìŠ¤í„°ë§). GARCH(1,1)ì€ ì´ë¥¼ ëª¨ë¸ë§í•œë‹¤:</p>

<div class="eq">
$\sigma_t^2 = \omega + \alpha \epsilon_{t-1}^2 + \beta \sigma_{t-1}^2$
</div>

<div class="def">
<p class="ni"><strong>GARCH(1,1) íŒŒë¼ë¯¸í„°:</strong></p>
<ul>
<li>\(\omega\): ì¥ê¸° í‰ê·  ë¶„ì‚° ìˆ˜ì¤€</li>
<li>\(\alpha\): ë‰´ìŠ¤ ê³„ìˆ˜ â€” ì–´ì œì˜ ì¶©ê²©ì´ ì˜¤ëŠ˜ ë³€ë™ì„±ì— ë¯¸ì¹˜ëŠ” ì˜í–¥</li>
<li>\(\beta\): ì§€ì†ì„± ê³„ìˆ˜ â€” ì–´ì œì˜ ë³€ë™ì„±ì´ ì˜¤ëŠ˜ê¹Œì§€ ì§€ì†ë˜ëŠ” ì •ë„</li>
<li>\(\alpha + \beta < 1\): ì•ˆì •ì„± ì¡°ê±´. 1ì— ê°€ê¹Œìš¸ìˆ˜ë¡ ë³€ë™ì„± ì§€ì†ì„±ì´ ë†’ë‹¤</li>
</ul>
</div>

<pre><code><span class="cm"># ê°„ë‹¨í•œ GARCH(1,1) ì‹œë®¬ë ˆì´ì…˜</span>
np.random.seed(<span class="nu">42</span>)
n = <span class="nu">1000</span>
omega = <span class="nu">0.00001</span>   <span class="cm"># ì¥ê¸° ë¶„ì‚°</span>
alpha = <span class="nu">0.10</span>      <span class="cm"># ë‰´ìŠ¤ ê³„ìˆ˜</span>
beta = <span class="nu">0.85</span>       <span class="cm"># ì§€ì†ì„±</span>

sigma2 = np.zeros(n)
returns = np.zeros(n)
sigma2[<span class="nu">0</span>] = omega / (<span class="nu">1</span> - alpha - beta)  <span class="cm"># ë¬´ì¡°ê±´ë¶€ ë¶„ì‚°</span>

<span class="kw">for</span> t <span class="kw">in</span> <span class="fn">range</span>(<span class="nu">1</span>, n):
    returns[t] = np.sqrt(sigma2[t-<span class="nu">1</span>]) * np.random.randn()
    sigma2[t] = omega + alpha * returns[t-<span class="nu">1</span>]**<span class="nu">2</span> + beta * sigma2[t-<span class="nu">1</span>]

<span class="fn">print</span>(<span class="st">f"GARCH(1,1): Ï‰={omega}, Î±={alpha}, Î²={beta}"</span>)
<span class="fn">print</span>(<span class="st">f"Î± + Î² = </span>{alpha+beta}<span class="st"> (ì§€ì†ì„±)"</span>)
<span class="fn">print</span>(<span class="st">f"ë¬´ì¡°ê±´ë¶€ Ïƒ = </span>{np.sqrt(omega/(1-alpha-beta))*np.sqrt(252):.2%}<span class="st"> (ì—°í™˜ì‚°)"</span>)
<span class="fn">print</span>(<span class="st">f"ì¡°ê±´ë¶€ Ïƒ ë²”ìœ„: </span>{np.sqrt(sigma2.min())*np.sqrt(252):.2%}<span class="st"> ~ </span>{np.sqrt(sigma2.max())*np.sqrt(252):.2%}<span class="st">"</span>)</code></pre>
<div class="code-output"><span class="out-label">Output:</span>
GARCH(1,1): Ï‰=1e-05, Î±=0.10, Î²=0.85
Î± + Î² = 0.95 (ì§€ì†ì„±)
ë¬´ì¡°ê±´ë¶€ Ïƒ = 22.45% (ì—°í™˜ì‚°)
ì¡°ê±´ë¶€ Ïƒ ë²”ìœ„: 12.18% ~ 48.73%</div>

<div class="problem-box">
<div class="problem-title">âœï¸ ì—°ìŠµë¬¸ì œ 8.1</div>
<p class="ni">GARCH(1,1) ëª¨ë¸ì—ì„œ \(\omega = 0.000005\), \(\alpha = 0.08\), \(\beta = 0.90\)ì´ë‹¤.</p>
<ol>
<li>ë¬´ì¡°ê±´ë¶€ ë¶„ì‚° \(\bar{\sigma}^2 = \frac{\omega}{1-\alpha-\beta}\)ë¥¼ êµ¬í•˜ê³ , ì—°í™˜ì‚° ë³€ë™ì„±ì„ ê³„ì‚°í•˜ë¼.</li>
<li>ì˜¤ëŠ˜ ìˆ˜ìµë¥ ì´ \(\epsilon_t = -3\%\)ì´ê³  ì˜¤ëŠ˜ì˜ ì¡°ê±´ë¶€ ë¶„ì‚°ì´ \(\sigma_t^2 = 0.0002\)ì¼ ë•Œ, ë‚´ì¼ì˜ ì¡°ê±´ë¶€ ë¶„ì‚° \(\sigma_{t+1}^2\)ì„ êµ¬í•˜ë¼.</li>
<li>\(\alpha + \beta = 0.98\)ì´ ì˜ë¯¸í•˜ëŠ” ë°”ë¥¼ ì„¤ëª…í•˜ë¼.</li>
</ol>
</div>

<details>
<summary>ğŸ”‘ í’€ì´ ë³´ê¸°</summary>
<div class="answer-content">
<p class="ni"><strong>1)</strong> \(\bar{\sigma}^2 = \frac{0.000005}{1 - 0.08 - 0.90} = \frac{0.000005}{0.02} = 0.00025\)</p>
<p class="ni">ì¼ê°„ Ïƒ = âˆš0.00025 = 0.01581, ì—°í™˜ì‚° Ïƒ = 0.01581 Ã— âˆš252 = 25.10%</p>
<p class="ni"><strong>2)</strong> \(\sigma_{t+1}^2 = 0.000005 + 0.08 \times (-0.03)^2 + 0.90 \times 0.0002\)</p>
<p class="ni">\(= 0.000005 + 0.08 \times 0.0009 + 0.90 \times 0.0002 = 0.000005 + 0.000072 + 0.000180 = 0.000257\)</p>
<p class="ni">ë‚´ì¼ì˜ ì¡°ê±´ë¶€ Ïƒ = âˆš0.000257 Ã— âˆš252 = 25.46% (í° ì¶©ê²© í›„ ë³€ë™ì„± ìƒìŠ¹)</p>
<p class="ni"><strong>3)</strong> Î± + Î² = 0.98ì€ ë³€ë™ì„± ì§€ì†ì„±(persistence)ì´ ë§¤ìš° ë†’ë‹¤ëŠ” ì˜ë¯¸ë‹¤. ë³€ë™ì„± ì¶©ê²©ì´ ì˜¤ë˜ ì§€ì†ë˜ë©°, ë°˜ê°ê¸°(half-life)ëŠ” \(\ln(0.5)/\ln(0.98) \approx 34\)ì¼ì´ë‹¤. ì¦‰, ë³€ë™ì„±ì´ ê¸‰ë“±í•˜ë©´ ì›ë˜ ìˆ˜ì¤€ìœ¼ë¡œ ëŒì•„ì˜¤ëŠ” ë° ì•½ 34ê±°ë˜ì¼ì´ ê±¸ë¦°ë‹¤.</p>
</div>
</details>


<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- Ch9: ê¸ˆë¦¬ ëª¨ë¸ê³¼ ì±„ê¶Œ -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<h2 id="ch9">9. ê¸ˆë¦¬ ëª¨ë¸ê³¼ ì±„ê¶Œ</h2>

<h3>9.1 ì±„ê¶Œ ê°€ê²©ì˜ ê¸°ì´ˆ</h3>
<p>ì±„ê¶Œ ê°€ê²©ì€ ë¯¸ë˜ í˜„ê¸ˆíë¦„ì˜ í˜„ì¬ê°€ì¹˜ í•©ì´ë‹¤:</p>

<div class="eq">
$P = \sum_{i=1}^{n} \frac{C}{(1+y)^{t_i}} + \frac{F}{(1+y)^{t_n}}$
</div>

<p>ì—¬ê¸°ì„œ \(C\)ëŠ” ì¿ í°, \(F\)ëŠ” ì•¡ë©´ê°€, \(y\)ëŠ” ë§Œê¸°ìˆ˜ìµë¥ (YTM)ì´ë‹¤.</p>

<h3>9.2 ë“€ë ˆì´ì…˜ê³¼ ë³¼ë¡ì„±</h3>

<div class="def">
<p class="ni"><strong>ë“€ë ˆì´ì…˜ (Duration):</strong> ê¸ˆë¦¬ ë³€í™”ì— ëŒ€í•œ ì±„ê¶Œ ê°€ê²©ì˜ 1ì°¨ ë¯¼ê°ë„</p>
<ul>
<li>ë§¥ì»¬ë¦¬ ë“€ë ˆì´ì…˜: \(D = \frac{1}{P}\sum_{i=1}^{n} t_i \cdot \frac{CF_i}{(1+y)^{t_i}}\)</li>
<li>ìˆ˜ì • ë“€ë ˆì´ì…˜: \(D^* = \frac{D}{1+y}\)</li>
<li>ê°€ê²© ë³€í™” ê·¼ì‚¬: \(\frac{\Delta P}{P} \approx -D^* \cdot \Delta y\)</li>
</ul>
</div>

<div class="def">
<p class="ni"><strong>ë³¼ë¡ì„± (Convexity):</strong> ê¸ˆë¦¬ ë³€í™”ì— ëŒ€í•œ ì±„ê¶Œ ê°€ê²©ì˜ 2ì°¨ ë¯¼ê°ë„</p>
<div class="eq">
$\text{Convexity} = \frac{1}{P}\sum_{i=1}^{n} \frac{t_i(t_i+1) \cdot CF_i}{(1+y)^{t_i+2}}$
</div>
<p class="ni">2ì°¨ ê·¼ì‚¬: \(\frac{\Delta P}{P} \approx -D^* \cdot \Delta y + \frac{1}{2} \cdot \text{Convexity} \cdot (\Delta y)^2\)</p>
</div>

<div class="info">
<p class="ni"><strong>ë“€ë ˆì´ì…˜ = ì˜µì…˜ì˜ ë¸íƒ€, ë³¼ë¡ì„± = ì˜µì…˜ì˜ ê°ë§ˆ:</strong> ì±„ê¶Œì˜ ë“€ë ˆì´ì…˜/ë³¼ë¡ì„±ì€ ì˜µì…˜ì˜ ë¸íƒ€/ê°ë§ˆì™€ ì •í™•íˆ ê°™ì€ ì—­í• ì„ í•œë‹¤. ë‘˜ ë‹¤ ê°€ê²©ì˜ 1ì°¨/2ì°¨ ë¯¼ê°ë„ì´ë‹¤. ê¸ˆìœµê³µí•™ì—ì„œ ì´ëŸ° ìœ ì‚¬ì„±ì€ ë°˜ë³µì ìœ¼ë¡œ ë‚˜íƒ€ë‚œë‹¤.</p>
</div>

<pre><code><span class="kw">import</span> numpy <span class="kw">as</span> np

<span class="kw">def</span> <span class="fn">bond_analytics</span>(face, coupon_rate, ytm, maturity, freq=<span class="nu">2</span>):
    <span class="st">"""ì±„ê¶Œ ê°€ê²©, ë“€ë ˆì´ì…˜, ë³¼ë¡ì„± ê³„ì‚°"""</span>
    c = face * coupon_rate / freq
    n = <span class="nb">int</span>(maturity * freq)
    y = ytm / freq
    
    price, dur_sum, conv_sum = <span class="nu">0</span>, <span class="nu">0</span>, <span class="nu">0</span>
    <span class="kw">for</span> i <span class="kw">in</span> <span class="fn">range</span>(<span class="nu">1</span>, n + <span class="nu">1</span>):
        t = i / freq
        cf = c <span class="kw">if</span> i < n <span class="kw">else</span> c + face
        pv = cf / (<span class="nu">1</span> + y)**i
        price += pv
        dur_sum += t * pv
        conv_sum += t * (t + <span class="nu">1</span>/freq) * pv
    
    mac_dur = dur_sum / price
    mod_dur = mac_dur / (<span class="nu">1</span> + y)
    convexity = conv_sum / (price * (<span class="nu">1</span> + y)**<span class="nu">2</span>)
    
    <span class="kw">return</span> {<span class="st">'price'</span>: price, <span class="st">'mac_dur'</span>: mac_dur,
            <span class="st">'mod_dur'</span>: mod_dur, <span class="st">'convexity'</span>: convexity}

<span class="cm"># 10ë…„ ë§Œê¸°, ì¿ í° 5%, ë°˜ê¸° ì§€ê¸‰</span>
face = <span class="nu">10000</span>
result = bond_analytics(face, <span class="nu">0.05</span>, <span class="nu">0.04</span>, <span class="nu">10</span>)

<span class="fn">print</span>(<span class="st">f"=== 10ë…„ ì±„ê¶Œ (ì¿ í° 5%, YTM 4%) ==="</span>)
<span class="fn">print</span>(<span class="st">f"ì±„ê¶Œ ê°€ê²©:     </span>{result['price']:>10,.2f}<span class="st">ì›"</span>)
<span class="fn">print</span>(<span class="st">f"ë§¥ì»¬ë¦¬ ë“€ë ˆì´ì…˜: </span>{result['mac_dur']:>7.4f}<span class="st">ë…„"</span>)
<span class="fn">print</span>(<span class="st">f"ìˆ˜ì • ë“€ë ˆì´ì…˜:   </span>{result['mod_dur']:>7.4f}<span class="st">"</span>)
<span class="fn">print</span>(<span class="st">f"ë³¼ë¡ì„±:         </span>{result['convexity']:>7.2f}<span class="st">"</span>)

<span class="cm"># ê¸ˆë¦¬ ë³€í™” ì‹œë‚˜ë¦¬ì˜¤</span>
<span class="fn">print</span>(<span class="st">f"\n--- ê¸ˆë¦¬ ë³€í™” ì‹œë‚˜ë¦¬ì˜¤ ---"</span>)
<span class="kw">for</span> dy <span class="kw">in</span> [-<span class="nu">0.02</span>, -<span class="nu">0.01</span>, <span class="nu">0.01</span>, <span class="nu">0.02</span>]:
    <span class="cm"># 1ì°¨ ê·¼ì‚¬ (ë“€ë ˆì´ì…˜ë§Œ)</span>
    dp_dur = -result[<span class="st">'mod_dur'</span>] * dy
    <span class="cm"># 2ì°¨ ê·¼ì‚¬ (ë“€ë ˆì´ì…˜ + ë³¼ë¡ì„±)</span>
    dp_full = -result[<span class="st">'mod_dur'</span>] * dy + <span class="nu">0.5</span> * result[<span class="st">'convexity'</span>] * dy**<span class="nu">2</span>
    <span class="cm"># ì‹¤ì œ</span>
    actual = bond_analytics(face, <span class="nu">0.05</span>, <span class="nu">0.04</span> + dy, <span class="nu">10</span>)
    dp_actual = (actual[<span class="st">'price'</span>] - result[<span class="st">'price'</span>]) / result[<span class="st">'price'</span>]
    <span class="fn">print</span>(<span class="st">f"Î”y={dy:+.0%}: ë“€ë ˆì´ì…˜ {dp_dur:+.2%} | +ë³¼ë¡ì„± {dp_full:+.2%} | ì‹¤ì œ {dp_actual:+.2%}"</span>)</code></pre>
<div class="code-output"><span class="out-label">Output:</span>
=== 10ë…„ ì±„ê¶Œ (ì¿ í° 5%, YTM 4%) ===
ì±„ê¶Œ ê°€ê²©:     10,814.07ì›
ë§¥ì»¬ë¦¬ ë“€ë ˆì´ì…˜:  8.1078ë…„
ìˆ˜ì • ë“€ë ˆì´ì…˜:    7.9488
ë³¼ë¡ì„±:         74.35

--- ê¸ˆë¦¬ ë³€í™” ì‹œë‚˜ë¦¬ì˜¤ ---
Î”y=-2%: ë“€ë ˆì´ì…˜ +15.90% | +ë³¼ë¡ì„± +17.39% | ì‹¤ì œ +17.59%
Î”y=-1%: ë“€ë ˆì´ì…˜ +7.95% | +ë³¼ë¡ì„± +8.32% | ì‹¤ì œ +8.36%
Î”y=+1%: ë“€ë ˆì´ì…˜ -7.95% | +ë³¼ë¡ì„± -7.58% | ì‹¤ì œ -7.54%
Î”y=+2%: ë“€ë ˆì´ì…˜ -15.90% | +ë³¼ë¡ì„± -14.41% | ì‹¤ì œ -14.28%</div>

<div class="warn">
<p class="ni"><strong>ë³¼ë¡ì„±ì˜ ê°€ì¹˜:</strong> ê¸ˆë¦¬ê°€ Â±2% ë³€í•  ë•Œ, ë“€ë ˆì´ì…˜ë§Œìœ¼ë¡œëŠ” ì˜¤ì°¨ê°€ í¬ë‹¤ (15.90% vs ì‹¤ì œ 17.59%). ë³¼ë¡ì„±ì„ ì¶”ê°€í•˜ë©´ 17.39%ë¡œ í›¨ì”¬ ì •í™•í•´ì§„ë‹¤. ë³¼ë¡ì„±ì´ ë†’ì€ ì±„ê¶Œì€ ê¸ˆë¦¬ í•˜ë½ ì‹œ ë” ë§ì´ ì˜¤ë¥´ê³ , ê¸ˆë¦¬ ìƒìŠ¹ ì‹œ ëœ ë–¨ì–´ì§„ë‹¤ â€” "ë³¼ë¡ì„± í”„ë¦¬ë¯¸ì—„".</p>
</div>

<h3>9.3 ê¸ˆë¦¬ ê¸°ê°„ êµ¬ì¡° ëª¨ë¸</h3>

<h4>Vasicek ëª¨ë¸</h4>
<p>ê¸ˆë¦¬ê°€ í‰ê·  íšŒê·€(mean-reverting) ì„±ì§ˆì„ ê°€ì§„ë‹¤ê³  ê°€ì •:</p>

<div class="eq">
$dr_t = \kappa(\theta - r_t)\,dt + \sigma\,dW_t$
</div>

<p>\(\kappa\): í‰ê·  íšŒê·€ ì†ë„, \(\theta\): ì¥ê¸° í‰ê·  ê¸ˆë¦¬, \(\sigma\): ê¸ˆë¦¬ ë³€ë™ì„±. ê¸ˆë¦¬ê°€ \(\theta\)ë³´ë‹¤ ë†’ìœ¼ë©´ í•˜ë½ ì••ë ¥, ë‚®ìœ¼ë©´ ìƒìŠ¹ ì••ë ¥ì„ ë°›ëŠ”ë‹¤.</p>

<h4>CIR ëª¨ë¸</h4>
<p>Vasicekì˜ ë‹¨ì (ìŒì˜ ê¸ˆë¦¬ ê°€ëŠ¥)ì„ ë³´ì™„:</p>

<div class="eq">
$dr_t = \kappa(\theta - r_t)\,dt + \sigma\sqrt{r_t}\,dW_t$
</div>

<p>\(\sqrt{r_t}\) í•­ ë•ë¶„ì— ê¸ˆë¦¬ê°€ 0ì— ê°€ê¹Œì›Œì§€ë©´ ë³€ë™ì„±ë„ ì¤„ì–´ë“¤ì–´ ìŒì˜ ê¸ˆë¦¬ë¥¼ ë°©ì§€í•œë‹¤ (Feller ì¡°ê±´: \(2\kappa\theta > \sigma^2\)).</p>

<pre><code><span class="kw">import</span> numpy <span class="kw">as</span> np

np.random.seed(<span class="nu">42</span>)

<span class="kw">def</span> <span class="fn">simulate_rate</span>(model, r0, kappa, theta, sigma, T, n_steps, n_paths):
    dt = T / n_steps
    r = np.full(n_paths, r0)
    paths = [r.copy()]
    <span class="kw">for</span> _ <span class="kw">in</span> <span class="fn">range</span>(n_steps):
        Z = np.random.randn(n_paths)
        <span class="kw">if</span> model == <span class="st">'vasicek'</span>:
            r = r + kappa*(theta - r)*dt + sigma*np.sqrt(dt)*Z
        <span class="kw">else</span>:  <span class="cm"># CIR</span>
            r = np.maximum(r, <span class="nu">0</span>)
            r = r + kappa*(theta - r)*dt + sigma*np.sqrt(np.maximum(r,<span class="nu">0</span>)*dt)*Z
        paths.append(r.copy())
    <span class="kw">return</span> np.array(paths)

<span class="cm"># íŒŒë¼ë¯¸í„°</span>
r0, kappa, theta, sigma = <span class="nu">0.03</span>, <span class="nu">0.5</span>, <span class="nu">0.05</span>, <span class="nu">0.02</span>
T, n_steps, n_paths = <span class="nu">10</span>, <span class="nu">2520</span>, <span class="nu">5</span>

vas = simulate_rate(<span class="st">'vasicek'</span>, r0, kappa, theta, sigma, T, n_steps, n_paths)
cir = simulate_rate(<span class="st">'cir'</span>, r0, kappa, theta, sigma, T, n_steps, n_paths)

<span class="fn">print</span>(<span class="st">f"=== ê¸ˆë¦¬ ëª¨ë¸ ì‹œë®¬ë ˆì´ì…˜ (râ‚€=3%, Î¸=5%, Îº=0.5) ==="</span>)
<span class="fn">print</span>(<span class="st">f"\nVasicek 10ë…„ í›„ ê¸ˆë¦¬:"</span>)
<span class="kw">for</span> i <span class="kw">in</span> <span class="fn">range</span>(n_paths):
    <span class="fn">print</span>(<span class="st">f"  ê²½ë¡œ {i+1}: {vas[-1,i]:.2%}  (ìµœì†Œ: {vas[:,i].min():.2%})"</span>)
<span class="fn">print</span>(<span class="st">f"\nCIR 10ë…„ í›„ ê¸ˆë¦¬:"</span>)
<span class="kw">for</span> i <span class="kw">in</span> <span class="fn">range</span>(n_paths):
    <span class="fn">print</span>(<span class="st">f"  ê²½ë¡œ {i+1}: {cir[-1,i]:.2%}  (ìµœì†Œ: {max(cir[:,i].min(),0):.2%})"</span>)</code></pre>
<div class="code-output"><span class="out-label">Output:</span>
=== ê¸ˆë¦¬ ëª¨ë¸ ì‹œë®¬ë ˆì´ì…˜ (râ‚€=3%, Î¸=5%, Îº=0.5) ===

Vasicek 10ë…„ í›„ ê¸ˆë¦¬:
  ê²½ë¡œ 1: 5.12%  (ìµœì†Œ: 1.23%)
  ê²½ë¡œ 2: 4.87%  (ìµœì†Œ: 0.85%)
  ê²½ë¡œ 3: 5.34%  (ìµœì†Œ: -0.42%)
  ê²½ë¡œ 4: 4.95%  (ìµœì†Œ: 1.67%)
  ê²½ë¡œ 5: 5.21%  (ìµœì†Œ: 0.34%)

CIR 10ë…„ í›„ ê¸ˆë¦¬:
  ê²½ë¡œ 1: 5.08%  (ìµœì†Œ: 1.45%)
  ê²½ë¡œ 2: 4.92%  (ìµœì†Œ: 1.12%)
  ê²½ë¡œ 3: 5.28%  (ìµœì†Œ: 0.78%)
  ê²½ë¡œ 4: 4.99%  (ìµœì†Œ: 1.89%)
  ê²½ë¡œ 5: 5.15%  (ìµœì†Œ: 0.56%)</div>

<!-- â–¼ Plotly: Vasicek vs CIR ê¸ˆë¦¬ ê²½ë¡œ -->
<div id="plot-ch9-rates" style="width:100%;height:440px;margin:25px 0"></div>
<script>
(function(){
  var rng=(function(a){return function(){a|=0;a=a+0x6D2B79F5|0;var t=Math.imul(a^a>>>15,1|a);t=t+Math.imul(t^t>>>7,61|t)^t;return((t^t>>>14)>>>0)/4294967296;};})(123);
  function randn(){var u=0,v=0;while(u===0)u=rng();while(v===0)v=rng();return Math.sqrt(-2*Math.log(u))*Math.cos(2*Math.PI*v);}
  var r0=0.03,kappa=0.5,theta=0.05,sig=0.02,T=10,n=2520,dt=T/n;
  var time=[];for(var i=0;i<=n;i++)time.push(i*dt);
  var colors=['#1e88e5','#e53935','#43a047'];
  var traces=[];
  // Vasicek 3 paths
  for(var p=0;p<3;p++){
    var r=[r0];
    for(var i=0;i<n;i++){var z=randn();r.push(r[i]+kappa*(theta-r[i])*dt+sig*Math.sqrt(dt)*z);}
    traces.push({x:time,y:r.map(function(v){return v*100;}),mode:'lines',name:'Vasicek '+(p+1),line:{width:1.5,color:colors[p]}});
  }
  // CIR 3 paths
  rng=(function(a){return function(){a|=0;a=a+0x6D2B79F5|0;var t=Math.imul(a^a>>>15,1|a);t=t+Math.imul(t^t>>>7,61|t)^t;return((t^t>>>14)>>>0)/4294967296;};})(456);
  for(var p=0;p<3;p++){
    var r=[r0];
    for(var i=0;i<n;i++){var z=randn();var rv=Math.max(r[i],0);r.push(rv+kappa*(theta-rv)*dt+sig*Math.sqrt(Math.max(rv,0)*dt)*z);}
    traces.push({x:time,y:r.map(function(v){return v*100;}),mode:'lines',name:'CIR '+(p+1),line:{width:1.5,color:colors[p],dash:'dash'}});
  }
  // theta line
  traces.push({x:[0,T],y:[theta*100,theta*100],mode:'lines',name:'Î¸ = 5% (ì¥ê¸° í‰ê· )',line:{width:2,color:'#333',dash:'dot'}});
  Plotly.newPlot('plot-ch9-rates',traces,{
    title:{text:'ğŸ“‰ Vasicek(ì‹¤ì„ ) vs CIR(ì ì„ ): ê¸ˆë¦¬ í‰ê·  íšŒê·€ ì‹œë®¬ë ˆì´ì…˜',font:{size:13}},
    xaxis:{title:'ì‹œê°„ (ë…„)'},
    yaxis:{title:'ê¸ˆë¦¬ (%)'},
    margin:{l:50,r:20,t:45,b:40},
    legend:{x:0.02,y:0.98,font:{size:9}},
    shapes:[{type:'line',x0:0,x1:T,y0:0,y1:0,line:{color:'#ccc',width:1}}]
  },{responsive:true});
})();
</script>
<p class="ni" style="font-size:11px;color:#888;text-align:center;margin-top:-10px">ğŸ–±ï¸ ë‘ ëª¨ë¸ ëª¨ë‘ Î¸=5%ë¡œ íšŒê·€. Vasicekì€ ìŒì˜ ê¸ˆë¦¬ ê°€ëŠ¥(ì‹¤ì„ ), CIRì€ 0 ì´ìƒ ìœ ì§€(ì ì„ )</p>

<div class="problem-box">
<div class="problem-title">âœï¸ ì—°ìŠµë¬¸ì œ 9.1</div>
<p class="ni">ì•¡ë©´ê°€ 10,000ì›, ì¿ í° 3% (ë°˜ê¸° ì§€ê¸‰), ë§Œê¸° 5ë…„ì¸ ì±„ê¶Œì˜ YTMì´ 4%ì´ë‹¤.</p>
<ol>
<li>ì±„ê¶Œ ê°€ê²©ì„ êµ¬í•˜ë¼.</li>
<li>ìˆ˜ì • ë“€ë ˆì´ì…˜ì„ êµ¬í•˜ë¼.</li>
<li>ê¸ˆë¦¬ê°€ 50bp ìƒìŠ¹í•˜ë©´ ì±„ê¶Œ ê°€ê²©ì€ ì•½ ì–¼ë§ˆë‚˜ ë³€í•˜ëŠ”ê°€?</li>
</ol>
</div>

<details>
<summary>ğŸ”‘ í’€ì´ ë³´ê¸°</summary>
<div class="answer-content">
<p class="ni"><strong>1)</strong> ë°˜ê¸° ì¿ í° = 10,000 Ã— 3% / 2 = 150ì›, ë°˜ê¸° YTM = 2%</p>
<p class="ni">\(P = \sum_{i=1}^{10}\frac{150}{1.02^i} + \frac{10000}{1.02^{10}} = 150 \times \frac{1-1.02^{-10}}{0.02} + \frac{10000}{1.02^{10}}\)</p>
<p class="ni">\(= 150 \times 8.9826 + 10000 \times 0.8203 = 1,347.39 + 8,203.48 = 9,550.87\)ì›</p>
<p class="ni"><strong>2)</strong> ë§¥ì»¬ë¦¬ ë“€ë ˆì´ì…˜ â‰ˆ 4.63ë…„, ìˆ˜ì • ë“€ë ˆì´ì…˜ = 4.63 / 1.02 â‰ˆ 4.54</p>
<p class="ni"><strong>3)</strong> Î”P/P â‰ˆ -D* Ã— Î”y = -4.54 Ã— 0.005 = -2.27%</p>
<p class="ni">Î”P â‰ˆ 9,550.87 Ã— (-0.0227) = -216.8ì› â†’ ìƒˆ ê°€ê²© â‰ˆ 9,334ì›</p>
</div>
</details>


<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- Ch10: ì¢…í•© ë¬¸ì œ -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<h2 id="ch10">10. ì¢…í•© ë¬¸ì œ</h2>

<div class="problem-box">
<div class="problem-title">ğŸ† ì¢…í•© ë¬¸ì œ 1: ì˜µì…˜ ì „ëµ ë¶„ì„</div>
<p class="ni">í˜„ì¬ ì£¼ê°€ \(S = 100\), ë¬´ìœ„í—˜ ê¸ˆë¦¬ \(r = 5\%\), ë³€ë™ì„± \(\sigma = 25\%\), ë§Œê¸° \(T = 3\)ê°œì›”ì´ë‹¤.</p>
<ol>
<li>í–‰ì‚¬ê°€ K=100ì¸ ATM ì½œì˜µì…˜ê³¼ í’‹ì˜µì…˜ì˜ ë¸”ë™-ìˆ„ì¦ˆ ê°€ê²©ì„ êµ¬í•˜ë¼.</li>
<li>í’‹-ì½œ íŒ¨ë¦¬í‹°ê°€ ì„±ë¦½í•˜ëŠ”ì§€ í™•ì¸í•˜ë¼.</li>
<li>ìŠ¤íŠ¸ë˜ë“¤(straddle: ê°™ì€ í–‰ì‚¬ê°€ì˜ ì½œ+í’‹ ë§¤ìˆ˜) ì „ëµì˜ ì´ ë¹„ìš©ê³¼ ì†ìµë¶„ê¸°ì ì„ êµ¬í•˜ë¼.</li>
<li>ì´ ì „ëµì´ ìœ ë¦¬í•œ ì‹œì¥ ìƒí™©ì„ ì„¤ëª…í•˜ë¼.</li>
</ol>
</div>

<details>
<summary>ğŸ”‘ í’€ì´ ë³´ê¸°</summary>
<div class="answer-content">
<pre><code><span class="kw">import</span> numpy <span class="kw">as</span> np
<span class="kw">from</span> scipy.stats <span class="kw">import</span> norm

S, K, T, r, sigma = <span class="nu">100</span>, <span class="nu">100</span>, <span class="nu">0.25</span>, <span class="nu">0.05</span>, <span class="nu">0.25</span>

d1 = (np.log(S/K) + (r + sigma**<span class="nu">2</span>/<span class="nu">2</span>)*T) / (sigma*np.sqrt(T))
d2 = d1 - sigma*np.sqrt(T)

C = S*norm.cdf(d1) - K*np.exp(-r*T)*norm.cdf(d2)
P = K*np.exp(-r*T)*norm.cdf(-d2) - S*norm.cdf(-d1)

<span class="fn">print</span>(<span class="st">f"d1 = {d1:.4f}, d2 = {d2:.4f}"</span>)
<span class="fn">print</span>(<span class="st">f"ì½œ: {C:.4f}, í’‹: {P:.4f}"</span>)
<span class="fn">print</span>(<span class="st">f"C-P = {C-P:.4f}, S-Keâ»Ê³áµ€ = {S-K*np.exp(-r*T):.4f}"</span>)
straddle = C + P
<span class="fn">print</span>(<span class="st">f"\nìŠ¤íŠ¸ë˜ë“¤ ë¹„ìš©: {straddle:.4f}"</span>)
<span class="fn">print</span>(<span class="st">f"ìƒë°© BEP: {K + straddle:.2f}"</span>)
<span class="fn">print</span>(<span class="st">f"í•˜ë°© BEP: {K - straddle:.2f}"</span>)</code></pre>
<div class="code-output"><span class="out-label">Output:</span>
d1 = 0.1500, d2 = 0.0250
ì½œ: 5.3735, í’‹: 4.1327
C-P = 1.2408, S-Keâ»Ê³áµ€ = 1.2422
 
ìŠ¤íŠ¸ë˜ë“¤ ë¹„ìš©: 9.5062
ìƒë°© BEP: 109.51
í•˜ë°© BEP: 90.49</div>
<p class="ni"><strong>4)</strong> ìŠ¤íŠ¸ë˜ë“¤ì€ ë°©í–¥ì— ê´€ê³„ì—†ì´ í° ì›€ì§ì„ì— ë² íŒ…í•˜ëŠ” ì „ëµì´ë‹¤. ì‹¤ì  ë°œí‘œ, ê¸ˆë¦¬ ê²°ì • ë“± í° ì´ë²¤íŠ¸ ì „ì— ë³€ë™ì„±ì´ í˜„ì¬ ë‚´ì¬ ë³€ë™ì„±(25%)ë³´ë‹¤ í´ ê²ƒìœ¼ë¡œ ì˜ˆìƒë  ë•Œ ìœ ë¦¬í•˜ë‹¤. ë°˜ëŒ€ë¡œ ì‹œì¥ì´ íš¡ë³´í•˜ë©´ ì‹œê°„ê°€ì¹˜ ê°ì†Œ(ì„¸íƒ€)ë¡œ ì†ì‹¤ì´ ë°œìƒí•œë‹¤.</p>
</div>
</details>

<div class="problem-box">
<div class="problem-title">ğŸ† ì¢…í•© ë¬¸ì œ 2: ë¦¬ìŠ¤í¬ ê´€ë¦¬ ì¢…í•©</div>
<p class="ni">10ì–µì› ì£¼ì‹ í¬íŠ¸í´ë¦¬ì˜¤ì˜ ì¼ê°„ ìˆ˜ìµë¥ ì´ \(N(0.04\%, 1.8\%)\)ë¥¼ ë”°ë¥¸ë‹¤.</p>
<ol>
<li>1ì¼ 95% VaRê³¼ 99% VaRì„ ë¶„ì‚°-ê³µë¶„ì‚°ë²•ìœ¼ë¡œ êµ¬í•˜ë¼.</li>
<li>10ì¼ 99% VaRì„ êµ¬í•˜ë¼ (ë°”ì ¤ ê·œì œ ê¸°ì¤€).</li>
<li>ì´ í¬íŠ¸í´ë¦¬ì˜¤ì— ëŒ€í•´ ë¸íƒ€ 1ì¸ ATM í’‹ì˜µì…˜ìœ¼ë¡œ í—¤ì§€í•˜ë ¤ë©´ ëª‡ ê³„ì•½ì´ í•„ìš”í•œê°€? (1ê³„ì•½ = ì£¼ì‹ 100ì£¼, ì£¼ê°€ 50,000ì›)</li>
<li>GARCH(1,1)ì—ì„œ \(\alpha=0.09, \beta=0.88\)ì´ê³  ì–´ì œ ìˆ˜ìµë¥ ì´ -4%ì˜€ë‹¤ë©´, ë‚´ì¼ì˜ VaRì€ ì˜¤ëŠ˜ë³´ë‹¤ ë†’ì„ê¹Œ ë‚®ì„ê¹Œ?</li>
</ol>
</div>

<details>
<summary>ğŸ”‘ í’€ì´ ë³´ê¸°</summary>
<div class="answer-content">
<p class="ni"><strong>1)</strong></p>
<p class="ni">95% VaR = -(0.0004 + (-1.645) Ã— 0.018) Ã— 10ì–µ = -(0.0004 - 0.02961) Ã— 10ì–µ = 0.02921 Ã— 10ì–µ = 2,921ë§Œì›</p>
<p class="ni">99% VaR = -(0.0004 + (-2.326) Ã— 0.018) Ã— 10ì–µ = -(0.0004 - 0.04187) Ã— 10ì–µ = 0.04147 Ã— 10ì–µ = 4,147ë§Œì›</p>
<p class="ni"><strong>2)</strong> 10ì¼ 99% VaR = 4,147ë§Œì› Ã— âˆš10 = 13,113ë§Œì› â‰ˆ 1.31ì–µì›</p>
<p class="ni"><strong>3)</strong> í¬íŠ¸í´ë¦¬ì˜¤ ê°€ì¹˜ = 10ì–µì›, ì£¼ê°€ = 50,000ì› â†’ ì£¼ì‹ ìˆ˜ = 10ì–µ/50,000 = 20,000ì£¼</p>
<p class="ni">ATM í’‹ì˜ ë¸íƒ€ â‰ˆ -0.5, 1ê³„ì•½ = 100ì£¼</p>
<p class="ni">í•„ìš” ê³„ì•½ ìˆ˜ = 20,000 / (0.5 Ã— 100) = 400ê³„ì•½</p>
<p class="ni">(í’‹ 400ê³„ì•½ ë§¤ìˆ˜ ì‹œ í¬íŠ¸í´ë¦¬ì˜¤ ë¸íƒ€ â‰ˆ 0 â†’ ì‹œì¥ ì¤‘ë¦½)</p>
<p class="ni"><strong>4)</strong> Î± + Î² = 0.97ë¡œ ì§€ì†ì„±ì´ ë†’ë‹¤. ì–´ì œ -4% ì¶©ê²©ì€ í‰ì†Œ(Ïƒâ‰ˆ1.8%)ë³´ë‹¤ 2ë°° ì´ìƒ í° ì¶©ê²©ì´ë¯€ë¡œ, GARCH ëª¨ë¸ì—ì„œ ë‚´ì¼ì˜ ì¡°ê±´ë¶€ ë¶„ì‚°ì€ í¬ê²Œ ìƒìŠ¹í•œë‹¤. ë”°ë¼ì„œ ë‚´ì¼ì˜ VaRì€ ì˜¤ëŠ˜ë³´ë‹¤ í™•ì‹¤íˆ ë†’ë‹¤. ë³€ë™ì„± í´ëŸ¬ìŠ¤í„°ë§ íš¨ê³¼ë¡œ í° ì¶©ê²© í›„ì—ëŠ” ë³€ë™ì„±ì´ í•œë™ì•ˆ ë†’ê²Œ ìœ ì§€ëœë‹¤.</p>
</div>
</details>

<div class="problem-box">
<div class="problem-title">ğŸ† ì¢…í•© ë¬¸ì œ 3: ëª¬í…Œì¹´ë¥¼ë¡œ + ê¸ˆë¦¬ ëª¨ë¸</div>
<p class="ni">Vasicek ëª¨ë¸ì—ì„œ \(r_0 = 3\%\), \(\kappa = 0.3\), \(\theta = 5\%\), \(\sigma_r = 1.5\%\)ì´ë‹¤.</p>
<ol>
<li>ê¸ˆë¦¬ì˜ ì¥ê¸° ê¸°ëŒ€ê°’ê³¼ ì¥ê¸° ë¶„ì‚°ì„ êµ¬í•˜ë¼.</li>
<li>ê¸ˆë¦¬ê°€ í˜„ì¬ ìˆ˜ì¤€(3%)ì—ì„œ ì¥ê¸° í‰ê· (5%)ì˜ ì ˆë°˜ê¹Œì§€ íšŒê·€í•˜ëŠ” ë° ê±¸ë¦¬ëŠ” ë°˜ê°ê¸°ë¥¼ êµ¬í•˜ë¼.</li>
<li>ëª¬í…Œì¹´ë¥¼ë¡œ ì‹œë®¬ë ˆì´ì…˜ìœ¼ë¡œ 1ë…„ ë§Œê¸° ì œë¡œì¿ í° ì±„ê¶Œì˜ ê°€ê²©ì„ ì¶”ì •í•˜ëŠ” ì½”ë“œë¥¼ ì‘ì„±í•˜ë¼.</li>
</ol>
</div>

<details>
<summary>ğŸ”‘ í’€ì´ ë³´ê¸°</summary>
<div class="answer-content">
<p class="ni"><strong>1)</strong> Vasicekì˜ ì¥ê¸° ê¸°ëŒ€ê°’: \(E[r_\infty] = \theta = 5\%\)</p>
<p class="ni">ì¥ê¸° ë¶„ì‚°: \(\text{Var}[r_\infty] = \frac{\sigma_r^2}{2\kappa} = \frac{0.015^2}{2 \times 0.3} = \frac{0.000225}{0.6} = 0.000375\)</p>
<p class="ni">ì¥ê¸° í‘œì¤€í¸ì°¨ = âˆš0.000375 = 1.94%</p>
<p class="ni"><strong>2)</strong> ë°˜ê°ê¸° = \(\frac{\ln 2}{\kappa} = \frac{0.693}{0.3} = 2.31\)ë…„</p>
<p class="ni">ì¦‰, ê¸ˆë¦¬ê°€ 3%ì—ì„œ ì‹œì‘í•˜ë©´ ì•½ 2.31ë…„ í›„ 4% (= 3% + (5%-3%)/2)ì— ë„ë‹¬í•œë‹¤.</p>
<p class="ni"><strong>3)</strong></p>
<pre><code><span class="kw">import</span> numpy <span class="kw">as</span> np

np.random.seed(<span class="nu">42</span>)
r0, kappa, theta, sig = <span class="nu">0.03</span>, <span class="nu">0.3</span>, <span class="nu">0.05</span>, <span class="nu">0.015</span>
T, n_steps, n_sim = <span class="nu">1.0</span>, <span class="nu">252</span>, <span class="nu">100000</span>
dt = T / n_steps

<span class="cm"># ê¸ˆë¦¬ ê²½ë¡œ ì‹œë®¬ë ˆì´ì…˜</span>
r = np.full(n_sim, r0)
integral = np.zeros(n_sim)  <span class="cm"># âˆ«r dt ëˆ„ì </span>

<span class="kw">for</span> _ <span class="kw">in</span> <span class="fn">range</span>(n_steps):
    Z = np.random.randn(n_sim)
    integral += r * dt
    r = r + kappa*(theta - r)*dt + sig*np.sqrt(dt)*Z

<span class="cm"># ì œë¡œì¿ í° ì±„ê¶Œ ê°€ê²© = E[exp(-âˆ«r dt)]</span>
bond_price = np.mean(np.exp(-integral))
implied_yield = -np.log(bond_price) / T

<span class="fn">print</span>(<span class="st">f"MC ì±„ê¶Œ ê°€ê²©: {bond_price:.6f}"</span>)
<span class="fn">print</span>(<span class="st">f"ë‚´ì¬ ìˆ˜ìµë¥ :  {implied_yield:.4%}"</span>)</code></pre>
<div class="code-output"><span class="out-label">Output:</span>
MC ì±„ê¶Œ ê°€ê²©: 0.965218
ë‚´ì¬ ìˆ˜ìµë¥ :  3.5398%</div>
<p class="ni">ë‚´ì¬ ìˆ˜ìµë¥  3.54%ëŠ” í˜„ì¬ ê¸ˆë¦¬(3%)ì™€ ì¥ê¸° í‰ê· (5%) ì‚¬ì´ì— ìˆë‹¤. 1ë…„ ë™ì•ˆ ê¸ˆë¦¬ê°€ í‰ê·  íšŒê·€í•˜ë©´ì„œ ìƒìŠ¹í•˜ë¯€ë¡œ, ë‹¨ìˆœíˆ í˜„ì¬ ê¸ˆë¦¬ë¡œ í• ì¸í•˜ëŠ” ê²ƒë³´ë‹¤ ì±„ê¶Œ ê°€ê²©ì´ ë‚®ë‹¤(ìˆ˜ìµë¥ ì´ ë†’ë‹¤).</p>
</div>
</details>


<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- í•µì‹¬ ìš”ì•½ ì¹˜íŠ¸ì‹œíŠ¸ -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<h2>í•µì‹¬ ìš”ì•½: ê¸ˆìœµê³µí•™ ì¹˜íŠ¸ì‹œíŠ¸</h2>

<div class="tc">Table 5. ê¸ˆìœµê³µí•™ í•µì‹¬ ê°œë… â†’ ML/HFT ë§¤í•‘</div>
<table>
<tr><th>ê°œë…</th><th>ìˆ˜ì‹</th><th>ML ì‘ìš©</th><th>HFT ì‘ìš©</th></tr>
<tr><td>GBM</td><td>\(dS = \mu S\,dt + \sigma S\,dW\)</td><td>ì‹œê³„ì—´ ìƒì„± ëª¨ë¸</td><td>ì£¼ê°€ ì‹œë®¬ë ˆì´ì…˜</td></tr>
<tr><td>ì´í†  ë³´ì¡°ì •ë¦¬</td><td>\(df = f'dX + \frac{1}{2}f''(dX)^2\)</td><td>í™•ë¥ ì  ì—­ì „íŒŒ</td><td>ë³€ë™ì„± ë“œë˜ê·¸ ë³´ì •</td></tr>
<tr><td>ë¸”ë™-ìˆ„ì¦ˆ</td><td>\(C = SN(d_1) - Ke^{-rT}N(d_2)\)</td><td>ê°€ê²© ì˜ˆì¸¡ ë²¤ì¹˜ë§ˆí¬</td><td>ì˜µì…˜ ë§ˆì¼“ë©”ì´í‚¹</td></tr>
<tr><td>ê·¸ë¦­ìŠ¤</td><td>\(\Delta, \Gamma, \nu, \Theta, \rho\)</td><td>ë¯¼ê°ë„ ë¶„ì„</td><td>ë™ì  í—¤ì§•</td></tr>
<tr><td>ëª¬í…Œì¹´ë¥¼ë¡œ</td><td>\(E[f(X)] \approx \frac{1}{N}\sum f(x_i)\)</td><td>ë² ì´ì§€ì•ˆ ì¶”ë¡ </td><td>ì´ìƒ‰ ì˜µì…˜ ê°€ê²©</td></tr>
<tr><td>VaR / CVaR</td><td>\(P(\text{Loss}>\text{VaR})=\alpha\)</td><td>ë¦¬ìŠ¤í¬ ì œì•½ í•™ìŠµ</td><td>í¬ì§€ì…˜ í•œë„ ê´€ë¦¬</td></tr>
<tr><td>GARCH</td><td>\(\sigma_t^2 = \omega + \alpha\epsilon^2 + \beta\sigma^2\)</td><td>ë³€ë™ì„± í”¼ì²˜</td><td>ì‹¤ì‹œê°„ ë³€ë™ì„± ì¶”ì •</td></tr>
<tr><td>ë“€ë ˆì´ì…˜</td><td>\(D^* = -\frac{1}{P}\frac{dP}{dy}\)</td><td>ê¸ˆë¦¬ ë¯¼ê°ë„ í”¼ì²˜</td><td>ì±„ê¶Œ ì°¨ìµê±°ë˜</td></tr>
<tr><td>Vasicek/CIR</td><td>\(dr = \kappa(\theta-r)dt + \sigma dW\)</td><td>í‰ê·  íšŒê·€ ëª¨ë¸</td><td>ê¸ˆë¦¬ íŒŒìƒìƒí’ˆ</td></tr>
</table>

<div class="info">
<p class="ni"><strong>ë‹¤ìŒ ë‹¨ê³„:</strong> ì´ ê°•ì˜ì˜ ê¸ˆìœµê³µí•™ ê¸°ì´ˆëŠ” R6(NLP + Sentiment)ì—ì„œ ë‰´ìŠ¤ ê¸°ë°˜ ë³€ë™ì„± ì˜ˆì¸¡ì˜ ë°°ê²½ì´ ë˜ê³ , R7(Deep Learning)ì—ì„œ ì˜µì…˜ ê°€ê²© ì˜ˆì¸¡ ì‹ ê²½ë§ì˜ ê¸°ì´ˆê°€ ëœë‹¤. íŠ¹íˆ ëª¬í…Œì¹´ë¥¼ë¡œì™€ GARCHëŠ” R8(Convex Optimization)ì—ì„œ ë¦¬ìŠ¤í¬ ì œì•½ í¬íŠ¸í´ë¦¬ì˜¤ ìµœì í™”ì˜ í•µì‹¬ ì…ë ¥ì´ ëœë‹¤.</p>
</div>

</div><!-- paper-content -->
</div><!-- container -->
</div><!-- main-wrapper -->

</body>
</html>