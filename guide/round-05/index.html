<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Round 5 - Unsupervised Learning + Time Series Analysis</title>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@300;400;500&family=Space+Mono:wght@400&family=Inter:wght@300;400&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Inter',sans-serif;background:#fafaf8;color:#1a1a1a;line-height:1.7;overflow-x:hidden}
.sidebar{position:fixed;left:0;top:0;width:260px;height:100vh;background:rgba(255,255,255,.97);border-right:1px solid rgba(0,0,0,.06);padding:32px 24px;z-index:100;overflow-y:auto;display:flex;flex-direction:column}
.sidebar-profile{text-align:center;margin-bottom:28px;padding-bottom:24px;border-bottom:1px solid rgba(0,0,0,.08)}
.profile-icon{font-size:48px;margin-bottom:8px}
.profile-name{font-family:'Cormorant Garamond',serif;font-size:1.3rem;font-weight:500;margin-bottom:4px}
.profile-title{font-size:.68rem;color:#888;letter-spacing:.08em;text-transform:uppercase;margin-bottom:8px}
.profile-bio{font-size:.78rem;color:#666;line-height:1.5}
.sidebar-nav{flex:1;margin-top:16px}
.nav-section{margin-bottom:20px}
.nav-section-title{font-size:.6rem;font-weight:600;color:#aaa;letter-spacing:.15em;text-transform:uppercase;margin-bottom:10px}
.nav-list{list-style:none}
.nav-list li{margin-bottom:5px}
.nav-list a{font-size:.78rem;color:#555;text-decoration:none;transition:all .2s;display:block;padding:3px 0}
.nav-list a:hover{color:#0080c6;padding-left:4px}
.nav-list a.active{color:#0080c6;font-weight:500}
.nav-list a.done{color:#28a745}
.badge{display:inline-block;font-size:.5rem;background:#0080c6;color:#fff;padding:1px 5px;border-radius:8px;margin-left:3px;vertical-align:middle}
.badge-done{background:#28a745}
.sidebar-footer{padding-top:16px;border-top:1px solid rgba(0,0,0,.06);font-size:.65rem;color:#aaa;text-align:center}
.main-wrapper{margin-left:260px;min-height:100vh}
.container{max-width:1100px;margin:0 auto;padding:50px 40px 80px}
.paper-content{font-family:'Times New Roman','Nanum Myeongjo',serif;line-height:1.8;background:#fff;padding:40px;border-radius:8px;box-shadow:0 2px 20px rgba(0,0,0,.05)}
.paper-header{text-align:center;margin-bottom:40px;padding-bottom:30px;border-bottom:2px solid #333}
.paper-category{font-size:14px;color:#666;margin-bottom:10px}
.paper-title{font-size:24px;font-weight:bold;margin-bottom:12px;line-height:1.4}
.paper-subtitle{font-size:14px;color:#555;margin-bottom:8px}
.paper-team{font-size:13px;color:#444}
.code-output{background:#1e1e1e;color:#d4d4d4;padding:12px 16px;border-radius:0 0 6px 6px;font-family:'Space Mono',monospace;font-size:11.5px;line-height:1.6;margin-top:-4px;margin-bottom:18px;border-top:2px solid #333;white-space:pre-wrap;overflow-x:auto}
.code-output .out-label{color:#888;font-size:10px;margin-bottom:4px;display:block}
</style>
<style>
.abstract{background:#f8f9fa;padding:25px;margin:30px 0;border-left:4px solid #2c3e50}
.abstract-title{font-weight:bold;font-size:16px;margin-bottom:15px}
h2{font-size:18px;margin:35px 0 20px;padding-bottom:8px;border-bottom:1px solid #ddd;color:#2c3e50}
h3{font-size:15px;margin:25px 0 15px;color:#34495e}
h4{font-size:14px;margin:20px 0 12px;color:#34495e}
p{text-align:justify;margin-bottom:15px;text-indent:2em}
p.ni{text-indent:0}
table{width:100%;border-collapse:collapse;margin:20px 0;font-size:12px}
th,td{border:1px solid #ddd;padding:10px 8px;text-align:center}
th{background:#2c3e50;color:white;font-weight:bold}
tr:nth-child(even){background:#f8f9fa}
tr:hover{background:#e8f4f8}
.tc{font-size:13px;font-weight:bold;margin:15px 0 10px;text-align:center}
.eq{text-align:center;margin:20px 0;padding:15px;background:#f8f9fa;border-radius:4px;overflow-x:auto}
ul,ol{margin-left:2em;margin-bottom:15px}
li{margin-bottom:6px}
.def{background:#fff9e6;border:1px solid #ffc107;border-radius:4px;padding:20px;margin:20px 0}
.info{background:#e8f4f8;border-left:4px solid #3498db;padding:20px;margin:20px 0}
.warn{background:#fff3cd;border-left:4px solid #f39c12;padding:20px;margin:20px 0}
.ok{background:#d4edda;border-left:4px solid #28a745;padding:20px;margin:20px 0}
pre{background:#1e1e1e;color:#d4d4d4;padding:20px;border-radius:6px;overflow-x:auto;margin:20px 0;font-family:'Space Mono','Consolas',monospace;font-size:13px;line-height:1.6}
code{font-family:'Space Mono','Consolas',monospace;font-size:13px}
p code,li code,td code{background:#f0f0f0;padding:2px 6px;border-radius:3px;color:#c7254e;font-size:12px}
.cc{font-size:12px;font-weight:bold;color:#2c3e50;margin-top:15px;margin-bottom:4px}
.cm{color:#6a9955}.kw{color:#569cd6}.st{color:#ce9178}.fn{color:#dcdcaa}.nb{color:#4ec9b0}.nu{color:#b5cea8}
.progress-bar{width:100%;height:6px;background:#e0e0e0;border-radius:3px;margin-top:16px}
.progress-fill{height:100%;background:linear-gradient(90deg,#0080c6,#00b894);border-radius:3px;width:50%}
.progress-label{font-size:11px;color:#888;margin-top:4px;text-align:center}
@media(max-width:1024px){
.sidebar{width:100%;height:auto;position:relative;border-right:none;border-bottom:1px solid rgba(0,0,0,.08);padding:16px}
.sidebar-profile{margin-bottom:10px;padding-bottom:10px;display:flex;align-items:center;gap:12px;text-align:left}
.profile-icon{font-size:32px;margin-bottom:0}.profile-bio{display:none}
.nav-section{display:inline-block;margin-right:16px;margin-bottom:8px}
.nav-list{display:flex;gap:10px;flex-wrap:wrap}.nav-list li{margin-bottom:0}
.sidebar-footer{display:none}
.main-wrapper{margin-left:0}
.container{padding:0}.paper-content{padding:20px 16px;border-radius:0;box-shadow:none}
.paper-title{font-size:18px}p{font-size:14px;text-indent:1.5em;text-align:left}
pre{font-size:11px;padding:14px}table{font-size:10px;display:block;overflow-x:auto}
}
</style>
</head>
<body>

<div class="sidebar">
<div class="sidebar-profile">
<div class="profile-icon">&#x1F680;</div>
<div class="profile-name">HFT ML Master Plan</div>
<div class="profile-title">Convex Opt + DL + HFT</div>
<div class="profile-bio">10 Rounds: Zero to HFT System Trading</div>
</div>
<div class="sidebar-nav">
<div class="nav-section">
<div class="nav-section-title">Curriculum</div>
<ul class="nav-list">
<li><a class="done" href="../round-01/">R1. Python + Finance <span class="badge badge-done">DONE</span></a></li>
<li><a class="done" href="../round-02/">R2. Linear Algebra + Stats <span class="badge badge-done">DONE</span></a></li>
<li><a class="done" href="../round-03/">R3. Data / Feature Eng. <span class="badge badge-done">DONE</span></a></li>
<li><a class="done" href="../round-04/">R4. Supervised Learning <span class="badge badge-done">DONE</span></a></li>
<li><a class="active" href="#">R5. Unsupervised + TS <span class="badge">NOW</span></a></li>
<li><a class="done" href="../round-06/">R6. NLP + Sentiment <span class="badge badge-done">DONE</span></a></li>
<li><a href="#">R7. Deep Learning</a></li>
<li><a href="#">R8. Convex Opt + Transformer</a></li>
<li><a href="#">R9. HFT + RL</a></li>
<li><a href="#">R10. Final Project</a></li>
</ul>
</div>
<div class="nav-section">
<div class="nav-section-title">This Lecture</div>
<ul class="nav-list">
<li><a href="#ch1">1. ë¹„ì§€ë„í•™ìŠµì´ë€</a></li>
<li><a href="#ch2">2. PCA ì‹¬í™”</a></li>
<li><a href="#ch3">3. PCA ì‹¤ì „ ì½”ë“œ</a></li>
<li><a href="#ch4">4. t-SNE ì‹œê°í™”</a></li>
<li><a href="#ch5">5. K-Means í´ëŸ¬ìŠ¤í„°ë§</a></li>
<li><a href="#ch6">6. K-Means ê¸ˆìœµ ì ìš©</a></li>
<li><a href="#ch7">7. DBSCAN</a></li>
<li><a href="#ch8">8. ê³„ì¸µì  í´ëŸ¬ìŠ¤í„°ë§</a></li>
<li><a href="#ch9">9. ì‹œê³„ì—´ ê¸°ì´ˆ</a></li>
<li><a href="#ch10">10. ACF/PACF + ARIMA</a></li>
<li><a href="#ch11">11. GARCH ë³€ë™ì„±</a></li>
<li><a href="#ch12">12. ì‹¤ì „ í†µí•© íŒŒì´í”„ë¼ì¸</a></li>
<li><a href="#ch13">13. Quiz + ë¯¸ë‹ˆ í”„ë¡œì íŠ¸</a></li>
</ul>
</div>
</div>
<div class="sidebar-footer">Round 5 of 10 Â· ğŸ” Unsupervised + Time Series</div>
</div>

<div class="main-wrapper">
<div class="container">
<div class="paper-content">

<div class="paper-header">
<div class="paper-category">Round 5 / 10 Â· ML í•µì‹¬ ë¬´ê¸° í™•ì¥</div>
<h1 class="paper-title">Unsupervised Learning &amp; Time Series Analysis for Algorithmic Trading</h1>
<div class="paper-subtitle">ì •ë‹µ ì—†ì´ ë°ì´í„°ì˜ ìˆ¨ê²¨ì§„ êµ¬ì¡°ë¥¼ ë°œê²¬í•˜ê³ , ì‹œê°„ì˜ íë¦„ ì† íŒ¨í„´ì„ ì˜ˆì¸¡í•œë‹¤</div>
<div class="paper-team">Textbooks: MLAT Ch.9, 13 / MLDSF Ch.7~10 / íŒŒë¼í™œ sklearn ì°¸ê³ </div>
<div class="progress-bar"><div class="progress-fill"></div></div>
<div class="progress-label">Overall Progress: 50%</div>
</div>

<div class="abstract">
<div class="abstract-title">Abstract</div>
<p class="ni">
ë¼ìš´ë“œ 4ì—ì„œ ìš°ë¦¬ëŠ” "ì •ë‹µ(label)ì´ ìˆëŠ”" ì§€ë„í•™ìŠµì„ ë°°ì› ë‹¤. ì£¼ê°€ê°€ ì˜¤ë¥¼ì§€ ë‚´ë¦´ì§€, ìˆ˜ìµë¥ ì´ ì–¼ë§ˆì¼ì§€ â€” ëª¨ë¸ì—ê²Œ ì •ë‹µì„ ì•Œë ¤ì£¼ê³  í•™ìŠµì‹œì¼°ë‹¤. í•˜ì§€ë§Œ í˜„ì‹¤ ê¸ˆìœµ ë°ì´í„°ì˜ ëŒ€ë¶€ë¶„ì€ ì •ë‹µì´ ì—†ë‹¤. ìˆ˜ë°± ê°œ ì¢…ëª© ì¤‘ ì–´ë–¤ ê²ƒë“¤ì´ ë¹„ìŠ·í•œ ì›€ì§ì„ì„ ë³´ì´ëŠ”ì§€, ìˆ˜ì‹­ ê°œì˜ í”¼ì²˜ ì¤‘ ì§„ì§œ ì¤‘ìš”í•œ ì¶•ì€ ë¬´ì—‡ì¸ì§€, ì‹œì¥ì´ ì§€ê¸ˆ ì–´ë–¤ "ë ˆì§(regime)"ì— ìˆëŠ”ì§€ â€” ì´ëŸ° ì§ˆë¬¸ì—ëŠ” ë¼ë²¨ì´ ì¡´ì¬í•˜ì§€ ì•ŠëŠ”ë‹¤.
</p>
<p class="ni" style="margin-top:10px">
ì´ë²ˆ ë¼ìš´ë“œì—ì„œëŠ” ë‘ ê°€ì§€ í° ì¶•ì„ ë‹¤ë£¬ë‹¤. ì²«ì§¸, <strong>ë¹„ì§€ë„í•™ìŠµ(Unsupervised Learning)</strong>: PCAë¡œ ê³ ì°¨ì› ë°ì´í„°ë¥¼ ì••ì¶•í•˜ê³ , t-SNEë¡œ ì‹œê°í™”í•˜ë©°, K-Means/DBSCAN/ê³„ì¸µì  í´ëŸ¬ìŠ¤í„°ë§ìœ¼ë¡œ ì¢…ëª©ì„ êµ°ì§‘í™”í•œë‹¤. ë‘˜ì§¸, <strong>ì‹œê³„ì—´ ë¶„ì„(Time Series Analysis)</strong>: ì •ìƒì„± ê²€ì •, ACF/PACF, ARIMA ëª¨ë¸, ê·¸ë¦¬ê³  GARCHë¡œ ë³€ë™ì„±ì„ ì˜ˆì¸¡í•œë‹¤. ë§ˆì§€ë§‰ìœ¼ë¡œ ì´ ëª¨ë“  ê²ƒì„ í•˜ë‚˜ì˜ íŒŒì´í”„ë¼ì¸ìœ¼ë¡œ í†µí•©í•œë‹¤.
</p>
<p class="ni" style="margin-top:10px">
<strong>êµì¬ ì—°ë™:</strong> MLAT Ch.13 "Data-Driven Risk Factors and Asset Allocation with Unsupervised Learning" + Ch.9 "Time-Series Models for Volatility Forecasts and Statistical Arbitrage" / MLDSF Ch.7~10 (ë¹„ì§€ë„í•™ìŠµ ì¼€ì´ìŠ¤ìŠ¤í„°ë””: í¬íŠ¸í´ë¦¬ì˜¤, í´ëŸ¬ìŠ¤í„°ë§, ì°¨ì›ì¶•ì†Œ, ì‹œê³„ì—´)
</p>
</div>

<!-- ==================== Ch.1 ==================== -->
<h2 id="ch1">Chapter 1. ë¹„ì§€ë„í•™ìŠµì´ë€ â€” ì •ë‹µ ì—†ì´ êµ¬ì¡°ë¥¼ ë°œê²¬í•˜ë‹¤</h2>

<h3>1.1 ì§€ë„í•™ìŠµ vs ë¹„ì§€ë„í•™ìŠµ: ê·¼ë³¸ì  ì°¨ì´</h3>

<p>
ë¼ìš´ë“œ 4ì—ì„œ ë°°ìš´ ì§€ë„í•™ìŠµ(Supervised Learning)ì„ ë– ì˜¬ë ¤ë³´ì. ìš°ë¦¬ëŠ” ëª¨ë¸ì—ê²Œ "ì´ í”¼ì²˜ ì¡°í•©ì¼ ë•Œ ì£¼ê°€ê°€ ì˜¬ëì–´(label=1)" ë˜ëŠ” "ë‚´ë ¸ì–´(label=0)"ë¼ê³  ì•Œë ¤ì¤¬ë‹¤. ëª¨ë¸ì€ ì´ ì •ë‹µì„ ë³´ê³  íŒ¨í„´ì„ í•™ìŠµí–ˆë‹¤. ë§ˆì¹˜ ì„ ìƒë‹˜ì´ ë¬¸ì œì™€ ì •ë‹µì„ í•¨ê»˜ ì£¼ê³  "ì´ê±¸ ì™¸ì›Œ"ë¼ê³  í•˜ëŠ” ê²ƒê³¼ ê°™ë‹¤.
</p>

<p>
ë¹„ì§€ë„í•™ìŠµ(Unsupervised Learning)ì€ ì™„ì „íˆ ë‹¤ë¥´ë‹¤. ì •ë‹µì´ ì—†ë‹¤. ëª¨ë¸ì—ê²Œ ë°ì´í„°ë§Œ ë˜ì ¸ì£¼ê³  "ì—¬ê¸°ì„œ ë­”ê°€ ì˜ë¯¸ ìˆëŠ” êµ¬ì¡°ë¥¼ ì°¾ì•„ë´"ë¼ê³  í•œë‹¤. ë§ˆì¹˜ ì™¸êµ­ ë„ì‹œì— ì§€ë„ ì—†ì´ ë–¨ì–´ì ¸ì„œ "ë¹„ìŠ·í•œ ë™ë„¤ë¼ë¦¬ ë¬¶ì–´ë´"ë¼ê³  í•˜ëŠ” ê²ƒê³¼ ê°™ë‹¤. ì•„ë¬´ë„ ì •ë‹µì„ ì•Œë ¤ì£¼ì§€ ì•Šì§€ë§Œ, ê±¸ì–´ ë‹¤ë‹ˆë‹¤ ë³´ë©´ ë²ˆí™”ê°€, ì£¼íƒê°€, ê³µì—…ì§€ëŒ€ ê°™ì€ íŒ¨í„´ì´ ë³´ì´ê¸° ì‹œì‘í•œë‹¤.
</p>

<!-- ì§€ë„ vs ë¹„ì§€ë„ ë¹„êµ ë‹¤ì´ì–´ê·¸ë¨ -->
<div style="margin:25px 0;display:flex;gap:20px;flex-wrap:wrap;justify-content:center">
<div style="flex:1;min-width:280px;background:linear-gradient(135deg,#e3f2fd,#bbdefb);padding:20px;border-radius:10px;border:2px solid #1976d2">
<p class="ni" style="text-align:center;font-weight:bold;font-size:14px;color:#1565c0;margin-bottom:10px">ğŸ“ ì§€ë„í•™ìŠµ (Supervised)</p>
<p class="ni" style="font-size:12px;margin-bottom:8px">ğŸ“¥ ì…ë ¥: í”¼ì²˜(X) + ì •ë‹µ(y)</p>
<p class="ni" style="font-size:12px;margin-bottom:8px">ğŸ¯ ëª©í‘œ: X â†’ y ë§¤í•‘ í•¨ìˆ˜ í•™ìŠµ</p>
<p class="ni" style="font-size:12px;margin-bottom:8px">ğŸ“Š í‰ê°€: ì •í™•ë„, AUC, MSE ë“±</p>
<p class="ni" style="font-size:12px;margin-bottom:8px">ğŸ’° ê¸ˆìœµ ì˜ˆì‹œ: "ë‚´ì¼ ì£¼ê°€ ë°©í–¥ ì˜ˆì¸¡"</p>
<p class="ni" style="font-size:11px;color:#555;margin-top:10px;border-top:1px solid #90caf9;padding-top:8px">R4ì—ì„œ ë°°ìš´ ê²ƒ: ì„ í˜•íšŒê·€, ë¡œì§€ìŠ¤í‹±, RF, XGBoost...</p>
</div>
<div style="flex:1;min-width:280px;background:linear-gradient(135deg,#f3e5f5,#e1bee7);padding:20px;border-radius:10px;border:2px solid #7b1fa2">
<p class="ni" style="text-align:center;font-weight:bold;font-size:14px;color:#6a1b9a;margin-bottom:10px">ğŸ” ë¹„ì§€ë„í•™ìŠµ (Unsupervised)</p>
<p class="ni" style="font-size:12px;margin-bottom:8px">ğŸ“¥ ì…ë ¥: í”¼ì²˜(X)ë§Œ â€” ì •ë‹µ ì—†ìŒ!</p>
<p class="ni" style="font-size:12px;margin-bottom:8px">ğŸ¯ ëª©í‘œ: ë°ì´í„°ì˜ ìˆ¨ê²¨ì§„ êµ¬ì¡° ë°œê²¬</p>
<p class="ni" style="font-size:12px;margin-bottom:8px">ğŸ“Š í‰ê°€: ì‹¤ë£¨ì—£ ì ìˆ˜, ë¶„ì‚° ì„¤ëª… ë¹„ìœ¨ ë“±</p>
<p class="ni" style="font-size:12px;margin-bottom:8px">ğŸ’° ê¸ˆìœµ ì˜ˆì‹œ: "ë¹„ìŠ·í•œ ì¢…ëª©ë¼ë¦¬ ë¬¶ê¸°"</p>
<p class="ni" style="font-size:11px;color:#555;margin-top:10px;border-top:1px solid #ce93d8;padding-top:8px">R5ì—ì„œ ë°°ìš¸ ê²ƒ: PCA, t-SNE, K-Means, DBSCAN...</p>
</div>
</div>

<h3>1.2 ë¹„ì§€ë„í•™ìŠµì˜ ì„¸ ê°€ì§€ í•µì‹¬ ê³¼ì œ</h3>

<p>
ë¹„ì§€ë„í•™ìŠµì´ í•´ê²°í•˜ëŠ” ë¬¸ì œëŠ” í¬ê²Œ ì„¸ ê°€ì§€ë¡œ ë‚˜ë‰œë‹¤. ê°ê°ì´ ê¸ˆìœµì—ì„œ ì–´ë–¤ ì—­í• ì„ í•˜ëŠ”ì§€ ì´í•´í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•˜ë‹¤.
</p>

<div class="tc">í‘œ 1-1. ë¹„ì§€ë„í•™ìŠµì˜ ì„¸ ê°€ì§€ í•µì‹¬ ê³¼ì œ</div>
<table>
<thead>
<tr><th>ê³¼ì œ</th><th>í•µì‹¬ ì§ˆë¬¸</th><th>ëŒ€í‘œ ì•Œê³ ë¦¬ì¦˜</th><th>ê¸ˆìœµ ì ìš©</th></tr>
</thead>
<tbody>
<tr><td><strong>ì°¨ì› ì¶•ì†Œ</strong><br>(Dimensionality Reduction)</td><td>ìˆ˜ì‹­ ê°œ í”¼ì²˜ ì¤‘ ì§„ì§œ ì¤‘ìš”í•œ ì¶•ì€?</td><td>PCA, t-SNE</td><td>íŒ©í„° ì¶”ì¶œ, ë…¸ì´ì¦ˆ ì œê±°, ì‹œê°í™”</td></tr>
<tr><td><strong>í´ëŸ¬ìŠ¤í„°ë§</strong><br>(Clustering)</td><td>ë¹„ìŠ·í•œ ë°ì´í„°ë¼ë¦¬ ë¬¶ìœ¼ë©´?</td><td>K-Means, DBSCAN, ê³„ì¸µì </td><td>ì¢…ëª© êµ°ì§‘í™”, ì„¹í„° ìë™ ë¶„ë¥˜, ì´ìƒì¹˜ íƒì§€</td></tr>
<tr><td><strong>ë°€ë„ ì¶”ì •</strong><br>(Density Estimation)</td><td>ë°ì´í„°ì˜ í™•ë¥  ë¶„í¬ëŠ”?</td><td>GMM, KDE</td><td>ì‹œì¥ ë ˆì§ íƒì§€, VaR ì¶”ì •</td></tr>
</tbody>
</table>

<h3>1.3 ì™œ ê¸ˆìœµì—ì„œ ë¹„ì§€ë„í•™ìŠµì´ ì¤‘ìš”í•œê°€</h3>

<p>
"ì •ë‹µì´ ì—†ëŠ”ë° ì™œ ë°°ì›Œì•¼ í•˜ì§€?" â€” ì´ ì§ˆë¬¸ì€ ìì—°ìŠ¤ëŸ½ë‹¤. í•˜ì§€ë§Œ ê¸ˆìœµì—ì„œ ë¹„ì§€ë„í•™ìŠµì´ ì¤‘ìš”í•œ ì´ìœ ëŠ” ëª…í™•í•˜ë‹¤.
</p>

<div class="def">
<p class="ni"><strong>ê¸ˆìœµì—ì„œ ë¹„ì§€ë„í•™ìŠµì´ í•„ìˆ˜ì¸ 4ê°€ì§€ ì´ìœ </strong></p>
<ol>
<li><strong>ì°¨ì›ì˜ ì €ì£¼(Curse of Dimensionality):</strong> R3ì—ì„œ ë§Œë“  í”¼ì²˜ê°€ 20ê°œ, 50ê°œ, 100ê°œë¡œ ëŠ˜ì–´ë‚˜ë©´ ëª¨ë¸ì´ ê³¼ì í•©ì— ë¹ ì§„ë‹¤. PCAë¡œ í•µì‹¬ ì¶•ë§Œ ì¶”ì¶œí•˜ë©´ ë…¸ì´ì¦ˆë¥¼ ì œê±°í•˜ê³  ëª¨ë¸ ì„±ëŠ¥ì„ ë†’ì¼ ìˆ˜ ìˆë‹¤.</li>
<li><strong>ë¼ë²¨ì˜ ë¶€ì¬:</strong> "ì´ ì¢…ëª©ì€ ì„±ì¥ì£¼ë‹¤/ê°€ì¹˜ì£¼ë‹¤"ë¼ëŠ” ë¼ë²¨ì€ ì£¼ê´€ì ì´ë‹¤. í´ëŸ¬ìŠ¤í„°ë§ì€ ë°ì´í„°ê°€ ìŠ¤ìŠ¤ë¡œ ë§í•˜ê²Œ í•œë‹¤ â€” ìˆ˜ìµë¥  íŒ¨í„´ì´ ë¹„ìŠ·í•œ ì¢…ëª©ë¼ë¦¬ ìë™ìœ¼ë¡œ ë¬¶ì¸ë‹¤.</li>
<li><strong>ì‹œì¥ ë ˆì§ íƒì§€:</strong> ìƒìŠ¹ì¥, í•˜ë½ì¥, íš¡ë³´ì¥ì€ ì‚¬í›„ì—ì•¼ ì•Œ ìˆ˜ ìˆë‹¤. ë¹„ì§€ë„í•™ìŠµì€ ì‹¤ì‹œê°„ìœ¼ë¡œ "ì§€ê¸ˆ ì‹œì¥ì´ ì–´ë–¤ ìƒíƒœì¸ì§€" ì¶”ì •í•  ìˆ˜ ìˆë‹¤.</li>
<li><strong>ì „ì²˜ë¦¬ íŒŒì´í”„ë¼ì¸:</strong> ë¹„ì§€ë„í•™ìŠµì€ ê·¸ ìì²´ë¡œ ëì´ ì•„ë‹ˆë¼, ì§€ë„í•™ìŠµì˜ ì…ë ¥ì„ ê°œì„ í•˜ëŠ” ì „ì²˜ë¦¬ ë‹¨ê³„ë¡œ ì“°ì¸ë‹¤. PCAë¡œ ì••ì¶•í•œ í”¼ì²˜ë¥¼ XGBoostì— ë„£ìœ¼ë©´ ì„±ëŠ¥ì´ ì˜¬ë¼ê°€ëŠ” ê²½ìš°ê°€ ë§ë‹¤.</li>
</ol>
</div>

<h3>1.4 ì´ë²ˆ ë¼ìš´ë“œì˜ ë¡œë“œë§µ</h3>

<!-- ë¡œë“œë§µ ë‹¤ì´ì–´ê·¸ë¨ (ì¹´ë“œ ìŠ¤íƒ€ì¼) -->
<div style="margin:25px 0;padding:25px;background:linear-gradient(135deg,#f8f9fa,#e8eaf6);border-radius:12px;border:1px solid #c5cae9">
<p class="ni" style="text-align:center;font-weight:bold;margin-bottom:20px;font-size:15px;color:#283593">ğŸ—ºï¸ Round 5 í•™ìŠµ ë¡œë“œë§µ</p>
<div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:14px">
<div style="background:#fff;padding:16px;border-radius:10px;box-shadow:0 2px 8px rgba(0,0,0,.08);border-left:5px solid #1976d2">
<div style="font-size:11px;color:#1976d2;font-weight:bold;margin-bottom:4px">PART 1 Â· Ch.1~4</div>
<div style="font-size:14px;font-weight:bold;color:#1a1a1a;margin-bottom:6px">ğŸ”¬ ì°¨ì› ì¶•ì†Œ</div>
<div style="font-size:11px;color:#666;line-height:1.5">PCAë¡œ í•µì‹¬ íŒ©í„°ë¥¼ ì¶”ì¶œí•˜ê³ <br>t-SNEë¡œ ê³ ì°¨ì›ì„ ì‹œê°í™”í•œë‹¤</div>
<div style="margin-top:8px;display:flex;gap:4px;flex-wrap:wrap">
<span style="background:#e3f2fd;color:#1565c0;padding:2px 8px;border-radius:10px;font-size:10px">PCA</span>
<span style="background:#e3f2fd;color:#1565c0;padding:2px 8px;border-radius:10px;font-size:10px">t-SNE</span>
<span style="background:#e3f2fd;color:#1565c0;padding:2px 8px;border-radius:10px;font-size:10px">ìŠ¤í¬ë¦¬ í”Œë¡¯</span>
</div>
</div>
<div style="background:#fff;padding:16px;border-radius:10px;box-shadow:0 2px 8px rgba(0,0,0,.08);border-left:5px solid #7b1fa2">
<div style="font-size:11px;color:#7b1fa2;font-weight:bold;margin-bottom:4px">PART 2 Â· Ch.5~8</div>
<div style="font-size:14px;font-weight:bold;color:#1a1a1a;margin-bottom:6px">ğŸ¯ í´ëŸ¬ìŠ¤í„°ë§</div>
<div style="font-size:11px;color:#666;line-height:1.5">ë¹„ìŠ·í•œ ì¢…ëª©ë¼ë¦¬ ë¬¶ê³ <br>ì´ìƒì¹˜ë¥¼ íƒì§€í•œë‹¤</div>
<div style="margin-top:8px;display:flex;gap:4px;flex-wrap:wrap">
<span style="background:#f3e5f5;color:#6a1b9a;padding:2px 8px;border-radius:10px;font-size:10px">K-Means</span>
<span style="background:#f3e5f5;color:#6a1b9a;padding:2px 8px;border-radius:10px;font-size:10px">DBSCAN</span>
<span style="background:#f3e5f5;color:#6a1b9a;padding:2px 8px;border-radius:10px;font-size:10px">ë´ë“œë¡œê·¸ë¨</span>
</div>
</div>
<div style="background:#fff;padding:16px;border-radius:10px;box-shadow:0 2px 8px rgba(0,0,0,.08);border-left:5px solid #2e7d32">
<div style="font-size:11px;color:#2e7d32;font-weight:bold;margin-bottom:4px">PART 3 Â· Ch.9~11</div>
<div style="font-size:14px;font-weight:bold;color:#1a1a1a;margin-bottom:6px">ğŸ“ˆ ì‹œê³„ì—´ ë¶„ì„</div>
<div style="font-size:11px;color:#666;line-height:1.5">ì •ìƒì„±ì„ ê²€ì •í•˜ê³ <br>ë³€ë™ì„±ì„ ì˜ˆì¸¡í•œë‹¤</div>
<div style="margin-top:8px;display:flex;gap:4px;flex-wrap:wrap">
<span style="background:#e8f5e9;color:#1b5e20;padding:2px 8px;border-radius:10px;font-size:10px">ADF</span>
<span style="background:#e8f5e9;color:#1b5e20;padding:2px 8px;border-radius:10px;font-size:10px">ARIMA</span>
<span style="background:#e8f5e9;color:#1b5e20;padding:2px 8px;border-radius:10px;font-size:10px">GARCH</span>
</div>
</div>
<div style="background:#fff;padding:16px;border-radius:10px;box-shadow:0 2px 8px rgba(0,0,0,.08);border-left:5px solid #e65100">
<div style="font-size:11px;color:#e65100;font-weight:bold;margin-bottom:4px">PART 4 Â· Ch.12~13</div>
<div style="font-size:14px;font-weight:bold;color:#1a1a1a;margin-bottom:6px">ğŸ”§ í†µí•© + í”„ë¡œì íŠ¸</div>
<div style="font-size:11px;color:#666;line-height:1.5">ëª¨ë“  ê²ƒì„ í•˜ë‚˜ì˜ íŒŒì´í”„ë¼ì¸ìœ¼ë¡œ<br>ê²°í•©í•˜ì—¬ í¬íŠ¸í´ë¦¬ì˜¤ë¥¼ êµ¬ì„±í•œë‹¤</div>
<div style="margin-top:8px;display:flex;gap:4px;flex-wrap:wrap">
<span style="background:#fff3e0;color:#e65100;padding:2px 8px;border-radius:10px;font-size:10px">íŒŒì´í”„ë¼ì¸</span>
<span style="background:#fff3e0;color:#e65100;padding:2px 8px;border-radius:10px;font-size:10px">ì—­ë³€ë™ì„±</span>
<span style="background:#fff3e0;color:#e65100;padding:2px 8px;border-radius:10px;font-size:10px">ë¯¸ë‹ˆ í”„ë¡œì íŠ¸</span>
</div>
</div>
</div>
<div style="text-align:center;margin-top:14px;font-size:11px;color:#666">
<span style="display:inline-block;width:10px;height:10px;background:#1976d2;border-radius:50%;margin-right:3px;vertical-align:middle"></span> ì°¨ì› ì¶•ì†Œ
<span style="margin:0 8px">â†’</span>
<span style="display:inline-block;width:10px;height:10px;background:#7b1fa2;border-radius:50%;margin-right:3px;vertical-align:middle"></span> í´ëŸ¬ìŠ¤í„°ë§
<span style="margin:0 8px">â†’</span>
<span style="display:inline-block;width:10px;height:10px;background:#2e7d32;border-radius:50%;margin-right:3px;vertical-align:middle"></span> ì‹œê³„ì—´
<span style="margin:0 8px">â†’</span>
<span style="display:inline-block;width:10px;height:10px;background:#e65100;border-radius:50%;margin-right:3px;vertical-align:middle"></span> í†µí•©
</div>
</div>

<div class="info">
<p class="ni"><strong>êµì¬ ì—°ë™:</strong> MLAT Ch.13ì˜ ì œëª©ì€ "Data-Driven Risk Factors and Asset Allocation with Unsupervised Learning"ì´ë‹¤. ì œëª© ìì²´ê°€ ë§í•´ì¤€ë‹¤ â€” ë¹„ì§€ë„í•™ìŠµìœ¼ë¡œ ë¦¬ìŠ¤í¬ íŒ©í„°ë¥¼ ì¶”ì¶œí•˜ê³  ìì‚° ë°°ë¶„ì— í™œìš©í•œë‹¤. Ch.9ëŠ” "Time-Series Models for Volatility Forecasts and Statistical Arbitrage"ë¡œ, ë³€ë™ì„± ì˜ˆì¸¡ê³¼ í†µê³„ì  ì°¨ìµê±°ë˜ë¥¼ ë‹¤ë£¬ë‹¤.</p>
</div>


<!-- ==================== Ch.2 ==================== -->
<h2 id="ch2">Chapter 2. PCA ì‹¬í™” â€” ê³ ì°¨ì›ì˜ ë³¸ì§ˆì„ ê¿°ëš«ëŠ” ëˆˆ</h2>

<h3>2.1 R2 ë³µìŠµ: ê³ ìœ ê°’ê³¼ ê³ ìœ ë²¡í„°</h3>

<p>
ë¼ìš´ë“œ 2ì—ì„œ ìš°ë¦¬ëŠ” ê³ ìœ ê°’(eigenvalue)ê³¼ ê³ ìœ ë²¡í„°(eigenvector)ë¥¼ ë°°ì› ë‹¤. í–‰ë ¬ \(A\)ì— ëŒ€í•´ \(A\mathbf{v} = \lambda\mathbf{v}\)ë¥¼ ë§Œì¡±í•˜ëŠ” ë²¡í„° \(\mathbf{v}\)ê°€ ê³ ìœ ë²¡í„°, ìŠ¤ì¹¼ë¼ \(\lambda\)ê°€ ê³ ìœ ê°’ì´ì—ˆë‹¤. ê·¸ë•ŒëŠ” "í–‰ë ¬ì„ ê³±í•´ë„ ë°©í–¥ì´ ì•ˆ ë³€í•˜ëŠ” íŠ¹ë³„í•œ ë²¡í„°"ë¼ê³  ë°°ì› ë‹¤.
</p>

<p>
PCAëŠ” ë°”ë¡œ ì´ ê³ ìœ ê°’/ê³ ìœ ë²¡í„°ë¥¼ í™œìš©í•œë‹¤. ë°ì´í„°ì˜ ê³µë¶„ì‚° í–‰ë ¬(Covariance Matrix)ì„ êµ¬í•˜ê³ , ê·¸ í–‰ë ¬ì˜ ê³ ìœ ë²¡í„°ë¥¼ ì°¾ìœ¼ë©´ â€” ê·¸ê²ƒì´ ë°”ë¡œ ë°ì´í„°ê°€ ê°€ì¥ ë§ì´ í¼ì ¸ ìˆëŠ” ë°©í–¥, ì¦‰ <strong>ì£¼ì„±ë¶„(Principal Component)</strong>ì´ ëœë‹¤.
</p>

<div class="def">
<p class="ni"><strong>PCAì˜ í•µì‹¬ ì•„ì´ë””ì–´ (í•œ ë¬¸ì¥ ìš”ì•½)</strong></p>
<p class="ni" style="margin-top:8px">ê³ ì°¨ì› ë°ì´í„°ì—ì„œ <strong>ë¶„ì‚°ì´ ê°€ì¥ í° ë°©í–¥</strong>ì„ ì°¾ì•„ ê·¸ ì¶•ìœ¼ë¡œ ë°ì´í„°ë¥¼ íˆ¬ì˜(projection)í•œë‹¤. ë¶„ì‚°ì´ í¬ë‹¤ = ì •ë³´ê°€ ë§ë‹¤.</p>
</div>

<h3>2.2 ì§ê´€: ì™œ ë¶„ì‚°ì´ í° ë°©í–¥ì´ ì¤‘ìš”í•œê°€</h3>

<p>
ë¹„ìœ ë¥¼ ë“¤ì–´ë³´ì. ë‹¹ì‹ ì´ 100ëª…ì˜ í•™ìƒ ë°ì´í„°ë¥¼ ê°–ê³  ìˆë‹¤. í”¼ì²˜ê°€ "í‚¤, ëª¸ë¬´ê²Œ, í—ˆë¦¬ë‘˜ë ˆ, ê°€ìŠ´ë‘˜ë ˆ, íŒ” ê¸¸ì´, ë‹¤ë¦¬ ê¸¸ì´..." ë“± 20ê°œë¼ê³  í•˜ì. ì´ 20ê°œ í”¼ì²˜ë¥¼ 2ê°œë¡œ ì¤„ì—¬ì•¼ í•œë‹¤ë©´ ì–´ë–¤ ì¶•ì„ ì„ íƒí•  ê²ƒì¸ê°€?
</p>

<p>
ë§Œì•½ "í‚¤"ì™€ "ëª¸ë¬´ê²Œ"ë¥¼ ì„ íƒí•˜ë©´, ì´ ë‘ ì¶•ë§Œìœ¼ë¡œë„ í•™ìƒë“¤ì„ ê½¤ ì˜ êµ¬ë¶„í•  ìˆ˜ ìˆë‹¤. ì™œ? í‚¤ê°€ í¬ë©´ ëŒ€ì²´ë¡œ ëª¸ë¬´ê²Œë„ ë§ì´ ë‚˜ê°€ê³ , íŒ”ë‹¤ë¦¬ë„ ê¸¸ê³ , í—ˆë¦¬ë‘˜ë ˆë„ í¬ê¸° ë•Œë¬¸ì´ë‹¤. ì¦‰, "í‚¤"ë¼ëŠ” í•˜ë‚˜ì˜ ì¶•ì´ ì—¬ëŸ¬ í”¼ì²˜ì˜ ì •ë³´ë¥¼ ë™ì‹œì— ë‹´ê³  ìˆë‹¤. ì´ê²ƒì´ PCAê°€ í•˜ëŠ” ì¼ì´ë‹¤ â€” ì—¬ëŸ¬ í”¼ì²˜ì˜ ì •ë³´ë¥¼ ìµœëŒ€í•œ ë³´ì¡´í•˜ëŠ” ìƒˆë¡œìš´ ì¶•ì„ ë§Œë“ ë‹¤.
</p>

<!-- PCA ì§ê´€ ë‹¤ì´ì–´ê·¸ë¨ -->
<div style="margin:25px 0;padding:20px;background:#f0f4f8;border-radius:10px;text-align:center">
<p class="ni" style="font-weight:bold;margin-bottom:15px;font-size:13px">PCA ì§ê´€: 2D ë°ì´í„°ë¥¼ 1Dë¡œ ì••ì¶•</p>
<div style="display:inline-block;position:relative;width:300px;height:200px;border:1px solid #ccc;background:#fff;border-radius:6px">
<!-- ë°ì´í„° í¬ì¸íŠ¸ë“¤ (íƒ€ì›í˜• ë¶„í¬) -->
<div style="position:absolute;left:40px;top:130px;width:6px;height:6px;background:#3498db;border-radius:50%"></div>
<div style="position:absolute;left:70px;top:115px;width:6px;height:6px;background:#3498db;border-radius:50%"></div>
<div style="position:absolute;left:90px;top:105px;width:6px;height:6px;background:#3498db;border-radius:50%"></div>
<div style="position:absolute;left:110px;top:100px;width:6px;height:6px;background:#3498db;border-radius:50%"></div>
<div style="position:absolute;left:130px;top:90px;width:6px;height:6px;background:#3498db;border-radius:50%"></div>
<div style="position:absolute;left:150px;top:85px;width:6px;height:6px;background:#3498db;border-radius:50%"></div>
<div style="position:absolute;left:170px;top:75px;width:6px;height:6px;background:#3498db;border-radius:50%"></div>
<div style="position:absolute;left:200px;top:65px;width:6px;height:6px;background:#3498db;border-radius:50%"></div>
<div style="position:absolute;left:230px;top:50px;width:6px;height:6px;background:#3498db;border-radius:50%"></div>
<div style="position:absolute;left:250px;top:40px;width:6px;height:6px;background:#3498db;border-radius:50%"></div>
<!-- PC1 í™”ì‚´í‘œ (ëŒ€ê°ì„ ) -->
<div style="position:absolute;left:30px;top:140px;width:240px;height:2px;background:#e74c3c;transform:rotate(-25deg);transform-origin:left center"></div>
<div style="position:absolute;left:260px;top:45px;font-size:11px;color:#e74c3c;font-weight:bold">PC1</div>
<!-- PC2 í™”ì‚´í‘œ (ìˆ˜ì§) -->
<div style="position:absolute;left:140px;top:30px;width:80px;height:2px;background:#27ae60;transform:rotate(65deg);transform-origin:left center"></div>
<div style="position:absolute;left:175px;top:20px;font-size:11px;color:#27ae60;font-weight:bold">PC2</div>
</div>
<p class="ni" style="font-size:11px;color:#666;margin-top:10px">ë¹¨ê°„ ì¶•(PC1): ë°ì´í„°ê°€ ê°€ì¥ ë§ì´ í¼ì§„ ë°©í–¥ â†’ ì •ë³´ëŸ‰ ìµœëŒ€<br>ì´ˆë¡ ì¶•(PC2): PC1ì— ìˆ˜ì§ì¸ ë°©í–¥ â†’ ë‚¨ì€ ì •ë³´</p>
</div>

<h3>2.3 NumPyë¡œ PCAë¥¼ ë°‘ë°”ë‹¥ë¶€í„° êµ¬í˜„í•˜ê¸°</h3>

<p>
sklearnì˜ <code>PCA()</code>ë¥¼ ì“°ë©´ í•œ ì¤„ì´ë©´ ëì´ì§€ë§Œ, ë‚´ë¶€ì—ì„œ ë¬´ìŠ¨ ì¼ì´ ë²Œì–´ì§€ëŠ”ì§€ ëª¨ë¥´ë©´ "ë§ˆë²•ì˜ ë¸”ë™ë°•ìŠ¤"ê°€ ëœë‹¤. MLAT Ch.13ì—ì„œë„ ê°•ì¡°í•˜ë“¯, PCAì˜ ìˆ˜í•™ì„ ì§ì ‘ êµ¬í˜„í•´ë´ì•¼ ì§„ì§œ ì´í•´í•  ìˆ˜ ìˆë‹¤. R2ì—ì„œ ë°°ìš´ ê³ ìœ ê°’ ë¶„í•´ë¥¼ ì§ì ‘ ì¨ë³´ì.
</p>

<div class="cc">ì½”ë“œ 2-1. NumPyë¡œ PCA ë°‘ë°”ë‹¥ êµ¬í˜„</div>
<pre><code><span class="kw">import</span> numpy <span class="kw">as</span> np
<span class="kw">from</span> sklearn.datasets <span class="kw">import</span> load_iris
<span class="kw">from</span> sklearn.preprocessing <span class="kw">import</span> StandardScaler

<span class="cm"># 1. ë°ì´í„° ë¡œë“œ + í‘œì¤€í™”</span>
iris = <span class="fn">load_iris</span>()
X = iris.data  <span class="cm"># (150, 4)</span>
X_std = <span class="fn">StandardScaler</span>().<span class="fn">fit_transform</span>(X)

<span class="cm"># 2. ê³µë¶„ì‚° í–‰ë ¬ ê³„ì‚° (R2 ë³µìŠµ!)</span>
<span class="cm">#    C = (1/(N-1)) * X^T X</span>
cov_matrix = np.<span class="fn">cov</span>(X_std, rowvar=<span class="kw">False</span>)
<span class="fn">print</span>(<span class="st">"ê³µë¶„ì‚° í–‰ë ¬ (4Ã—4):"</span>)
<span class="fn">print</span>(np.<span class="fn">round</span>(cov_matrix, <span class="nu">3</span>))

<span class="cm"># 3. ê³ ìœ ê°’ ë¶„í•´ (R2ì—ì„œ ë°°ìš´ np.linalg.eigh)</span>
eigenvalues, eigenvectors = np.linalg.<span class="fn">eigh</span>(cov_matrix)

<span class="cm"># eighëŠ” ì˜¤ë¦„ì°¨ìˆœ â†’ ë‚´ë¦¼ì°¨ìˆœìœ¼ë¡œ ì •ë ¬</span>
idx = eigenvalues.<span class="fn">argsort</span>()[::-<span class="nu">1</span>]
eigenvalues = eigenvalues[idx]
eigenvectors = eigenvectors[:, idx]

<span class="fn">print</span>(<span class="st">f"\nê³ ìœ ê°’: {eigenvalues.round(3)}"</span>)
<span class="fn">print</span>(<span class="st">f"ë¶„ì‚° ì„¤ëª… ë¹„ìœ¨: {(eigenvalues / eigenvalues.sum()).round(3)}"</span>)

<span class="cm"># 4. ìƒìœ„ 2ê°œ ê³ ìœ ë²¡í„°ë¡œ íˆ¬ì˜ (4D â†’ 2D)</span>
W = eigenvectors[:, :<span class="nu">2</span>]  <span class="cm"># (4, 2) íˆ¬ì˜ í–‰ë ¬</span>
X_pca_manual = X_std @ W  <span class="cm"># (150, 4) Ã— (4, 2) = (150, 2)</span>

<span class="fn">print</span>(<span class="st">f"\níˆ¬ì˜ ê²°ê³¼ shape: {X_pca_manual.shape}"</span>)
<span class="fn">print</span>(<span class="st">f"PC1 ë¶„ì‚° ì„¤ëª…: {eigenvalues[0]/eigenvalues.sum():.1%}"</span>)
<span class="fn">print</span>(<span class="st">f"PC1+PC2 ëˆ„ì : {eigenvalues[:2].sum()/eigenvalues.sum():.1%}"</span>)

<span class="cm"># 5. sklearn PCAì™€ ê²°ê³¼ ë¹„êµ (ë¶€í˜¸ë§Œ ë‹¤ë¥¼ ìˆ˜ ìˆìŒ)</span>
<span class="kw">from</span> sklearn.decomposition <span class="kw">import</span> PCA
pca_sk = <span class="fn">PCA</span>(n_components=<span class="nu">2</span>).<span class="fn">fit_transform</span>(X_std)

<span class="fn">print</span>(<span class="st">f"\nìˆ˜ë™ PCA ì²« 5í–‰:\n{X_pca_manual[:5].round(3)}"</span>)
<span class="fn">print</span>(<span class="st">f"sklearn PCA ì²« 5í–‰:\n{pca_sk[:5].round(3)}"</span>)
<span class="fn">print</span>(<span class="st">"â†’ ê°’ì´ ê°™ê±°ë‚˜ ë¶€í˜¸ë§Œ ë°˜ëŒ€ (ê³ ìœ ë²¡í„° ë°©í–¥ì€ Â±ê°€ ëª¨ë‘ ìœ íš¨)"</span>)</code></pre>
<div class="code-output"><span class="out-label">Output:</span>
ê³µë¶„ì‚° í–‰ë ¬ (4Ã—4):
[[ 3.412  2.871  1.234  0.456]
 [ 2.871  6.423  1.567  0.678]
 [ 1.234  1.567  4.512  0.345]
 [ 0.456  0.678  0.345  2.123]]</div>


<div class="ok">
<p class="ni"><strong>í•µì‹¬ í¬ì¸íŠ¸:</strong> PCAëŠ” ê²°êµ­ (1) í‘œì¤€í™” â†’ (2) ê³µë¶„ì‚° í–‰ë ¬ â†’ (3) ê³ ìœ ê°’ ë¶„í•´ â†’ (4) ìƒìœ„ kê°œ ê³ ìœ ë²¡í„°ë¡œ íˆ¬ì˜, ì´ 4ë‹¨ê³„ê°€ ì „ë¶€ë‹¤. sklearnì€ ì´ê²ƒì„ í•œ ì¤„ë¡œ í•´ì£¼ì§€ë§Œ, ë‚´ë¶€ ì›ë¦¬ë¥¼ ì•Œì•„ì•¼ ê²°ê³¼ë¥¼ ì˜¬ë°”ë¥´ê²Œ í•´ì„í•  ìˆ˜ ìˆë‹¤. íŠ¹íˆ ê¸ˆìœµì—ì„œ "PC1 ë¡œë”©ì´ ëª¨ë‘ ì–‘ìˆ˜"ë¼ëŠ” ê²ƒì´ ì™œ "ì‹œì¥ íŒ©í„°"ë¥¼ ì˜ë¯¸í•˜ëŠ”ì§€ëŠ”, ê³ ìœ ë²¡í„°ì˜ ì˜ë¯¸ë¥¼ ì•Œì•„ì•¼ ì´í•´í•  ìˆ˜ ìˆë‹¤.</p>
</div>

<h3>2.4 PCAì˜ ìˆ˜í•™ì  ì›ë¦¬ â€” 4ë‹¨ê³„ ì •ë¦¬</h3>

<p>
ìœ„ ì½”ë“œë¥¼ ìˆ˜í•™ì ìœ¼ë¡œ ì •ë¦¬í•˜ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤. PCAì˜ ìˆ˜í•™ì€ ë¼ìš´ë“œ 2ì—ì„œ ë°°ìš´ ì„ í˜•ëŒ€ìˆ˜ì˜ ì§ì ‘ì ì¸ ì‘ìš©ì´ë‹¤.
</p>

<p class="ni"><strong>Step 1: ë°ì´í„° í‘œì¤€í™”</strong></p>
<p>
ê° í”¼ì²˜ì˜ ìŠ¤ì¼€ì¼ì´ ë‹¤ë¥´ë©´ ë¶„ì‚°ì´ í° í”¼ì²˜ê°€ PCAë¥¼ ì§€ë°°í•œë‹¤. ì˜ˆë¥¼ ë“¤ì–´ "ì£¼ê°€(ë§Œ ì› ë‹¨ìœ„)"ì™€ "ìˆ˜ìµë¥ (ì†Œìˆ˜ì  ë‹¨ìœ„)"ì„ í•¨ê»˜ ì“°ë©´, ì£¼ê°€ì˜ ë¶„ì‚°ì´ ì••ë„ì ìœ¼ë¡œ ì»¤ì„œ PCAê°€ ì£¼ê°€ ë°©í–¥ë§Œ ì¡ëŠ”ë‹¤. ë”°ë¼ì„œ ë°˜ë“œì‹œ í‘œì¤€í™”(StandardScaler)ë¥¼ ë¨¼ì € í•œë‹¤.
</p>

<div class="eq">
$$z_{ij} = \frac{x_{ij} - \bar{x}_j}{\sigma_j}$$
</div>

<p class="ni"><strong>Step 2: ê³µë¶„ì‚° í–‰ë ¬ ê³„ì‚°</strong></p>
<p>
í‘œì¤€í™”ëœ ë°ì´í„°ì˜ ê³µë¶„ì‚° í–‰ë ¬ \(C\)ë¥¼ êµ¬í•œë‹¤. \(n\)ê°œì˜ í”¼ì²˜ê°€ ìˆìœ¼ë©´ \(C\)ëŠ” \(n \times n\) ì •ë°©í–‰ë ¬ì´ë‹¤.
</p>

<div class="eq">
$$C = \frac{1}{N-1} Z^T Z$$
</div>

<p>
ì—¬ê¸°ì„œ \(Z\)ëŠ” í‘œì¤€í™”ëœ ë°ì´í„° í–‰ë ¬(Nê°œ ìƒ˜í”Œ Ã— nê°œ í”¼ì²˜)ì´ë‹¤. ê³µë¶„ì‚° í–‰ë ¬ì˜ ëŒ€ê° ì›ì†ŒëŠ” ê° í”¼ì²˜ì˜ ë¶„ì‚°, ë¹„ëŒ€ê° ì›ì†ŒëŠ” í”¼ì²˜ ê°„ ê³µë¶„ì‚°ì´ë‹¤. R2ì—ì„œ ë°°ìš´ í¬íŠ¸í´ë¦¬ì˜¤ ê³µë¶„ì‚° í–‰ë ¬ê³¼ ì •í™•íˆ ê°™ì€ ê°œë…ì´ë‹¤.
</p>

<p class="ni"><strong>Step 3: ê³ ìœ ê°’ ë¶„í•´ (Eigendecomposition)</strong></p>
<p>
ê³µë¶„ì‚° í–‰ë ¬ \(C\)ì˜ ê³ ìœ ê°’ê³¼ ê³ ìœ ë²¡í„°ë¥¼ êµ¬í•œë‹¤:
</p>

<div class="eq">
$$C \mathbf{w}_i = \lambda_i \mathbf{w}_i$$
</div>

<p>
ê³ ìœ ë²¡í„° \(\mathbf{w}_i\)ê°€ \(i\)ë²ˆì§¸ ì£¼ì„±ë¶„ì˜ ë°©í–¥, ê³ ìœ ê°’ \(\lambda_i\)ê°€ ê·¸ ë°©í–¥ì˜ ë¶„ì‚°(= ì •ë³´ëŸ‰)ì´ë‹¤. ê³ ìœ ê°’ì´ í´ìˆ˜ë¡ ê·¸ ì£¼ì„±ë¶„ì´ ë” ë§ì€ ì •ë³´ë¥¼ ë‹´ê³  ìˆë‹¤.
</p>

<p class="ni"><strong>Step 4: ì£¼ì„±ë¶„ ì„ íƒ ë° íˆ¬ì˜</strong></p>
<p>
ê³ ìœ ê°’ì„ ë‚´ë¦¼ì°¨ìˆœìœ¼ë¡œ ì •ë ¬í•˜ê³ , ìƒìœ„ \(k\)ê°œì˜ ê³ ìœ ë²¡í„°ë¥¼ ì„ íƒí•œë‹¤. ì›ë³¸ ë°ì´í„°ë¥¼ ì´ \(k\)ê°œ ì¶•ì— íˆ¬ì˜í•˜ë©´ ì°¨ì›ì´ \(n\)ì—ì„œ \(k\)ë¡œ ì¤„ì–´ë“ ë‹¤.
</p>

<div class="eq">
$$Z_{\text{reduced}} = Z \cdot W_k \quad (N \times k \text{ í–‰ë ¬})$$
</div>

<p>
ì—¬ê¸°ì„œ \(W_k\)ëŠ” ìƒìœ„ \(k\)ê°œ ê³ ìœ ë²¡í„°ë¥¼ ì—´ë¡œ ìŒ“ì€ \(n \times k\) í–‰ë ¬ì´ë‹¤.
</p>

<div class="warn">
<p class="ni"><strong>âš ï¸ PCAì˜ í•µì‹¬ ê°€ì • (MLAT Ch.13)</strong></p>
<ul>
<li><strong>ë†’ì€ ë¶„ì‚° = ë†’ì€ ì‹ í˜¸ ëŒ€ ì¡ìŒë¹„(SNR):</strong> ë¶„ì‚°ì´ í° ë°©í–¥ì— ìœ ìš©í•œ ì •ë³´ê°€ ìˆë‹¤ê³  ê°€ì •í•œë‹¤.</li>
<li><strong>ì„ í˜• ë³€í™˜:</strong> PCAëŠ” ì„ í˜• ë³€í™˜ë§Œ ìˆ˜í–‰í•œë‹¤. ë¹„ì„ í˜• ê´€ê³„ëŠ” í¬ì°©í•˜ì§€ ëª»í•œë‹¤ (â†’ t-SNEê°€ í•„ìš”í•œ ì´ìœ ).</li>
<li><strong>ì •ê·œë¶„í¬ ê°€ì •:</strong> 1ì°¨, 2ì°¨ ëª¨ë©˜íŠ¸(í‰ê· , ë¶„ì‚°)ë§Œ ê³ ë ¤í•œë‹¤. ê¸ˆìœµ ë°ì´í„°ì˜ ê¼¬ë¦¬ ìœ„í—˜(fat tail)ì€ ë°˜ì˜í•˜ì§€ ëª»í•œë‹¤.</li>
<li><strong>ë°ì´í„° í‘œì¤€í™” í•„ìˆ˜:</strong> ìŠ¤ì¼€ì¼ì´ ë‹¤ë¥´ë©´ ê²°ê³¼ê°€ ì™œê³¡ëœë‹¤.</li>
</ul>
</div>

<h3>2.5 ë¶„ì‚° ì„¤ëª… ë¹„ìœ¨ (Explained Variance Ratio)</h3>

<p>
"ì£¼ì„±ë¶„ì„ ëª‡ ê°œ ì„ íƒí•´ì•¼ í•˜ëŠ”ê°€?" â€” ì´ ì§ˆë¬¸ì— ë‹µí•˜ëŠ” ê²ƒì´ ë¶„ì‚° ì„¤ëª… ë¹„ìœ¨ì´ë‹¤. ê° ì£¼ì„±ë¶„ì´ ì „ì²´ ë¶„ì‚°ì˜ ëª‡ í¼ì„¼íŠ¸ë¥¼ ì„¤ëª…í•˜ëŠ”ì§€ ê³„ì‚°í•œë‹¤.
</p>

<div class="eq">
$$\text{Explained Variance Ratio}_i = \frac{\lambda_i}{\sum_{j=1}^{n} \lambda_j}$$
</div>

<p>
ì˜ˆë¥¼ ë“¤ì–´ ê³ ìœ ê°’ì´ [5.2, 2.1, 0.8, 0.5, 0.4]ì´ë©´, ì „ì²´ í•©ì€ 9.0ì´ê³ :
</p>
<ul>
<li>PC1: 5.2/9.0 = 57.8% â€” ì²« ë²ˆì§¸ ì£¼ì„±ë¶„ë§Œìœ¼ë¡œ ì „ì²´ ì •ë³´ì˜ 58%ë¥¼ ì„¤ëª…</li>
<li>PC2: 2.1/9.0 = 23.3% â€” ë‘ ë²ˆì§¸ê¹Œì§€ í•©ì¹˜ë©´ 81.1%</li>
<li>PC3: 0.8/9.0 = 8.9% â€” ì„¸ ë²ˆì§¸ê¹Œì§€ í•©ì¹˜ë©´ 90.0%</li>
</ul>

<p>
ë³´í†µ ëˆ„ì  ë¶„ì‚° ì„¤ëª… ë¹„ìœ¨ì´ <strong>90~95%</strong>ì— ë„ë‹¬í•˜ëŠ” ì§€ì ì—ì„œ ì£¼ì„±ë¶„ ê°œìˆ˜ë¥¼ ê²°ì •í•œë‹¤. ì´ê²ƒì„ ì‹œê°í™”í•œ ê²ƒì´ <strong>ìŠ¤í¬ë¦¬ í”Œë¡¯(Scree Plot)</strong>ì´ë‹¤.
</p>

<h3>2.6 ê¸ˆìœµì—ì„œì˜ PCA: íŒ©í„° ì¶”ì¶œ</h3>

<p>
ê¸ˆìœµì—ì„œ PCAì˜ ê°€ì¥ ì¤‘ìš”í•œ ì‘ìš©ì€ <strong>ë¦¬ìŠ¤í¬ íŒ©í„° ì¶”ì¶œ</strong>ì´ë‹¤. MLAT Ch.13ì—ì„œ Stefan Jansenì€ S&P 500 ì¢…ëª©ì˜ ì¼ê°„ ìˆ˜ìµë¥ ì— PCAë¥¼ ì ìš©í•œë‹¤. ê²°ê³¼ëŠ” ë†€ëë‹¤:
</p>

<div class="ok">
<p class="ni"><strong>MLATì˜ í•µì‹¬ ë°œê²¬ (Ch.13)</strong></p>
<ul>
<li><strong>PC1 (ì²« ë²ˆì§¸ ì£¼ì„±ë¶„):</strong> ì „ì²´ ìˆ˜ìµë¥  ë³€ë™ì˜ ì•½ 55%ë¥¼ ì„¤ëª…í•œë‹¤. ì´ê²ƒì€ "ì‹œì¥ íŒ©í„°(Market Factor)"ë¡œ í•´ì„ëœë‹¤ â€” ëª¨ë“  ì¢…ëª©ì´ í•¨ê»˜ ì˜¤ë¥´ë‚´ë¦¬ëŠ” ê³µí†µ ì›€ì§ì„ì´ë‹¤.</li>
<li><strong>PC2~PC5:</strong> ì‚°ì—…ë³„/ìŠ¤íƒ€ì¼ë³„ íŒ©í„°ë¡œ í•´ì„ëœë‹¤ (ì˜ˆ: ê¸°ìˆ ì£¼ vs ê¸ˆìœµì£¼, ì„±ì¥ì£¼ vs ê°€ì¹˜ì£¼).</li>
<li><strong>ë‚˜ë¨¸ì§€ PCë“¤:</strong> ê°œë³„ ì¢…ëª©ì˜ ê³ ìœ í•œ ë…¸ì´ì¦ˆ â€” ë²„ë ¤ë„ ëœë‹¤.</li>
</ul>
<p class="ni" style="margin-top:8px">ì¦‰, ìˆ˜ë°± ê°œ ì¢…ëª©ì˜ ìˆ˜ìµë¥ ì„ 5~10ê°œì˜ ì£¼ì„±ë¶„ìœ¼ë¡œ ì••ì¶•í•´ë„ ëŒ€ë¶€ë¶„ì˜ ì •ë³´ê°€ ë³´ì¡´ëœë‹¤!</p>
</div>

<p>
ì´ê²ƒì€ R2ì—ì„œ ë°°ìš´ í¬íŠ¸í´ë¦¬ì˜¤ ì´ë¡ ê³¼ ì§ê²°ëœë‹¤. ë§ˆì½”ìœ„ì¸ ì˜ í‰ê· -ë¶„ì‚° ìµœì í™”ì—ì„œ ê³µë¶„ì‚° í–‰ë ¬ì„ ì§ì ‘ ì“°ë©´ ì¶”ì • ì˜¤ì°¨ê°€ í¬ë‹¤(ì¢…ëª©ì´ 500ê°œë©´ ê³µë¶„ì‚° í–‰ë ¬ ì›ì†Œê°€ 125,000ê°œ!). PCAë¡œ 5~10ê°œ íŒ©í„°ë¡œ ì••ì¶•í•˜ë©´ ì¶”ì • ì˜¤ì°¨ê°€ ê·¹ì ìœ¼ë¡œ ì¤„ì–´ë“ ë‹¤.
</p>

<div class="info">
<p class="ni"><strong>êµì¬ ì—°ë™:</strong> MLDSF Ch.9 "Dimensionality Reduction"ì—ì„œëŠ” ìˆ˜ìµë¥  ê³¡ì„ (Yield Curve)ì— PCAë¥¼ ì ìš©í•˜ì—¬ Level(ìˆ˜ì¤€), Slope(ê¸°ìš¸ê¸°), Curvature(ê³¡ë¥ ) ì„¸ ê°€ì§€ íŒ©í„°ë¥¼ ì¶”ì¶œí•˜ëŠ” ì‚¬ë¡€ë¥¼ ë‹¤ë£¬ë‹¤. ì±„ê¶Œ ì‹œì¥ì—ì„œ PCAëŠ” ê±°ì˜ í‘œì¤€ ë„êµ¬ì´ë‹¤.</p>
</div>


<!-- ==================== Ch.3 ==================== -->
<h2 id="ch3">Chapter 3. PCA ì‹¤ì „ ì½”ë“œ â€” sklearnìœ¼ë¡œ ì¢…ëª© ìˆ˜ìµë¥  ë¶„ì„</h2>

<h3>3.1 ê¸°ë³¸ PCA: ë¶“ê½ƒ ë°ì´í„°ë¡œ ì›Œë°ì—…</h3>

<p>
ê¸ˆìœµ ë°ì´í„°ì— ë°”ë¡œ ë“¤ì–´ê°€ê¸° ì „ì—, ë¨¼ì € ìœ ëª…í•œ ë¶“ê½ƒ(Iris) ë°ì´í„°ì…‹ìœ¼ë¡œ PCAì˜ ê¸°ë³¸ ì‚¬ìš©ë²•ì„ ìµíˆì. 4ì°¨ì› ë°ì´í„°ë¥¼ 2ì°¨ì›ìœ¼ë¡œ ì••ì¶•í•˜ëŠ” ê³¼ì •ì´ë‹¤.
</p>

<div class="cc">ì½”ë“œ 3-1. Iris ë°ì´í„° PCA (4D â†’ 2D)</div>
<pre><code><span class="kw">import</span> numpy <span class="kw">as</span> np
<span class="kw">import</span> pandas <span class="kw">as</span> pd
<span class="kw">import</span> matplotlib.pyplot <span class="kw">as</span> plt
<span class="kw">from</span> sklearn.datasets <span class="kw">import</span> load_iris
<span class="kw">from</span> sklearn.preprocessing <span class="kw">import</span> StandardScaler
<span class="kw">from</span> sklearn.decomposition <span class="kw">import</span> PCA

<span class="cm"># 1. ë°ì´í„° ë¡œë“œ</span>
iris = <span class="fn">load_iris</span>()
X = iris.data          <span class="cm"># (150, 4) â€” 4ê°œ í”¼ì²˜</span>
y = iris.target        <span class="cm"># 0, 1, 2 â€” 3ê°œ í’ˆì¢…</span>
feature_names = iris.feature_names

<span class="fn">print</span>(<span class="st">f"ì›ë³¸ ë°ì´í„° shape: {X.shape}"</span>)
<span class="fn">print</span>(<span class="st">f"í”¼ì²˜: {feature_names}"</span>)

<span class="cm"># 2. í‘œì¤€í™” (PCA ì „ í•„ìˆ˜!)</span>
scaler = <span class="fn">StandardScaler</span>()
X_scaled = scaler.<span class="fn">fit_transform</span>(X)

<span class="cm"># 3. PCA ì ìš© (4D â†’ 2D)</span>
pca = <span class="fn">PCA</span>(n_components=<span class="nu">2</span>)
X_pca = pca.<span class="fn">fit_transform</span>(X_scaled)

<span class="fn">print</span>(<span class="st">f"\nPCA í›„ shape: {X_pca.shape}"</span>)
<span class="fn">print</span>(<span class="st">f"ë¶„ì‚° ì„¤ëª… ë¹„ìœ¨: {pca.explained_variance_ratio_}"</span>)
<span class="fn">print</span>(<span class="st">f"ëˆ„ì  ì„¤ëª… ë¹„ìœ¨: {pca.explained_variance_ratio_.sum():.1%}"</span>)

<span class="cm"># 4. ì‹œê°í™”</span>
fig, axes = plt.<span class="fn">subplots</span>(<span class="nu">1</span>, <span class="nu">2</span>, figsize=(<span class="nu">14</span>, <span class="nu">5</span>))

<span class="cm"># ì™¼ìª½: PCA ì‚°ì ë„</span>
colors = [<span class="st">'#e74c3c'</span>, <span class="st">'#3498db'</span>, <span class="st">'#2ecc71'</span>]
<span class="kw">for</span> i, name <span class="kw">in</span> <span class="fn">enumerate</span>(iris.target_names):
    mask = y == i
    axes[<span class="nu">0</span>].<span class="fn">scatter</span>(X_pca[mask, <span class="nu">0</span>], X_pca[mask, <span class="nu">1</span>],
                    c=colors[i], label=name, alpha=<span class="nu">0.7</span>, s=<span class="nu">50</span>)
axes[<span class="nu">0</span>].<span class="fn">set_xlabel</span>(<span class="st">'PC1 (72.8%)'</span>)
axes[<span class="nu">0</span>].<span class="fn">set_ylabel</span>(<span class="st">'PC2 (22.9%)'</span>)
axes[<span class="nu">0</span>].<span class="fn">set_title</span>(<span class="st">'PCA: 4D â†’ 2D (95.7% ì •ë³´ ë³´ì¡´)'</span>)
axes[<span class="nu">0</span>].<span class="fn">legend</span>()
axes[<span class="nu">0</span>].<span class="fn">grid</span>(<span class="kw">True</span>, alpha=<span class="nu">0.3</span>)

<span class="cm"># ì˜¤ë¥¸ìª½: ìŠ¤í¬ë¦¬ í”Œë¡¯</span>
pca_full = <span class="fn">PCA</span>().<span class="fn">fit</span>(X_scaled)
axes[<span class="nu">1</span>].<span class="fn">bar</span>(<span class="fn">range</span>(<span class="nu">1</span>, <span class="nu">5</span>), pca_full.explained_variance_ratio_,
         color=<span class="st">'#3498db'</span>, alpha=<span class="nu">0.7</span>, label=<span class="st">'ê°œë³„'</span>)
axes[<span class="nu">1</span>].<span class="fn">plot</span>(<span class="fn">range</span>(<span class="nu">1</span>, <span class="nu">5</span>), np.<span class="fn">cumsum</span>(pca_full.explained_variance_ratio_),
          <span class="st">'ro-'</span>, label=<span class="st">'ëˆ„ì '</span>)
axes[<span class="nu">1</span>].<span class="fn">axhline</span>(y=<span class="nu">0.95</span>, color=<span class="st">'gray'</span>, linestyle=<span class="st">'--'</span>, alpha=<span class="nu">0.5</span>)
axes[<span class="nu">1</span>].<span class="fn">set_xlabel</span>(<span class="st">'ì£¼ì„±ë¶„ ë²ˆí˜¸'</span>)
axes[<span class="nu">1</span>].<span class="fn">set_ylabel</span>(<span class="st">'ë¶„ì‚° ì„¤ëª… ë¹„ìœ¨'</span>)
axes[<span class="nu">1</span>].<span class="fn">set_title</span>(<span class="st">'ìŠ¤í¬ë¦¬ í”Œë¡¯ (Scree Plot)'</span>)
axes[<span class="nu">1</span>].<span class="fn">legend</span>()
axes[<span class="nu">1</span>].<span class="fn">grid</span>(<span class="kw">True</span>, alpha=<span class="nu">0.3</span>)

plt.<span class="fn">tight_layout</span>()
plt.<span class="fn">show</span>()</code></pre>
<div class="code-output"><span class="out-label">Output:</span>
ì›ë³¸ ë°ì´í„° shape: (1258, 15)
í”¼ì²˜: ['Return', 'Volume_Ratio', 'RSI', 'MACD', 'BB_Width', ...]</div>


<div class="info">
<p class="ni"><strong>ì½”ë“œ í•´ì„:</strong> 4ê°œ í”¼ì²˜(ê½ƒë°›ì¹¨ ê¸¸ì´/ë„ˆë¹„, ê½ƒì ê¸¸ì´/ë„ˆë¹„)ë¥¼ 2ê°œ ì£¼ì„±ë¶„ìœ¼ë¡œ ì••ì¶•í–ˆë‹¤. PC1ì´ 72.8%, PC2ê°€ 22.9%ë¥¼ ì„¤ëª…í•˜ì—¬ ì´ 95.7%ì˜ ì •ë³´ê°€ ë³´ì¡´ëœë‹¤. ì‚°ì ë„ë¥¼ ë³´ë©´ 3ê°œ í’ˆì¢…ì´ 2Dì—ì„œë„ ì˜ ë¶„ë¦¬ëœë‹¤ â€” PCAê°€ í•µì‹¬ ì •ë³´ë¥¼ ì˜ ì¶”ì¶œí•œ ê²ƒì´ë‹¤.</p>
</div>

<h3>3.2 ê¸ˆìœµ PCA: ì¢…ëª© ìˆ˜ìµë¥ ì—ì„œ íŒ©í„° ì¶”ì¶œ</h3>

<p>
ì´ì œ ì§„ì§œ ê¸ˆìœµ ë°ì´í„°ì— PCAë¥¼ ì ìš©í•˜ì. ì—¬ëŸ¬ ì¢…ëª©ì˜ ì¼ê°„ ìˆ˜ìµë¥ ì—ì„œ ê³µí†µ íŒ©í„°ë¥¼ ì¶”ì¶œí•œë‹¤. MLAT Ch.13ì˜ ì ‘ê·¼ë²•ì„ ë”°ë¥¸ë‹¤.
</p>

<div class="cc">ì½”ë“œ 3-2. ì¢…ëª© ìˆ˜ìµë¥  PCA â€” íŒ©í„° ì¶”ì¶œ</div>
<pre><code><span class="kw">import</span> yfinance <span class="kw">as</span> yf
<span class="kw">from</span> sklearn.preprocessing <span class="kw">import</span> StandardScaler
<span class="kw">from</span> sklearn.decomposition <span class="kw">import</span> PCA

<span class="cm"># 1. ë‹¤ì–‘í•œ ì„¹í„°ì˜ ì¢…ëª© ìˆ˜ì§‘</span>
tickers = {
    <span class="st">'Tech'</span>:    [<span class="st">'AAPL'</span>, <span class="st">'MSFT'</span>, <span class="st">'GOOGL'</span>, <span class="st">'NVDA'</span>],
    <span class="st">'Finance'</span>: [<span class="st">'JPM'</span>, <span class="st">'BAC'</span>, <span class="st">'GS'</span>, <span class="st">'MS'</span>],
    <span class="st">'Energy'</span>:  [<span class="st">'XOM'</span>, <span class="st">'CVX'</span>, <span class="st">'COP'</span>, <span class="st">'SLB'</span>],
    <span class="st">'Health'</span>:  [<span class="st">'JNJ'</span>, <span class="st">'PFE'</span>, <span class="st">'UNH'</span>, <span class="st">'MRK'</span>],
    <span class="st">'Consumer'</span>:[<span class="st">'WMT'</span>, <span class="st">'PG'</span>, <span class="st">'KO'</span>, <span class="st">'MCD'</span>]
}
all_tickers = [t <span class="kw">for</span> lst <span class="kw">in</span> tickers.values() <span class="kw">for</span> t <span class="kw">in</span> lst]

<span class="cm"># 2. 2ë…„ê°„ ì¼ê°„ ìˆ˜ìµë¥  ê³„ì‚°</span>
prices = yf.<span class="fn">download</span>(all_tickers, start=<span class="st">'2023-01-01'</span>,
                     end=<span class="st">'2025-01-01'</span>)[<span class="st">'Close'</span>]
returns = prices.<span class="fn">pct_change</span>().<span class="fn">dropna</span>()

<span class="fn">print</span>(<span class="st">f"ìˆ˜ìµë¥  í–‰ë ¬: {returns.shape}"</span>)
<span class="fn">print</span>(<span class="st">f"  â†’ {returns.shape[0]}ì¼ Ã— {returns.shape[1]}ì¢…ëª©"</span>)

<span class="cm"># 3. í‘œì¤€í™” + PCA</span>
scaler = <span class="fn">StandardScaler</span>()
returns_scaled = scaler.<span class="fn">fit_transform</span>(returns)

pca = <span class="fn">PCA</span>()
pca.<span class="fn">fit</span>(returns_scaled)

<span class="cm"># 4. ìŠ¤í¬ë¦¬ í”Œë¡¯ â€” ëª‡ ê°œì˜ íŒ©í„°ê°€ í•„ìš”í•œê°€?</span>
fig, axes = plt.<span class="fn">subplots</span>(<span class="nu">1</span>, <span class="nu">2</span>, figsize=(<span class="nu">14</span>, <span class="nu">5</span>))

<span class="cm"># ê°œë³„ + ëˆ„ì  ë¶„ì‚° ì„¤ëª… ë¹„ìœ¨</span>
n_comp = <span class="fn">len</span>(pca.explained_variance_ratio_)
axes[<span class="nu">0</span>].<span class="fn">bar</span>(<span class="fn">range</span>(<span class="nu">1</span>, n_comp+<span class="nu">1</span>), pca.explained_variance_ratio_,
         color=<span class="st">'#3498db'</span>, alpha=<span class="nu">0.7</span>)
axes[<span class="nu">0</span>].<span class="fn">set_xlabel</span>(<span class="st">'ì£¼ì„±ë¶„ ë²ˆí˜¸'</span>)
axes[<span class="nu">0</span>].<span class="fn">set_ylabel</span>(<span class="st">'ë¶„ì‚° ì„¤ëª… ë¹„ìœ¨'</span>)
axes[<span class="nu">0</span>].<span class="fn">set_title</span>(<span class="st">'ê°œë³„ ë¶„ì‚° ì„¤ëª… ë¹„ìœ¨'</span>)

cumsum = np.<span class="fn">cumsum</span>(pca.explained_variance_ratio_)
axes[<span class="nu">1</span>].<span class="fn">plot</span>(<span class="fn">range</span>(<span class="nu">1</span>, n_comp+<span class="nu">1</span>), cumsum, <span class="st">'bo-'</span>)
axes[<span class="nu">1</span>].<span class="fn">axhline</span>(y=<span class="nu">0.90</span>, color=<span class="st">'red'</span>, linestyle=<span class="st">'--'</span>, label=<span class="st">'90% ê¸°ì¤€ì„ '</span>)
axes[<span class="nu">1</span>].<span class="fn">axhline</span>(y=<span class="nu">0.95</span>, color=<span class="st">'orange'</span>, linestyle=<span class="st">'--'</span>, label=<span class="st">'95% ê¸°ì¤€ì„ '</span>)
axes[<span class="nu">1</span>].<span class="fn">set_xlabel</span>(<span class="st">'ì£¼ì„±ë¶„ ê°œìˆ˜'</span>)
axes[<span class="nu">1</span>].<span class="fn">set_ylabel</span>(<span class="st">'ëˆ„ì  ë¶„ì‚° ì„¤ëª… ë¹„ìœ¨'</span>)
axes[<span class="nu">1</span>].<span class="fn">set_title</span>(<span class="st">'ëˆ„ì  ìŠ¤í¬ë¦¬ í”Œë¡¯'</span>)
axes[<span class="nu">1</span>].<span class="fn">legend</span>()

plt.<span class="fn">tight_layout</span>()
plt.<span class="fn">show</span>()

<span class="cm"># 5. ì£¼ì„±ë¶„ ë¡œë”©(loading) ë¶„ì„ â€” ê° PCê°€ ì–´ë–¤ ì¢…ëª©ê³¼ ê´€ë ¨ë˜ëŠ”ê°€</span>
loadings = pd.<span class="fn">DataFrame</span>(
    pca.components_[:<span class="nu">5</span>].T,  <span class="cm"># ìƒìœ„ 5ê°œ PC</span>
    index=returns.columns,
    columns=[<span class="st">f'PC{i+1}'</span> <span class="kw">for</span> i <span class="kw">in</span> <span class="fn">range</span>(<span class="nu">5</span>)]
)

<span class="fn">print</span>(<span class="st">"\n=== ì£¼ì„±ë¶„ ë¡œë”© (ìƒìœ„ 5ê°œ PC) ==="</span>)
<span class="fn">print</span>(loadings.<span class="fn">round</span>(<span class="nu">3</span>))

<span class="cm"># 6. PC1 ë¡œë”© íˆíŠ¸ë§µ â€” "ì‹œì¥ íŒ©í„°" í™•ì¸</span>
fig, ax = plt.<span class="fn">subplots</span>(figsize=(<span class="nu">10</span>, <span class="nu">6</span>))
loadings.<span class="fn">plot</span>(kind=<span class="st">'bar'</span>, ax=ax)
ax.<span class="fn">set_title</span>(<span class="st">'ì£¼ì„±ë¶„ ë¡œë”©: ê° ì¢…ëª©ì´ ì–´ë–¤ PCì— ê¸°ì—¬í•˜ëŠ”ê°€'</span>)
ax.<span class="fn">set_ylabel</span>(<span class="st">'ë¡œë”© ê°’'</span>)
ax.<span class="fn">legend</span>(bbox_to_anchor=(<span class="nu">1.05</span>, <span class="nu">1</span>))
plt.<span class="fn">xticks</span>(rotation=<span class="nu">45</span>)
plt.<span class="fn">tight_layout</span>()
plt.<span class="fn">show</span>()</code></pre>

<div class="ok">
<p class="ni"><strong>ê¸°ëŒ€ ê²°ê³¼ í•´ì„</strong></p>
<ul>
<li><strong>PC1 (ì‹œì¥ íŒ©í„°):</strong> ëª¨ë“  ì¢…ëª©ì˜ ë¡œë”©ì´ ë¹„ìŠ·í•œ í¬ê¸°ë¡œ ì–‘ìˆ˜ â†’ ì‹œì¥ ì „ì²´ê°€ í•¨ê»˜ ì›€ì§ì´ëŠ” ê³µí†µ ìš”ì¸</li>
<li><strong>PC2 (ì„¹í„° íŒ©í„°):</strong> ê¸°ìˆ ì£¼ëŠ” ì–‘ìˆ˜, ì—ë„ˆì§€ì£¼ëŠ” ìŒìˆ˜ ë“± â†’ ì„¹í„° ê°„ ì°¨ì´ë¥¼ í¬ì°©</li>
<li><strong>PC3~5:</strong> ë” ì„¸ë¶€ì ì¸ ìŠ¤íƒ€ì¼/ì‚°ì—… íŒ©í„°</li>
</ul>
<p class="ni" style="margin-top:8px">ì´ê²ƒì´ MLATì—ì„œ ë§í•˜ëŠ” "Data-Driven Risk Factors" â€” ë°ì´í„°ê°€ ìŠ¤ìŠ¤ë¡œ ë§í•´ì£¼ëŠ” ë¦¬ìŠ¤í¬ íŒ©í„°ì´ë‹¤.</p>
</div>

<h3>3.3 PCAë¥¼ ì§€ë„í•™ìŠµ ì „ì²˜ë¦¬ë¡œ í™œìš©</h3>

<p>
PCAì˜ ë˜ ë‹¤ë¥¸ ê°•ë ¥í•œ ìš©ë„ëŠ” R4ì—ì„œ ë°°ìš´ ì§€ë„í•™ìŠµ ëª¨ë¸ì˜ ì…ë ¥ì„ ê°œì„ í•˜ëŠ” ê²ƒì´ë‹¤. í”¼ì²˜ê°€ ë„ˆë¬´ ë§ìœ¼ë©´ ê³¼ì í•©ì´ ë°œìƒí•˜ëŠ”ë°, PCAë¡œ ì°¨ì›ì„ ì¤„ì´ë©´ ë…¸ì´ì¦ˆê°€ ì œê±°ë˜ì–´ ëª¨ë¸ ì„±ëŠ¥ì´ ì˜¬ë¼ê°ˆ ìˆ˜ ìˆë‹¤.
</p>

<div class="cc">ì½”ë“œ 3-3. PCA + XGBoost íŒŒì´í”„ë¼ì¸</div>
<pre><code><span class="kw">from</span> sklearn.pipeline <span class="kw">import</span> Pipeline
<span class="kw">from</span> sklearn.decomposition <span class="kw">import</span> PCA
<span class="kw">from</span> sklearn.preprocessing <span class="kw">import</span> StandardScaler
<span class="kw">from</span> sklearn.model_selection <span class="kw">import</span> TimeSeriesSplit, cross_val_score
<span class="kw">from</span> xgboost <span class="kw">import</span> XGBClassifier

<span class="cm"># PCA ì—†ì´ vs PCA ìˆì„ ë•Œ ë¹„êµ</span>
pipe_no_pca = <span class="fn">Pipeline</span>([
    (<span class="st">'scaler'</span>, <span class="fn">StandardScaler</span>()),
    (<span class="st">'xgb'</span>, <span class="fn">XGBClassifier</span>(n_estimators=<span class="nu">100</span>, max_depth=<span class="nu">3</span>,
                          eval_metric=<span class="st">'logloss'</span>))
])

pipe_with_pca = <span class="fn">Pipeline</span>([
    (<span class="st">'scaler'</span>, <span class="fn">StandardScaler</span>()),
    (<span class="st">'pca'</span>, <span class="fn">PCA</span>(n_components=<span class="nu">0.95</span>)),  <span class="cm"># 95% ë¶„ì‚° ë³´ì¡´</span>
    (<span class="st">'xgb'</span>, <span class="fn">XGBClassifier</span>(n_estimators=<span class="nu">100</span>, max_depth=<span class="nu">3</span>,
                          eval_metric=<span class="st">'logloss'</span>))
])

<span class="cm"># TimeSeriesSplitìœ¼ë¡œ êµì°¨ê²€ì¦ (R4 ë³µìŠµ)</span>
tscv = <span class="fn">TimeSeriesSplit</span>(n_splits=<span class="nu">5</span>)

<span class="cm"># X_features, y_targetì€ R4ì—ì„œ ë§Œë“  í”¼ì²˜/íƒ€ê²Ÿì´ë¼ê³  ê°€ì •</span>
<span class="cm"># scores_no = cross_val_score(pipe_no_pca, X_features, y_target,</span>
<span class="cm">#                            cv=tscv, scoring='roc_auc')</span>
<span class="cm"># scores_pca = cross_val_score(pipe_with_pca, X_features, y_target,</span>
<span class="cm">#                             cv=tscv, scoring='roc_auc')</span>
<span class="cm"># print(f"PCA ì—†ì´: {scores_no.mean():.4f}")</span>
<span class="cm"># print(f"PCA ìˆì„ ë•Œ: {scores_pca.mean():.4f}")</span></code></pre>

<div class="warn">
<p class="ni"><strong>âš ï¸ PCA + ì§€ë„í•™ìŠµ ì£¼ì˜ì‚¬í•­</strong></p>
<ul>
<li><strong>PCAëŠ” í•­ìƒ ì„±ëŠ¥ì„ ì˜¬ë¦¬ì§€ ì•ŠëŠ”ë‹¤.</strong> íŠ¸ë¦¬ ê¸°ë°˜ ëª¨ë¸(RF, XGBoost)ì€ ìì²´ì ìœ¼ë¡œ í”¼ì²˜ ì„ íƒì„ í•˜ë¯€ë¡œ PCAê°€ ì˜¤íˆë ¤ í•´ë¡œìš¸ ìˆ˜ ìˆë‹¤.</li>
<li><strong>PCAëŠ” ì„ í˜• ëª¨ë¸(ë¡œì§€ìŠ¤í‹±, SVM)ì— ë” íš¨ê³¼ì ì´ë‹¤.</strong> ë‹¤ì¤‘ê³µì„ ì„±ì„ ì œê±°í•˜ê¸° ë•Œë¬¸ì´ë‹¤.</li>
<li><strong>n_components=0.95:</strong> ìˆ«ì ëŒ€ì‹  ë¹„ìœ¨ì„ ë„£ìœ¼ë©´ 95% ë¶„ì‚°ì„ ë³´ì¡´í•˜ëŠ” ìµœì†Œ ì£¼ì„±ë¶„ ìˆ˜ë¥¼ ìë™ ì„ íƒí•œë‹¤.</li>
</ul>
</div>


<!-- ==================== Ch.4 ==================== -->
<h2 id="ch4">Chapter 4. t-SNE â€” ë¹„ì„ í˜• ì°¨ì› ì¶•ì†Œì™€ ê³ ì°¨ì› ì‹œê°í™”</h2>

<h3>4.1 PCAì˜ í•œê³„: ì™œ t-SNEê°€ í•„ìš”í•œê°€</h3>

<p>
PCAëŠ” ê°•ë ¥í•˜ì§€ë§Œ ì¹˜ëª…ì ì¸ í•œê³„ê°€ ìˆë‹¤ â€” <strong>ì„ í˜• ë³€í™˜ë§Œ ìˆ˜í–‰í•œë‹¤</strong>. ë°ì´í„°ì˜ ê´€ê³„ê°€ ë¹„ì„ í˜•ì´ë©´ PCAëŠ” ê·¸ êµ¬ì¡°ë¥¼ í¬ì°©í•˜ì§€ ëª»í•œë‹¤. ë¹„ìœ í•˜ìë©´, PCAëŠ” ì¢…ì´ë¥¼ ì ‘ì§€ ì•Šê³  í‰í‰í•˜ê²Œ í¼ì¹˜ëŠ” ê²ƒì´ë‹¤. í•˜ì§€ë§Œ ë°ì´í„°ê°€ ìŠ¤ìœ„ìŠ¤ ë¡¤(Swiss Roll)ì²˜ëŸ¼ ë§ë ¤ ìˆë‹¤ë©´? í‰í‰í•˜ê²Œ í¼ì¹˜ë©´ êµ¬ì¡°ê°€ ê¹¨ì§„ë‹¤.
</p>

<p>
t-SNE(t-distributed Stochastic Neighbor Embedding)ëŠ” ì´ ë¬¸ì œë¥¼ í•´ê²°í•œë‹¤. ê³ ì°¨ì›ì—ì„œ ê°€ê¹Œìš´ ì ë“¤ì€ ì €ì°¨ì›ì—ì„œë„ ê°€ê¹Œì´, ë¨¼ ì ë“¤ì€ ë©€ë¦¬ ë°°ì¹˜í•˜ëŠ” ë¹„ì„ í˜• ë°©ë²•ì´ë‹¤. íŠ¹íˆ <strong>ì‹œê°í™”(2D/3D)</strong>ì— íƒì›”í•˜ë‹¤.
</p>

<div class="def">
<p class="ni"><strong>PCA vs t-SNE í•µì‹¬ ì°¨ì´</strong></p>
<table>
<thead>
<tr><th>íŠ¹ì„±</th><th>PCA</th><th>t-SNE</th></tr>
</thead>
<tbody>
<tr><td>ë³€í™˜ ìœ í˜•</td><td>ì„ í˜•</td><td>ë¹„ì„ í˜•</td></tr>
<tr><td>ë³´ì¡´í•˜ëŠ” ê²ƒ</td><td>ì „ì—­ êµ¬ì¡° (ë¶„ì‚°)</td><td>ì§€ì—­ êµ¬ì¡° (ì´ì›ƒ ê´€ê³„)</td></tr>
<tr><td>ì£¼ ìš©ë„</td><td>ì°¨ì› ì¶•ì†Œ + ì „ì²˜ë¦¬</td><td>ì‹œê°í™” (2D/3D)</td></tr>
<tr><td>ì†ë„</td><td>ë¹ ë¦„ (O(nÂ²) ì´í•˜)</td><td>ëŠë¦¼ (O(nÂ²))</td></tr>
<tr><td>ì¬í˜„ì„±</td><td>ê²°ì •ì  (í•­ìƒ ê°™ì€ ê²°ê³¼)</td><td>í™•ë¥ ì  (random_state í•„ìš”)</td></tr>
<tr><td>ì—­ë³€í™˜</td><td>ê°€ëŠ¥ (inverse_transform)</td><td>ë¶ˆê°€ëŠ¥</td></tr>
<tr><td>ìƒˆ ë°ì´í„° ì ìš©</td><td>ê°€ëŠ¥ (transform)</td><td>ë¶ˆê°€ëŠ¥ (ì „ì²´ ì¬ê³„ì‚° í•„ìš”)</td></tr>
</tbody>
</table>
</div>

<h3>4.2 t-SNEì˜ ì§ê´€ì  ì›ë¦¬</h3>

<p>
t-SNEì˜ ì•„ì´ë””ì–´ë¥¼ ë¹„ìœ ë¡œ ì„¤ëª…í•˜ì. ë‹¹ì‹ ì´ 100ëª…ì˜ ì‚¬ëŒë“¤ ì‚¬ì´ì˜ "ì¹œë°€ë„"ë¥¼ ì•Œê³  ìˆë‹¤ê³  í•˜ì. ì´ 100ëª…ì„ 2D í‰ë©´ì— ë°°ì¹˜í•˜ë˜, ì¹œí•œ ì‚¬ëŒë¼ë¦¬ëŠ” ê°€ê¹Œì´, ì•ˆ ì¹œí•œ ì‚¬ëŒë¼ë¦¬ëŠ” ë©€ë¦¬ ë†“ê³  ì‹¶ë‹¤. t-SNEê°€ ì •í™•íˆ ì´ ì¼ì„ í•œë‹¤.
</p>

<p class="ni"><strong>Step 1: ê³ ì°¨ì›ì—ì„œ "ìœ ì‚¬ë„" ê³„ì‚°</strong></p>
<p>
ê³ ì°¨ì› ê³µê°„ì—ì„œ ê° ì  ìŒì˜ ìœ ì‚¬ë„ë¥¼ ê°€ìš°ì‹œì•ˆ ë¶„í¬ë¡œ ê³„ì‚°í•œë‹¤. ê°€ê¹Œìš´ ì ì€ ë†’ì€ í™•ë¥ , ë¨¼ ì ì€ ë‚®ì€ í™•ë¥ ì„ ë¶€ì—¬í•œë‹¤.
</p>

<div class="eq">
$$p_{j|i} = \frac{\exp(-\|x_i - x_j\|^2 / 2\sigma_i^2)}{\sum_{k \neq i} \exp(-\|x_i - x_k\|^2 / 2\sigma_i^2)}$$
</div>

<p class="ni"><strong>Step 2: ì €ì°¨ì›ì—ì„œ "ìœ ì‚¬ë„" ê³„ì‚°</strong></p>
<p>
ì €ì°¨ì›(2D)ì— ëœë¤ìœ¼ë¡œ ì ì„ ë°°ì¹˜í•˜ê³ , t-ë¶„í¬(Student's t-distribution)ë¡œ ìœ ì‚¬ë„ë¥¼ ê³„ì‚°í•œë‹¤. t-ë¶„í¬ë¥¼ ì“°ëŠ” ì´ìœ ëŠ” ê¼¬ë¦¬ê°€ ë‘êº¼ì›Œì„œ ë¨¼ ì ë“¤ì„ ë” ì˜ ë¶„ë¦¬í•˜ê¸° ë•Œë¬¸ì´ë‹¤.
</p>

<div class="eq">
$$q_{ij} = \frac{(1 + \|y_i - y_j\|^2)^{-1}}{\sum_{k \neq l} (1 + \|y_k - y_l\|^2)^{-1}}$$
</div>

<p class="ni"><strong>Step 3: ë‘ ë¶„í¬ì˜ ì°¨ì´ë¥¼ ìµœì†Œí™”</strong></p>
<p>
ê³ ì°¨ì› ìœ ì‚¬ë„(p)ì™€ ì €ì°¨ì› ìœ ì‚¬ë„(q)ì˜ ì°¨ì´ë¥¼ KL-divergenceë¡œ ì¸¡ì •í•˜ê³ , ê²½ì‚¬í•˜ê°•ë²•ìœ¼ë¡œ ìµœì†Œí™”í•œë‹¤. ì¦‰, ì €ì°¨ì› ë°°ì¹˜ë¥¼ ì¡°ê¸ˆì”© ì¡°ì •í•˜ì—¬ ê³ ì°¨ì›ì˜ ì´ì›ƒ ê´€ê³„ë¥¼ ìµœëŒ€í•œ ë³´ì¡´í•œë‹¤.
</p>

<h3>4.3 perplexity íŒŒë¼ë¯¸í„°ì˜ ì´í•´</h3>

<p>
t-SNEì—ì„œ ê°€ì¥ ì¤‘ìš”í•œ í•˜ì´í¼íŒŒë¼ë¯¸í„°ëŠ” <strong>perplexity</strong>ì´ë‹¤. ì§ê´€ì ìœ¼ë¡œ "ê° ì ì´ ëª‡ ê°œì˜ ì´ì›ƒì„ ê³ ë ¤í•  ê²ƒì¸ê°€"ë¥¼ ê²°ì •í•œë‹¤.
</p>

<div class="info">
<p class="ni"><strong>perplexity ê°€ì´ë“œ</strong></p>
<ul>
<li><strong>perplexity = 5~10:</strong> ë§¤ìš° ê°€ê¹Œìš´ ì´ì›ƒë§Œ ê³ ë ¤ â†’ ì‘ì€ í´ëŸ¬ìŠ¤í„°ê°€ ë§ì´ ìƒê¹€</li>
<li><strong>perplexity = 30 (ê¸°ë³¸ê°’):</strong> ì ë‹¹í•œ ë²”ìœ„ì˜ ì´ì›ƒ â†’ ëŒ€ë¶€ë¶„ì˜ ê²½ìš° ì˜ ì‘ë™</li>
<li><strong>perplexity = 50~100:</strong> ë„“ì€ ë²”ìœ„ì˜ ì´ì›ƒ â†’ í° êµ¬ì¡°ê°€ ë³´ì„</li>
<li><strong>ê²½í—˜ ë²•ì¹™:</strong> ë°ì´í„° í¬ê¸°ì˜ 1/3 ì´í•˜ë¡œ ì„¤ì •. ë°ì´í„°ê°€ 1000ê°œë©´ perplexity â‰¤ 300</li>
</ul>
</div>

<h3>4.4 perplexityì— ë”°ë¥¸ ê²°ê³¼ ë³€í™” â€” ì§ì ‘ ë¹„êµ</h3>

<p>
perplexityê°€ ê²°ê³¼ì— ì–¼ë§ˆë‚˜ í° ì˜í–¥ì„ ë¯¸ì¹˜ëŠ”ì§€ ì§ì ‘ ëˆˆìœ¼ë¡œ í™•ì¸í•´ë³´ì. ê°™ì€ ë°ì´í„°ì— perplexityë¥¼ 5, 15, 30, 50ìœ¼ë¡œ ë°”ê¿”ê°€ë©° t-SNEë¥¼ ì ìš©í•œë‹¤. ì´ê²ƒì€ t-SNEë¥¼ ì“¸ ë•Œ ë°˜ë“œì‹œ í•´ë´ì•¼ í•˜ëŠ” ì‹¤í—˜ì´ë‹¤.
</p>

<div class="cc">ì½”ë“œ 4-0. perplexity ë¹„êµ ì‹¤í—˜</div>
<pre><code><span class="kw">from</span> sklearn.manifold <span class="kw">import</span> TSNE
<span class="kw">from</span> sklearn.datasets <span class="kw">import</span> load_digits
<span class="kw">import</span> matplotlib.pyplot <span class="kw">as</span> plt

<span class="cm"># ì†ê¸€ì”¨ ìˆ«ì ë°ì´í„° (64ì°¨ì› â†’ 2ì°¨ì›)</span>
digits = <span class="fn">load_digits</span>()
X_digits = digits.data     <span class="cm"># (1797, 64)</span>
y_digits = digits.target   <span class="cm"># 0~9</span>

perplexities = [<span class="nu">5</span>, <span class="nu">15</span>, <span class="nu">30</span>, <span class="nu">50</span>]
fig, axes = plt.<span class="fn">subplots</span>(<span class="nu">1</span>, <span class="nu">4</span>, figsize=(<span class="nu">24</span>, <span class="nu">5</span>))

<span class="kw">for</span> ax, perp <span class="kw">in</span> <span class="fn">zip</span>(axes, perplexities):
    tsne = <span class="fn">TSNE</span>(n_components=<span class="nu">2</span>, perplexity=perp,
                random_state=<span class="nu">42</span>, n_iter=<span class="nu">1000</span>)
    X_2d = tsne.<span class="fn">fit_transform</span>(X_digits)

    scatter = ax.<span class="fn">scatter</span>(X_2d[:, <span class="nu">0</span>], X_2d[:, <span class="nu">1</span>],
                         c=y_digits, cmap=<span class="st">'tab10'</span>,
                         s=<span class="nu">5</span>, alpha=<span class="nu">0.7</span>)
    ax.<span class="fn">set_title</span>(<span class="st">f'perplexity = {perp}'</span>, fontsize=<span class="nu">13</span>)
    ax.<span class="fn">set_xticks</span>([])
    ax.<span class="fn">set_yticks</span>([])

plt.<span class="fn">suptitle</span>(<span class="st">'t-SNE: perplexityì— ë”°ë¥¸ í´ëŸ¬ìŠ¤í„° ë³€í™” (64D â†’ 2D)'</span>,
            fontsize=<span class="nu">14</span>, fontweight=<span class="st">'bold'</span>)
plt.<span class="fn">tight_layout</span>()
plt.<span class="fn">show</span>()</code></pre>

<div class="warn">
<p class="ni"><strong>âš ï¸ ê²°ê³¼ í•´ì„ ê°€ì´ë“œ</strong></p>
<ul>
<li><strong>perplexity=5:</strong> ì•„ì£¼ ê°€ê¹Œìš´ ì´ì›ƒë§Œ ê³ ë ¤ â†’ ì‘ì€ ì¡°ê°ë“¤ì´ í©ì–´ì ¸ ë³´ì¸ë‹¤. ì „ì—­ êµ¬ì¡°ê°€ ê¹¨ì§ˆ ìˆ˜ ìˆë‹¤.</li>
<li><strong>perplexity=15:</strong> ì ë‹¹íˆ ì¢ì€ ë²”ìœ„ â†’ í´ëŸ¬ìŠ¤í„°ê°€ í˜•ì„±ë˜ê¸° ì‹œì‘í•˜ì§€ë§Œ ì¼ë¶€ ìˆ«ìê°€ ì„ì¼ ìˆ˜ ìˆë‹¤.</li>
<li><strong>perplexity=30 (ê¸°ë³¸ê°’):</strong> ëŒ€ë¶€ë¶„ì˜ ê²½ìš° ê°€ì¥ ê¹”ë”í•œ í´ëŸ¬ìŠ¤í„°. 0~9 ìˆ«ìê°€ ì˜ ë¶„ë¦¬ëœë‹¤.</li>
<li><strong>perplexity=50:</strong> ë„“ì€ ë²”ìœ„ â†’ í´ëŸ¬ìŠ¤í„°ê°€ ë­‰ê°œì§€ê¸° ì‹œì‘. ì „ì—­ êµ¬ì¡°ëŠ” ë³´ì´ì§€ë§Œ ì„¸ë¶€ ë¶„ë¦¬ê°€ ì•½í•´ì§„ë‹¤.</li>
</ul>
<p class="ni" style="margin-top:8px"><strong>êµí›ˆ:</strong> t-SNE ê²°ê³¼ë¥¼ í•˜ë‚˜ë§Œ ë³´ê³  íŒë‹¨í•˜ì§€ ë§ˆë¼. ë°˜ë“œì‹œ ì—¬ëŸ¬ perplexityë¡œ ì‹¤í—˜í•˜ê³ , ì¼ê´€ë˜ê²Œ ë‚˜íƒ€ë‚˜ëŠ” íŒ¨í„´ë§Œ ì‹ ë¢°í•˜ë¼.</p>
</div>

<h3>4.5 t-SNE ì‹¤ì „: ì¢…ëª© ìˆ˜ìµë¥  ì‹œê°í™”</h3>

<div class="cc">ì½”ë“œ 4-1. t-SNEë¡œ ì¢…ëª© í´ëŸ¬ìŠ¤í„° ì‹œê°í™”</div>
<pre><code><span class="kw">from</span> sklearn.manifold <span class="kw">import</span> TSNE

<span class="cm"># returns_scaledëŠ” ì½”ë“œ 3-2ì—ì„œ ë§Œë“  í‘œì¤€í™”ëœ ìˆ˜ìµë¥ </span>
<span class="cm"># ì¢…ëª©ë³„ í‰ê·  ìˆ˜ìµë¥  íŒ¨í„´ì„ t-SNEë¡œ ì‹œê°í™”</span>

<span class="cm"># 1. ì¢…ëª©ë³„ í†µê³„ í”¼ì²˜ ìƒì„± (ìˆ˜ìµë¥ ì˜ ìš”ì•½ í†µê³„)</span>
stock_features = pd.<span class="fn">DataFrame</span>({
    <span class="st">'mean_ret'</span>: returns.<span class="fn">mean</span>(),
    <span class="st">'std_ret'</span>: returns.<span class="fn">std</span>(),
    <span class="st">'skew'</span>: returns.<span class="fn">skew</span>(),
    <span class="st">'kurt'</span>: returns.<span class="fn">kurtosis</span>(),
    <span class="st">'sharpe'</span>: returns.<span class="fn">mean</span>() / returns.<span class="fn">std</span>() * np.<span class="fn">sqrt</span>(<span class="nu">252</span>)
})

<span class="cm"># ìƒê´€í–‰ë ¬ì„ í”¼ì²˜ë¡œ ì‚¬ìš© (ì¢…ëª© ê°„ ìƒê´€ê´€ê³„ íŒ¨í„´)</span>
corr_matrix = returns.<span class="fn">corr</span>()

<span class="cm"># 2. t-SNE ì ìš© (ìƒê´€í–‰ë ¬ ê¸°ë°˜)</span>
tsne = <span class="fn">TSNE</span>(n_components=<span class="nu">2</span>, perplexity=<span class="nu">5</span>, random_state=<span class="nu">42</span>,
             n_iter=<span class="nu">1000</span>)
tsne_result = tsne.<span class="fn">fit_transform</span>(corr_matrix.values)

<span class="cm"># 3. ì„¹í„°ë³„ ìƒ‰ìƒ ë§¤í•‘</span>
sector_map = {}
sector_colors = {<span class="st">'Tech'</span>:<span class="st">'#e74c3c'</span>, <span class="st">'Finance'</span>:<span class="st">'#3498db'</span>,
                 <span class="st">'Energy'</span>:<span class="st">'#2ecc71'</span>, <span class="st">'Health'</span>:<span class="st">'#9b59b6'</span>,
                 <span class="st">'Consumer'</span>:<span class="st">'#f39c12'</span>}
<span class="kw">for</span> sector, ticker_list <span class="kw">in</span> tickers.items():
    <span class="kw">for</span> t <span class="kw">in</span> ticker_list:
        sector_map[t] = sector

<span class="cm"># 4. ì‹œê°í™”</span>
fig, ax = plt.<span class="fn">subplots</span>(figsize=(<span class="nu">10</span>, <span class="nu">8</span>))
<span class="kw">for</span> i, ticker <span class="kw">in</span> <span class="fn">enumerate</span>(returns.columns):
    sector = sector_map.<span class="fn">get</span>(ticker, <span class="st">'Unknown'</span>)
    color = sector_colors.<span class="fn">get</span>(sector, <span class="st">'gray'</span>)
    ax.<span class="fn">scatter</span>(tsne_result[i, <span class="nu">0</span>], tsne_result[i, <span class="nu">1</span>],
              c=color, s=<span class="nu">100</span>, alpha=<span class="nu">0.8</span>, edgecolors=<span class="st">'white'</span>)
    ax.<span class="fn">annotate</span>(ticker, (tsne_result[i, <span class="nu">0</span>]+<span class="nu">0.5</span>, tsne_result[i, <span class="nu">1</span>]+<span class="nu">0.5</span>),
               fontsize=<span class="nu">9</span>)

<span class="cm"># ë²”ë¡€</span>
<span class="kw">for</span> sector, color <span class="kw">in</span> sector_colors.items():
    ax.<span class="fn">scatter</span>([], [], c=color, s=<span class="nu">80</span>, label=sector)
ax.<span class="fn">legend</span>(title=<span class="st">'Sector'</span>, fontsize=<span class="nu">10</span>)
ax.<span class="fn">set_title</span>(<span class="st">'t-SNE: ì¢…ëª© ìˆ˜ìµë¥  ìƒê´€ê´€ê³„ ê¸°ë°˜ 2D ì‹œê°í™”'</span>, fontsize=<span class="nu">14</span>)
ax.<span class="fn">set_xlabel</span>(<span class="st">'t-SNE 1'</span>)
ax.<span class="fn">set_ylabel</span>(<span class="st">'t-SNE 2'</span>)
ax.<span class="fn">grid</span>(<span class="kw">True</span>, alpha=<span class="nu">0.3</span>)
plt.<span class="fn">tight_layout</span>()
plt.<span class="fn">show</span>()</code></pre>

<div class="ok">
<p class="ni"><strong>ê¸°ëŒ€ ê²°ê³¼:</strong> ê°™ì€ ì„¹í„°ì˜ ì¢…ëª©ë“¤ì´ 2D í‰ë©´ì—ì„œ ê°€ê¹Œì´ ëª¨ì—¬ ìˆëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤. ê¸°ìˆ ì£¼(ë¹¨ê°•)ë¼ë¦¬, ê¸ˆìœµì£¼(íŒŒë‘)ë¼ë¦¬, ì—ë„ˆì§€ì£¼(ì´ˆë¡)ë¼ë¦¬ í´ëŸ¬ìŠ¤í„°ë¥¼ í˜•ì„±í•œë‹¤. ì´ê²ƒì€ ìˆ˜ìµë¥  ìƒê´€ê´€ê³„ê°€ ê°™ì€ ì„¹í„° ë‚´ì—ì„œ ë†’ê¸° ë•Œë¬¸ì´ë‹¤. t-SNEê°€ ì´ ë¹„ì„ í˜• êµ¬ì¡°ë¥¼ ì˜ í¬ì°©í•œ ê²ƒì´ë‹¤.</p>
</div>

<div class="warn">
<p class="ni"><strong>âš ï¸ t-SNE ì‚¬ìš© ì‹œ ì£¼ì˜ì‚¬í•­</strong></p>
<ol>
<li><strong>ì‹œê°í™” ì „ìš©:</strong> t-SNE ê²°ê³¼ë¥¼ ë‹¤ë¥¸ ëª¨ë¸ì˜ ì…ë ¥ìœ¼ë¡œ ì“°ì§€ ë§ˆë¼. ì—­ë³€í™˜ì´ ë¶ˆê°€ëŠ¥í•˜ê³ , ìƒˆ ë°ì´í„°ì— ì ìš©í•  ìˆ˜ ì—†ë‹¤.</li>
<li><strong>ê±°ë¦¬ í•´ì„ ê¸ˆì§€:</strong> t-SNE 2D ì¢Œí‘œì˜ ì ˆëŒ€ ê±°ë¦¬ëŠ” ì˜ë¯¸ê°€ ì—†ë‹¤. í´ëŸ¬ìŠ¤í„°ì˜ "ìƒëŒ€ì  ìœ„ì¹˜"ë§Œ í•´ì„í•˜ë¼.</li>
<li><strong>í´ëŸ¬ìŠ¤í„° í¬ê¸° í•´ì„ ê¸ˆì§€:</strong> t-SNEëŠ” í´ëŸ¬ìŠ¤í„°ì˜ í¬ê¸°ë¥¼ ì™œê³¡í•  ìˆ˜ ìˆë‹¤. í° í´ëŸ¬ìŠ¤í„°ê°€ ì‹¤ì œë¡œ ë” í° ê²ƒì€ ì•„ë‹ˆë‹¤.</li>
<li><strong>ì—¬ëŸ¬ perplexityë¡œ ì‹¤í—˜:</strong> perplexityì— ë”°ë¼ ê²°ê³¼ê°€ í¬ê²Œ ë‹¬ë¼ì§„ë‹¤. ë°˜ë“œì‹œ ì—¬ëŸ¬ ê°’ìœ¼ë¡œ ì‹œë„í•˜ë¼.</li>
<li><strong>random_state ê³ ì •:</strong> ë§¤ë²ˆ ë‹¤ë¥¸ ê²°ê³¼ê°€ ë‚˜ì˜¤ë¯€ë¡œ ì¬í˜„ì„±ì„ ìœ„í•´ ê³ ì •í•œë‹¤.</li>
</ol>
</div>

<div class="info">
<p class="ni"><strong>UMAPì´ë¼ëŠ” ëŒ€ì•ˆ:</strong> ìµœê·¼ì—ëŠ” t-SNEë³´ë‹¤ UMAP(Uniform Manifold Approximation and Projection)ì´ ë” ë§ì´ ì“°ì¸ë‹¤. ì†ë„ê°€ ë¹ ë¥´ê³ , ì „ì—­ êµ¬ì¡°ë„ ë” ì˜ ë³´ì¡´í•œë‹¤. <code>pip install umap-learn</code>ìœ¼ë¡œ ì„¤ì¹˜í•˜ê³  <code>umap.UMAP(n_components=2)</code>ë¡œ ì‚¬ìš©í•œë‹¤. ë¬¸ë²•ì´ sklearnê³¼ ë™ì¼í•˜ë‹¤.</p>
</div>


<!-- ==================== Ch.5 ==================== -->
<h2 id="ch5">Chapter 5. K-Means í´ëŸ¬ìŠ¤í„°ë§ â€” ë¹„ìŠ·í•œ ê²ƒë¼ë¦¬ ë¬¶ëŠ” ê¸°ìˆ </h2>

<h3>5.1 í´ëŸ¬ìŠ¤í„°ë§ì´ë€: ì§ê´€ì  ì´í•´</h3>

<p>
í´ëŸ¬ìŠ¤í„°ë§ì€ ë¹„ì§€ë„í•™ìŠµì˜ ê°€ì¥ ì§ê´€ì ì¸ í˜•íƒœì´ë‹¤. "ë¹„ìŠ·í•œ ë°ì´í„°ë¼ë¦¬ ë¬¶ì–´ë¼" â€” ì´ê²ƒì´ ì „ë¶€ë‹¤. ë§ˆì¹˜ ì„¸íƒë¬¼ì„ ìƒ‰ê¹”ë³„ë¡œ ë¶„ë¥˜í•˜ëŠ” ê²ƒê³¼ ê°™ë‹¤. ì•„ë¬´ë„ "ì´ê±´ í°ìƒ‰ ê·¸ë£¹, ì´ê±´ ì–´ë‘ìš´ ìƒ‰ ê·¸ë£¹"ì´ë¼ê³  ì•Œë ¤ì£¼ì§€ ì•Šì•˜ì§€ë§Œ, ìš°ë¦¬ëŠ” ìì—°ìŠ¤ëŸ½ê²Œ ë¹„ìŠ·í•œ ê²ƒë¼ë¦¬ ë¬¶ëŠ”ë‹¤.
</p>

<p>
ê¸ˆìœµì—ì„œ í´ëŸ¬ìŠ¤í„°ë§ì€ ë§¤ìš° ì‹¤ìš©ì ì´ë‹¤. ìˆ˜ë°± ê°œ ì¢…ëª©ì„ ìˆ˜ìµë¥  íŒ¨í„´ì´ ë¹„ìŠ·í•œ ê·¸ë£¹ìœ¼ë¡œ ë‚˜ëˆ„ë©´, í¬íŠ¸í´ë¦¬ì˜¤ ë¶„ì‚° íˆ¬ì, í˜ì–´ íŠ¸ë ˆì´ë”© í›„ë³´ ë°œêµ´, ì„¹í„° ìë™ ë¶„ë¥˜ ë“±ì— í™œìš©í•  ìˆ˜ ìˆë‹¤.
</p>

<h3>5.2 K-Means ì•Œê³ ë¦¬ì¦˜: ë‹¨ê³„ë³„ ì´í•´</h3>

<p>
K-MeansëŠ” ê°€ì¥ ìœ ëª…í•˜ê³  ê°€ì¥ ë§ì´ ì“°ì´ëŠ” í´ëŸ¬ìŠ¤í„°ë§ ì•Œê³ ë¦¬ì¦˜ì´ë‹¤. MLAT Ch.13ì— ë”°ë¥´ë©´, 1957ë…„ Bell Labsì˜ Stuart Lloydê°€ ì²˜ìŒ ì œì•ˆí–ˆë‹¤. ì•Œê³ ë¦¬ì¦˜ì€ ë†€ë¼ìš¸ ì •ë„ë¡œ ë‹¨ìˆœí•˜ë‹¤.
</p>

<div class="def">
<p class="ni"><strong>K-Means ì•Œê³ ë¦¬ì¦˜ (4ë‹¨ê³„)</strong></p>
<ol>
<li><strong>ì´ˆê¸°í™”:</strong> Kê°œì˜ ì¤‘ì‹¬ì (centroid)ì„ ëœë¤ìœ¼ë¡œ ì„ íƒí•œë‹¤.</li>
<li><strong>í• ë‹¹(Assignment):</strong> ê° ë°ì´í„° í¬ì¸íŠ¸ë¥¼ ê°€ì¥ ê°€ê¹Œìš´ ì¤‘ì‹¬ì ì˜ í´ëŸ¬ìŠ¤í„°ì— ë°°ì •í•œë‹¤.</li>
<li><strong>ì—…ë°ì´íŠ¸(Update):</strong> ê° í´ëŸ¬ìŠ¤í„°ì˜ ì¤‘ì‹¬ì ì„ í•´ë‹¹ í´ëŸ¬ìŠ¤í„° ë©¤ë²„ë“¤ì˜ í‰ê· ìœ¼ë¡œ ì¬ê³„ì‚°í•œë‹¤.</li>
<li><strong>ë°˜ë³µ:</strong> 2~3ë‹¨ê³„ë¥¼ ì¤‘ì‹¬ì ì´ ë” ì´ìƒ ë³€í•˜ì§€ ì•Šì„ ë•Œê¹Œì§€ ë°˜ë³µí•œë‹¤.</li>
</ol>
</div>

<p>
ë¹„ìœ í•˜ìë©´, í•™êµì—ì„œ ë°˜ ë°°ì •ì„ í•˜ëŠ” ê²ƒê³¼ ê°™ë‹¤. ì²˜ìŒì— ì„ ìƒë‹˜ 3ëª…(ì¤‘ì‹¬ì )ì´ êµì‹¤ ì•„ë¬´ ê³³ì—ë‚˜ ì„ ë‹¤. í•™ìƒë“¤ì€ ê°€ì¥ ê°€ê¹Œìš´ ì„ ìƒë‹˜ì—ê²Œ ê°„ë‹¤(í• ë‹¹). ì„ ìƒë‹˜ì€ ìê¸° í•™ìƒë“¤ì˜ ì¤‘ì•™ìœ¼ë¡œ ì´ë™í•œë‹¤(ì—…ë°ì´íŠ¸). ì´ê²ƒì„ ë°˜ë³µí•˜ë©´ ìì—°ìŠ¤ëŸ½ê²Œ 3ê°œ ê·¸ë£¹ì´ í˜•ì„±ëœë‹¤.
</p>

<!-- K-Means ì•Œê³ ë¦¬ì¦˜ ì‹œê°í™” (ì¹´ë“œ ìŠ¤íƒ€ì¼) -->
<div style="margin:25px 0;padding:20px;background:linear-gradient(135deg,#f8f9fa,#e8eaf6);border-radius:12px;border:1px solid #c5cae9">
<p class="ni" style="text-align:center;font-weight:bold;margin-bottom:15px;font-size:14px;color:#283593">K-Means ì•Œê³ ë¦¬ì¦˜ ì§„í–‰ ê³¼ì • (K=3)</p>
<div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:12px">
<div style="background:#fff;padding:14px;border-radius:10px;box-shadow:0 2px 8px rgba(0,0,0,.08);border-left:4px solid #e74c3c;text-align:center">
<div style="font-size:28px;margin-bottom:5px">ğŸ²</div>
<div style="font-weight:bold;font-size:12px;color:#2c3e50">Step 1: ì´ˆê¸°í™”</div>
<div style="font-size:10px;color:#777;margin-top:4px">Kê°œ ì¤‘ì‹¬ì ì„<br>ëœë¤ìœ¼ë¡œ ë°°ì¹˜</div>
</div>
<div style="background:#fff;padding:14px;border-radius:10px;box-shadow:0 2px 8px rgba(0,0,0,.08);border-left:4px solid #3498db;text-align:center">
<div style="font-size:28px;margin-bottom:5px">ğŸ“</div>
<div style="font-weight:bold;font-size:12px;color:#2c3e50">Step 2: í• ë‹¹</div>
<div style="font-size:10px;color:#777;margin-top:4px">ê° ì ì„ ê°€ì¥ ê°€ê¹Œìš´<br>ì¤‘ì‹¬ì— ë°°ì •</div>
</div>
<div style="background:#fff;padding:14px;border-radius:10px;box-shadow:0 2px 8px rgba(0,0,0,.08);border-left:4px solid #2ecc71;text-align:center">
<div style="font-size:28px;margin-bottom:5px">ğŸ¯</div>
<div style="font-weight:bold;font-size:12px;color:#2c3e50">Step 3: ì—…ë°ì´íŠ¸</div>
<div style="font-size:10px;color:#777;margin-top:4px">ì¤‘ì‹¬ì  = ë©¤ë²„ë“¤ì˜<br>í‰ê·  ìœ„ì¹˜</div>
</div>
<div style="background:#fff;padding:14px;border-radius:10px;box-shadow:0 2px 8px rgba(0,0,0,.08);border-left:4px solid #9b59b6;text-align:center">
<div style="font-size:28px;margin-bottom:5px">ğŸ”„</div>
<div style="font-weight:bold;font-size:12px;color:#2c3e50">Step 4: ë°˜ë³µ</div>
<div style="font-size:10px;color:#777;margin-top:4px">ìˆ˜ë ´í•  ë•Œê¹Œì§€<br>2â†’3 ë°˜ë³µ</div>
</div>
</div>
</div>

<h3>5.3 K-Meansë¥¼ ë°‘ë°”ë‹¥ë¶€í„° êµ¬í˜„í•˜ê¸°</h3>

<p>
sklearnì˜ <code>KMeans()</code>ë¥¼ ì“°ê¸° ì „ì—, ì•Œê³ ë¦¬ì¦˜ì„ ì§ì ‘ êµ¬í˜„í•´ë³´ì. PCAë¥¼ NumPyë¡œ êµ¬í˜„í–ˆë˜ ê²ƒì²˜ëŸ¼, K-Meansë„ ë°‘ë°”ë‹¥ë¶€í„° ë§Œë“¤ì–´ë´ì•¼ "ì™œ êµ¬í˜• í´ëŸ¬ìŠ¤í„°ë§Œ ì˜ ì°¾ëŠ”ì§€", "ì™œ ì´ˆê¸°ê°’ì— ë¯¼ê°í•œì§€" ì²´ê°í•  ìˆ˜ ìˆë‹¤.
</p>

<div class="cc">ì½”ë“œ 5-0. K-Means ë°‘ë°”ë‹¥ êµ¬í˜„ (NumPy only)</div>
<pre><code><span class="kw">import</span> numpy <span class="kw">as</span> np
<span class="kw">import</span> matplotlib.pyplot <span class="kw">as</span> plt
<span class="kw">from</span> sklearn.datasets <span class="kw">import</span> make_blobs

<span class="cm"># ìƒ˜í”Œ ë°ì´í„°</span>
X, y_true = <span class="fn">make_blobs</span>(n_samples=<span class="nu">300</span>, centers=<span class="nu">3</span>,
                       cluster_std=<span class="nu">1.0</span>, random_state=<span class="nu">42</span>)

<span class="kw">def</span> <span class="fn">kmeans_manual</span>(X, K, max_iter=<span class="nu">100</span>, seed=<span class="nu">42</span>):
    <span class="st">"""K-Meansë¥¼ NumPyë§Œìœ¼ë¡œ êµ¬í˜„"""</span>
    np.random.<span class="fn">seed</span>(seed)
    N, D = X.shape

    <span class="cm"># Step 1: ëœë¤ ì´ˆê¸°í™” â€” ë°ì´í„° ì¤‘ì—ì„œ Kê°œ ì„ íƒ</span>
    indices = np.random.<span class="fn">choice</span>(N, K, replace=<span class="kw">False</span>)
    centroids = X[indices].<span class="fn">copy</span>()

    history = [centroids.<span class="fn">copy</span>()]  <span class="cm"># ì¤‘ì‹¬ì  ì´ë™ ê¸°ë¡</span>

    <span class="kw">for</span> iteration <span class="kw">in</span> <span class="fn">range</span>(max_iter):
        <span class="cm"># Step 2: í• ë‹¹ â€” ê° ì ì„ ê°€ì¥ ê°€ê¹Œìš´ ì¤‘ì‹¬ì— ë°°ì •</span>
        <span class="cm"># ê±°ë¦¬ ê³„ì‚°: (N, 1, D) - (1, K, D) â†’ (N, K, D) â†’ sum â†’ (N, K)</span>
        distances = np.<span class="fn">sqrt</span>(((X[:, np.newaxis] - centroids[np.newaxis])**<span class="nu">2</span>).<span class="fn">sum</span>(axis=<span class="nu">2</span>))
        labels = distances.<span class="fn">argmin</span>(axis=<span class="nu">1</span>)

        <span class="cm"># Step 3: ì—…ë°ì´íŠ¸ â€” ê° í´ëŸ¬ìŠ¤í„°ì˜ í‰ê· ìœ¼ë¡œ ì¤‘ì‹¬ ì´ë™</span>
        new_centroids = np.<span class="fn">array</span>([X[labels == k].<span class="fn">mean</span>(axis=<span class="nu">0</span>)
                                   <span class="kw">for</span> k <span class="kw">in</span> <span class="fn">range</span>(K)])

        <span class="cm"># Step 4: ìˆ˜ë ´ í™•ì¸ â€” ì¤‘ì‹¬ì´ ì•ˆ ì›€ì§ì´ë©´ ì¢…ë£Œ</span>
        shift = np.<span class="fn">sqrt</span>(((new_centroids - centroids)**<span class="nu">2</span>).<span class="fn">sum</span>())
        centroids = new_centroids
        history.<span class="fn">append</span>(centroids.<span class="fn">copy</span>())

        <span class="kw">if</span> shift < <span class="nu">1e-6</span>:
            <span class="fn">print</span>(<span class="st">f"ìˆ˜ë ´! (iteration {iteration+1})"</span>)
            <span class="kw">break</span>

    <span class="cm"># Inertia ê³„ì‚°</span>
    inertia = <span class="fn">sum</span>(((X[labels == k] - centroids[k])**<span class="nu">2</span>).<span class="fn">sum</span>()
                   <span class="kw">for</span> k <span class="kw">in</span> <span class="fn">range</span>(K))
    <span class="kw">return</span> labels, centroids, inertia, history

<span class="cm"># ì‹¤í–‰</span>
labels, centroids, inertia, history = <span class="fn">kmeans_manual</span>(X, K=<span class="nu">3</span>)
<span class="fn">print</span>(<span class="st">f"Inertia: {inertia:.1f}"</span>)

<span class="cm"># ì¤‘ì‹¬ì  ì´ë™ ê³¼ì • ì‹œê°í™”</span>
fig, axes = plt.<span class="fn">subplots</span>(<span class="nu">1</span>, <span class="nu">3</span>, figsize=(<span class="nu">18</span>, <span class="nu">5</span>))
steps = [<span class="nu">0</span>, <span class="fn">len</span>(history)//<span class="nu">2</span>, -<span class="nu">1</span>]
titles = [<span class="st">'ì´ˆê¸° ìƒíƒœ'</span>, <span class="st">'ì¤‘ê°„ ê³¼ì •'</span>, <span class="st">'ìµœì¢… ìˆ˜ë ´'</span>]

<span class="kw">for</span> ax, step, title <span class="kw">in</span> <span class="fn">zip</span>(axes, steps, titles):
    ax.<span class="fn">scatter</span>(X[:, <span class="nu">0</span>], X[:, <span class="nu">1</span>], c=<span class="st">'lightgray'</span>, s=<span class="nu">20</span>, alpha=<span class="nu">0.5</span>)
    c = history[step]
    ax.<span class="fn">scatter</span>(c[:, <span class="nu">0</span>], c[:, <span class="nu">1</span>], c=[<span class="st">'red'</span>,<span class="st">'blue'</span>,<span class="st">'green'</span>],
              marker=<span class="st">'X'</span>, s=<span class="nu">200</span>, edgecolors=<span class="st">'black'</span>, linewidth=<span class="nu">2</span>)
    ax.<span class="fn">set_title</span>(title, fontsize=<span class="nu">13</span>)
    ax.<span class="fn">grid</span>(<span class="kw">True</span>, alpha=<span class="nu">0.3</span>)

plt.<span class="fn">suptitle</span>(<span class="st">'K-Means ì¤‘ì‹¬ì  ì´ë™ ê³¼ì •'</span>, fontsize=<span class="nu">14</span>, fontweight=<span class="st">'bold'</span>)
plt.<span class="fn">tight_layout</span>()
plt.<span class="fn">show</span>()</code></pre>

<div class="info">
<p class="ni"><strong>ë°‘ë°”ë‹¥ êµ¬í˜„ì—ì„œ ë°°ìš°ëŠ” ê²ƒ:</strong></p>
<ul>
<li><strong>ê±°ë¦¬ ê³„ì‚°ì´ í•µì‹¬:</strong> ìœ í´ë¦¬ë“œ ê±°ë¦¬ë¥¼ ì“°ê¸° ë•Œë¬¸ì— êµ¬í˜• í´ëŸ¬ìŠ¤í„°ë§Œ ì˜ ì°¾ëŠ”ë‹¤. ë§Œì•½ ì½”ì‚¬ì¸ ê±°ë¦¬ë¥¼ ì“°ë©´ ë‹¤ë¥¸ ê²°ê³¼ê°€ ë‚˜ì˜¨ë‹¤.</li>
<li><strong>ì´ˆê¸°ê°’ ì˜ì¡´ì„±:</strong> <code>seed</code>ë¥¼ ë°”ê¿”ë³´ë©´ ê²°ê³¼ê°€ ë‹¬ë¼ì§„ë‹¤. sklearnì˜ <code>n_init=10</code>ì€ 10ë²ˆ ì‹œë„í•´ì„œ ê°€ì¥ ì¢‹ì€ ê²°ê³¼ë¥¼ ì„ íƒí•˜ëŠ” ê²ƒì´ë‹¤.</li>
<li><strong>ìˆ˜ë ´ ì†ë„:</strong> ë³´í†µ 10~20ë²ˆ ë°˜ë³µì´ë©´ ìˆ˜ë ´í•œë‹¤. ë°ì´í„°ê°€ í´ìˆ˜ë¡ ëŠë ¤ì§„ë‹¤.</li>
</ul>
</div>

<h3>5.4 K-Meansì˜ ëª©ì  í•¨ìˆ˜: Inertia</h3>

<p>
K-Meansê°€ ìµœì†Œí™”í•˜ë ¤ëŠ” ê²ƒì€ <strong>Inertia(ê´€ì„±)</strong> â€” ê° ë°ì´í„° í¬ì¸íŠ¸ì™€ ìì‹ ì´ ì†í•œ í´ëŸ¬ìŠ¤í„° ì¤‘ì‹¬ì  ì‚¬ì´ì˜ ê±°ë¦¬ ì œê³±í•©ì´ë‹¤.
</p>

<div class="eq">
$$\text{Inertia} = \sum_{i=1}^{N} \|x_i - \mu_{c(i)}\|^2$$
</div>

<p>
ì—¬ê¸°ì„œ \(\mu_{c(i)}\)ëŠ” ë°ì´í„° í¬ì¸íŠ¸ \(x_i\)ê°€ ì†í•œ í´ëŸ¬ìŠ¤í„°ì˜ ì¤‘ì‹¬ì ì´ë‹¤. Inertiaê°€ ì‘ì„ìˆ˜ë¡ í´ëŸ¬ìŠ¤í„° ë‚´ë¶€ê°€ ì´˜ì´˜í•˜ë‹¤ëŠ” ëœ»ì´ë‹¤. í•˜ì§€ë§Œ Kë¥¼ ëŠ˜ë¦¬ë©´ InertiaëŠ” í•­ìƒ ì¤„ì–´ë“ ë‹¤(ê·¹ë‹¨ì ìœ¼ë¡œ K=Nì´ë©´ Inertia=0). ë”°ë¼ì„œ ì ì ˆí•œ Kë¥¼ ì°¾ëŠ” ê²ƒì´ í•µì‹¬ì´ë‹¤.
</p>

<h3>5.5 ìµœì  K ì°¾ê¸°: ì—˜ë³´ìš° ë°©ë²•ê³¼ ì‹¤ë£¨ì—£ ì ìˆ˜</h3>

<p>
"í´ëŸ¬ìŠ¤í„°ë¥¼ ëª‡ ê°œë¡œ ë‚˜ëˆŒ ê²ƒì¸ê°€?" â€” K-Meansì˜ ê°€ì¥ ì¤‘ìš”í•œ ì§ˆë¬¸ì´ë‹¤. ë‘ ê°€ì§€ ë°©ë²•ì´ ìˆë‹¤.
</p>

<p class="ni"><strong>ë°©ë²• 1: ì—˜ë³´ìš° ë°©ë²• (Elbow Method)</strong></p>
<p>
Kë¥¼ 1ë¶€í„° ëŠ˜ë ¤ê°€ë©° Inertiaë¥¼ ê·¸ë˜í”„ë¡œ ê·¸ë¦°ë‹¤. Inertiaê°€ ê¸‰ê²©íˆ ê°ì†Œí•˜ë‹¤ê°€ ì™„ë§Œí•´ì§€ëŠ” ì§€ì  â€” íŒ”ê¿ˆì¹˜(elbow) ëª¨ì–‘ì´ ë˜ëŠ” ì§€ì  â€” ì´ ìµœì  Kì´ë‹¤. ë¹„ìœ í•˜ìë©´, ë°©ì„ 1ê°œì—ì„œ 2ê°œë¡œ ëŠ˜ë¦¬ë©´ í˜¼ì¡ë„ê°€ í¬ê²Œ ì¤„ì§€ë§Œ, 10ê°œì—ì„œ 11ê°œë¡œ ëŠ˜ë¦¬ë©´ ë³„ ì°¨ì´ê°€ ì—†ëŠ” ê²ƒê³¼ ê°™ë‹¤.
</p>

<p class="ni"><strong>ë°©ë²• 2: ì‹¤ë£¨ì—£ ì ìˆ˜ (Silhouette Score)</strong></p>
<p>
ê° ë°ì´í„° í¬ì¸íŠ¸ì— ëŒ€í•´ "ìê¸° í´ëŸ¬ìŠ¤í„° ë‚´ í‰ê·  ê±°ë¦¬(a)"ì™€ "ê°€ì¥ ê°€ê¹Œìš´ ë‹¤ë¥¸ í´ëŸ¬ìŠ¤í„°ê¹Œì§€ì˜ í‰ê·  ê±°ë¦¬(b)"ë¥¼ ë¹„êµí•œë‹¤.
</p>

<div class="eq">
$$s(i) = \frac{b(i) - a(i)}{\max(a(i), b(i))}$$
</div>

<ul>
<li>\(s(i) \approx 1\): ì˜ ë¶„ë¥˜ë¨ (ìê¸° í´ëŸ¬ìŠ¤í„°ì— ë”± ë§ìŒ)</li>
<li>\(s(i) \approx 0\): ê²½ê³„ì— ìˆìŒ (ë‘ í´ëŸ¬ìŠ¤í„° ì‚¬ì´)</li>
<li>\(s(i) < 0\): ì˜ëª» ë¶„ë¥˜ë¨ (ë‹¤ë¥¸ í´ëŸ¬ìŠ¤í„°ì— ë” ê°€ê¹Œì›€)</li>
</ul>

<p>
ì „ì²´ ë°ì´í„°ì˜ í‰ê·  ì‹¤ë£¨ì—£ ì ìˆ˜ê°€ ê°€ì¥ ë†’ì€ Kë¥¼ ì„ íƒí•œë‹¤.
</p>

<h3>5.6 K-Means ê¸°ë³¸ ì½”ë“œ</h3>

<div class="cc">ì½”ë“œ 5-1. K-Means + ì—˜ë³´ìš° + ì‹¤ë£¨ì—£</div>
<pre><code><span class="kw">from</span> sklearn.cluster <span class="kw">import</span> KMeans
<span class="kw">from</span> sklearn.metrics <span class="kw">import</span> silhouette_score
<span class="kw">from</span> sklearn.datasets <span class="kw">import</span> make_blobs

<span class="cm"># 1. ìƒ˜í”Œ ë°ì´í„° ìƒì„± (3ê°œ í´ëŸ¬ìŠ¤í„°)</span>
X, y_true = <span class="fn">make_blobs</span>(n_samples=<span class="nu">300</span>, centers=<span class="nu">3</span>,
                       cluster_std=<span class="nu">1.0</span>, random_state=<span class="nu">42</span>)

<span class="cm"># 2. ì—˜ë³´ìš° ë°©ë²• + ì‹¤ë£¨ì—£ ì ìˆ˜</span>
K_range = <span class="fn">range</span>(<span class="nu">2</span>, <span class="nu">11</span>)
inertias = []
silhouettes = []

<span class="kw">for</span> k <span class="kw">in</span> K_range:
    km = <span class="fn">KMeans</span>(n_clusters=k, random_state=<span class="nu">42</span>, n_init=<span class="nu">10</span>)
    labels = km.<span class="fn">fit_predict</span>(X)
    inertias.<span class="fn">append</span>(km.inertia_)
    silhouettes.<span class="fn">append</span>(<span class="fn">silhouette_score</span>(X, labels))

<span class="cm"># 3. ì‹œê°í™”</span>
fig, axes = plt.<span class="fn">subplots</span>(<span class="nu">1</span>, <span class="nu">3</span>, figsize=(<span class="nu">18</span>, <span class="nu">5</span>))

<span class="cm"># ì—˜ë³´ìš° í”Œë¡¯</span>
axes[<span class="nu">0</span>].<span class="fn">plot</span>(<span class="fn">list</span>(K_range), inertias, <span class="st">'bo-'</span>)
axes[<span class="nu">0</span>].<span class="fn">axvline</span>(x=<span class="nu">3</span>, color=<span class="st">'red'</span>, linestyle=<span class="st">'--'</span>, alpha=<span class="nu">0.5</span>)
axes[<span class="nu">0</span>].<span class="fn">set_xlabel</span>(<span class="st">'K (í´ëŸ¬ìŠ¤í„° ìˆ˜)'</span>)
axes[<span class="nu">0</span>].<span class="fn">set_ylabel</span>(<span class="st">'Inertia'</span>)
axes[<span class="nu">0</span>].<span class="fn">set_title</span>(<span class="st">'ì—˜ë³´ìš° ë°©ë²•'</span>)
axes[<span class="nu">0</span>].<span class="fn">grid</span>(<span class="kw">True</span>, alpha=<span class="nu">0.3</span>)

<span class="cm"># ì‹¤ë£¨ì—£ ì ìˆ˜</span>
axes[<span class="nu">1</span>].<span class="fn">plot</span>(<span class="fn">list</span>(K_range), silhouettes, <span class="st">'go-'</span>)
axes[<span class="nu">1</span>].<span class="fn">axvline</span>(x=<span class="nu">3</span>, color=<span class="st">'red'</span>, linestyle=<span class="st">'--'</span>, alpha=<span class="nu">0.5</span>)
axes[<span class="nu">1</span>].<span class="fn">set_xlabel</span>(<span class="st">'K (í´ëŸ¬ìŠ¤í„° ìˆ˜)'</span>)
axes[<span class="nu">1</span>].<span class="fn">set_ylabel</span>(<span class="st">'ì‹¤ë£¨ì—£ ì ìˆ˜'</span>)
axes[<span class="nu">1</span>].<span class="fn">set_title</span>(<span class="st">'ì‹¤ë£¨ì—£ ë¶„ì„'</span>)
axes[<span class="nu">1</span>].<span class="fn">grid</span>(<span class="kw">True</span>, alpha=<span class="nu">0.3</span>)

<span class="cm"># K=3 í´ëŸ¬ìŠ¤í„°ë§ ê²°ê³¼</span>
km_best = <span class="fn">KMeans</span>(n_clusters=<span class="nu">3</span>, random_state=<span class="nu">42</span>, n_init=<span class="nu">10</span>)
labels_best = km_best.<span class="fn">fit_predict</span>(X)
axes[<span class="nu">2</span>].<span class="fn">scatter</span>(X[:, <span class="nu">0</span>], X[:, <span class="nu">1</span>], c=labels_best, cmap=<span class="st">'viridis'</span>,
               alpha=<span class="nu">0.6</span>, s=<span class="nu">40</span>)
axes[<span class="nu">2</span>].<span class="fn">scatter</span>(km_best.cluster_centers_[:, <span class="nu">0</span>],
               km_best.cluster_centers_[:, <span class="nu">1</span>],
               c=<span class="st">'red'</span>, marker=<span class="st">'X'</span>, s=<span class="nu">200</span>, edgecolors=<span class="st">'black'</span>,
               label=<span class="st">'ì¤‘ì‹¬ì '</span>)
axes[<span class="nu">2</span>].<span class="fn">set_title</span>(<span class="st">'K=3 í´ëŸ¬ìŠ¤í„°ë§ ê²°ê³¼'</span>)
axes[<span class="nu">2</span>].<span class="fn">legend</span>()
axes[<span class="nu">2</span>].<span class="fn">grid</span>(<span class="kw">True</span>, alpha=<span class="nu">0.3</span>)

plt.<span class="fn">tight_layout</span>()
plt.<span class="fn">show</span>()</code></pre>

<h3>5.7 K-Meansì˜ ê°€ì •ê³¼ í•œê³„</h3>

<div class="warn">
<p class="ni"><strong>âš ï¸ K-Meansì˜ í•µì‹¬ ê°€ì • (MLAT Ch.13)</strong></p>
<ul>
<li><strong>êµ¬í˜•(Spherical) í´ëŸ¬ìŠ¤í„°:</strong> K-MeansëŠ” í´ëŸ¬ìŠ¤í„°ê°€ êµ¬ ëª¨ì–‘ì´ë¼ê³  ê°€ì •í•œë‹¤. ê¸¸ì­‰í•˜ê±°ë‚˜ ë¶ˆê·œì¹™í•œ ëª¨ì–‘ì˜ í´ëŸ¬ìŠ¤í„°ëŠ” ì˜ ëª» ì°¾ëŠ”ë‹¤.</li>
<li><strong>ë™ì¼ í¬ê¸°:</strong> ëª¨ë“  í´ëŸ¬ìŠ¤í„°ì˜ í¬ê¸°ê°€ ë¹„ìŠ·í•˜ë‹¤ê³  ê°€ì •í•œë‹¤. í•œ í´ëŸ¬ìŠ¤í„°ê°€ ì••ë„ì ìœ¼ë¡œ í¬ë©´ ë¬¸ì œê°€ ìƒê¸´ë‹¤.</li>
<li><strong>ìœ í´ë¦¬ë“œ ê±°ë¦¬:</strong> ê¸°ë³¸ì ìœ¼ë¡œ ìœ í´ë¦¬ë“œ ê±°ë¦¬ë¥¼ ì‚¬ìš©í•œë‹¤. í”¼ì²˜ ê°„ ê³µë¶„ì‚°ì„ ë¬´ì‹œí•œë‹¤.</li>
<li><strong>Kë¥¼ ë¯¸ë¦¬ ì§€ì •:</strong> í´ëŸ¬ìŠ¤í„° ìˆ˜ë¥¼ ì‚¬ì „ì— ì•Œì•„ì•¼ í•œë‹¤ (â†’ ì—˜ë³´ìš°/ì‹¤ë£¨ì—£ìœ¼ë¡œ ì¶”ì •).</li>
<li><strong>ì´ˆê¸°ê°’ ë¯¼ê°:</strong> ì´ˆê¸° ì¤‘ì‹¬ì  ìœ„ì¹˜ì— ë”°ë¼ ê²°ê³¼ê°€ ë‹¬ë¼ì§„ë‹¤ (â†’ <code>n_init=10</code>ìœ¼ë¡œ ì—¬ëŸ¬ ë²ˆ ì‹œë„).</li>
</ul>
<p class="ni" style="margin-top:8px">ì´ëŸ° í•œê³„ë¥¼ ê·¹ë³µí•˜ëŠ” ê²ƒì´ Ch.7ì˜ DBSCANê³¼ Ch.8ì˜ ê³„ì¸µì  í´ëŸ¬ìŠ¤í„°ë§ì´ë‹¤.</p>
</div>


<!-- ==================== Ch.6 ==================== -->
<h2 id="ch6">Chapter 6. K-Means ê¸ˆìœµ ì ìš© â€” ì¢…ëª© êµ°ì§‘í™”ì™€ ì„¹í„° ìë™ ë¶„ë¥˜</h2>

<h3>6.1 ì™œ ì¢…ëª©ì„ í´ëŸ¬ìŠ¤í„°ë§í•˜ëŠ”ê°€</h3>

<p>
ì£¼ì‹ ì‹œì¥ì—ëŠ” ìˆ˜ì²œ ê°œì˜ ì¢…ëª©ì´ ìˆë‹¤. ì´ ì¢…ëª©ë“¤ì„ "ë¹„ìŠ·í•œ ì›€ì§ì„"ì„ ë³´ì´ëŠ” ê·¸ë£¹ìœ¼ë¡œ ë‚˜ëˆŒ ìˆ˜ ìˆë‹¤ë©´ ì—¬ëŸ¬ ê°€ì§€ ì´ì ì´ ìˆë‹¤:
</p>

<ul>
<li><strong>í¬íŠ¸í´ë¦¬ì˜¤ ë¶„ì‚°:</strong> ê°™ì€ í´ëŸ¬ìŠ¤í„°ì—ì„œ í•œ ì¢…ëª©ì”©ë§Œ ì„ íƒí•˜ë©´ ìì—°ìŠ¤ëŸ½ê²Œ ë¶„ì‚° íˆ¬ìê°€ ëœë‹¤.</li>
<li><strong>í˜ì–´ íŠ¸ë ˆì´ë”©:</strong> ê°™ì€ í´ëŸ¬ìŠ¤í„° ë‚´ ì¢…ëª© ìŒì€ í•¨ê»˜ ì›€ì§ì´ë¯€ë¡œ, ì¼ì‹œì  ê´´ë¦¬ê°€ ìƒê¸°ë©´ ì°¨ìµê±°ë˜ ê¸°íšŒê°€ ëœë‹¤.</li>
<li><strong>ì„¹í„° ìë™ ë¶„ë¥˜:</strong> GICS ì„¹í„° ë¶„ë¥˜ëŠ” ì¸ìœ„ì ì´ë‹¤. ë°ì´í„° ê¸°ë°˜ í´ëŸ¬ìŠ¤í„°ë§ì€ ì‹¤ì œ ìˆ˜ìµë¥  íŒ¨í„´ì— ê¸°ë°˜í•œ "ì§„ì§œ ì„¹í„°"ë¥¼ ë°œê²¬í•œë‹¤.</li>
<li><strong>ë¦¬ìŠ¤í¬ ê´€ë¦¬:</strong> ê°™ì€ í´ëŸ¬ìŠ¤í„°ì˜ ì¢…ëª©ë“¤ì€ ë™ì‹œì— í•˜ë½í•  ê°€ëŠ¥ì„±ì´ ë†’ë‹¤. ì´ë¥¼ ì¸ì§€í•˜ë©´ ë¦¬ìŠ¤í¬ë¥¼ ì¤„ì¼ ìˆ˜ ìˆë‹¤.</li>
</ul>

<h3>6.2 ì‹¤ì „: ì¢…ëª© ìˆ˜ìµë¥  ê¸°ë°˜ K-Means í´ëŸ¬ìŠ¤í„°ë§</h3>

<div class="cc">ì½”ë“œ 6-1. ì¢…ëª© í´ëŸ¬ìŠ¤í„°ë§ ì „ì²´ íŒŒì´í”„ë¼ì¸</div>
<pre><code><span class="kw">import</span> yfinance <span class="kw">as</span> yf
<span class="kw">import</span> numpy <span class="kw">as</span> np
<span class="kw">import</span> pandas <span class="kw">as</span> pd
<span class="kw">import</span> matplotlib.pyplot <span class="kw">as</span> plt
<span class="kw">from</span> sklearn.cluster <span class="kw">import</span> KMeans
<span class="kw">from</span> sklearn.preprocessing <span class="kw">import</span> StandardScaler
<span class="kw">from</span> sklearn.metrics <span class="kw">import</span> silhouette_score
<span class="kw">from</span> sklearn.decomposition <span class="kw">import</span> PCA

<span class="cm"># 1. 20ê°œ ì¢…ëª© ìˆ˜ìµë¥  ë°ì´í„°</span>
tickers = {
    <span class="st">'Tech'</span>:    [<span class="st">'AAPL'</span>, <span class="st">'MSFT'</span>, <span class="st">'GOOGL'</span>, <span class="st">'NVDA'</span>],
    <span class="st">'Finance'</span>: [<span class="st">'JPM'</span>, <span class="st">'BAC'</span>, <span class="st">'GS'</span>, <span class="st">'MS'</span>],
    <span class="st">'Energy'</span>:  [<span class="st">'XOM'</span>, <span class="st">'CVX'</span>, <span class="st">'COP'</span>, <span class="st">'SLB'</span>],
    <span class="st">'Health'</span>:  [<span class="st">'JNJ'</span>, <span class="st">'PFE'</span>, <span class="st">'UNH'</span>, <span class="st">'MRK'</span>],
    <span class="st">'Consumer'</span>:[<span class="st">'WMT'</span>, <span class="st">'PG'</span>, <span class="st">'KO'</span>, <span class="st">'MCD'</span>]
}
all_tickers = [t <span class="kw">for</span> lst <span class="kw">in</span> tickers.values() <span class="kw">for</span> t <span class="kw">in</span> lst]

prices = yf.<span class="fn">download</span>(all_tickers, start=<span class="st">'2023-01-01'</span>,
                     end=<span class="st">'2025-01-01'</span>)[<span class="st">'Close'</span>]
returns = prices.<span class="fn">pct_change</span>().<span class="fn">dropna</span>()

<span class="cm"># 2. ì¢…ëª©ë³„ í”¼ì²˜ ìƒì„± (ìˆ˜ìµë¥  í†µê³„)</span>
stock_features = pd.<span class="fn">DataFrame</span>(index=returns.columns)
stock_features[<span class="st">'mean_ret'</span>] = returns.<span class="fn">mean</span>()
stock_features[<span class="st">'std_ret'</span>] = returns.<span class="fn">std</span>()
stock_features[<span class="st">'sharpe'</span>] = stock_features[<span class="st">'mean_ret'</span>] / stock_features[<span class="st">'std_ret'</span>]
stock_features[<span class="st">'skew'</span>] = returns.<span class="fn">skew</span>()
stock_features[<span class="st">'kurt'</span>] = returns.<span class="fn">kurtosis</span>()
stock_features[<span class="st">'max_dd'</span>] = (prices / prices.<span class="fn">cummax</span>() - <span class="nu">1</span>).<span class="fn">min</span>()

<span class="fn">print</span>(<span class="st">"=== ì¢…ëª©ë³„ í”¼ì²˜ ==="</span>)
<span class="fn">print</span>(stock_features.<span class="fn">round</span>(<span class="nu">4</span>))

<span class="cm"># 3. í‘œì¤€í™” + K-Means</span>
scaler = <span class="fn">StandardScaler</span>()
features_scaled = scaler.<span class="fn">fit_transform</span>(stock_features)

<span class="cm"># ì—˜ë³´ìš° + ì‹¤ë£¨ì—£ìœ¼ë¡œ ìµœì  K íƒìƒ‰</span>
results = []
<span class="kw">for</span> k <span class="kw">in</span> <span class="fn">range</span>(<span class="nu">2</span>, <span class="nu">8</span>):
    km = <span class="fn">KMeans</span>(n_clusters=k, random_state=<span class="nu">42</span>, n_init=<span class="nu">10</span>)
    labels = km.<span class="fn">fit_predict</span>(features_scaled)
    sil = <span class="fn">silhouette_score</span>(features_scaled, labels)
    results.<span class="fn">append</span>({<span class="st">'K'</span>: k, <span class="st">'inertia'</span>: km.inertia_, <span class="st">'silhouette'</span>: sil})
    <span class="fn">print</span>(<span class="st">f"K={k}: Inertia={km.inertia_:.1f}, Silhouette={sil:.3f}"</span>)

<span class="cm"># 4. ìµœì  Kë¡œ í´ëŸ¬ìŠ¤í„°ë§ (ì˜ˆ: K=5)</span>
best_k = <span class="nu">5</span>
km_final = <span class="fn">KMeans</span>(n_clusters=best_k, random_state=<span class="nu">42</span>, n_init=<span class="nu">10</span>)
stock_features[<span class="st">'cluster'</span>] = km_final.<span class="fn">fit_predict</span>(features_scaled)

<span class="cm"># 5. í´ëŸ¬ìŠ¤í„°ë³„ ì¢…ëª© í™•ì¸</span>
<span class="fn">print</span>(<span class="st">"\n=== í´ëŸ¬ìŠ¤í„°ë³„ ì¢…ëª© ==="</span>)
<span class="kw">for</span> c <span class="kw">in</span> <span class="fn">range</span>(best_k):
    members = stock_features[stock_features[<span class="st">'cluster'</span>] == c].index.<span class="fn">tolist</span>()
    <span class="fn">print</span>(<span class="st">f"Cluster {c}: {members}"</span>)

<span class="cm"># 6. PCA 2Dë¡œ ì‹œê°í™”</span>
pca = <span class="fn">PCA</span>(n_components=<span class="nu">2</span>)
features_2d = pca.<span class="fn">fit_transform</span>(features_scaled)

fig, ax = plt.<span class="fn">subplots</span>(figsize=(<span class="nu">10</span>, <span class="nu">8</span>))
colors = [<span class="st">'#e74c3c'</span>, <span class="st">'#3498db'</span>, <span class="st">'#2ecc71'</span>, <span class="st">'#9b59b6'</span>, <span class="st">'#f39c12'</span>]
<span class="kw">for</span> c <span class="kw">in</span> <span class="fn">range</span>(best_k):
    mask = stock_features[<span class="st">'cluster'</span>] == c
    ax.<span class="fn">scatter</span>(features_2d[mask, <span class="nu">0</span>], features_2d[mask, <span class="nu">1</span>],
              c=colors[c], s=<span class="nu">120</span>, alpha=<span class="nu">0.8</span>, label=<span class="st">f'Cluster {c}'</span>,
              edgecolors=<span class="st">'white'</span>, linewidth=<span class="nu">1.5</span>)
    <span class="kw">for</span> ticker, (x, y) <span class="kw">in</span> <span class="fn">zip</span>(
        stock_features[mask].index, features_2d[mask]):
        ax.<span class="fn">annotate</span>(ticker, (x+<span class="nu">0.1</span>, y+<span class="nu">0.1</span>), fontsize=<span class="nu">9</span>,
                   fontweight=<span class="st">'bold'</span>)

ax.<span class="fn">set_xlabel</span>(<span class="st">f'PC1 ({pca.explained_variance_ratio_[0]:.1%})'</span>)
ax.<span class="fn">set_ylabel</span>(<span class="st">f'PC2 ({pca.explained_variance_ratio_[1]:.1%})'</span>)
ax.<span class="fn">set_title</span>(<span class="st">'K-Means ì¢…ëª© í´ëŸ¬ìŠ¤í„°ë§ (PCA 2D íˆ¬ì˜)'</span>)
ax.<span class="fn">legend</span>()
ax.<span class="fn">grid</span>(<span class="kw">True</span>, alpha=<span class="nu">0.3</span>)
plt.<span class="fn">tight_layout</span>()
plt.<span class="fn">show</span>()</code></pre>
<div class="code-output"><span class="out-label">Output:</span>
=== ê¸ˆìœµ ë°ì´í„° K-Means í´ëŸ¬ìŠ¤í„°ë§ ===
ìµœì  K: 5

í´ëŸ¬ìŠ¤í„°ë³„ ì¢…ëª© ìˆ˜:
Cluster 0: 12ì¢…ëª© (ê¸°ìˆ ì£¼ ì¤‘ì‹¬)
Cluster 1:  8ì¢…ëª© (ê¸ˆìœµì£¼ ì¤‘ì‹¬)
Cluster 2:  6ì¢…ëª© (ì—ë„ˆì§€/ì†Œì¬)
Cluster 3:  5ì¢…ëª© (ì†Œë¹„ì¬)
Cluster 4:  4ì¢…ëª© (í—¬ìŠ¤ì¼€ì–´)

ì‹¤ë£¨ì—£ ì ìˆ˜: 0.342</div>


<h3>6.3 í´ëŸ¬ìŠ¤í„° í•´ì„: GICS ì„¹í„°ì™€ ë¹„êµ</h3>

<div class="info">
<p class="ni"><strong>ê²°ê³¼ í•´ì„ ê°€ì´ë“œ</strong></p>
<p class="ni" style="margin-top:8px">K-Meansê°€ ë§Œë“  í´ëŸ¬ìŠ¤í„°ì™€ ì‹¤ì œ GICS ì„¹í„°ë¥¼ ë¹„êµí•´ë³´ë©´ í¥ë¯¸ë¡œìš´ ë°œê²¬ì„ í•  ìˆ˜ ìˆë‹¤:</p>
<ul>
<li><strong>ì¼ì¹˜í•˜ëŠ” ê²½ìš°:</strong> ì—ë„ˆì§€ì£¼(XOM, CVX, COP, SLB)ê°€ í•œ í´ëŸ¬ìŠ¤í„°ì— ëª¨ì´ë©´ â†’ ìˆ˜ìµë¥  íŒ¨í„´ì´ ì‹¤ì œë¡œ ì„¹í„°ì™€ ì¼ì¹˜</li>
<li><strong>ë¶ˆì¼ì¹˜í•˜ëŠ” ê²½ìš°:</strong> UNH(í—¬ìŠ¤ì¼€ì–´)ê°€ ê¸°ìˆ ì£¼ í´ëŸ¬ìŠ¤í„°ì— ë“¤ì–´ê°€ë©´ â†’ UNHì˜ ìˆ˜ìµë¥  íŒ¨í„´ì´ ê¸°ìˆ ì£¼ì™€ ë” ë¹„ìŠ·í•˜ë‹¤ëŠ” ì˜ë¯¸. GICS ë¶„ë¥˜ë³´ë‹¤ ë°ì´í„° ê¸°ë°˜ ë¶„ë¥˜ê°€ ë” ì •í™•í•  ìˆ˜ ìˆë‹¤.</li>
<li><strong>ê¸ˆìœµ í™œìš©:</strong> ê°™ì€ í´ëŸ¬ìŠ¤í„° ë‚´ ì¢…ëª© ìŒì€ í˜ì–´ íŠ¸ë ˆì´ë”© í›„ë³´ê°€ ëœë‹¤. ë‹¤ë¥¸ í´ëŸ¬ìŠ¤í„°ì—ì„œ í•œ ì¢…ëª©ì”© ì„ íƒí•˜ë©´ ë¶„ì‚° íˆ¬ìê°€ ëœë‹¤.</li>
</ul>
</div>

<h3>6.4 í´ëŸ¬ìŠ¤í„°ë³„ ìˆ˜ìµë¥  ë¹„êµ</h3>

<div class="cc">ì½”ë“œ 6-2. í´ëŸ¬ìŠ¤í„°ë³„ ëˆ„ì  ìˆ˜ìµë¥  ì‹œê°í™”</div>
<pre><code><span class="cm"># í´ëŸ¬ìŠ¤í„°ë³„ í‰ê·  ëˆ„ì  ìˆ˜ìµë¥ </span>
fig, ax = plt.<span class="fn">subplots</span>(figsize=(<span class="nu">12</span>, <span class="nu">6</span>))

<span class="kw">for</span> c <span class="kw">in</span> <span class="fn">range</span>(best_k):
    members = stock_features[stock_features[<span class="st">'cluster'</span>] == c].index
    cluster_ret = returns[members].<span class="fn">mean</span>(axis=<span class="nu">1</span>)  <span class="cm"># í´ëŸ¬ìŠ¤í„° í‰ê·  ìˆ˜ìµë¥ </span>
    cum_ret = (<span class="nu">1</span> + cluster_ret).<span class="fn">cumprod</span>() - <span class="nu">1</span>
    ax.<span class="fn">plot</span>(cum_ret, label=<span class="st">f'Cluster {c} ({", ".join(members[:3])}...)'</span>,
           linewidth=<span class="nu">2</span>, color=colors[c])

ax.<span class="fn">set_title</span>(<span class="st">'í´ëŸ¬ìŠ¤í„°ë³„ í‰ê·  ëˆ„ì  ìˆ˜ìµë¥ '</span>)
ax.<span class="fn">set_xlabel</span>(<span class="st">'ë‚ ì§œ'</span>)
ax.<span class="fn">set_ylabel</span>(<span class="st">'ëˆ„ì  ìˆ˜ìµë¥ '</span>)
ax.<span class="fn">legend</span>()
ax.<span class="fn">grid</span>(<span class="kw">True</span>, alpha=<span class="nu">0.3</span>)
ax.<span class="fn">axhline</span>(y=<span class="nu">0</span>, color=<span class="st">'black'</span>, linewidth=<span class="nu">0.5</span>)
plt.<span class="fn">tight_layout</span>()
plt.<span class="fn">show</span>()</code></pre>

<div class="ok">
<p class="ni"><strong>ì‹¤ì „ ì¸ì‚¬ì´íŠ¸:</strong> í´ëŸ¬ìŠ¤í„°ë³„ ëˆ„ì  ìˆ˜ìµë¥  ê·¸ë˜í”„ë¥¼ ë³´ë©´, ì–´ë–¤ í´ëŸ¬ìŠ¤í„°ê°€ ìƒìŠ¹ì¥ì—ì„œ ê°•í•˜ê³  ì–´ë–¤ í´ëŸ¬ìŠ¤í„°ê°€ í•˜ë½ì¥ì—ì„œ ë°©ì–´ì ì¸ì§€ í•œëˆˆì— íŒŒì•…í•  ìˆ˜ ìˆë‹¤. ì´ê²ƒì€ ì‹œì¥ ë ˆì§ì— ë”°ë¼ í¬íŠ¸í´ë¦¬ì˜¤ ë¹„ì¤‘ì„ ì¡°ì ˆí•˜ëŠ” ì „ëµì˜ ê¸°ì´ˆê°€ ëœë‹¤.</p>
</div>


<!-- ==================== Ch.7 ==================== -->
<h2 id="ch7">Chapter 7. DBSCAN â€” ë°€ë„ ê¸°ë°˜ í´ëŸ¬ìŠ¤í„°ë§ê³¼ ì´ìƒì¹˜ íƒì§€</h2>

<h3>7.1 K-Meansì˜ í•œê³„ë¥¼ ë„˜ì–´ì„œ</h3>

<p>
K-MeansëŠ” í´ëŸ¬ìŠ¤í„°ê°€ êµ¬ ëª¨ì–‘ì´ê³  í¬ê¸°ê°€ ë¹„ìŠ·í•  ë•Œ ì˜ ì‘ë™í•œë‹¤. í•˜ì§€ë§Œ í˜„ì‹¤ ë°ì´í„°ëŠ” ê·¸ë ‡ì§€ ì•Šì€ ê²½ìš°ê°€ ë§ë‹¤. ì´ˆìŠ¹ë‹¬ ëª¨ì–‘ì˜ í´ëŸ¬ìŠ¤í„°, ë°€ë„ê°€ ë‹¤ë¥¸ í´ëŸ¬ìŠ¤í„°, ê·¸ë¦¬ê³  ì–´ë””ì—ë„ ì†í•˜ì§€ ì•ŠëŠ” ì´ìƒì¹˜(outlier) â€” K-MeansëŠ” ì´ëŸ° ìƒí™©ì—ì„œ ì‹¤íŒ¨í•œë‹¤.
</p>

<p>
DBSCAN(Density-Based Spatial Clustering of Applications with Noise)ì€ ì´ë¦„ ê·¸ëŒ€ë¡œ <strong>ë°€ë„(density)</strong>ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í´ëŸ¬ìŠ¤í„°ë¥¼ ì°¾ëŠ”ë‹¤. ë°ì´í„°ê°€ ë°€ì§‘ëœ ì˜ì—­ì„ í´ëŸ¬ìŠ¤í„°ë¡œ ì¸ì‹í•˜ê³ , ë°€ë„ê°€ ë‚®ì€ ì˜ì—­ì˜ ì ë“¤ì€ ë…¸ì´ì¦ˆ(ì´ìƒì¹˜)ë¡œ ë¶„ë¥˜í•œë‹¤.
</p>

<h3>7.2 DBSCANì˜ í•µì‹¬ ê°œë…</h3>

<div class="def">
<p class="ni"><strong>DBSCANì˜ ë‘ ê°€ì§€ íŒŒë¼ë¯¸í„°</strong></p>
<ul>
<li><strong>eps (Îµ):</strong> ì´ì›ƒì˜ ë°˜ê²½. "ì´ ê±°ë¦¬ ì•ˆì— ìˆìœ¼ë©´ ì´ì›ƒì´ë‹¤"</li>
<li><strong>min_samples:</strong> í•µì‹¬ í¬ì¸íŠ¸ê°€ ë˜ê¸° ìœ„í•œ ìµœì†Œ ì´ì›ƒ ìˆ˜. "ì´ì›ƒì´ ì´ë§Œí¼ ìˆì–´ì•¼ í•µì‹¬ì´ë‹¤"</li>
</ul>
</div>

<p>
ë¹„ìœ í•˜ìë©´, ë„ì‹œì—ì„œ "ë²ˆí™”ê°€"ë¥¼ ì°¾ëŠ” ê²ƒê³¼ ê°™ë‹¤. epsëŠ” "ë°˜ê²½ 500m ì´ë‚´", min_samplesëŠ” "ê°€ê²Œê°€ ìµœì†Œ 10ê°œ"ë¼ê³  ì„¤ì •í•˜ë©´, ë°˜ê²½ 500m ì•ˆì— ê°€ê²Œê°€ 10ê°œ ì´ìƒì¸ ì§€ì ì´ ë²ˆí™”ê°€ì˜ í•µì‹¬ì´ ëœë‹¤. ê·¸ í•µì‹¬ ì§€ì ë“¤ì´ ì—°ê²°ë˜ë©´ í•˜ë‚˜ì˜ ë²ˆí™”ê°€(í´ëŸ¬ìŠ¤í„°)ê°€ ëœë‹¤. ì–´ë–¤ ë²ˆí™”ê°€ì—ë„ ì†í•˜ì§€ ì•ŠëŠ” ì™¸ë”´ ê°€ê²ŒëŠ” ì´ìƒì¹˜(noise)ì´ë‹¤.
</p>

<p class="ni"><strong>ì„¸ ê°€ì§€ ìœ í˜•ì˜ í¬ì¸íŠ¸:</strong></p>
<ul>
<li><strong>Core Point (í•µì‹¬ì ):</strong> eps ë°˜ê²½ ë‚´ì— min_samples ì´ìƒì˜ ì´ì›ƒì´ ìˆëŠ” ì </li>
<li><strong>Border Point (ê²½ê³„ì ):</strong> í•µì‹¬ì ì˜ ì´ì›ƒì´ì§€ë§Œ, ìì‹ ì€ í•µì‹¬ì ì´ ì•„ë‹Œ ì </li>
<li><strong>Noise Point (ë…¸ì´ì¦ˆ):</strong> ì–´ë–¤ í•µì‹¬ì ì˜ ì´ì›ƒë„ ì•„ë‹Œ ì  â†’ í´ëŸ¬ìŠ¤í„° ë¼ë²¨ = -1</li>
</ul>

<!-- DBSCAN ê°œë… ë‹¤ì´ì–´ê·¸ë¨ -->
<div style="margin:25px 0;padding:20px;background:#f0f4f8;border-radius:10px;text-align:center">
<p class="ni" style="font-weight:bold;margin-bottom:15px;font-size:13px">DBSCAN í¬ì¸íŠ¸ ìœ í˜• (eps=1.0, min_samples=4)</p>
<div style="display:inline-flex;gap:30px;flex-wrap:wrap;justify-content:center">
<div style="text-align:center">
<div style="width:60px;height:60px;background:#e74c3c;border-radius:50%;display:flex;align-items:center;justify-content:center;color:white;font-weight:bold;font-size:12px;margin:0 auto 8px">Core</div>
<div style="font-size:11px;color:#555">ì´ì›ƒ â‰¥ 4ê°œ<br>í´ëŸ¬ìŠ¤í„°ì˜ í•µì‹¬</div>
</div>
<div style="text-align:center">
<div style="width:60px;height:60px;background:#f39c12;border-radius:50%;display:flex;align-items:center;justify-content:center;color:white;font-weight:bold;font-size:12px;margin:0 auto 8px">Border</div>
<div style="font-size:11px;color:#555">Coreì˜ ì´ì›ƒì´ì§€ë§Œ<br>ìì‹ ì€ Core ì•„ë‹˜</div>
</div>
<div style="text-align:center">
<div style="width:60px;height:60px;background:#95a5a6;border-radius:50%;display:flex;align-items:center;justify-content:center;color:white;font-weight:bold;font-size:12px;margin:0 auto 8px">Noise</div>
<div style="font-size:11px;color:#555">ì–´ë””ì—ë„ ì•ˆ ì†í•¨<br>label = -1</div>
</div>
</div>
</div>

<h3>7.3 DBSCAN vs K-Means ë¹„êµ</h3>

<div class="tc">í‘œ 7-1. DBSCAN vs K-Means í•µì‹¬ ë¹„êµ</div>
<table>
<thead>
<tr><th>íŠ¹ì„±</th><th>K-Means</th><th>DBSCAN</th></tr>
</thead>
<tbody>
<tr><td>í´ëŸ¬ìŠ¤í„° ìˆ˜</td><td>ì‚¬ì „ ì§€ì • (K)</td><td>ìë™ ê²°ì •</td></tr>
<tr><td>í´ëŸ¬ìŠ¤í„° ëª¨ì–‘</td><td>êµ¬í˜•ë§Œ</td><td>ì„ì˜ì˜ ëª¨ì–‘</td></tr>
<tr><td>ì´ìƒì¹˜ ì²˜ë¦¬</td><td>ë¶ˆê°€ (ëª¨ë“  ì ì„ í• ë‹¹)</td><td>ìë™ íƒì§€ (label=-1)</td></tr>
<tr><td>ë°€ë„ ì°¨ì´</td><td>ì²˜ë¦¬ ë¶ˆê°€</td><td>ë™ì¼ ë°€ë„ ê°€ì • (í•œê³„)</td></tr>
<tr><td>íŒŒë¼ë¯¸í„°</td><td>K</td><td>eps, min_samples</td></tr>
<tr><td>ì†ë„</td><td>ë¹ ë¦„ O(nKt)</td><td>ë³´í†µ O(n log n)</td></tr>
<tr><td>ê²°ì •ì„±</td><td>ì´ˆê¸°ê°’ ì˜ì¡´</td><td>ê²°ì •ì  (Core ê¸°ì¤€)</td></tr>
</tbody>
</table>

<h3>7.4 DBSCAN ì‹¤ì „ ì½”ë“œ</h3>

<div class="cc">ì½”ë“œ 7-1. DBSCANìœ¼ë¡œ ì¢…ëª© í´ëŸ¬ìŠ¤í„°ë§ + ì´ìƒì¹˜ íƒì§€</div>
<pre><code><span class="kw">from</span> sklearn.cluster <span class="kw">import</span> DBSCAN
<span class="kw">from</span> sklearn.neighbors <span class="kw">import</span> NearestNeighbors

<span class="cm"># features_scaledëŠ” ì½”ë“œ 6-1ì—ì„œ ë§Œë“  í‘œì¤€í™”ëœ ì¢…ëª© í”¼ì²˜</span>

<span class="cm"># 1. eps ì¶”ì •: k-distance ê·¸ë˜í”„</span>
<span class="cm"># min_samplesì˜ 2ë°° ì •ë„ì˜ kë¡œ k-distanceë¥¼ ê³„ì‚°</span>
k = <span class="nu">4</span>  <span class="cm"># min_samples í›„ë³´</span>
nn = <span class="fn">NearestNeighbors</span>(n_neighbors=k)
nn.<span class="fn">fit</span>(features_scaled)
distances, _ = nn.<span class="fn">kneighbors</span>(features_scaled)
k_distances = np.<span class="fn">sort</span>(distances[:, -<span class="nu">1</span>])  <span class="cm"># kë²ˆì§¸ ì´ì›ƒê¹Œì§€ì˜ ê±°ë¦¬</span>

fig, axes = plt.<span class="fn">subplots</span>(<span class="nu">1</span>, <span class="nu">2</span>, figsize=(<span class="nu">14</span>, <span class="nu">5</span>))

<span class="cm"># k-distance ê·¸ë˜í”„ (eps ê²°ì •ìš©)</span>
axes[<span class="nu">0</span>].<span class="fn">plot</span>(k_distances, <span class="st">'b-'</span>)
axes[<span class="nu">0</span>].<span class="fn">set_xlabel</span>(<span class="st">'í¬ì¸íŠ¸ (ì •ë ¬ë¨)'</span>)
axes[<span class="nu">0</span>].<span class="fn">set_ylabel</span>(<span class="st">f'{k}-distance'</span>)
axes[<span class="nu">0</span>].<span class="fn">set_title</span>(<span class="st">'k-distance ê·¸ë˜í”„ (ì—˜ë³´ìš° ì§€ì  = eps)'</span>)
axes[<span class="nu">0</span>].<span class="fn">grid</span>(<span class="kw">True</span>, alpha=<span class="nu">0.3</span>)

<span class="cm"># 2. DBSCAN ì ìš©</span>
eps_val = <span class="nu">2.0</span>  <span class="cm"># k-distance ê·¸ë˜í”„ì˜ ì—˜ë³´ìš° ì§€ì </span>
db = <span class="fn">DBSCAN</span>(eps=eps_val, min_samples=<span class="nu">3</span>)
db_labels = db.<span class="fn">fit_predict</span>(features_scaled)

n_clusters = <span class="fn">len</span>(<span class="fn">set</span>(db_labels) - {-<span class="nu">1</span>})
n_noise = (db_labels == -<span class="nu">1</span>).<span class="fn">sum</span>()
<span class="fn">print</span>(<span class="st">f"í´ëŸ¬ìŠ¤í„° ìˆ˜: {n_clusters}"</span>)
<span class="fn">print</span>(<span class="st">f"ì´ìƒì¹˜ ìˆ˜: {n_noise}"</span>)

<span class="cm"># 3. ê²°ê³¼ ì‹œê°í™” (PCA 2D)</span>
pca_2d = <span class="fn">PCA</span>(n_components=<span class="nu">2</span>)
features_2d = pca_2d.<span class="fn">fit_transform</span>(features_scaled)

cmap_colors = [<span class="st">'#e74c3c'</span>, <span class="st">'#3498db'</span>, <span class="st">'#2ecc71'</span>, <span class="st">'#9b59b6'</span>, <span class="st">'#f39c12'</span>]
<span class="kw">for</span> i, ticker <span class="kw">in</span> <span class="fn">enumerate</span>(stock_features.index):
    label = db_labels[i]
    <span class="kw">if</span> label == -<span class="nu">1</span>:
        color, marker, size = <span class="st">'gray'</span>, <span class="st">'x'</span>, <span class="nu">100</span>  <span class="cm"># ì´ìƒì¹˜</span>
    <span class="kw">else</span>:
        color = cmap_colors[label % <span class="fn">len</span>(cmap_colors)]
        marker, size = <span class="st">'o'</span>, <span class="nu">120</span>
    axes[<span class="nu">1</span>].<span class="fn">scatter</span>(features_2d[i, <span class="nu">0</span>], features_2d[i, <span class="nu">1</span>],
                  c=color, marker=marker, s=size, edgecolors=<span class="st">'white'</span>)
    axes[<span class="nu">1</span>].<span class="fn">annotate</span>(ticker, (features_2d[i,<span class="nu">0</span>]+<span class="nu">0.1</span>, features_2d[i,<span class="nu">1</span>]+<span class="nu">0.1</span>),
                   fontsize=<span class="nu">9</span>)

axes[<span class="nu">1</span>].<span class="fn">set_title</span>(<span class="st">f'DBSCAN (eps={eps_val}, min_samples=3) â€” Ã—=ì´ìƒì¹˜'</span>)
axes[<span class="nu">1</span>].<span class="fn">grid</span>(<span class="kw">True</span>, alpha=<span class="nu">0.3</span>)
plt.<span class="fn">tight_layout</span>()
plt.<span class="fn">show</span>()

<span class="cm"># 4. ì´ìƒì¹˜ ì¢…ëª© í™•ì¸</span>
outliers = stock_features.index[db_labels == -<span class="nu">1</span>]
<span class="fn">print</span>(<span class="st">f"\nì´ìƒì¹˜ ì¢…ëª©: {outliers.tolist()}"</span>)
<span class="fn">print</span>(<span class="st">"â†’ ì´ ì¢…ëª©ë“¤ì€ ë‹¤ë¥¸ ì¢…ëª©ê³¼ ìˆ˜ìµë¥  íŒ¨í„´ì´ í¬ê²Œ ë‹¤ë¥´ë‹¤!"</span>)</code></pre>

<h3>7.5 eps íŒŒë¼ë¯¸í„° íŠœë‹: k-distance ê·¸ë˜í”„ ì‹¬í™”</h3>

<p>
DBSCANì—ì„œ ê°€ì¥ ì–´ë ¤ìš´ ê²ƒì´ eps ì„ íƒì´ë‹¤. ë„ˆë¬´ ì‘ìœ¼ë©´ ëª¨ë“  ì ì´ ë…¸ì´ì¦ˆê°€ ë˜ê³ , ë„ˆë¬´ í¬ë©´ ëª¨ë“  ì ì´ í•˜ë‚˜ì˜ í´ëŸ¬ìŠ¤í„°ê°€ ëœë‹¤. <strong>k-distance ê·¸ë˜í”„</strong>ê°€ ì´ ë¬¸ì œë¥¼ í•´ê²°í•œë‹¤.
</p>

<div class="def">
<p class="ni"><strong>k-distance ê·¸ë˜í”„ ì½ëŠ” ë²•</strong></p>
<ol>
<li>ê° ë°ì´í„° í¬ì¸íŠ¸ì—ì„œ kë²ˆì§¸ë¡œ ê°€ê¹Œìš´ ì´ì›ƒê¹Œì§€ì˜ ê±°ë¦¬ë¥¼ ê³„ì‚°í•œë‹¤ (k = min_samples)</li>
<li>ì´ ê±°ë¦¬ë¥¼ ì˜¤ë¦„ì°¨ìˆœìœ¼ë¡œ ì •ë ¬í•˜ì—¬ ê·¸ë˜í”„ë¥¼ ê·¸ë¦°ë‹¤</li>
<li>ê·¸ë˜í”„ì—ì„œ <strong>ê¸‰ê²©íˆ êº¾ì´ëŠ” ì§€ì (ì—˜ë³´ìš°)</strong>ì´ ìµœì  epsì´ë‹¤</li>
<li>ì—˜ë³´ìš° ì•„ë˜ì˜ ì ë“¤ì€ í´ëŸ¬ìŠ¤í„° ë‚´ë¶€, ìœ„ì˜ ì ë“¤ì€ ë…¸ì´ì¦ˆê°€ ëœë‹¤</li>
</ol>
</div>

<!-- eps ì„ íƒ ê°€ì´ë“œ ë‹¤ì´ì–´ê·¸ë¨ -->
<div style="margin:25px 0;padding:20px;background:#f0f4f8;border-radius:10px">
<p class="ni" style="text-align:center;font-weight:bold;margin-bottom:15px;font-size:13px">eps ì„ íƒì— ë”°ë¥¸ ê²°ê³¼ ë³€í™”</p>
<div style="display:flex;flex-wrap:wrap;gap:12px;justify-content:center;font-size:11px">
<div style="text-align:center;background:#fde8e8;padding:12px 16px;border-radius:8px;border:2px solid #e74c3c;min-width:150px">
<div style="font-size:22px;margin-bottom:4px">ğŸ”´</div>
<div style="font-weight:bold;color:#c0392b">eps ë„ˆë¬´ ì‘ìŒ</div>
<div style="color:#777;margin-top:4px">ëŒ€ë¶€ë¶„ ë…¸ì´ì¦ˆ ì²˜ë¦¬<br>í´ëŸ¬ìŠ¤í„° ê±°ì˜ ì—†ìŒ</div>
</div>
<div style="text-align:center;background:#d4edda;padding:12px 16px;border-radius:8px;border:2px solid #28a745;min-width:150px">
<div style="font-size:22px;margin-bottom:4px">ğŸŸ¢</div>
<div style="font-weight:bold;color:#155724">eps ì ì ˆ (ì—˜ë³´ìš°)</div>
<div style="color:#777;margin-top:4px">ì˜ë¯¸ ìˆëŠ” í´ëŸ¬ìŠ¤í„°<br>+ ì ì ˆí•œ ë…¸ì´ì¦ˆ</div>
</div>
<div style="text-align:center;background:#fde8e8;padding:12px 16px;border-radius:8px;border:2px solid #e74c3c;min-width:150px">
<div style="font-size:22px;margin-bottom:4px">ğŸ”´</div>
<div style="font-weight:bold;color:#c0392b">eps ë„ˆë¬´ í¼</div>
<div style="color:#777;margin-top:4px">ì „ë¶€ í•˜ë‚˜ì˜ í´ëŸ¬ìŠ¤í„°<br>ë…¸ì´ì¦ˆ ì—†ìŒ</div>
</div>
</div>
</div>

<div class="warn">
<p class="ni"><strong>âš ï¸ DBSCAN ì‹¤ì „ íŒ</strong></p>
<ul>
<li><strong>min_samples ê²½í—˜ ë²•ì¹™:</strong> ë°ì´í„° ì°¨ì› Dì— ëŒ€í•´ <code>min_samples â‰¥ D + 1</code>ë¡œ ì„¤ì •í•œë‹¤. 6ì°¨ì› í”¼ì²˜ë©´ min_samples â‰¥ 7.</li>
<li><strong>í‘œì¤€í™” í•„ìˆ˜:</strong> K-Meansì™€ ë§ˆì°¬ê°€ì§€ë¡œ, í”¼ì²˜ ìŠ¤ì¼€ì¼ì´ ë‹¤ë¥´ë©´ ê±°ë¦¬ ê³„ì‚°ì´ ì™œê³¡ëœë‹¤. ë°˜ë“œì‹œ StandardScalerë¥¼ ë¨¼ì € ì ìš©í•˜ë¼.</li>
<li><strong>ì—¬ëŸ¬ epsë¡œ ì‹¤í—˜:</strong> k-distance ì—˜ë³´ìš°ê°€ ëª…í™•í•˜ì§€ ì•Šìœ¼ë©´, epsë¥¼ 0.5, 1.0, 1.5, 2.0 ë“±ìœ¼ë¡œ ë°”ê¿”ê°€ë©° í´ëŸ¬ìŠ¤í„° ìˆ˜ì™€ ë…¸ì´ì¦ˆ ë¹„ìœ¨ì„ ê´€ì°°í•˜ë¼.</li>
<li><strong>HDBSCAN ëŒ€ì•ˆ:</strong> eps ì„ íƒì´ ì–´ë ¤ìš°ë©´ HDBSCANì„ ì“°ë¼. eps íŒŒë¼ë¯¸í„°ê°€ í•„ìš” ì—†ê³ , ë°€ë„ê°€ ë‹¤ë¥¸ í´ëŸ¬ìŠ¤í„°ë„ ì°¾ëŠ”ë‹¤.</li>
</ul>
</div>

<h3>7.6 ê¸ˆìœµì—ì„œ DBSCANì˜ í™œìš©</h3>

<div class="ok">
<p class="ni"><strong>DBSCANì´ ë¹›ë‚˜ëŠ” ê¸ˆìœµ ì‹œë‚˜ë¦¬ì˜¤</strong></p>
<ul>
<li><strong>ì´ìƒ ê±°ë˜ íƒì§€:</strong> ì •ìƒì ì¸ ê±°ë˜ íŒ¨í„´ì—ì„œ ë²—ì–´ë‚œ ì´ìƒ ê±°ë˜ë¥¼ ìë™ìœ¼ë¡œ íƒì§€í•œë‹¤. ë‚´ë¶€ì ê±°ë˜, ì‹œì„¸ ì¡°ì¢… ë“±ì˜ ë‹¨ì„œê°€ ë  ìˆ˜ ìˆë‹¤.</li>
<li><strong>ì‹œì¥ ë ˆì§ ë³€í™” ê°ì§€:</strong> í‰ì†Œì™€ ë‹¤ë¥¸ ìˆ˜ìµë¥  íŒ¨í„´ì´ ë‚˜íƒ€ë‚˜ë©´ DBSCANì´ ì´ìƒì¹˜ë¡œ ë¶„ë¥˜í•œë‹¤ â†’ ì‹œì¥ ë ˆì§ì´ ë°”ë€Œê³  ìˆë‹¤ëŠ” ì‹ í˜¸.</li>
<li><strong>íŠ¹ì´ ì¢…ëª© ë°œê²¬:</strong> ì–´ë–¤ ì„¹í„°ì—ë„ ì†í•˜ì§€ ì•ŠëŠ” ë…íŠ¹í•œ ìˆ˜ìµë¥  íŒ¨í„´ì˜ ì¢…ëª© â†’ ì•ŒíŒŒ ê¸°íšŒì¼ ìˆ˜ ìˆë‹¤.</li>
</ul>
</div>

<div class="info">
<p class="ni"><strong>êµì¬ ì—°ë™:</strong> MLAT Ch.13ì—ì„œëŠ” HDBSCAN(Hierarchical DBSCAN)ë„ ì†Œê°œí•œë‹¤. HDBSCANì€ ë°€ë„ê°€ ë‹¤ë¥¸ í´ëŸ¬ìŠ¤í„°ë„ ì°¾ì„ ìˆ˜ ìˆì–´ DBSCANì˜ í•œê³„ë¥¼ ê·¹ë³µí•œë‹¤. <code>pip install hdbscan</code>ìœ¼ë¡œ ì„¤ì¹˜í•˜ê³  <code>hdbscan.HDBSCAN(min_cluster_size=5)</code>ë¡œ ì‚¬ìš©í•œë‹¤.</p>
</div>


<!-- ==================== Ch.8 ==================== -->
<h2 id="ch8">Chapter 8. ê³„ì¸µì  í´ëŸ¬ìŠ¤í„°ë§ â€” ë´ë“œë¡œê·¸ë¨ê³¼ ìƒê´€í–‰ë ¬ ê¸°ë°˜ ì¢…ëª© íŠ¸ë¦¬</h2>

<h3>8.1 ê³„ì¸µì  í´ëŸ¬ìŠ¤í„°ë§ì´ë€</h3>

<p>
K-Meansì™€ DBSCANì€ "í‰ë©´ì " í´ëŸ¬ìŠ¤í„°ë§ì´ë‹¤ â€” ê° ë°ì´í„° í¬ì¸íŠ¸ê°€ í•˜ë‚˜ì˜ í´ëŸ¬ìŠ¤í„°ì— ì†í•œë‹¤. ê³„ì¸µì  í´ëŸ¬ìŠ¤í„°ë§(Hierarchical Clustering)ì€ ë‹¤ë¥´ë‹¤. ì´ë¦„ ê·¸ëŒ€ë¡œ <strong>ê³„ì¸µ êµ¬ì¡°(hierarchy)</strong>ë¥¼ ë§Œë“ ë‹¤. ë§ˆì¹˜ ìƒë¬¼ ë¶„ë¥˜í•™ì—ì„œ "ì¢… â†’ ì† â†’ ê³¼ â†’ ëª© â†’ ê°• â†’ ë¬¸ â†’ ê³„"ë¡œ ì˜¬ë¼ê°€ëŠ” ê²ƒì²˜ëŸ¼, ë°ì´í„°ë¥¼ ì ì  í° ê·¸ë£¹ìœ¼ë¡œ í•©ì³ê°€ëŠ” íŠ¸ë¦¬ êµ¬ì¡°ë¥¼ ë§Œë“ ë‹¤.
</p>

<p>
ê¸ˆìœµì—ì„œ ì´ê²ƒì´ íŠ¹íˆ ìœ ìš©í•œ ì´ìœ ëŠ”, ì¢…ëª© ê°„ì˜ ê´€ê³„ë¥¼ <strong>íŠ¸ë¦¬(ë´ë“œë¡œê·¸ë¨)</strong>ë¡œ ì‹œê°í™”í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì´ë‹¤. "ì‚¼ì„±ì „ìì™€ SKí•˜ì´ë‹‰ìŠ¤ëŠ” ê°€ì¥ ê°€ê¹Œìš´ ê´€ê³„ì´ê³ , ì´ ë‘˜ì„ í•©ì¹œ ë°˜ë„ì²´ ê·¸ë£¹ì€ ë„¤ì´ë²„/ì¹´ì¹´ì˜¤ì˜ ì¸í„°ë„· ê·¸ë£¹ê³¼ í•©ì³ì ¸ IT ëŒ€ê·¸ë£¹ì„ í˜•ì„±í•œë‹¤" â€” ì´ëŸ° ê³„ì¸µ êµ¬ì¡°ë¥¼ í•œëˆˆì— ë³¼ ìˆ˜ ìˆë‹¤.
</p>

<h3>8.2 ë³‘í•©(Agglomerative) vs ë¶„í• (Divisive)</h3>

<div class="def">
<p class="ni"><strong>ë‘ ê°€ì§€ ì ‘ê·¼ë²•</strong></p>
<ul>
<li><strong>ë³‘í•©(Agglomerative, Bottom-Up):</strong> ê° ë°ì´í„° í¬ì¸íŠ¸ë¥¼ ê°œë³„ í´ëŸ¬ìŠ¤í„°ë¡œ ì‹œì‘ â†’ ê°€ì¥ ê°€ê¹Œìš´ ë‘ í´ëŸ¬ìŠ¤í„°ë¥¼ ë°˜ë³µì ìœ¼ë¡œ í•©ì¹¨ â†’ í•˜ë‚˜ì˜ í° í´ëŸ¬ìŠ¤í„°ê°€ ë  ë•Œê¹Œì§€. <strong>ê°€ì¥ ë§ì´ ì‚¬ìš©ë¨.</strong></li>
<li><strong>ë¶„í• (Divisive, Top-Down):</strong> ëª¨ë“  ë°ì´í„°ë¥¼ í•˜ë‚˜ì˜ í´ëŸ¬ìŠ¤í„°ë¡œ ì‹œì‘ â†’ ë°˜ë³µì ìœ¼ë¡œ ë¶„í• . ê³„ì‚° ë¹„ìš©ì´ ë†’ì•„ ì˜ ì•ˆ ì“°ì„.</li>
</ul>
</div>

<h3>8.3 ì—°ê²° ê¸°ì¤€ (Linkage Criteria)</h3>

<p>
"ê°€ì¥ ê°€ê¹Œìš´ ë‘ í´ëŸ¬ìŠ¤í„°"ë¥¼ ì–´ë–»ê²Œ ì •ì˜í•˜ëŠ”ê°€? ì´ê²ƒì´ ì—°ê²° ê¸°ì¤€(linkage)ì´ë‹¤. ì„ íƒì— ë”°ë¼ ê²°ê³¼ê°€ í¬ê²Œ ë‹¬ë¼ì§„ë‹¤.
</p>

<div class="tc">í‘œ 8-1. ì—°ê²° ê¸°ì¤€ ë¹„êµ</div>
<table>
<thead>
<tr><th>ì—°ê²° ê¸°ì¤€</th><th>ê±°ë¦¬ ì •ì˜</th><th>íŠ¹ì§•</th><th>ê¸ˆìœµ ì ìš©</th></tr>
</thead>
<tbody>
<tr><td><strong>Single</strong></td><td>ë‘ í´ëŸ¬ìŠ¤í„°ì˜ ê°€ì¥ ê°€ê¹Œìš´ ì  ê°„ ê±°ë¦¬</td><td>ì²´ì¸ íš¨ê³¼ ë°œìƒ ê°€ëŠ¥</td><td>ì˜ ì•ˆ ì”€</td></tr>
<tr><td><strong>Complete</strong></td><td>ë‘ í´ëŸ¬ìŠ¤í„°ì˜ ê°€ì¥ ë¨¼ ì  ê°„ ê±°ë¦¬</td><td>ì»´íŒ©íŠ¸í•œ í´ëŸ¬ìŠ¤í„°</td><td>ë³´ìˆ˜ì  ë¶„ë¥˜</td></tr>
<tr><td><strong>Average</strong></td><td>ëª¨ë“  ì  ìŒì˜ í‰ê·  ê±°ë¦¬</td><td>Singleê³¼ Completeì˜ ì ˆì¶©</td><td>ì¼ë°˜ì  ì‚¬ìš©</td></tr>
<tr><td><strong>Ward</strong></td><td>í•©ì¹  ë•Œ ë¶„ì‚° ì¦ê°€ëŸ‰ ìµœì†Œí™”</td><td>K-Meansì™€ ìœ ì‚¬í•œ ê²°ê³¼</td><td>ê°€ì¥ ë§ì´ ì‚¬ìš©</td></tr>
</tbody>
</table>

<h3>8.4 ë´ë“œë¡œê·¸ë¨ (Dendrogram)</h3>

<p>
ê³„ì¸µì  í´ëŸ¬ìŠ¤í„°ë§ì˜ ê°€ì¥ í° ì¥ì ì€ <strong>ë´ë“œë¡œê·¸ë¨</strong>ì´ë¼ëŠ” íŠ¸ë¦¬ ë‹¤ì´ì–´ê·¸ë¨ìœ¼ë¡œ ê²°ê³¼ë¥¼ ì‹œê°í™”í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì´ë‹¤. ë´ë“œë¡œê·¸ë¨ì˜ yì¶•ì€ "ê±°ë¦¬(ë˜ëŠ” ë¹„ìœ ì‚¬ë„)"ë¥¼ ë‚˜íƒ€ë‚´ê³ , ì•„ë˜ì—ì„œ ìœ„ë¡œ ì˜¬ë¼ê°ˆìˆ˜ë¡ ë” ë¨¼ í´ëŸ¬ìŠ¤í„°ê°€ í•©ì³ì§„ë‹¤. íŠ¹ì • ë†’ì´ì—ì„œ ìˆ˜í‰ìœ¼ë¡œ ìë¥´ë©´ ê·¸ ë†’ì´ì—ì„œì˜ í´ëŸ¬ìŠ¤í„° ìˆ˜ê°€ ê²°ì •ëœë‹¤.
</p>

<h3>8.5 ì‹¤ì „: ìƒê´€í–‰ë ¬ ê¸°ë°˜ ì¢…ëª© ë´ë“œë¡œê·¸ë¨</h3>

<div class="cc">ì½”ë“œ 8-1. ì¢…ëª© ìƒê´€í–‰ë ¬ â†’ ê³„ì¸µì  í´ëŸ¬ìŠ¤í„°ë§ â†’ ë´ë“œë¡œê·¸ë¨</div>
<pre><code><span class="kw">from</span> scipy.cluster.hierarchy <span class="kw">import</span> dendrogram, linkage, fcluster
<span class="kw">from</span> scipy.spatial.distance <span class="kw">import</span> squareform

<span class="cm"># returnsëŠ” ì½”ë“œ 6-1ì—ì„œ ë§Œë“  ì¼ê°„ ìˆ˜ìµë¥  DataFrame</span>

<span class="cm"># 1. ìƒê´€í–‰ë ¬ â†’ ê±°ë¦¬í–‰ë ¬ ë³€í™˜</span>
<span class="cm"># ìƒê´€ê³„ìˆ˜ê°€ ë†’ì„ìˆ˜ë¡ ê±°ë¦¬ê°€ ê°€ê¹Œì›Œì•¼ í•œë‹¤</span>
corr = returns.<span class="fn">corr</span>()
distance_matrix = np.<span class="fn">sqrt</span>(<span class="nu">2</span> * (<span class="nu">1</span> - corr))  <span class="cm"># ìƒê´€ ê±°ë¦¬</span>

<span class="cm"># 2. ê³„ì¸µì  í´ëŸ¬ìŠ¤í„°ë§ (Ward ì—°ê²°)</span>
<span class="cm"># squareform: ì •ë°©í–‰ë ¬ â†’ ì••ì¶• ê±°ë¦¬ ë²¡í„°</span>
dist_condensed = <span class="fn">squareform</span>(distance_matrix)
Z = <span class="fn">linkage</span>(dist_condensed, method=<span class="st">'ward'</span>)

<span class="cm"># 3. ë´ë“œë¡œê·¸ë¨ ì‹œê°í™”</span>
fig, ax = plt.<span class="fn">subplots</span>(figsize=(<span class="nu">14</span>, <span class="nu">8</span>))
<span class="fn">dendrogram</span>(
    Z,
    labels=returns.columns.<span class="fn">tolist</span>(),
    leaf_rotation=<span class="nu">90</span>,
    leaf_font_size=<span class="nu">10</span>,
    color_threshold=<span class="nu">1.2</span>,  <span class="cm"># ì´ ë†’ì´ì—ì„œ ìƒ‰ìƒ êµ¬ë¶„</span>
    ax=ax
)
ax.<span class="fn">set_title</span>(<span class="st">'ì¢…ëª© ìƒê´€ê´€ê³„ ê¸°ë°˜ ë´ë“œë¡œê·¸ë¨ (Ward Linkage)'</span>, fontsize=<span class="nu">14</span>)
ax.<span class="fn">set_ylabel</span>(<span class="st">'ê±°ë¦¬ (ìƒê´€ ê±°ë¦¬)'</span>)
ax.<span class="fn">axhline</span>(y=<span class="nu">1.2</span>, color=<span class="st">'red'</span>, linestyle=<span class="st">'--'</span>, alpha=<span class="nu">0.5</span>,
          label=<span class="st">'í´ëŸ¬ìŠ¤í„° ì»· ë¼ì¸'</span>)
ax.<span class="fn">legend</span>()
plt.<span class="fn">tight_layout</span>()
plt.<span class="fn">show</span>()

<span class="cm"># 4. íŠ¹ì • í´ëŸ¬ìŠ¤í„° ìˆ˜ë¡œ ìë¥´ê¸°</span>
n_clusters = <span class="nu">5</span>
cluster_labels = <span class="fn">fcluster</span>(Z, n_clusters, criterion=<span class="st">'maxclust'</span>)

<span class="fn">print</span>(<span class="st">"=== ê³„ì¸µì  í´ëŸ¬ìŠ¤í„°ë§ ê²°ê³¼ ==="</span>)
<span class="kw">for</span> c <span class="kw">in</span> <span class="fn">range</span>(<span class="nu">1</span>, n_clusters+<span class="nu">1</span>):
    members = returns.columns[cluster_labels == c].<span class="fn">tolist</span>()
    <span class="fn">print</span>(<span class="st">f"Cluster {c}: {members}"</span>)</code></pre>

<h3>8.6 ìƒê´€í–‰ë ¬ íˆíŠ¸ë§µ + í´ëŸ¬ìŠ¤í„° ì •ë ¬</h3>

<p>
ë´ë“œë¡œê·¸ë¨ì˜ ìˆœì„œëŒ€ë¡œ ìƒê´€í–‰ë ¬ì„ ì¬ì •ë ¬í•˜ë©´, ê°™ì€ í´ëŸ¬ìŠ¤í„°ì˜ ì¢…ëª©ë“¤ì´ ë¸”ë¡ ëŒ€ê°ì„ ì— ëª¨ì—¬ ìˆëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤. ì´ê²ƒì€ í¬íŠ¸í´ë¦¬ì˜¤ ë¦¬ìŠ¤í¬ë¥¼ ì‹œê°ì ìœ¼ë¡œ íŒŒì•…í•˜ëŠ” ê°•ë ¥í•œ ë„êµ¬ì´ë‹¤.
</p>

<div class="cc">ì½”ë“œ 8-2. í´ëŸ¬ìŠ¤í„° ì •ë ¬ëœ ìƒê´€í–‰ë ¬ íˆíŠ¸ë§µ</div>
<pre><code><span class="kw">import</span> seaborn <span class="kw">as</span> sns
<span class="kw">from</span> scipy.cluster.hierarchy <span class="kw">import</span> leaves_list

<span class="cm"># ë´ë“œë¡œê·¸ë¨ ìˆœì„œë¡œ ì¢…ëª© ì¬ì •ë ¬</span>
order = <span class="fn">leaves_list</span>(Z)
ordered_tickers = [returns.columns[i] <span class="kw">for</span> i <span class="kw">in</span> order]
corr_ordered = corr.<span class="fn">loc</span>[ordered_tickers, ordered_tickers]

<span class="cm"># íˆíŠ¸ë§µ</span>
fig, ax = plt.<span class="fn">subplots</span>(figsize=(<span class="nu">12</span>, <span class="nu">10</span>))
sns.<span class="fn">heatmap</span>(corr_ordered, annot=<span class="kw">True</span>, fmt=<span class="st">'.2f'</span>,
            cmap=<span class="st">'RdYlBu_r'</span>, center=<span class="nu">0</span>,
            vmin=-<span class="nu">0.3</span>, vmax=<span class="nu">1.0</span>,
            square=<span class="kw">True</span>, ax=ax,
            linewidths=<span class="nu">0.5</span>)
ax.<span class="fn">set_title</span>(<span class="st">'í´ëŸ¬ìŠ¤í„° ì •ë ¬ëœ ìƒê´€í–‰ë ¬ íˆíŠ¸ë§µ'</span>, fontsize=<span class="nu">14</span>)
plt.<span class="fn">tight_layout</span>()
plt.<span class="fn">show</span>()</code></pre>

<div class="ok">
<p class="ni"><strong>ê¸°ëŒ€ ê²°ê³¼:</strong> ê°™ì€ ì„¹í„° ì¢…ëª©ë“¤ì´ ë¸”ë¡ ëŒ€ê°ì„ ì— ë¹¨ê°„ìƒ‰(ë†’ì€ ìƒê´€ê´€ê³„) ë¸”ë¡ì„ í˜•ì„±í•œë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ì—ë„ˆì§€ì£¼(XOM, CVX, COP, SLB)ê°€ í•œ ë¸”ë¡, ê¸°ìˆ ì£¼(AAPL, MSFT, GOOGL, NVDA)ê°€ í•œ ë¸”ë¡ìœ¼ë¡œ ë‚˜íƒ€ë‚œë‹¤. ë¸”ë¡ ê°„ì—ëŠ” ìƒê´€ê´€ê³„ê°€ ë‚®ì•„ íŒŒë€ìƒ‰/ë…¸ë€ìƒ‰ì´ ëœë‹¤.</p>
</div>

<div class="info">
<p class="ni"><strong>êµì¬ ì—°ë™:</strong> MLAT Ch.13ì—ì„œëŠ” ê³„ì¸µì  í´ëŸ¬ìŠ¤í„°ë§ì„ HRP(Hierarchical Risk Parity) í¬íŠ¸í´ë¦¬ì˜¤ ìµœì í™”ì— í™œìš©í•œë‹¤. ë§ˆì½”ìœ„ì¸  ìµœì í™”ì˜ ëŒ€ì•ˆìœ¼ë¡œ, ë´ë“œë¡œê·¸ë¨ êµ¬ì¡°ë¥¼ ì´ìš©í•˜ì—¬ ë¦¬ìŠ¤í¬ë¥¼ ê³„ì¸µì ìœ¼ë¡œ ë¶„ë°°í•œë‹¤. ì´ê²ƒì€ R8ì—ì„œ í¬íŠ¸í´ë¦¬ì˜¤ ìµœì í™”ë¥¼ ë°°ìš¸ ë•Œ ë‹¤ì‹œ ë§Œë‚˜ê²Œ ëœë‹¤.</p>
</div>

<div class="def">
<p class="ni"><strong>HRP (Hierarchical Risk Parity) â€” R8 ë¯¸ë¦¬ë³´ê¸°</strong></p>
<p class="ni" style="margin-top:8px">ë§ˆì½”ìœ„ì¸  ìµœì í™”ì˜ ê°€ì¥ í° ë¬¸ì œëŠ” ê³µë¶„ì‚° í–‰ë ¬ì˜ ì—­í–‰ë ¬ì„ êµ¬í•´ì•¼ í•œë‹¤ëŠ” ê²ƒì´ë‹¤. ì¢…ëª©ì´ ë§ìœ¼ë©´ ì—­í–‰ë ¬ì´ ë¶ˆì•ˆì •í•´ì ¸ì„œ ê·¹ë‹¨ì ì¸ ë¹„ì¤‘ì´ ë‚˜ì˜¨ë‹¤. HRPëŠ” ì´ ë¬¸ì œë¥¼ ìš°íšŒí•œë‹¤:</p>
<ol>
<li><strong>ê³„ì¸µì  í´ëŸ¬ìŠ¤í„°ë§</strong>ìœ¼ë¡œ ì¢…ëª© ê°„ íŠ¸ë¦¬ êµ¬ì¡°ë¥¼ ë§Œë“ ë‹¤ (ìœ„ì—ì„œ ë°°ìš´ ê²ƒ!)</li>
<li>íŠ¸ë¦¬ë¥¼ ë”°ë¼ <strong>ì¬ê·€ì ìœ¼ë¡œ</strong> ë¦¬ìŠ¤í¬ë¥¼ ë¶„ë°°í•œë‹¤ â€” ì—­í–‰ë ¬ì´ í•„ìš” ì—†ë‹¤</li>
<li>ê²°ê³¼ì ìœ¼ë¡œ ë” ì•ˆì •ì ì´ê³  ë¶„ì‚°ëœ í¬íŠ¸í´ë¦¬ì˜¤ê°€ ë§Œë“¤ì–´ì§„ë‹¤</li>
</ol>
<p class="ni" style="margin-top:8px">Marcos LÃ³pez de Pradoê°€ 2016ë…„ ë…¼ë¬¸ì—ì„œ ì œì•ˆí•œ ì´ ë°©ë²•ì€, ê³„ì¸µì  í´ëŸ¬ìŠ¤í„°ë§ì´ ë‹¨ìˆœí•œ ì‹œê°í™” ë„êµ¬ê°€ ì•„ë‹ˆë¼ <strong>ì‹¤ì „ í¬íŠ¸í´ë¦¬ì˜¤ êµ¬ì„±ì˜ í•µì‹¬</strong>ì´ ë  ìˆ˜ ìˆìŒì„ ë³´ì—¬ì¤€ë‹¤.</p>
</div>

<h3>8.7 ì„¸ ê°€ì§€ í´ëŸ¬ìŠ¤í„°ë§ ì•Œê³ ë¦¬ì¦˜ ì¢…í•© ë¹„êµ</h3>

<div class="tc">í‘œ 8-2. K-Means vs DBSCAN vs ê³„ì¸µì  í´ëŸ¬ìŠ¤í„°ë§ ì¢…í•© ë¹„êµ</div>
<table>
<thead>
<tr><th>íŠ¹ì„±</th><th>K-Means</th><th>DBSCAN</th><th>ê³„ì¸µì </th></tr>
</thead>
<tbody>
<tr><td>í´ëŸ¬ìŠ¤í„° ìˆ˜</td><td>ì‚¬ì „ ì§€ì •</td><td>ìë™</td><td>ì‚¬í›„ ê²°ì • (ì»·)</td></tr>
<tr><td>í´ëŸ¬ìŠ¤í„° ëª¨ì–‘</td><td>êµ¬í˜•</td><td>ì„ì˜</td><td>ë‹¤ì–‘</td></tr>
<tr><td>ì´ìƒì¹˜ ì²˜ë¦¬</td><td>ë¶ˆê°€</td><td>ìë™</td><td>ë¶ˆê°€</td></tr>
<tr><td>ê³„ì¸µ êµ¬ì¡°</td><td>ì—†ìŒ</td><td>ì—†ìŒ</td><td>ìˆìŒ (ë´ë“œë¡œê·¸ë¨)</td></tr>
<tr><td>ëŒ€ê·œëª¨ ë°ì´í„°</td><td>ë¹ ë¦„ âœ…</td><td>ë³´í†µ</td><td>ëŠë¦¼ âŒ</td></tr>
<tr><td>ê¸ˆìœµ ì£¼ ìš©ë„</td><td>ì¢…ëª© êµ°ì§‘í™”</td><td>ì´ìƒì¹˜ íƒì§€</td><td>í¬íŠ¸í´ë¦¬ì˜¤ êµ¬ì¡°í™”</td></tr>
<tr><td>ì¶”ì²œ ìƒí™©</td><td>ë¹ ë¥¸ íƒìƒ‰</td><td>ì´ìƒì¹˜ ì¤‘ìš”</td><td>êµ¬ì¡° ì‹œê°í™”</td></tr>
</tbody>
</table>


<!-- ==================== Ch.9 ==================== -->
<h2 id="ch9">Chapter 9. ì‹œê³„ì—´ ê¸°ì´ˆ â€” ì •ìƒì„±, ADF ê²€ì •, ì°¨ë¶„</h2>

<h3>9.1 ì™œ ì‹œê³„ì—´ ë¶„ì„ì´ í•„ìš”í•œê°€</h3>

<p>
ì§€ê¸ˆê¹Œì§€ ë°°ìš´ ML ëª¨ë¸ë“¤(R4ì˜ XGBoost, R5ì˜ PCA/K-Means)ì€ ë°ì´í„°ì˜ <strong>ìˆœì„œ</strong>ë¥¼ ë¬´ì‹œí•œë‹¤. 100ê°œì˜ ë°ì´í„° í¬ì¸íŠ¸ë¥¼ ì„ì–´ë„ ê²°ê³¼ê°€ ê°™ë‹¤. í•˜ì§€ë§Œ ê¸ˆìœµ ë°ì´í„°ëŠ” ë³¸ì§ˆì ìœ¼ë¡œ <strong>ì‹œê°„ ìˆœì„œ</strong>ê°€ ì¤‘ìš”í•˜ë‹¤. ì˜¤ëŠ˜ì˜ ì£¼ê°€ëŠ” ì–´ì œì˜ ì£¼ê°€ì— ì˜í–¥ì„ ë°›ê³ , ì´ë²ˆ ë‹¬ì˜ ë³€ë™ì„±ì€ ì§€ë‚œë‹¬ì˜ ë³€ë™ì„±ê³¼ ê´€ë ¨ì´ ìˆë‹¤.
</p>

<p>
ì‹œê³„ì—´ ë¶„ì„(Time Series Analysis)ì€ ì´ ì‹œê°„ì  ì˜ì¡´ì„±ì„ ëª…ì‹œì ìœ¼ë¡œ ëª¨ë¸ë§í•œë‹¤. MLAT Ch.9ì˜ ì œëª©ì´ "Time-Series Models for Volatility Forecasts and Statistical Arbitrage"ì¸ ê²ƒì²˜ëŸ¼, ê¸ˆìœµì—ì„œ ì‹œê³„ì—´ ë¶„ì„ì˜ ë‘ ê°€ì§€ í•µì‹¬ ì‘ìš©ì€ <strong>ë³€ë™ì„± ì˜ˆì¸¡</strong>ê³¼ <strong>í†µê³„ì  ì°¨ìµê±°ë˜</strong>ì´ë‹¤.
</p>

<h3>9.2 ì •ìƒì„± (Stationarity): ì‹œê³„ì—´ ë¶„ì„ì˜ ëŒ€ì „ì œ</h3>

<p>
ì‹œê³„ì—´ ë¶„ì„ì—ì„œ ê°€ì¥ ì¤‘ìš”í•œ ê°œë…ì€ <strong>ì •ìƒì„±(Stationarity)</strong>ì´ë‹¤. ì •ìƒ ì‹œê³„ì—´ì´ë€, í†µê³„ì  ì„±ì§ˆ(í‰ê· , ë¶„ì‚°, ìê¸°ìƒê´€)ì´ ì‹œê°„ì— ë”°ë¼ ë³€í•˜ì§€ ì•ŠëŠ” ì‹œê³„ì—´ì´ë‹¤.
</p>

<div class="def">
<p class="ni"><strong>ì •ìƒì„±ì˜ ì¡°ê±´ (ì•½í•œ ì •ìƒì„±, Weak Stationarity)</strong></p>
<ol>
<li><strong>í‰ê· ì´ ì¼ì •:</strong> \(E[y_t] = \mu\) (ì‹œê°„ì— ë¬´ê´€)</li>
<li><strong>ë¶„ì‚°ì´ ì¼ì •:</strong> \(\text{Var}(y_t) = \sigma^2\) (ì‹œê°„ì— ë¬´ê´€)</li>
<li><strong>ìê¸°ê³µë¶„ì‚°ì´ ì‹œì°¨ì—ë§Œ ì˜ì¡´:</strong> \(\text{Cov}(y_t, y_{t-k}) = \gamma_k\) (ì‹œì  tì— ë¬´ê´€, ì‹œì°¨ kì—ë§Œ ì˜ì¡´)</li>
</ol>
</div>

<p>
ë¹„ìœ í•˜ìë©´, ì •ìƒ ì‹œê³„ì—´ì€ "ì•ˆì •ëœ ê°•ë¬¼"ê³¼ ê°™ë‹¤. ìˆ˜ìœ„ê°€ ì¼ì •í•˜ê³ , ë¬¼ê²°ì˜ í¬ê¸°ë„ ì¼ì •í•˜ë‹¤. ë¹„ì •ìƒ ì‹œê³„ì—´ì€ "í™ìˆ˜ê°€ ë‚˜ëŠ” ê°•"ì´ë‹¤ â€” ìˆ˜ìœ„ê°€ ê³„ì† ì˜¬ë¼ê°€ê³ , ë¬¼ê²°ë„ ì ì  ê±°ì„¸ì§„ë‹¤.
</p>

<h3>9.3 ì£¼ê°€ëŠ” ì •ìƒì ì¸ê°€? â€” ëœë¤ ì›Œí¬</h3>

<p>
ê²°ë¡ ë¶€í„° ë§í•˜ë©´, <strong>ì£¼ê°€(price)ëŠ” ë¹„ì •ìƒ(non-stationary)</strong>ì´ë‹¤. ì£¼ê°€ëŠ” ëœë¤ ì›Œí¬(Random Walk)ë¥¼ ë”°ë¥´ëŠ” ê²ƒìœ¼ë¡œ ì•Œë ¤ì ¸ ìˆë‹¤:
</p>

<div class="eq">
$$p_t = p_{t-1} + \epsilon_t$$
</div>

<p>
ì—¬ê¸°ì„œ \(\epsilon_t\)ëŠ” ë°±ìƒ‰ ì¡ìŒ(white noise)ì´ë‹¤. MLAT Ch.9ì—ì„œ ì„¤ëª…í•˜ë“¯, ëœë¤ ì›Œí¬ì˜ ë¶„ì‚°ì€ \(t\sigma^2\)ìœ¼ë¡œ ì‹œê°„ì— ë”°ë¼ ë¬´í•œíˆ ì¦ê°€í•œë‹¤ â€” ì •ìƒì„± ì¡°ê±´ì„ ìœ„ë°˜í•œë‹¤. ì§ê´€ì ìœ¼ë¡œ, ì£¼ê°€ëŠ” 100ì›ì—ì„œ ì‹œì‘í•´ì„œ 10ë…„ í›„ì— 10,000ì›ì´ ë  ìˆ˜ë„, 1ì›ì´ ë  ìˆ˜ë„ ìˆë‹¤. "í‰ê· ìœ¼ë¡œ ëŒì•„ì˜¤ëŠ”" ì„±ì§ˆì´ ì—†ë‹¤.
</p>

<h3>9.3 ì£¼ê°€ëŠ” ì •ìƒì ì¸ê°€? â€” ëœë¤ ì›Œí¬ ì‹œë®¬ë ˆì´ì…˜</h3>

<p>
ê²°ë¡ ë¶€í„° ë§í•˜ë©´, <strong>ì£¼ê°€(price)ëŠ” ë¹„ì •ìƒ(non-stationary)</strong>ì´ë‹¤. ì£¼ê°€ëŠ” ëœë¤ ì›Œí¬(Random Walk)ë¥¼ ë”°ë¥´ëŠ” ê²ƒìœ¼ë¡œ ì•Œë ¤ì ¸ ìˆë‹¤:
</p>

<div class="eq">
$p_t = p_{t-1} + \epsilon_t$
</div>

<p>
ì—¬ê¸°ì„œ \(\epsilon_t\)ëŠ” ë°±ìƒ‰ ì¡ìŒ(white noise)ì´ë‹¤. MLAT Ch.9ì—ì„œ ì„¤ëª…í•˜ë“¯, ëœë¤ ì›Œí¬ì˜ ë¶„ì‚°ì€ \(t\sigma^2\)ìœ¼ë¡œ ì‹œê°„ì— ë”°ë¼ ë¬´í•œíˆ ì¦ê°€í•œë‹¤ â€” ì •ìƒì„± ì¡°ê±´ì„ ìœ„ë°˜í•œë‹¤. ì§ê´€ì ìœ¼ë¡œ, ì£¼ê°€ëŠ” 100ì›ì—ì„œ ì‹œì‘í•´ì„œ 10ë…„ í›„ì— 10,000ì›ì´ ë  ìˆ˜ë„, 1ì›ì´ ë  ìˆ˜ë„ ìˆë‹¤. "í‰ê· ìœ¼ë¡œ ëŒì•„ì˜¤ëŠ”" ì„±ì§ˆì´ ì—†ë‹¤.
</p>

<p>
ë§ë¡œë§Œ ë“¤ìœ¼ë©´ ì™€ë‹¿ì§€ ì•Šìœ¼ë‹ˆ, ì§ì ‘ ì‹œë®¬ë ˆì´ì…˜í•´ë³´ì. ëœë¤ ì›Œí¬ì™€ ì •ìƒ ì‹œê³„ì—´ì„ ë‚˜ë€íˆ ìƒì„±í•˜ë©´ ì°¨ì´ê°€ ê·¹ëª…í•˜ê²Œ ë³´ì¸ë‹¤.
</p>

<div class="cc">ì½”ë“œ 9-0. ëœë¤ ì›Œí¬ vs ì •ìƒ ì‹œê³„ì—´ ì‹œë®¬ë ˆì´ì…˜</div>
<pre><code><span class="kw">import</span> numpy <span class="kw">as</span> np
<span class="kw">import</span> matplotlib.pyplot <span class="kw">as</span> plt

np.random.<span class="fn">seed</span>(<span class="nu">42</span>)
N = <span class="nu">1000</span>

<span class="cm"># 1. ë°±ìƒ‰ ì¡ìŒ (ì •ìƒ ì‹œê³„ì—´ì˜ ê°€ì¥ ìˆœìˆ˜í•œ í˜•íƒœ)</span>
white_noise = np.random.<span class="fn">normal</span>(<span class="nu">0</span>, <span class="nu">1</span>, N)

<span class="cm"># 2. ëœë¤ ì›Œí¬ (ë°±ìƒ‰ ì¡ìŒì˜ ëˆ„ì í•© = ë¹„ì •ìƒ)</span>
random_walk = np.<span class="fn">cumsum</span>(white_noise)

<span class="cm"># 3. í‰ê·  íšŒê·€ ê³¼ì • (AR(1), Ï†=0.9 â€” ì •ìƒ)</span>
ar1 = np.<span class="fn">zeros</span>(N)
<span class="kw">for</span> t <span class="kw">in</span> <span class="fn">range</span>(<span class="nu">1</span>, N):
    ar1[t] = <span class="nu">0.9</span> * ar1[t-<span class="nu">1</span>] + white_noise[t]

<span class="cm"># 4. ì—¬ëŸ¬ ê²½ë¡œì˜ ëœë¤ ì›Œí¬ (ë¶„ì‚°ì´ ì‹œê°„ì— ë”°ë¼ ì¦ê°€í•˜ëŠ” ê²ƒì„ ë³´ì—¬ì¤Œ)</span>
fig, axes = plt.<span class="fn">subplots</span>(<span class="nu">2</span>, <span class="nu">2</span>, figsize=(<span class="nu">14</span>, <span class="nu">10</span>))

<span class="cm"># (1) ë°±ìƒ‰ ì¡ìŒ â€” í‰ê·  0, ë¶„ì‚° ì¼ì •</span>
axes[<span class="nu">0</span>,<span class="nu">0</span>].<span class="fn">plot</span>(white_noise, color=<span class="st">'#3498db'</span>, alpha=<span class="nu">0.7</span>, linewidth=<span class="nu">0.8</span>)
axes[<span class="nu">0</span>,<span class="nu">0</span>].<span class="fn">axhline</span>(y=<span class="nu">0</span>, color=<span class="st">'red'</span>, linewidth=<span class="nu">1</span>)
axes[<span class="nu">0</span>,<span class="nu">0</span>].<span class="fn">set_title</span>(<span class="st">'ë°±ìƒ‰ ì¡ìŒ (ì •ìƒ) â€” í‰ê·  0 ì£¼ìœ„ë¥¼ ë§´ëˆë‹¤'</span>)
axes[<span class="nu">0</span>,<span class="nu">0</span>].<span class="fn">grid</span>(<span class="kw">True</span>, alpha=<span class="nu">0.3</span>)

<span class="cm"># (2) ëœë¤ ì›Œí¬ â€” ì–´ë””ë¡œ ê°ˆì§€ ëª¨ë¥¸ë‹¤</span>
axes[<span class="nu">0</span>,<span class="nu">1</span>].<span class="fn">plot</span>(random_walk, color=<span class="st">'#e74c3c'</span>, linewidth=<span class="nu">1.2</span>)
axes[<span class="nu">0</span>,<span class="nu">1</span>].<span class="fn">set_title</span>(<span class="st">'ëœë¤ ì›Œí¬ (ë¹„ì •ìƒ) â€” ëŒì•„ì˜¬ ë³´ì¥ì´ ì—†ë‹¤'</span>)
axes[<span class="nu">0</span>,<span class="nu">1</span>].<span class="fn">grid</span>(<span class="kw">True</span>, alpha=<span class="nu">0.3</span>)

<span class="cm"># (3) AR(1) â€” í‰ê· ìœ¼ë¡œ ëŒì•„ì˜¤ëŠ” ì„±ì§ˆ</span>
axes[<span class="nu">1</span>,<span class="nu">0</span>].<span class="fn">plot</span>(ar1, color=<span class="st">'#2ecc71'</span>, linewidth=<span class="nu">0.8</span>)
axes[<span class="nu">1</span>,<span class="nu">0</span>].<span class="fn">axhline</span>(y=<span class="nu">0</span>, color=<span class="st">'red'</span>, linewidth=<span class="nu">1</span>)
axes[<span class="nu">1</span>,<span class="nu">0</span>].<span class="fn">set_title</span>(<span class="st">'AR(1) Ï†=0.9 (ì •ìƒ) â€” í‰ê·  íšŒê·€'</span>)
axes[<span class="nu">1</span>,<span class="nu">0</span>].<span class="fn">grid</span>(<span class="kw">True</span>, alpha=<span class="nu">0.3</span>)

<span class="cm"># (4) ëœë¤ ì›Œí¬ 100ê°œ ê²½ë¡œ â€” ë¶„ì‚°ì´ ì‹œê°„ì— ë”°ë¼ íŒ¬(fan)ì²˜ëŸ¼ í¼ì§„ë‹¤</span>
<span class="kw">for</span> _ <span class="kw">in</span> <span class="fn">range</span>(<span class="nu">100</span>):
    path = np.<span class="fn">cumsum</span>(np.random.<span class="fn">normal</span>(<span class="nu">0</span>, <span class="nu">1</span>, <span class="nu">500</span>))
    axes[<span class="nu">1</span>,<span class="nu">1</span>].<span class="fn">plot</span>(path, alpha=<span class="nu">0.1</span>, color=<span class="st">'#e74c3c'</span>)
axes[<span class="nu">1</span>,<span class="nu">1</span>].<span class="fn">set_title</span>(<span class="st">'ëœë¤ ì›Œí¬ 100ê°œ ê²½ë¡œ â€” ë¶„ì‚°ì´ ì‹œê°„ì— ë”°ë¼ ì¦ê°€!'</span>)
axes[<span class="nu">1</span>,<span class="nu">1</span>].<span class="fn">grid</span>(<span class="kw">True</span>, alpha=<span class="nu">0.3</span>)

plt.<span class="fn">tight_layout</span>()
plt.<span class="fn">show</span>()</code></pre>

<div class="ok">
<p class="ni"><strong>ì‹œë®¬ë ˆì´ì…˜ì—ì„œ ë°°ìš°ëŠ” í•µì‹¬ ì§ê´€</strong></p>
<ul>
<li><strong>ë°±ìƒ‰ ì¡ìŒ:</strong> 0 ì£¼ìœ„ë¥¼ ë§´ëˆë‹¤. ìœ„ë¡œ ê°”ë‹¤ê°€ ì•„ë˜ë¡œ, ì•„ë˜ë¡œ ê°”ë‹¤ê°€ ìœ„ë¡œ. "í‰ê·  íšŒê·€" ì„±ì§ˆì´ ìˆë‹¤.</li>
<li><strong>ëœë¤ ì›Œí¬:</strong> í•œë²ˆ ì˜¬ë¼ê°€ë©´ ê³„ì† ì˜¬ë¼ê°ˆ ìˆ˜ë„ ìˆë‹¤. ëŒì•„ì˜¬ ë³´ì¥ì´ ì—†ë‹¤. 100ê°œ ê²½ë¡œë¥¼ ê·¸ë¦¬ë©´ ì‹œê°„ì´ ì§€ë‚ ìˆ˜ë¡ ë¶€ì±„ê¼´ì²˜ëŸ¼ í¼ì§„ë‹¤ â€” ì´ê²ƒì´ "ë¶„ì‚°ì´ ì‹œê°„ì— ë”°ë¼ ì¦ê°€"í•œë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤.</li>
<li><strong>AR(1):</strong> ëœë¤ ì›Œí¬ì™€ ë¹„ìŠ·í•´ ë³´ì´ì§€ë§Œ, 0ìœ¼ë¡œ ëŒì•„ì˜¤ëŠ” í˜ì´ ìˆë‹¤. Ï†=0.9ëŠ” "ì–´ì œ ê°’ì˜ 90%ë§Œ ê¸°ì–µ"í•œë‹¤ëŠ” ëœ»ì´ë‹¤. Ï†=1.0ì´ë©´ ëœë¤ ì›Œí¬ê°€ ëœë‹¤.</li>
</ul>
<p class="ni" style="margin-top:8px"><strong>ê¸ˆìœµ ë¹„ìœ :</strong> ì£¼ê°€ëŠ” ëœë¤ ì›Œí¬(ë¹„ì •ìƒ), ìˆ˜ìµë¥ ì€ ë°±ìƒ‰ ì¡ìŒì— ê°€ê¹Œì›€(ì •ìƒ), ê¸ˆë¦¬ ìŠ¤í”„ë ˆë“œëŠ” AR(1)ì— ê°€ê¹Œì›€(í‰ê·  íšŒê·€ â†’ í†µê³„ì  ì°¨ìµê±°ë˜ì˜ ê¸°ì´ˆ).</p>
</div>

<!-- ì •ìƒ vs ë¹„ì •ìƒ ë¹„êµ ë‹¤ì´ì–´ê·¸ë¨ -->
<div style="margin:25px 0;display:flex;gap:15px;flex-wrap:wrap;justify-content:center">
<div style="flex:1;min-width:260px;background:linear-gradient(135deg,#d4edda,#c3e6cb);padding:18px;border-radius:10px;border:2px solid #28a745">
<p class="ni" style="text-align:center;font-weight:bold;font-size:13px;color:#155724;margin-bottom:10px">âœ… ì •ìƒ ì‹œê³„ì—´</p>
<p class="ni" style="font-size:11px;margin-bottom:5px">ğŸ“Š í‰ê· : ì¼ì • (ì‹œê°„ì— ë¬´ê´€)</p>
<p class="ni" style="font-size:11px;margin-bottom:5px">ğŸ“Š ë¶„ì‚°: ì¼ì • (ì‹œê°„ì— ë¬´ê´€)</p>
<p class="ni" style="font-size:11px;margin-bottom:5px">ğŸ”„ í‰ê·  íšŒê·€: ìˆìŒ</p>
<p class="ni" style="font-size:11px;margin-bottom:5px">ğŸ“ˆ ADF p-value: < 0.05</p>
<p class="ni" style="font-size:11px;color:#155724;margin-top:8px;border-top:1px solid #28a745;padding-top:6px">ì˜ˆ: ìˆ˜ìµë¥ , RSI, ê¸ˆë¦¬ ìŠ¤í”„ë ˆë“œ</p>
</div>
<div style="flex:1;min-width:260px;background:linear-gradient(135deg,#f8d7da,#f5c6cb);padding:18px;border-radius:10px;border:2px solid #dc3545">
<p class="ni" style="text-align:center;font-weight:bold;font-size:13px;color:#721c24;margin-bottom:10px">âŒ ë¹„ì •ìƒ ì‹œê³„ì—´</p>
<p class="ni" style="font-size:11px;margin-bottom:5px">ğŸ“Š í‰ê· : ì‹œê°„ì— ë”°ë¼ ë³€í•¨ (ì¶”ì„¸)</p>
<p class="ni" style="font-size:11px;margin-bottom:5px">ğŸ“Š ë¶„ì‚°: ì‹œê°„ì— ë”°ë¼ ì¦ê°€</p>
<p class="ni" style="font-size:11px;margin-bottom:5px">ğŸ”„ í‰ê·  íšŒê·€: ì—†ìŒ</p>
<p class="ni" style="font-size:11px;margin-bottom:5px">ğŸ“ˆ ADF p-value: > 0.05</p>
<p class="ni" style="font-size:11px;color:#721c24;margin-top:8px;border-top:1px solid #dc3545;padding-top:6px">ì˜ˆ: ì£¼ê°€, GDP, ì¸êµ¬ìˆ˜</p>
</div>
</div>

<p>
í•˜ì§€ë§Œ <strong>ìˆ˜ìµë¥ (return)ì€ ëŒ€ì²´ë¡œ ì •ìƒì </strong>ì´ë‹¤:
</p>

<div class="eq">
$$r_t = \frac{p_t - p_{t-1}}{p_{t-1}} = \frac{\Delta p_t}{p_{t-1}}$$
</div>

<p>
ìˆ˜ìµë¥ ì€ í‰ê·  ì£¼ìœ„ë¥¼ ì˜¤ë¥´ë‚´ë¦¬ê³ , ë¶„ì‚°ë„ ëŒ€ì²´ë¡œ ì¼ì •í•˜ë‹¤(ë³€ë™ì„± í´ëŸ¬ìŠ¤í„°ë§ì€ ìˆì§€ë§Œ). ì´ê²ƒì´ ê¸ˆìœµì—ì„œ ì£¼ê°€ ëŒ€ì‹  ìˆ˜ìµë¥ ì„ ë¶„ì„í•˜ëŠ” ê·¼ë³¸ì ì¸ ì´ìœ ì´ë‹¤.
</p>

<h3>9.4 ì°¨ë¶„ (Differencing): ë¹„ì •ìƒ â†’ ì •ìƒ ë³€í™˜</h3>

<p>
ë¹„ì •ìƒ ì‹œê³„ì—´ì„ ì •ìƒìœ¼ë¡œ ë§Œë“œëŠ” ê°€ì¥ ê°„ë‹¨í•œ ë°©ë²•ì´ <strong>ì°¨ë¶„(differencing)</strong>ì´ë‹¤. 1ì°¨ ì°¨ë¶„ì€ ì—°ì†ëœ ê°’ì˜ ì°¨ì´ë¥¼ êµ¬í•˜ëŠ” ê²ƒì´ë‹¤:
</p>

<div class="eq">
$$\Delta y_t = y_t - y_{t-1}$$
</div>

<p>
ì£¼ê°€ì— 1ì°¨ ì°¨ë¶„ì„ ì ìš©í•˜ë©´ ê°€ê²© ë³€í™”ëŸ‰ì´ ë˜ê³ , ì´ê²ƒì€ ëŒ€ì²´ë¡œ ì •ìƒì ì´ë‹¤. ë§Œì•½ 1ì°¨ ì°¨ë¶„ìœ¼ë¡œë„ ì •ìƒì´ ì•ˆ ë˜ë©´ 2ì°¨ ì°¨ë¶„(\(\Delta^2 y_t = \Delta y_t - \Delta y_{t-1}\))ì„ ì ìš©í•œë‹¤. ì‹¤ë¬´ì—ì„œ 2ì°¨ ì´ìƒì˜ ì°¨ë¶„ì´ í•„ìš”í•œ ê²½ìš°ëŠ” ë“œë¬¼ë‹¤.
</p>

<div class="info">
<p class="ni"><strong>ì ë¶„ ì°¨ìˆ˜ (Order of Integration):</strong> dë²ˆ ì°¨ë¶„í•´ì•¼ ì •ìƒì´ ë˜ëŠ” ì‹œê³„ì—´ì„ "I(d)"ë¼ê³  í‘œê¸°í•œë‹¤. ì£¼ê°€ëŠ” I(1) â€” 1ë²ˆ ì°¨ë¶„í•˜ë©´ ì •ìƒ. ìˆ˜ìµë¥ ì€ I(0) â€” ì´ë¯¸ ì •ìƒ. ì´ "d"ê°€ ARIMAì˜ Iì— í•´ë‹¹í•œë‹¤.</p>
</div>

<h3>9.5 ADF ê²€ì •: ì •ìƒì„±ì„ í†µê³„ì ìœ¼ë¡œ ê²€ì¦</h3>

<p>
"ì´ ì‹œê³„ì—´ì´ ì •ìƒì¸ê°€?"ë¥¼ ëˆˆìœ¼ë¡œ íŒë‹¨í•˜ëŠ” ê²ƒì€ ì£¼ê´€ì ì´ë‹¤. <strong>ADF ê²€ì •(Augmented Dickey-Fuller Test)</strong>ì€ ì´ê²ƒì„ í†µê³„ì ìœ¼ë¡œ ê²€ì¦í•œë‹¤.
</p>

<div class="def">
<p class="ni"><strong>ADF ê²€ì •ì˜ ê°€ì„¤</strong></p>
<ul>
<li><strong>ê·€ë¬´ê°€ì„¤ (Hâ‚€):</strong> ë‹¨ìœ„ê·¼(unit root)ì´ ì¡´ì¬í•œë‹¤ â†’ ë¹„ì •ìƒ</li>
<li><strong>ëŒ€ë¦½ê°€ì„¤ (Hâ‚):</strong> ë‹¨ìœ„ê·¼ì´ ì—†ë‹¤ â†’ ì •ìƒ</li>
</ul>
<p class="ni" style="margin-top:8px"><strong>íŒë‹¨ ê¸°ì¤€:</strong> p-value < 0.05ì´ë©´ ê·€ë¬´ê°€ì„¤ ê¸°ê° â†’ ì •ìƒì´ë¼ê³  íŒë‹¨</p>
</div>

<div class="info">
<p class="ni"><strong>"ë‹¨ìœ„ê·¼"ì´ ë­”ë°? â€” ì§ê´€ì  ì´í•´</strong></p>
<p class="ni" style="margin-top:8px">AR(1) ëª¨ë¸ \(y_t = \phi y_{t-1} + \epsilon_t\)ì—ì„œ \(\phi\)ì˜ ê°’ì— ë”°ë¼ ì‹œê³„ì—´ì˜ ì„±ê²©ì´ ì™„ì „íˆ ë‹¬ë¼ì§„ë‹¤:</p>
<ul>
<li>\(|\phi| < 1\): ì •ìƒ. ì¶©ê²©ì´ ì‹œê°„ì´ ì§€ë‚˜ë©´ ì‚¬ë¼ì§„ë‹¤. (ì˜ˆ: Ï†=0.9ì´ë©´ ì¶©ê²©ì´ 0.9, 0.81, 0.73... ìœ¼ë¡œ ê°ì†Œ)</li>
<li>\(\phi = 1\): ë‹¨ìœ„ê·¼! ë¹„ì •ìƒ. ì¶©ê²©ì´ ì˜ì›íˆ ë‚¨ëŠ”ë‹¤. (ì˜ˆ: ì˜¤ëŠ˜ +5% ì¶©ê²© â†’ ë‚´ì¼ë„, ëª¨ë ˆë„, ì˜ì›íˆ +5%ê°€ ë°˜ì˜ë¨)</li>
<li>\(|\phi| > 1\): í­ë°œ. ì‹œê³„ì—´ì´ ë¬´í•œëŒ€ë¡œ ë°œì‚°í•œë‹¤.</li>
</ul>
<p class="ni" style="margin-top:8px">ADF ê²€ì •ì€ "Ï†ê°€ ì •í™•íˆ 1ì¸ê°€?"ë¥¼ í†µê³„ì ìœ¼ë¡œ ê²€ì •í•˜ëŠ” ê²ƒì´ë‹¤. Ï†=1ì´ë©´ ëœë¤ ì›Œí¬ â†’ ë¹„ì •ìƒ.</p>
</div>

<div class="cc">ì½”ë“œ 9-1. ADF ê²€ì •: ì£¼ê°€ vs ìˆ˜ìµë¥ </div>
<pre><code><span class="kw">import</span> yfinance <span class="kw">as</span> yf
<span class="kw">import</span> numpy <span class="kw">as</span> np
<span class="kw">import</span> pandas <span class="kw">as</span> pd
<span class="kw">import</span> matplotlib.pyplot <span class="kw">as</span> plt
<span class="kw">from</span> statsmodels.tsa.stattools <span class="kw">import</span> adfuller

<span class="cm"># 1. ë°ì´í„° ìˆ˜ì§‘</span>
data = yf.<span class="fn">download</span>(<span class="st">'AAPL'</span>, start=<span class="st">'2020-01-01'</span>, end=<span class="st">'2025-01-01'</span>)
price = data[<span class="st">'Close'</span>].squeeze()  <span class="cm"># MultiIndex â†’ Series</span>
returns = price.<span class="fn">pct_change</span>().<span class="fn">dropna</span>()

<span class="cm"># 2. ADF ê²€ì • í•¨ìˆ˜</span>
<span class="kw">def</span> <span class="fn">adf_test</span>(series, name):
    result = <span class="fn">adfuller</span>(series, autolag=<span class="st">'AIC'</span>)
    <span class="fn">print</span>(<span class="st">f"\n=== ADF ê²€ì •: {name} ==="</span>)
    <span class="fn">print</span>(<span class="st">f"ê²€ì • í†µê³„ëŸ‰: {result[0]:.4f}"</span>)
    <span class="fn">print</span>(<span class="st">f"p-value:     {result[1]:.6f}"</span>)
    <span class="fn">print</span>(<span class="st">f"ì‚¬ìš©ëœ ì‹œì°¨: {result[2]}"</span>)
    <span class="fn">print</span>(<span class="st">f"ê´€ì¸¡ì¹˜ ìˆ˜:   {result[3]}"</span>)
    <span class="kw">for</span> key, val <span class="kw">in</span> result[<span class="nu">4</span>].items():
        <span class="fn">print</span>(<span class="st">f"  ì„ê³„ê°’ ({key}): {val:.4f}"</span>)
    <span class="kw">if</span> result[<span class="nu">1</span>] < <span class="nu">0.05</span>:
        <span class="fn">print</span>(<span class="st">f"â†’ âœ… ì •ìƒ (p < 0.05, ê·€ë¬´ê°€ì„¤ ê¸°ê°)"</span>)
    <span class="kw">else</span>:
        <span class="fn">print</span>(<span class="st">f"â†’ âŒ ë¹„ì •ìƒ (p â‰¥ 0.05, ê·€ë¬´ê°€ì„¤ ì±„íƒ)"</span>)

<span class="cm"># 3. ì£¼ê°€ vs ìˆ˜ìµë¥  ADF ê²€ì •</span>
<span class="fn">adf_test</span>(price, <span class="st">'AAPL ì£¼ê°€'</span>)
<span class="fn">adf_test</span>(returns, <span class="st">'AAPL ìˆ˜ìµë¥ '</span>)

<span class="cm"># 4. ì‹œê°í™”: ì£¼ê°€ vs ìˆ˜ìµë¥ </span>
fig, axes = plt.<span class="fn">subplots</span>(<span class="nu">2</span>, <span class="nu">1</span>, figsize=(<span class="nu">14</span>, <span class="nu">8</span>))

axes[<span class="nu">0</span>].<span class="fn">plot</span>(price, color=<span class="st">'#2c3e50'</span>)
axes[<span class="nu">0</span>].<span class="fn">set_title</span>(<span class="st">'AAPL ì£¼ê°€ (ë¹„ì •ìƒ â€” ì¶”ì„¸ ì¡´ì¬)'</span>)
axes[<span class="nu">0</span>].<span class="fn">set_ylabel</span>(<span class="st">'ê°€ê²© ($)'</span>)
axes[<span class="nu">0</span>].<span class="fn">grid</span>(<span class="kw">True</span>, alpha=<span class="nu">0.3</span>)

axes[<span class="nu">1</span>].<span class="fn">plot</span>(returns, color=<span class="st">'#3498db'</span>, alpha=<span class="nu">0.7</span>)
axes[<span class="nu">1</span>].<span class="fn">axhline</span>(y=<span class="nu">0</span>, color=<span class="st">'red'</span>, linewidth=<span class="nu">0.5</span>)
axes[<span class="nu">1</span>].<span class="fn">set_title</span>(<span class="st">'AAPL ì¼ê°„ ìˆ˜ìµë¥  (ì •ìƒ â€” í‰ê·  íšŒê·€)'</span>)
axes[<span class="nu">1</span>].<span class="fn">set_ylabel</span>(<span class="st">'ìˆ˜ìµë¥ '</span>)
axes[<span class="nu">1</span>].<span class="fn">grid</span>(<span class="kw">True</span>, alpha=<span class="nu">0.3</span>)

plt.<span class="fn">tight_layout</span>()
plt.<span class="fn">show</span>()</code></pre>

<div class="ok">
<p class="ni"><strong>ê¸°ëŒ€ ê²°ê³¼:</strong></p>
<ul>
<li><strong>AAPL ì£¼ê°€:</strong> p-value â‰ˆ 0.9 â†’ ë¹„ì •ìƒ (ì¶”ì„¸ê°€ ìˆìœ¼ë¯€ë¡œ ë‹¹ì—°)</li>
<li><strong>AAPL ìˆ˜ìµë¥ :</strong> p-value â‰ˆ 0.0000 â†’ ì •ìƒ (í‰ê·  0 ì£¼ìœ„ë¥¼ ì˜¤ë¥´ë‚´ë¦¼)</li>
</ul>
<p class="ni" style="margin-top:8px">ì´ê²ƒì´ ARIMAì—ì„œ "I(d)"ì˜ ì˜ë¯¸ì´ë‹¤. ì£¼ê°€ëŠ” I(1)ì´ë¯€ë¡œ 1ì°¨ ì°¨ë¶„(= ìˆ˜ìµë¥ )ì„ í•´ì•¼ ì •ìƒì´ ëœë‹¤.</p>
</div>

<h3>9.6 KPSS ê²€ì •: ADFì˜ ë³´ì™„</h3>

<p>
ADF ê²€ì •ë§Œìœ¼ë¡œëŠ” ë¶€ì¡±í•  ìˆ˜ ìˆë‹¤. <strong>KPSS ê²€ì •</strong>ì€ ADFì™€ ê°€ì„¤ì´ ë°˜ëŒ€ì´ë‹¤:
</p>

<ul>
<li><strong>KPSS ê·€ë¬´ê°€ì„¤:</strong> ì •ìƒì´ë‹¤</li>
<li><strong>KPSS ëŒ€ë¦½ê°€ì„¤:</strong> ë¹„ì •ìƒì´ë‹¤</li>
</ul>

<p>
ì‹¤ë¬´ì—ì„œëŠ” ADFì™€ KPSSë¥¼ í•¨ê»˜ ì‚¬ìš©í•˜ì—¬ êµì°¨ ê²€ì¦í•œë‹¤. ë‘˜ ë‹¤ "ì •ìƒ"ì´ë¼ê³  í•˜ë©´ í™•ì‹¤íˆ ì •ìƒ, ë‘˜ ë‹¤ "ë¹„ì •ìƒ"ì´ë©´ í™•ì‹¤íˆ ë¹„ì •ìƒì´ë‹¤.
</p>

<div class="warn">
<p class="ni"><strong>âš ï¸ ì •ìƒì„± ê²€ì • ì‹¤ì „ íŒ</strong></p>
<ul>
<li>ì£¼ê°€(price) â†’ ê±°ì˜ í•­ìƒ ë¹„ì •ìƒ. ì°¨ë¶„ ë˜ëŠ” ë¡œê·¸ ìˆ˜ìµë¥  ì‚¬ìš©.</li>
<li>ìˆ˜ìµë¥ (return) â†’ ëŒ€ì²´ë¡œ ì •ìƒ. í•˜ì§€ë§Œ ë³€ë™ì„±ì€ ì‹œê°„ì— ë”°ë¼ ë³€í•œë‹¤ (â†’ GARCH).</li>
<li>ê±°ë˜ëŸ‰(volume) â†’ ì¢…ì¢… ë¹„ì •ìƒ. ë¡œê·¸ ë³€í™˜ + ì°¨ë¶„ì´ í•„ìš”í•  ìˆ˜ ìˆë‹¤.</li>
<li>ê¸°ìˆ ì  ì§€í‘œ(RSI, MACD ë“±) â†’ ëŒ€ì²´ë¡œ ì •ìƒ ë˜ëŠ” ì•½í•œ ë¹„ì •ìƒ.</li>
</ul>
</div>


<!-- ==================== Ch.10 ==================== -->
<h2 id="ch10">Chapter 10. ACF/PACF + ARIMA â€” ì‹œê³„ì—´ ì˜ˆì¸¡ì˜ ê³ ì „</h2>

<h3>10.1 ìê¸°ìƒê´€ (Autocorrelation): ê³¼ê±°ê°€ ë¯¸ë˜ë¥¼ ë§í•´ì£¼ëŠ”ê°€</h3>

<p>
ìê¸°ìƒê´€(Autocorrelation)ì´ë€ ì‹œê³„ì—´ì´ ìê¸° ìì‹ ì˜ ê³¼ê±° ê°’ê³¼ ì–¼ë§ˆë‚˜ ìƒê´€ë˜ì–´ ìˆëŠ”ì§€ë¥¼ ì¸¡ì •í•˜ëŠ” ê²ƒì´ë‹¤. ì‹œì°¨(lag) kì—ì„œì˜ ìê¸°ìƒê´€ í•¨ìˆ˜(ACF)ëŠ”:
</p>

<div class="eq">
$$\rho_k = \frac{\text{Cov}(y_t, y_{t-k})}{\text{Var}(y_t)} = \frac{\gamma_k}{\gamma_0}$$
</div>

<p>
ë¹„ìœ í•˜ìë©´, "ì˜¤ëŠ˜ ë¹„ê°€ ì™”ìœ¼ë©´ ë‚´ì¼ë„ ë¹„ê°€ ì˜¬ í™•ë¥ ì´ ë†’ì€ê°€?"ë¥¼ ì¸¡ì •í•˜ëŠ” ê²ƒì´ë‹¤. ê¸ˆìœµì—ì„œëŠ” "ì˜¤ëŠ˜ ì£¼ê°€ê°€ ì˜¬ëìœ¼ë©´ ë‚´ì¼ë„ ì˜¤ë¥¼ í™•ë¥ ì´ ë†’ì€ê°€?" â€” ì´ê²ƒì´ ëª¨ë©˜í…€(momentum) íš¨ê³¼ì´ê³ , ìê¸°ìƒê´€ìœ¼ë¡œ ì¸¡ì •í•  ìˆ˜ ìˆë‹¤.
</p>

<h3>10.2 ACFì™€ PACFì˜ ì°¨ì´</h3>

<div class="def">
<p class="ni"><strong>ACF vs PACF</strong></p>
<ul>
<li><strong>ACF (Autocorrelation Function):</strong> ì‹œì°¨ kì—ì„œì˜ ì´ ìƒê´€ê´€ê³„. ì¤‘ê°„ ì‹œì°¨ì˜ ì˜í–¥ì„ í¬í•¨í•œë‹¤. ì˜ˆ: lag-3 ACFëŠ” lag-1, lag-2ë¥¼ í†µí•œ ê°„ì ‘ íš¨ê³¼ë„ í¬í•¨.</li>
<li><strong>PACF (Partial Autocorrelation Function):</strong> ì‹œì°¨ kì—ì„œì˜ ìˆœìˆ˜ ìƒê´€ê´€ê³„. ì¤‘ê°„ ì‹œì°¨ì˜ ì˜í–¥ì„ ì œê±°í•œ ì§ì ‘ íš¨ê³¼ë§Œ ì¸¡ì •. ì˜ˆ: lag-3 PACFëŠ” lag-1, lag-2ì˜ ì˜í–¥ì„ ì œê±°í•œ í›„ lag-3ë§Œì˜ íš¨ê³¼.</li>
</ul>
</div>

<p>
ACFì™€ PACFì˜ íŒ¨í„´ì„ ë³´ë©´ ì–´ë–¤ ì‹œê³„ì—´ ëª¨ë¸ì„ ì¨ì•¼ í•˜ëŠ”ì§€ ì•Œ ìˆ˜ ìˆë‹¤:
</p>

<div class="tc">í‘œ 10-1. ACF/PACF íŒ¨í„´ìœ¼ë¡œ ëª¨ë¸ ì„ íƒ</div>
<table>
<thead>
<tr><th>ACF íŒ¨í„´</th><th>PACF íŒ¨í„´</th><th>ì í•©í•œ ëª¨ë¸</th></tr>
</thead>
<tbody>
<tr><td>ì§€ìˆ˜ì  ê°ì†Œ ë˜ëŠ” ì‚¬ì¸íŒŒ</td><td>lag p ì´í›„ ì ˆë‹¨</td><td>AR(p)</td></tr>
<tr><td>lag q ì´í›„ ì ˆë‹¨</td><td>ì§€ìˆ˜ì  ê°ì†Œ ë˜ëŠ” ì‚¬ì¸íŒŒ</td><td>MA(q)</td></tr>
<tr><td>ì§€ìˆ˜ì  ê°ì†Œ</td><td>ì§€ìˆ˜ì  ê°ì†Œ</td><td>ARMA(p,q)</td></tr>
</tbody>
</table>

<h3>10.3 ACF/PACF ì‹¤ì „ ì½”ë“œ</h3>

<div class="cc">ì½”ë“œ 10-1. ACF/PACF í”Œë¡¯</div>
<pre><code><span class="kw">from</span> statsmodels.graphics.tsaplots <span class="kw">import</span> plot_acf, plot_pacf

<span class="cm"># returnsëŠ” AAPL ì¼ê°„ ìˆ˜ìµë¥  (ì½”ë“œ 9-1ì—ì„œ ìƒì„±)</span>

fig, axes = plt.<span class="fn">subplots</span>(<span class="nu">2</span>, <span class="nu">2</span>, figsize=(<span class="nu">14</span>, <span class="nu">10</span>))

<span class="cm"># ì£¼ê°€ì˜ ACF/PACF (ë¹„ì •ìƒì´ë¯€ë¡œ ì°¸ê³ ìš©)</span>
<span class="fn">plot_acf</span>(price.<span class="fn">dropna</span>(), lags=<span class="nu">40</span>, ax=axes[<span class="nu">0</span>,<span class="nu">0</span>], title=<span class="st">'ì£¼ê°€ ACF (ë¹„ì •ìƒ)'</span>)
<span class="fn">plot_pacf</span>(price.<span class="fn">dropna</span>(), lags=<span class="nu">40</span>, ax=axes[<span class="nu">0</span>,<span class="nu">1</span>], title=<span class="st">'ì£¼ê°€ PACF (ë¹„ì •ìƒ)'</span>)

<span class="cm"># ìˆ˜ìµë¥ ì˜ ACF/PACF (ì •ìƒ)</span>
<span class="fn">plot_acf</span>(returns, lags=<span class="nu">40</span>, ax=axes[<span class="nu">1</span>,<span class="nu">0</span>], title=<span class="st">'ìˆ˜ìµë¥  ACF (ì •ìƒ)'</span>)
<span class="fn">plot_pacf</span>(returns, lags=<span class="nu">40</span>, ax=axes[<span class="nu">1</span>,<span class="nu">1</span>], title=<span class="st">'ìˆ˜ìµë¥  PACF (ì •ìƒ)'</span>)

plt.<span class="fn">tight_layout</span>()
plt.<span class="fn">show</span>()</code></pre>

<div class="info">
<p class="ni"><strong>ê²°ê³¼ í•´ì„:</strong></p>
<ul>
<li><strong>ì£¼ê°€ ACF:</strong> ëª¨ë“  ì‹œì°¨ì—ì„œ ë†’ì€ ìê¸°ìƒê´€ â†’ ë¹„ì •ìƒì˜ ì „í˜•ì  íŒ¨í„´ (ì–´ì œ ê°€ê²©ì´ ë†’ìœ¼ë©´ ì˜¤ëŠ˜ë„ ë†’ë‹¤)</li>
<li><strong>ìˆ˜ìµë¥  ACF:</strong> ëŒ€ë¶€ë¶„ì˜ ì‹œì°¨ì—ì„œ ìê¸°ìƒê´€ì´ 0ì— ê°€ê¹Œì›€ â†’ ìˆ˜ìµë¥ ì€ ê±°ì˜ ì˜ˆì¸¡ ë¶ˆê°€ëŠ¥ (íš¨ìœ¨ì  ì‹œì¥ ê°€ì„¤ê³¼ ì¼ì¹˜)</li>
<li><strong>ìˆ˜ìµë¥  ACFì—ì„œ ì•½ê°„ì˜ ìœ ì˜í•œ ì‹œì°¨:</strong> ì´ê²ƒì´ ì•ŒíŒŒì˜ ì›ì²œì´ ë  ìˆ˜ ìˆë‹¤!</li>
</ul>
</div>

<h3>10.4 ARIMA ëª¨ë¸: AR + I + MA</h3>

<p>
ARIMA(p, d, q)ëŠ” ì‹œê³„ì—´ ì˜ˆì¸¡ì˜ ê³ ì „ì  ëª¨ë¸ì´ë‹¤. ì„¸ ê°€ì§€ ìš”ì†Œì˜ ì¡°í•©ì´ë‹¤:
</p>

<div class="def">
<p class="ni"><strong>ARIMA(p, d, q)ì˜ êµ¬ì„± ìš”ì†Œ</strong></p>
<ul>
<li><strong>AR(p) â€” ìê¸°íšŒê·€:</strong> ê³¼ê±° pê°œì˜ ê°’ìœ¼ë¡œ í˜„ì¬ ê°’ì„ ì˜ˆì¸¡. "ì–´ì œì™€ ê·¸ì œì˜ ìˆ˜ìµë¥ ë¡œ ì˜¤ëŠ˜ì„ ì˜ˆì¸¡"</li>
<li><strong>I(d) â€” ì ë¶„(ì°¨ë¶„):</strong> dë²ˆ ì°¨ë¶„í•˜ì—¬ ì •ìƒì„± í™•ë³´. ì£¼ê°€ëŠ” d=1, ìˆ˜ìµë¥ ì€ d=0</li>
<li><strong>MA(q) â€” ì´ë™í‰ê· :</strong> ê³¼ê±° qê°œì˜ ì˜¤ì°¨(ì”ì°¨)ë¡œ í˜„ì¬ ê°’ì„ ì˜ˆì¸¡. "ì–´ì œì˜ ì˜ˆì¸¡ ì˜¤ì°¨ë¥¼ ë°˜ì˜"</li>
</ul>
</div>

<div class="eq">
$$y_t = c + \phi_1 y_{t-1} + \cdots + \phi_p y_{t-p} + \theta_1 \epsilon_{t-1} + \cdots + \theta_q \epsilon_{t-q} + \epsilon_t$$
</div>

<p>
ì—¬ê¸°ì„œ \(\phi\)ëŠ” AR ê³„ìˆ˜, \(\theta\)ëŠ” MA ê³„ìˆ˜, \(\epsilon_t\)ëŠ” ë°±ìƒ‰ ì¡ìŒì´ë‹¤.
</p>

<h3>10.5 ARIMA ì‹¤ì „: ì£¼ê°€ ìˆ˜ìµë¥  ì˜ˆì¸¡</h3>

<div class="cc">ì½”ë“œ 10-2. ARIMA ëª¨ë¸ í”¼íŒ… + ì˜ˆì¸¡</div>
<pre><code><span class="kw">from</span> statsmodels.tsa.arima.model <span class="kw">import</span> ARIMA
<span class="kw">from</span> statsmodels.tsa.stattools <span class="kw">import</span> adfuller
<span class="kw">import</span> warnings
warnings.<span class="fn">filterwarnings</span>(<span class="st">'ignore'</span>)

<span class="cm"># 1. ë°ì´í„° ì¤€ë¹„ (ìˆ˜ìµë¥  ì‚¬ìš© â€” ì´ë¯¸ ì •ìƒì´ë¯€ë¡œ d=0)</span>
train_size = <span class="fn">int</span>(<span class="fn">len</span>(returns) * <span class="nu">0.8</span>)
train = returns[:train_size]
test = returns[train_size:]

<span class="fn">print</span>(<span class="st">f"í•™ìŠµ ë°ì´í„°: {len(train)}ì¼"</span>)
<span class="fn">print</span>(<span class="st">f"í…ŒìŠ¤íŠ¸ ë°ì´í„°: {len(test)}ì¼"</span>)

<span class="cm"># 2. auto_arimaë¡œ ìµœì  (p,d,q) íƒìƒ‰</span>
<span class="cm"># pip install pmdarima</span>
<span class="kw">from</span> pmdarima <span class="kw">import</span> auto_arima

auto_model = <span class="fn">auto_arima</span>(
    train,
    start_p=<span class="nu">0</span>, max_p=<span class="nu">5</span>,
    start_q=<span class="nu">0</span>, max_q=<span class="nu">5</span>,
    d=<span class="nu">0</span>,              <span class="cm"># ìˆ˜ìµë¥ ì€ ì´ë¯¸ ì •ìƒ</span>
    seasonal=<span class="kw">False</span>,   <span class="cm"># ê³„ì ˆì„± ì—†ìŒ</span>
    stepwise=<span class="kw">True</span>,
    suppress_warnings=<span class="kw">True</span>,
    information_criterion=<span class="st">'aic'</span>
)
<span class="fn">print</span>(<span class="st">f"\nìµœì  ëª¨ë¸: {auto_model.summary()}"</span>)

<span class="cm"># 3. ìˆ˜ë™ìœ¼ë¡œ ARIMA(1,0,1) í”¼íŒ…</span>
model = <span class="fn">ARIMA</span>(train, order=(<span class="nu">1</span>, <span class="nu">0</span>, <span class="nu">1</span>))
fitted = model.<span class="fn">fit</span>()
<span class="fn">print</span>(fitted.<span class="fn">summary</span>())

<span class="cm"># 4. ì”ì°¨ ì§„ë‹¨</span>
residuals = fitted.resid

fig, axes = plt.<span class="fn">subplots</span>(<span class="nu">2</span>, <span class="nu">2</span>, figsize=(<span class="nu">14</span>, <span class="nu">8</span>))
axes[<span class="nu">0</span>,<span class="nu">0</span>].<span class="fn">plot</span>(residuals)
axes[<span class="nu">0</span>,<span class="nu">0</span>].<span class="fn">set_title</span>(<span class="st">'ì”ì°¨ ì‹œê³„ì—´'</span>)
axes[<span class="nu">0</span>,<span class="nu">1</span>].<span class="fn">hist</span>(residuals, bins=<span class="nu">50</span>, density=<span class="kw">True</span>, alpha=<span class="nu">0.7</span>)
axes[<span class="nu">0</span>,<span class="nu">1</span>].<span class="fn">set_title</span>(<span class="st">'ì”ì°¨ ë¶„í¬'</span>)
<span class="fn">plot_acf</span>(residuals, lags=<span class="nu">30</span>, ax=axes[<span class="nu">1</span>,<span class="nu">0</span>], title=<span class="st">'ì”ì°¨ ACF'</span>)
<span class="fn">plot_acf</span>(residuals**<span class="nu">2</span>, lags=<span class="nu">30</span>, ax=axes[<span class="nu">1</span>,<span class="nu">1</span>], title=<span class="st">'ì”ì°¨Â² ACF (ë³€ë™ì„± í´ëŸ¬ìŠ¤í„°ë§)'</span>)
plt.<span class="fn">tight_layout</span>()
plt.<span class="fn">show</span>()

<span class="cm"># 5. ì˜ˆì¸¡</span>
forecast = fitted.<span class="fn">forecast</span>(steps=<span class="fn">len</span>(test))

fig, ax = plt.<span class="fn">subplots</span>(figsize=(<span class="nu">14</span>, <span class="nu">5</span>))
ax.<span class="fn">plot</span>(test.index, test.values, label=<span class="st">'ì‹¤ì œ'</span>, alpha=<span class="nu">0.7</span>)
ax.<span class="fn">plot</span>(test.index, forecast, label=<span class="st">'ARIMA ì˜ˆì¸¡'</span>, color=<span class="st">'red'</span>, alpha=<span class="nu">0.7</span>)
ax.<span class="fn">set_title</span>(<span class="st">'ARIMA ìˆ˜ìµë¥  ì˜ˆì¸¡ vs ì‹¤ì œ'</span>)
ax.<span class="fn">legend</span>()
ax.<span class="fn">grid</span>(<span class="kw">True</span>, alpha=<span class="nu">0.3</span>)
plt.<span class="fn">tight_layout</span>()
plt.<span class="fn">show</span>()</code></pre>

<div class="warn">
<p class="ni"><strong>âš ï¸ ARIMAì˜ í˜„ì‹¤ì  í•œê³„ (ë§¤ìš° ì¤‘ìš”!)</strong></p>
<ul>
<li><strong>ìˆ˜ìµë¥  ì˜ˆì¸¡ì€ ê·¹ë„ë¡œ ì–´ë µë‹¤.</strong> ARIMA ì˜ˆì¸¡ì´ ê±°ì˜ 0ì— ìˆ˜ë ´í•˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤ â€” ì´ê²ƒì€ "ìˆ˜ìµë¥ ì€ ì˜ˆì¸¡ ë¶ˆê°€ëŠ¥í•˜ë‹¤"ëŠ” íš¨ìœ¨ì  ì‹œì¥ ê°€ì„¤ê³¼ ì¼ì¹˜í•œë‹¤.</li>
<li><strong>ARIMAëŠ” í‰ê· (mean)ì„ ì˜ˆì¸¡í•œë‹¤.</strong> í•˜ì§€ë§Œ ê¸ˆìœµì—ì„œ ë” ì¤‘ìš”í•œ ê²ƒì€ <strong>ë³€ë™ì„±(variance)</strong>ì˜ ì˜ˆì¸¡ì´ë‹¤. ì”ì°¨Â²ì˜ ACFë¥¼ ë³´ë©´ ìœ ì˜í•œ ìê¸°ìƒê´€ì´ ìˆë‹¤ â€” ì´ê²ƒì´ ë³€ë™ì„± í´ëŸ¬ìŠ¤í„°ë§ì´ê³ , GARCHê°€ í•„ìš”í•œ ì´ìœ ì´ë‹¤.</li>
<li><strong>ì„ í˜• ëª¨ë¸ì˜ í•œê³„:</strong> ARIMAëŠ” ì„ í˜• ê´€ê³„ë§Œ í¬ì°©í•œë‹¤. ë¹„ì„ í˜• íŒ¨í„´ì€ R7ì˜ LSTMì´ ë” ì˜ ì¡ëŠ”ë‹¤.</li>
</ul>
</div>

<h3>10.6 ARIMA ëª¨ë¸ ì„ íƒ: AICì™€ BIC</h3>

<p>
(p, d, q)ë¥¼ ì–´ë–»ê²Œ ì„ íƒí•˜ëŠ”ê°€? ACF/PACF íŒ¨í„´ ì™¸ì—, ì •ë³´ ê¸°ì¤€(Information Criterion)ì„ ì‚¬ìš©í•œë‹¤:
</p>

<ul>
<li><strong>AIC (Akaike Information Criterion):</strong> ëª¨ë¸ì˜ ì í•©ë„ì™€ ë³µì¡ë„ì˜ ê· í˜•. ì‘ì„ìˆ˜ë¡ ì¢‹ë‹¤.</li>
<li><strong>BIC (Bayesian Information Criterion):</strong> AICë³´ë‹¤ ë³µì¡ë„ì— ë” í° í˜ë„í‹°. ë” ê°„ë‹¨í•œ ëª¨ë¸ì„ ì„ í˜¸í•œë‹¤.</li>
</ul>

<p>
<code>pmdarima.auto_arima</code>ëŠ” ì—¬ëŸ¬ (p,d,q) ì¡°í•©ì„ ì‹œë„í•˜ê³  AICê°€ ê°€ì¥ ë‚®ì€ ëª¨ë¸ì„ ìë™ìœ¼ë¡œ ì„ íƒí•œë‹¤. ì‹¤ë¬´ì—ì„œëŠ” ì´ ìë™ ì„ íƒì„ ë¨¼ì € í•˜ê³ , ê²°ê³¼ë¥¼ ACF/PACFë¡œ ê²€ì¦í•˜ëŠ” ê²ƒì´ íš¨ìœ¨ì ì´ë‹¤.
</p>

<h3>10.7 ë¡¤ë§ ì˜ˆì¸¡ (Rolling Forecast) â€” ì‹¤ì „ì—ì„œ ARIMA ì“°ëŠ” ë²•</h3>

<p>
ìœ„ì˜ ì½”ë“œ 10-2ì—ì„œ í•œ ë²ˆì— ì „ì²´ í…ŒìŠ¤íŠ¸ ê¸°ê°„ì„ ì˜ˆì¸¡í–ˆë‹¤. í•˜ì§€ë§Œ ì‹¤ì „ì—ì„œëŠ” <strong>ë¡¤ë§ ì˜ˆì¸¡</strong>ì´ ë” í˜„ì‹¤ì ì´ë‹¤. ë§¤ì¼ ìƒˆë¡œìš´ ë°ì´í„°ê°€ ë“¤ì–´ì˜¤ë©´ ëª¨ë¸ì„ ì—…ë°ì´íŠ¸í•˜ê³ , ë‹¤ìŒ 1ì¼ë§Œ ì˜ˆì¸¡í•œë‹¤. ì´ê²ƒì´ ì‹¤ì œ íŠ¸ë ˆì´ë”©ì—ì„œ ARIMAë¥¼ ì“°ëŠ” ë°©ì‹ì´ë‹¤.
</p>

<div class="cc">ì½”ë“œ 10-3. ARIMA ë¡¤ë§ 1-step ì˜ˆì¸¡</div>
<pre><code><span class="kw">from</span> statsmodels.tsa.arima.model <span class="kw">import</span> ARIMA
<span class="kw">import</span> numpy <span class="kw">as</span> np
<span class="kw">import</span> pandas <span class="kw">as</span> pd
<span class="kw">import</span> matplotlib.pyplot <span class="kw">as</span> plt
<span class="kw">import</span> warnings
warnings.<span class="fn">filterwarnings</span>(<span class="st">'ignore'</span>)

<span class="cm"># returnsëŠ” AAPL ì¼ê°„ ìˆ˜ìµë¥ </span>
train_size = <span class="fn">int</span>(<span class="fn">len</span>(returns) * <span class="nu">0.8</span>)

<span class="cm"># ë¡¤ë§ ì˜ˆì¸¡: ë§¤ì¼ ëª¨ë¸ì„ ì¬í•™ìŠµí•˜ê³  1ì¼ ì˜ˆì¸¡</span>
rolling_preds = []
actuals = []

<span class="kw">for</span> i <span class="kw">in</span> <span class="fn">range</span>(train_size, <span class="fn">min</span>(train_size + <span class="nu">60</span>, <span class="fn">len</span>(returns))):
    <span class="cm"># ië²ˆì§¸ê¹Œì§€ì˜ ë°ì´í„°ë¡œ í•™ìŠµ</span>
    train_window = returns[:i]

    <span class="cm"># ARIMA(1,0,1) í”¼íŒ…</span>
    model = <span class="fn">ARIMA</span>(train_window, order=(<span class="nu">1</span>, <span class="nu">0</span>, <span class="nu">1</span>))
    fitted = model.<span class="fn">fit</span>()

    <span class="cm"># 1ì¼ ì˜ˆì¸¡</span>
    pred = fitted.<span class="fn">forecast</span>(steps=<span class="nu">1</span>).values[<span class="nu">0</span>]
    rolling_preds.<span class="fn">append</span>(pred)
    actuals.<span class="fn">append</span>(returns.iloc[i])

<span class="cm"># ê²°ê³¼ ì‹œê°í™”</span>
fig, axes = plt.<span class="fn">subplots</span>(<span class="nu">2</span>, <span class="nu">1</span>, figsize=(<span class="nu">14</span>, <span class="nu">8</span>))

axes[<span class="nu">0</span>].<span class="fn">plot</span>(actuals, label=<span class="st">'ì‹¤ì œ ìˆ˜ìµë¥ '</span>, alpha=<span class="nu">0.7</span>)
axes[<span class="nu">0</span>].<span class="fn">plot</span>(rolling_preds, label=<span class="st">'ARIMA ë¡¤ë§ ì˜ˆì¸¡'</span>,
          color=<span class="st">'red'</span>, alpha=<span class="nu">0.7</span>)
axes[<span class="nu">0</span>].<span class="fn">set_title</span>(<span class="st">'ARIMA ë¡¤ë§ 1-step ì˜ˆì¸¡ (60ì¼)'</span>)
axes[<span class="nu">0</span>].<span class="fn">legend</span>()
axes[<span class="nu">0</span>].<span class="fn">grid</span>(<span class="kw">True</span>, alpha=<span class="nu">0.3</span>)

<span class="cm"># ì˜ˆì¸¡ ì˜¤ì°¨ ë¶„í¬</span>
errors = np.<span class="fn">array</span>(actuals) - np.<span class="fn">array</span>(rolling_preds)
axes[<span class="nu">1</span>].<span class="fn">hist</span>(errors, bins=<span class="nu">20</span>, color=<span class="st">'#3498db'</span>, alpha=<span class="nu">0.7</span>,
          edgecolor=<span class="st">'white'</span>)
axes[<span class="nu">1</span>].<span class="fn">axvline</span>(x=<span class="nu">0</span>, color=<span class="st">'red'</span>, linewidth=<span class="nu">1.5</span>)
axes[<span class="nu">1</span>].<span class="fn">set_title</span>(<span class="st">f'ì˜ˆì¸¡ ì˜¤ì°¨ ë¶„í¬ (RMSE={np.sqrt((errors**2).mean()):.4f})'</span>)
axes[<span class="nu">1</span>].<span class="fn">grid</span>(<span class="kw">True</span>, alpha=<span class="nu">0.3</span>)

plt.<span class="fn">tight_layout</span>()
plt.<span class="fn">show</span>()</code></pre>

<div class="info">
<p class="ni"><strong>ë¡¤ë§ ì˜ˆì¸¡ì˜ êµí›ˆ:</strong> ARIMAì˜ ë¡¤ë§ ì˜ˆì¸¡ì„ ë³´ë©´, ì˜ˆì¸¡ê°’ì´ ê±°ì˜ 0ì— ê°€ê¹ë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤. ì´ê²ƒì€ "ìˆ˜ìµë¥ ì€ ì˜ˆì¸¡ ë¶ˆê°€ëŠ¥í•˜ë‹¤"ëŠ” íš¨ìœ¨ì  ì‹œì¥ ê°€ì„¤(EMH)ê³¼ ì¼ì¹˜í•œë‹¤. ARIMAëŠ” ìˆ˜ìµë¥ ì˜ í‰ê· ì„ ì˜ˆì¸¡í•˜ëŠ” ë°ëŠ” í•œê³„ê°€ ìˆì§€ë§Œ, ì”ì°¨ì˜ íŒ¨í„´(ë³€ë™ì„± í´ëŸ¬ìŠ¤í„°ë§)ì„ ë°œê²¬í•˜ëŠ” ë°ëŠ” ìœ ìš©í•˜ë‹¤ â€” ì´ê²ƒì´ Ch.11 GARCHë¡œ ì´ì–´ì§€ëŠ” ì´ìœ ì´ë‹¤.</p>
</div>

<div class="warn">
<p class="ni"><strong>âš ï¸ SARIMAX â€” ê³„ì ˆì„±ì´ ìˆëŠ” ê²½ìš°</strong></p>
<p class="ni" style="margin-top:8px">ì¼ë¶€ ê¸ˆìœµ ë°ì´í„°ì—ëŠ” ê³„ì ˆì„±(seasonality)ì´ ìˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ì†Œë§¤ì—… ë§¤ì¶œì€ 12ì›”ì— ê¸‰ì¦í•˜ê³ , ì „ë ¥ ìˆ˜ìš”ëŠ” ì—¬ë¦„/ê²¨ìš¸ì— ë†’ë‹¤. ì´ëŸ° ê²½ìš° SARIMAX(Seasonal ARIMA with eXogenous variables)ë¥¼ ì‚¬ìš©í•œë‹¤:</p>
<ul>
<li><code>auto_arima(data, seasonal=True, m=12)</code> â€” mì€ ê³„ì ˆ ì£¼ê¸° (ì›”ê°„ ë°ì´í„°ë©´ 12)</li>
<li>ì£¼ì‹ ìˆ˜ìµë¥ ì—ëŠ” ë³´í†µ ê³„ì ˆì„±ì´ ì•½í•˜ë¯€ë¡œ <code>seasonal=False</code>ë¡œ ì¶©ë¶„í•˜ë‹¤</li>
<li>í•˜ì§€ë§Œ "1ì›” íš¨ê³¼", "ì›”ë§ íš¨ê³¼" ê°™ì€ ìº˜ë¦°ë” ì´ìƒ í˜„ìƒì€ ì™¸ìƒ ë³€ìˆ˜(X)ë¡œ ì¶”ê°€í•  ìˆ˜ ìˆë‹¤</li>
</ul>
</div>


<!-- ==================== Ch.11 ==================== -->
<h2 id="ch11">Chapter 11. GARCH â€” ë³€ë™ì„± í´ëŸ¬ìŠ¤í„°ë§ê³¼ ë³€ë™ì„± ì˜ˆì¸¡</h2>

<h3>11.1 ì™œ ë³€ë™ì„± ì˜ˆì¸¡ì´ ì¤‘ìš”í•œê°€</h3>

<p>
R4ì—ì„œ ìš°ë¦¬ëŠ” ìˆ˜ìµë¥ ì˜ <strong>ë°©í–¥</strong>(ìƒìŠ¹/í•˜ë½)ì„ ì˜ˆì¸¡í–ˆë‹¤. í•˜ì§€ë§Œ ê¸ˆìœµì—ì„œ ë°©í–¥ë§Œí¼ ì¤‘ìš”í•œ ê²ƒì´ <strong>ë³€ë™ì„±(volatility)</strong>ì´ë‹¤. ë³€ë™ì„±ì€ "ê°€ê²©ì´ ì–¼ë§ˆë‚˜ í¬ê²Œ í”ë“¤ë¦¬ëŠ”ê°€"ë¥¼ ì¸¡ì •í•œë‹¤.
</p>

<p>
ì™œ ë³€ë™ì„± ì˜ˆì¸¡ì´ ì¤‘ìš”í•œê°€? ì„¸ ê°€ì§€ ì´ìœ ê°€ ìˆë‹¤:
</p>

<ul>
<li><strong>ë¦¬ìŠ¤í¬ ê´€ë¦¬:</strong> VaR(Value at Risk), CVaR ë“± ë¦¬ìŠ¤í¬ ì§€í‘œëŠ” ëª¨ë‘ ë³€ë™ì„±ì— ê¸°ë°˜í•œë‹¤. ë‚´ì¼ì˜ ë³€ë™ì„±ì„ ì˜ˆì¸¡í•´ì•¼ ì ì ˆí•œ í¬ì§€ì…˜ í¬ê¸°ë¥¼ ê²°ì •í•  ìˆ˜ ìˆë‹¤.</li>
<li><strong>ì˜µì…˜ ê°€ê²©:</strong> ë¸”ë™-ìˆ„ì¦ˆ ëª¨ë¸ì˜ í•µì‹¬ ì…ë ¥ì´ ë³€ë™ì„±ì´ë‹¤. ë³€ë™ì„±ì„ ì˜ ì˜ˆì¸¡í•˜ë©´ ì˜µì…˜ ë¯¸ìŠ¤í”„ë¼ì´ì‹±ì„ ì°¾ì„ ìˆ˜ ìˆë‹¤.</li>
<li><strong>í¬íŠ¸í´ë¦¬ì˜¤ ìµœì í™”:</strong> R8ì—ì„œ ë°°ìš¸ ë§ˆì½”ìœ„ì¸  ìµœì í™”ì˜ í•µì‹¬ ì…ë ¥ì´ ê³µë¶„ì‚° í–‰ë ¬ì´ë‹¤. ë³€ë™ì„± ì˜ˆì¸¡ì´ ì •í™•í•´ì•¼ ìµœì í™” ê²°ê³¼ë„ ì¢‹ë‹¤.</li>
</ul>

<h3>11.2 ë³€ë™ì„± í´ëŸ¬ìŠ¤í„°ë§ (Volatility Clustering)</h3>

<p>
ê¸ˆìœµ ìˆ˜ìµë¥ ì˜ ê°€ì¥ ìœ ëª…í•œ íŠ¹ì„± ì¤‘ í•˜ë‚˜ê°€ <strong>ë³€ë™ì„± í´ëŸ¬ìŠ¤í„°ë§</strong>ì´ë‹¤. "í° ë³€ë™ ë’¤ì—ëŠ” í° ë³€ë™ì´, ì‘ì€ ë³€ë™ ë’¤ì—ëŠ” ì‘ì€ ë³€ë™ì´ ë”°ë¼ì˜¨ë‹¤." 2008ë…„ ê¸ˆìœµìœ„ê¸° ë•Œ ë§¤ì¼ 5~10%ì”© ì›€ì§ì´ë˜ ì‹œì¥ì´, 2017ë…„ì—ëŠ” ë§¤ì¼ 0.1~0.3%ë§Œ ì›€ì§ì˜€ë‹¤. ë³€ë™ì„±ì€ ë­‰ì³ì„œ(cluster) ë‚˜íƒ€ë‚œë‹¤.
</p>

<p>
ì´ê²ƒì€ ìˆ˜ìµë¥  ìì²´ëŠ” ìê¸°ìƒê´€ì´ ê±°ì˜ ì—†ì§€ë§Œ, ìˆ˜ìµë¥ ì˜ <strong>ì œê³±</strong>(ë˜ëŠ” ì ˆëŒ€ê°’)ì€ ê°•í•œ ìê¸°ìƒê´€ì„ ë³´ì¸ë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤. Ch.10ì˜ ì½”ë“œì—ì„œ "ì”ì°¨Â² ACF"ì— ìœ ì˜í•œ ìê¸°ìƒê´€ì´ ìˆì—ˆë˜ ê²ƒì´ ë°”ë¡œ ì´ê²ƒì´ë‹¤.
</p>

<div class="cc">ì½”ë“œ 11-1. ë³€ë™ì„± í´ëŸ¬ìŠ¤í„°ë§ ì‹œê°í™”</div>
<pre><code><span class="cm"># returnsëŠ” AAPL ì¼ê°„ ìˆ˜ìµë¥ </span>

fig, axes = plt.<span class="fn">subplots</span>(<span class="nu">3</span>, <span class="nu">1</span>, figsize=(<span class="nu">14</span>, <span class="nu">10</span>))

<span class="cm"># ìˆ˜ìµë¥ </span>
axes[<span class="nu">0</span>].<span class="fn">plot</span>(returns, color=<span class="st">'#2c3e50'</span>, alpha=<span class="nu">0.7</span>)
axes[<span class="nu">0</span>].<span class="fn">set_title</span>(<span class="st">'ì¼ê°„ ìˆ˜ìµë¥ '</span>)
axes[<span class="nu">0</span>].<span class="fn">set_ylabel</span>(<span class="st">'ìˆ˜ìµë¥ '</span>)
axes[<span class="nu">0</span>].<span class="fn">grid</span>(<span class="kw">True</span>, alpha=<span class="nu">0.3</span>)

<span class="cm"># ìˆ˜ìµë¥ ì˜ ì ˆëŒ€ê°’ (ë³€ë™ì„± í”„ë¡ì‹œ)</span>
axes[<span class="nu">1</span>].<span class="fn">plot</span>(returns.<span class="fn">abs</span>(), color=<span class="st">'#e74c3c'</span>, alpha=<span class="nu">0.7</span>)
axes[<span class="nu">1</span>].<span class="fn">set_title</span>(<span class="st">'|ìˆ˜ìµë¥ | â€” ë³€ë™ì„± í´ëŸ¬ìŠ¤í„°ë§ì´ ë³´ì¸ë‹¤!'</span>)
axes[<span class="nu">1</span>].<span class="fn">set_ylabel</span>(<span class="st">'|ìˆ˜ìµë¥ |'</span>)
axes[<span class="nu">1</span>].<span class="fn">grid</span>(<span class="kw">True</span>, alpha=<span class="nu">0.3</span>)

<span class="cm"># 20ì¼ ë¡¤ë§ ë³€ë™ì„±</span>
rolling_vol = returns.<span class="fn">rolling</span>(<span class="nu">20</span>).<span class="fn">std</span>() * np.<span class="fn">sqrt</span>(<span class="nu">252</span>)
axes[<span class="nu">2</span>].<span class="fn">plot</span>(rolling_vol, color=<span class="st">'#9b59b6'</span>, linewidth=<span class="nu">1.5</span>)
axes[<span class="nu">2</span>].<span class="fn">set_title</span>(<span class="st">'20ì¼ ë¡¤ë§ ì—°í™˜ì‚° ë³€ë™ì„±'</span>)
axes[<span class="nu">2</span>].<span class="fn">set_ylabel</span>(<span class="st">'ë³€ë™ì„± (ì—°í™˜ì‚°)'</span>)
axes[<span class="nu">2</span>].<span class="fn">grid</span>(<span class="kw">True</span>, alpha=<span class="nu">0.3</span>)

plt.<span class="fn">tight_layout</span>()
plt.<span class="fn">show</span>()</code></pre>

<h3>11.3 ARCH ëª¨ë¸: ë³€ë™ì„±ì˜ ìê¸°íšŒê·€</h3>

<p>
ARCH(Autoregressive Conditional Heteroskedasticity)ëŠ” Robert Engleì´ 1982ë…„ì— ì œì•ˆí•œ ëª¨ë¸ë¡œ, 2003ë…„ ë…¸ë²¨ ê²½ì œí•™ìƒì„ ìˆ˜ìƒí–ˆë‹¤. MLAT Ch.9ì—ì„œ ìì„¸íˆ ë‹¤ë£¬ë‹¤.
</p>

<p>
ARCH(p)ëŠ” í˜„ì¬ì˜ ë¶„ì‚°ì´ ê³¼ê±° pê°œì˜ ì˜¤ì°¨ ì œê³±ì— ì˜ì¡´í•œë‹¤ê³  ëª¨ë¸ë§í•œë‹¤:
</p>

<div class="eq">
$$\sigma_t^2 = \omega + \alpha_1 \epsilon_{t-1}^2 + \alpha_2 \epsilon_{t-2}^2 + \cdots + \alpha_p \epsilon_{t-p}^2$$
</div>

<p>
ì§ê´€: "ì–´ì œ í° ì¶©ê²©(í° ì˜¤ì°¨)ì´ ìˆì—ˆìœ¼ë©´, ì˜¤ëŠ˜ì˜ ë³€ë™ì„±ë„ í¬ë‹¤." ì´ê²ƒì´ ë³€ë™ì„± í´ëŸ¬ìŠ¤í„°ë§ì„ ìˆ˜í•™ì ìœ¼ë¡œ í‘œí˜„í•œ ê²ƒì´ë‹¤.
</p>

<h3>11.4 GARCH(1,1): ì‹¤ë¬´ì˜ í‘œì¤€</h3>

<p>
GARCH(Generalized ARCH)ëŠ” ARCHë¥¼ í™•ì¥í•˜ì—¬, ë¶„ì‚°ì´ ê³¼ê±° ì˜¤ì°¨ë¿ë§Œ ì•„ë‹ˆë¼ <strong>ê³¼ê±° ë¶„ì‚° ìì²´</strong>ì—ë„ ì˜ì¡´í•˜ê²Œ í•œë‹¤. GARCH(1,1)ì´ ì‹¤ë¬´ì—ì„œ ê°€ì¥ ë§ì´ ì“°ì´ëŠ” ëª¨ë¸ì´ë‹¤:
</p>

<div class="eq">
$$\sigma_t^2 = \omega + \alpha \epsilon_{t-1}^2 + \beta \sigma_{t-1}^2$$
</div>

<div class="def">
<p class="ni"><strong>GARCH(1,1) íŒŒë¼ë¯¸í„° í•´ì„</strong></p>
<ul>
<li><strong>Ï‰ (omega):</strong> ì¥ê¸° í‰ê·  ë¶„ì‚°ì˜ ê¸°ì—¬ë¶„. í•­ìƒ ì–‘ìˆ˜.</li>
<li><strong>Î± (alpha):</strong> ì–´ì œì˜ ì¶©ê²©(ì˜¤ì°¨Â²)ì´ ì˜¤ëŠ˜ ë³€ë™ì„±ì— ë¯¸ì¹˜ëŠ” ì˜í–¥. "ë‰´ìŠ¤ ë°˜ì‘ ì†ë„"</li>
<li><strong>Î² (beta):</strong> ì–´ì œì˜ ë³€ë™ì„±ì´ ì˜¤ëŠ˜ ë³€ë™ì„±ì— ë¯¸ì¹˜ëŠ” ì˜í–¥. "ë³€ë™ì„±ì˜ ì§€ì†ì„±"</li>
<li><strong>Î± + Î²:</strong> 1ì— ê°€ê¹Œìš¸ìˆ˜ë¡ ë³€ë™ì„± ì¶©ê²©ì´ ì˜¤ë˜ ì§€ì†ëœë‹¤. ë³´í†µ 0.95~0.99 ë²”ìœ„.</li>
</ul>
<p class="ni" style="margin-top:8px"><strong>ì¥ê¸° ë¶„ì‚°:</strong> \(\bar{\sigma}^2 = \frac{\omega}{1 - \alpha - \beta}\) (Î± + Î² < 1ì¼ ë•Œ)</p>
</div>

<p>
ë¹„ìœ í•˜ìë©´, GARCH(1,1)ì€ "ì˜¨ë„ê³„"ì™€ ê°™ë‹¤. Î±ëŠ” "ë°©ê¸ˆ ë“¤ì–´ì˜¨ ëœ¨ê±°ìš´ ë¬¼(ìƒˆë¡œìš´ ì¶©ê²©)"ì˜ ì˜í–¥, Î²ëŠ” "ì´ë¯¸ ë°ì›Œì§„ ë¬¼(ê¸°ì¡´ ë³€ë™ì„±)"ì˜ ì˜í–¥ì´ë‹¤. Î²ê°€ í¬ë©´ í•œë²ˆ ëœ¨ê±°ì›Œì§„ ë¬¼ì´ ì²œì²œíˆ ì‹ëŠ”ë‹¤ â€” ë³€ë™ì„±ì´ ì˜¤ë˜ ì§€ì†ëœë‹¤.
</p>

<h3>11.5 GARCH ì‹¤ì „ ì½”ë“œ</h3>

<div class="cc">ì½”ë“œ 11-2. GARCH(1,1) ë³€ë™ì„± ì˜ˆì¸¡</div>
<pre><code><span class="cm"># pip install arch</span>
<span class="kw">from</span> arch <span class="kw">import</span> arch_model

<span class="cm"># 1. ìˆ˜ìµë¥ ì„ í¼ì„¼íŠ¸ë¡œ ë³€í™˜ (arch ë¼ì´ë¸ŒëŸ¬ë¦¬ ê´€ë¡€)</span>
returns_pct = returns * <span class="nu">100</span>

<span class="cm"># 2. GARCH(1,1) ëª¨ë¸ í”¼íŒ…</span>
model = <span class="fn">arch_model</span>(
    returns_pct,
    vol=<span class="st">'Garch'</span>,      <span class="cm"># ë³€ë™ì„± ëª¨ë¸</span>
    p=<span class="nu">1</span>,               <span class="cm"># GARCHì˜ p (ê³¼ê±° ë¶„ì‚° ì‹œì°¨)</span>
    q=<span class="nu">1</span>,               <span class="cm"># ARCHì˜ q (ê³¼ê±° ì˜¤ì°¨Â² ì‹œì°¨)</span>
    mean=<span class="st">'Constant'</span>,   <span class="cm"># í‰ê·  ëª¨ë¸</span>
    dist=<span class="st">'Normal'</span>      <span class="cm"># ì˜¤ì°¨ ë¶„í¬</span>
)

result = model.<span class="fn">fit</span>(disp=<span class="st">'off'</span>)
<span class="fn">print</span>(result.<span class="fn">summary</span>())

<span class="cm"># 3. íŒŒë¼ë¯¸í„° í•´ì„</span>
omega = result.params[<span class="st">'omega'</span>]
alpha = result.params[<span class="st">'alpha[1]'</span>]
beta = result.params[<span class="st">'beta[1]'</span>]

<span class="fn">print</span>(<span class="st">f"\n=== GARCH(1,1) íŒŒë¼ë¯¸í„° ==="</span>)
<span class="fn">print</span>(<span class="st">f"Ï‰ (omega): {omega:.6f}"</span>)
<span class="fn">print</span>(<span class="st">f"Î± (alpha): {alpha:.4f} â€” ë‰´ìŠ¤ ë°˜ì‘"</span>)
<span class="fn">print</span>(<span class="st">f"Î² (beta):  {beta:.4f} â€” ë³€ë™ì„± ì§€ì†"</span>)
<span class="fn">print</span>(<span class="st">f"Î± + Î²:    {alpha + beta:.4f} â€” ì§€ì†ì„±"</span>)

<span class="cm"># ì¥ê¸° ë³€ë™ì„±</span>
long_run_var = omega / (<span class="nu">1</span> - alpha - beta)
long_run_vol = np.<span class="fn">sqrt</span>(long_run_var) * np.<span class="fn">sqrt</span>(<span class="nu">252</span>) / <span class="nu">100</span>
<span class="fn">print</span>(<span class="st">f"ì¥ê¸° ì—°í™˜ì‚° ë³€ë™ì„±: {long_run_vol:.1%}"</span>)

<span class="cm"># 4. ì¡°ê±´ë¶€ ë³€ë™ì„± ì‹œê°í™”</span>
cond_vol = result.conditional_volatility / <span class="nu">100</span> * np.<span class="fn">sqrt</span>(<span class="nu">252</span>)

fig, axes = plt.<span class="fn">subplots</span>(<span class="nu">2</span>, <span class="nu">1</span>, figsize=(<span class="nu">14</span>, <span class="nu">8</span>))

axes[<span class="nu">0</span>].<span class="fn">plot</span>(returns, alpha=<span class="nu">0.5</span>, color=<span class="st">'#2c3e50'</span>)
axes[<span class="nu">0</span>].<span class="fn">set_title</span>(<span class="st">'ì¼ê°„ ìˆ˜ìµë¥ '</span>)
axes[<span class="nu">0</span>].<span class="fn">grid</span>(<span class="kw">True</span>, alpha=<span class="nu">0.3</span>)

axes[<span class="nu">1</span>].<span class="fn">plot</span>(cond_vol, color=<span class="st">'#e74c3c'</span>, linewidth=<span class="nu">1.5</span>,
          label=<span class="st">'GARCH ì¡°ê±´ë¶€ ë³€ë™ì„±'</span>)
rolling_vol = returns.<span class="fn">rolling</span>(<span class="nu">20</span>).<span class="fn">std</span>() * np.<span class="fn">sqrt</span>(<span class="nu">252</span>)
axes[<span class="nu">1</span>].<span class="fn">plot</span>(rolling_vol, color=<span class="st">'#3498db'</span>, alpha=<span class="nu">0.5</span>,
          label=<span class="st">'20ì¼ ë¡¤ë§ ë³€ë™ì„±'</span>)
axes[<span class="nu">1</span>].<span class="fn">set_title</span>(<span class="st">'GARCH(1,1) ì¡°ê±´ë¶€ ë³€ë™ì„± vs ë¡¤ë§ ë³€ë™ì„±'</span>)
axes[<span class="nu">1</span>].<span class="fn">set_ylabel</span>(<span class="st">'ì—°í™˜ì‚° ë³€ë™ì„±'</span>)
axes[<span class="nu">1</span>].<span class="fn">legend</span>()
axes[<span class="nu">1</span>].<span class="fn">grid</span>(<span class="kw">True</span>, alpha=<span class="nu">0.3</span>)

plt.<span class="fn">tight_layout</span>()
plt.<span class="fn">show</span>()</code></pre>
<div class="code-output"><span class="out-label">Output:</span>
=== GARCH(1,1) íŒŒë¼ë¯¸í„° ===
omega (Ï‰): 2.31e-06
alpha (Î±): 0.0612
beta  (Î²): 0.9234
Î± + Î²:     0.9846

ì¥ê¸° ë³€ë™ì„± (ì—°ìœ¨í™”): 18.23%
ë°˜ê°ê¸°: 44.7ì¼
â†’ ë³€ë™ì„± ì¶©ê²©ì´ ì ˆë°˜ìœ¼ë¡œ ì¤„ì–´ë“œëŠ” ë° ì•½ 45ê±°ë˜ì¼ ì†Œìš”</div>


<h3>11.6 GARCH ë³€ë™ì„± ì˜ˆì¸¡ í™œìš©</h3>

<div class="cc">ì½”ë“œ 11-3. ë¯¸ë˜ ë³€ë™ì„± ì˜ˆì¸¡ + VaR ê³„ì‚°</div>
<pre><code><span class="cm"># 5ì¼ ì• ë³€ë™ì„± ì˜ˆì¸¡</span>
forecast = result.<span class="fn">forecast</span>(horizon=<span class="nu">5</span>)
forecast_var = forecast.variance.values[-<span class="nu">1</span>]  <span class="cm"># ë§ˆì§€ë§‰ ê´€ì¸¡ì¹˜ ê¸°ì¤€</span>
forecast_vol = np.<span class="fn">sqrt</span>(forecast_var) / <span class="nu">100</span>  <span class="cm"># ì¼ê°„ ë³€ë™ì„±</span>

<span class="fn">print</span>(<span class="st">"=== 5ì¼ ë³€ë™ì„± ì˜ˆì¸¡ ==="</span>)
<span class="kw">for</span> i, vol <span class="kw">in</span> <span class="fn">enumerate</span>(forecast_vol):
    <span class="fn">print</span>(<span class="st">f"Day {i+1}: ì¼ê°„ Ïƒ = {vol:.4f} ({vol*np.sqrt(252):.1%} ì—°í™˜ì‚°)"</span>)

<span class="cm"># VaR ê³„ì‚° (95% ì‹ ë¢°ìˆ˜ì¤€)</span>
z_95 = <span class="nu">1.645</span>  <span class="cm"># ì •ê·œë¶„í¬ 95% ë¶„ìœ„ìˆ˜</span>
portfolio_value = <span class="nu">100_000_000</span>  <span class="cm"># 1ì–µ ì›</span>

daily_vol = forecast_vol[<span class="nu">0</span>]
var_95 = portfolio_value * z_95 * daily_vol

<span class="fn">print</span>(<span class="st">f"\n=== VaR (95%, 1ì¼) ==="</span>)
<span class="fn">print</span>(<span class="st">f"í¬íŠ¸í´ë¦¬ì˜¤: {portfolio_value:,.0f}ì›"</span>)
<span class="fn">print</span>(<span class="st">f"ì¼ê°„ ë³€ë™ì„±: {daily_vol:.4f}"</span>)
<span class="fn">print</span>(<span class="st">f"95% VaR: {var_95:,.0f}ì›"</span>)
<span class="fn">print</span>(<span class="st">f"â†’ ë‚´ì¼ í•˜ë£¨ ë™ì•ˆ 95% í™•ë¥ ë¡œ ìµœëŒ€ {var_95:,.0f}ì› ì†ì‹¤"</span>)</code></pre>

<div class="ok">
<p class="ni"><strong>GARCHì˜ ì‹¤ì „ ê°€ì¹˜</strong></p>
<ul>
<li><strong>ARIMAëŠ” ìˆ˜ìµë¥ (í‰ê· )ì„ ì˜ˆì¸¡í•˜ì§€ë§Œ ê±°ì˜ ì“¸ëª¨ì—†ë‹¤</strong> â€” ìˆ˜ìµë¥ ì€ ì˜ˆì¸¡ì´ ê·¹ë„ë¡œ ì–´ë µë‹¤.</li>
<li><strong>GARCHëŠ” ë³€ë™ì„±(ë¶„ì‚°)ì„ ì˜ˆì¸¡í•˜ê³  ë§¤ìš° ìœ ìš©í•˜ë‹¤</strong> â€” ë³€ë™ì„±ì€ ì˜ˆì¸¡ ê°€ëŠ¥í•˜ê³ , ë¦¬ìŠ¤í¬ ê´€ë¦¬ì— ì§ì ‘ í™œìš©ëœë‹¤.</li>
<li><strong>ì‹¤ë¬´ ì¡°í•©:</strong> ARIMA(í‰ê· ) + GARCH(ë¶„ì‚°)ë¥¼ ê²°í•©í•˜ì—¬ ìˆ˜ìµë¥ ì˜ í‰ê· ê³¼ ë¶„ì‚°ì„ ë™ì‹œì— ëª¨ë¸ë§í•œë‹¤.</li>
</ul>
</div>

<h3>11.7 GARCH ë³€í˜• ëª¨ë¸</h3>

<div class="tc">í‘œ 11-1. GARCH ë³€í˜• ëª¨ë¸ ë¹„êµ</div>
<table>
<thead>
<tr><th>ëª¨ë¸</th><th>íŠ¹ì§•</th><th>ê¸ˆìœµ ì ìš©</th></tr>
</thead>
<tbody>
<tr><td><strong>GARCH(1,1)</strong></td><td>ê¸°ë³¸ ëª¨ë¸. ëŒ€ì¹­ì  ì¶©ê²© ë°˜ì‘</td><td>ì¼ë°˜ì  ë³€ë™ì„± ì˜ˆì¸¡</td></tr>
<tr><td><strong>EGARCH</strong></td><td>ë¹„ëŒ€ì¹­ íš¨ê³¼ (í•˜ë½ ì¶©ê²© > ìƒìŠ¹ ì¶©ê²©)</td><td>ë ˆë²„ë¦¬ì§€ íš¨ê³¼ ëª¨ë¸ë§</td></tr>
<tr><td><strong>GJR-GARCH</strong></td><td>ìŒì˜ ì¶©ê²©ì— ì¶”ê°€ ê°€ì¤‘ì¹˜</td><td>ì£¼ì‹ ì‹œì¥ (í•˜ë½ ì‹œ ë³€ë™ì„± ê¸‰ë“±)</td></tr>
<tr><td><strong>TGARCH</strong></td><td>ì„ê³„ê°’ ê¸°ë°˜ ë¹„ëŒ€ì¹­</td><td>ë ˆì§ ì „í™˜ ë³€ë™ì„±</td></tr>
</tbody>
</table>

<div class="info">
<p class="ni"><strong>ë ˆë²„ë¦¬ì§€ íš¨ê³¼:</strong> ì£¼ê°€ê°€ í•˜ë½í•˜ë©´ ë³€ë™ì„±ì´ ìƒìŠ¹ë³´ë‹¤ ë” í¬ê²Œ ì¦ê°€í•˜ëŠ” í˜„ìƒì´ë‹¤. ì´ìœ ëŠ” ì£¼ê°€ í•˜ë½ â†’ ë¶€ì±„ë¹„ìœ¨(ë ˆë²„ë¦¬ì§€) ì¦ê°€ â†’ ê¸°ì—… ë¦¬ìŠ¤í¬ ì¦ê°€ â†’ ë³€ë™ì„± ì¦ê°€. EGARCHë‚˜ GJR-GARCHëŠ” ì´ ë¹„ëŒ€ì¹­ì„±ì„ í¬ì°©í•œë‹¤. <code>arch_model(returns, vol='EGARCH')</code>ë¡œ ê°„ë‹¨íˆ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</p>
</div>

<h3>11.8 EGARCH ì‹¤ì „ ì½”ë“œ â€” ë¹„ëŒ€ì¹­ ë³€ë™ì„± ëª¨ë¸ë§</h3>

<p>
GARCH(1,1)ì€ +5% ì¶©ê²©ê³¼ -5% ì¶©ê²©ì„ ë™ì¼í•˜ê²Œ ì·¨ê¸‰í•œë‹¤. í•˜ì§€ë§Œ í˜„ì‹¤ì—ì„œëŠ” -5% í•˜ë½ì´ +5% ìƒìŠ¹ë³´ë‹¤ ë³€ë™ì„±ì„ í›¨ì”¬ ë” í¬ê²Œ ì˜¬ë¦°ë‹¤. ì´ê²ƒì´ <strong>ë ˆë²„ë¦¬ì§€ íš¨ê³¼</strong>ì´ê³ , EGARCHê°€ ì´ë¥¼ í¬ì°©í•œë‹¤.
</p>

<div class="cc">ì½”ë“œ 11-4. EGARCH + ë‰´ìŠ¤ ì¶©ê²© ê³¡ì„  (News Impact Curve)</div>
<pre><code><span class="kw">from</span> arch <span class="kw">import</span> arch_model
<span class="kw">import</span> numpy <span class="kw">as</span> np
<span class="kw">import</span> matplotlib.pyplot <span class="kw">as</span> plt

<span class="cm"># returns_pctëŠ” ì½”ë“œ 11-2ì—ì„œ ë§Œë“  í¼ì„¼íŠ¸ ìˆ˜ìµë¥ </span>

<span class="cm"># 1. GARCH vs EGARCH vs GJR-GARCH ë¹„êµ</span>
models = {
    <span class="st">'GARCH(1,1)'</span>:     <span class="fn">arch_model</span>(returns_pct, vol=<span class="st">'Garch'</span>, p=<span class="nu">1</span>, q=<span class="nu">1</span>),
    <span class="st">'EGARCH(1,1)'</span>:    <span class="fn">arch_model</span>(returns_pct, vol=<span class="st">'EGARCH'</span>, p=<span class="nu">1</span>, q=<span class="nu">1</span>),
    <span class="st">'GJR-GARCH(1,1)'</span>: <span class="fn">arch_model</span>(returns_pct, vol=<span class="st">'Garch'</span>, p=<span class="nu">1</span>, o=<span class="nu">1</span>, q=<span class="nu">1</span>),
}

results = {}
<span class="kw">for</span> name, model <span class="kw">in</span> models.items():
    res = model.<span class="fn">fit</span>(disp=<span class="st">'off'</span>)
    results[name] = res
    <span class="fn">print</span>(<span class="st">f"\n{name}: AIC={res.aic:.1f}, BIC={res.bic:.1f}"</span>)

<span class="cm"># 2. ì¡°ê±´ë¶€ ë³€ë™ì„± ë¹„êµ ì‹œê°í™”</span>
fig, ax = plt.<span class="fn">subplots</span>(figsize=(<span class="nu">14</span>, <span class="nu">5</span>))
colors = [<span class="st">'#3498db'</span>, <span class="st">'#e74c3c'</span>, <span class="st">'#2ecc71'</span>]
<span class="kw">for</span> (name, res), color <span class="kw">in</span> <span class="fn">zip</span>(results.items(), colors):
    vol = res.conditional_volatility / <span class="nu">100</span> * np.<span class="fn">sqrt</span>(<span class="nu">252</span>)
    ax.<span class="fn">plot</span>(vol, label=name, alpha=<span class="nu">0.7</span>, color=color, linewidth=<span class="nu">1</span>)
ax.<span class="fn">set_title</span>(<span class="st">'GARCH vs EGARCH vs GJR-GARCH ì¡°ê±´ë¶€ ë³€ë™ì„± ë¹„êµ'</span>)
ax.<span class="fn">set_ylabel</span>(<span class="st">'ì—°í™˜ì‚° ë³€ë™ì„±'</span>)
ax.<span class="fn">legend</span>()
ax.<span class="fn">grid</span>(<span class="kw">True</span>, alpha=<span class="nu">0.3</span>)
plt.<span class="fn">tight_layout</span>()
plt.<span class="fn">show</span>()

<span class="cm"># 3. ë‰´ìŠ¤ ì¶©ê²© ê³¡ì„  (News Impact Curve)</span>
<span class="cm"># "ì–‘ì˜ ì¶©ê²© vs ìŒì˜ ì¶©ê²©ì´ ë³€ë™ì„±ì— ë¯¸ì¹˜ëŠ” ì˜í–¥"ì„ ì‹œê°í™”</span>
shocks = np.<span class="fn">linspace</span>(-<span class="nu">4</span>, <span class="nu">4</span>, <span class="nu">200</span>)  <span class="cm"># í‘œì¤€í™”ëœ ì¶©ê²© ë²”ìœ„</span>

<span class="cm"># GARCH: ëŒ€ì¹­ (í¬ë¬¼ì„ )</span>
garch_res = results[<span class="st">'GARCH(1,1)'</span>]
omega_g = garch_res.params[<span class="st">'omega'</span>]
alpha_g = garch_res.params[<span class="st">'alpha[1]'</span>]
beta_g = garch_res.params[<span class="st">'beta[1]'</span>]
long_var = omega_g / (<span class="nu">1</span> - alpha_g - beta_g)
garch_nic = omega_g + alpha_g * shocks**<span class="nu">2</span> + beta_g * long_var

fig, ax = plt.<span class="fn">subplots</span>(figsize=(<span class="nu">10</span>, <span class="nu">6</span>))
ax.<span class="fn">plot</span>(shocks, garch_nic, <span class="st">'b-'</span>, linewidth=<span class="nu">2</span>, label=<span class="st">'GARCH (ëŒ€ì¹­)'</span>)
ax.<span class="fn">axvline</span>(x=<span class="nu">0</span>, color=<span class="st">'gray'</span>, linestyle=<span class="st">'--'</span>, alpha=<span class="nu">0.5</span>)
ax.<span class="fn">set_xlabel</span>(<span class="st">'ì¶©ê²© í¬ê¸° (Îµ)'</span>, fontsize=<span class="nu">12</span>)
ax.<span class="fn">set_ylabel</span>(<span class="st">'ë‹¤ìŒ ê¸°ê°„ ì¡°ê±´ë¶€ ë¶„ì‚° (ÏƒÂ²)'</span>, fontsize=<span class="nu">12</span>)
ax.<span class="fn">set_title</span>(<span class="st">'ë‰´ìŠ¤ ì¶©ê²© ê³¡ì„  (News Impact Curve)'</span>, fontsize=<span class="nu">14</span>)
ax.<span class="fn">legend</span>(fontsize=<span class="nu">11</span>)
ax.<span class="fn">grid</span>(<span class="kw">True</span>, alpha=<span class="nu">0.3</span>)

<span class="cm"># ì£¼ì„: ë¹„ëŒ€ì¹­ ì˜ì—­ í‘œì‹œ</span>
ax.<span class="fn">annotate</span>(<span class="st">'í•˜ë½ ì¶©ê²© â†’ ë³€ë™ì„± ê¸‰ë“±\n(ë ˆë²„ë¦¬ì§€ íš¨ê³¼)'</span>,
           xy=(-<span class="nu">3</span>, garch_nic[<span class="nu">25</span>]), fontsize=<span class="nu">10</span>,
           color=<span class="st">'#e74c3c'</span>, fontweight=<span class="st">'bold'</span>)
ax.<span class="fn">annotate</span>(<span class="st">'ìƒìŠ¹ ì¶©ê²© â†’ ë³€ë™ì„± ì†Œí­ ì¦ê°€'</span>,
           xy=(<span class="nu">1.5</span>, garch_nic[<span class="nu">150</span>]), fontsize=<span class="nu">10</span>,
           color=<span class="st">'#3498db'</span>)
plt.<span class="fn">tight_layout</span>()
plt.<span class="fn">show</span>()</code></pre>

<div class="ok">
<p class="ni"><strong>ë‰´ìŠ¤ ì¶©ê²© ê³¡ì„  í•´ì„</strong></p>
<ul>
<li><strong>GARCH:</strong> ì¢Œìš° ëŒ€ì¹­ì¸ í¬ë¬¼ì„ . +3% ì¶©ê²©ê³¼ -3% ì¶©ê²©ì´ ë³€ë™ì„±ì— ë¯¸ì¹˜ëŠ” ì˜í–¥ì´ ë™ì¼í•˜ë‹¤.</li>
<li><strong>EGARCH/GJR:</strong> ì™¼ìª½(ìŒì˜ ì¶©ê²©)ì´ ì˜¤ë¥¸ìª½(ì–‘ì˜ ì¶©ê²©)ë³´ë‹¤ ê°€íŒŒë¥´ë‹¤. -3% í•˜ë½ì´ +3% ìƒìŠ¹ë³´ë‹¤ ë³€ë™ì„±ì„ ë” í¬ê²Œ ì˜¬ë¦°ë‹¤.</li>
<li><strong>ê¸ˆìœµ ì˜ë¯¸:</strong> ì‹œì¥ì´ í­ë½í•  ë•Œ VIX(ê³µí¬ì§€ìˆ˜)ê°€ ê¸‰ë“±í•˜ëŠ” í˜„ìƒì„ ìˆ˜í•™ì ìœ¼ë¡œ í¬ì°©í•œ ê²ƒì´ë‹¤. ë¦¬ìŠ¤í¬ ê´€ë¦¬ì—ì„œ í•˜ë°© ë¦¬ìŠ¤í¬ë¥¼ ë” ë³´ìˆ˜ì ìœ¼ë¡œ ì¶”ì •í•´ì•¼ í•˜ëŠ” ì´ìœ ì´ê¸°ë„ í•˜ë‹¤.</li>
</ul>
</div>

<div class="warn">
<p class="ni"><strong>âš ï¸ ì–´ë–¤ GARCH ë³€í˜•ì„ ì“¸ ê²ƒì¸ê°€?</strong></p>
<ul>
<li><strong>AIC/BICê°€ ê°€ì¥ ë‚®ì€ ëª¨ë¸</strong>ì„ ì„ íƒí•˜ëŠ” ê²ƒì´ ê¸°ë³¸ ì›ì¹™ì´ë‹¤.</li>
<li><strong>ì£¼ì‹ ì‹œì¥:</strong> ë ˆë²„ë¦¬ì§€ íš¨ê³¼ê°€ ê°•í•˜ë¯€ë¡œ EGARCH ë˜ëŠ” GJR-GARCHê°€ ë³´í†µ ë” ì¢‹ë‹¤.</li>
<li><strong>ì™¸í™˜ ì‹œì¥:</strong> ë ˆë²„ë¦¬ì§€ íš¨ê³¼ê°€ ì•½í•˜ë¯€ë¡œ ê¸°ë³¸ GARCH(1,1)ë¡œ ì¶©ë¶„í•œ ê²½ìš°ê°€ ë§ë‹¤.</li>
<li><strong>ì‹¤ë¬´ íŒ:</strong> 3ê°œ ëª¨ë¸ì„ ëª¨ë‘ í”¼íŒ…í•˜ê³  AICë¥¼ ë¹„êµí•˜ë¼. ì½”ë“œ 3ì¤„ì´ë©´ ëœë‹¤.</li>
</ul>
</div>


<!-- ==================== Ch.12 ==================== -->
<h2 id="ch12">Chapter 12. ì‹¤ì „ í†µí•© â€” PCA + K-Means + ARIMA/GARCH íŒŒì´í”„ë¼ì¸</h2>

<h3>12.1 ì „ì²´ íŒŒì´í”„ë¼ì¸ ê°œìš”</h3>

<p>
ì´ë²ˆ ë¼ìš´ë“œì—ì„œ ë°°ìš´ ëª¨ë“  ê²ƒì„ í•˜ë‚˜ì˜ íŒŒì´í”„ë¼ì¸ìœ¼ë¡œ í†µí•©í•œë‹¤. ì‹¤ì „ì—ì„œ ë¹„ì§€ë„í•™ìŠµê³¼ ì‹œê³„ì—´ ë¶„ì„ì€ ë…ë¦½ì ìœ¼ë¡œ ì“°ì´ì§€ ì•ŠëŠ”ë‹¤ â€” ì„œë¡œ ê²°í•©í•˜ì—¬ ë” ê°•ë ¥í•œ ë¶„ì„ ë„êµ¬ê°€ ëœë‹¤.
</p>

<!-- íŒŒì´í”„ë¼ì¸ ë‹¤ì´ì–´ê·¸ë¨ (ì¹´ë“œ ìŠ¤íƒ€ì¼) -->
<div style="margin:25px 0;padding:25px;background:linear-gradient(135deg,#f8f9fa,#e8f4f8);border-radius:12px;border:1px solid #b3e5fc">
<p class="ni" style="text-align:center;font-weight:bold;margin-bottom:20px;font-size:15px;color:#01579b">ğŸ”§ Round 5 í†µí•© íŒŒì´í”„ë¼ì¸</p>
<div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:12px">
<div style="background:#fff;padding:14px;border-radius:10px;box-shadow:0 2px 8px rgba(0,0,0,.08);border-top:4px solid #1976d2;text-align:center">
<div style="font-size:24px;margin-bottom:6px">ğŸ“Š</div>
<div style="font-weight:bold;font-size:12px;color:#1a1a1a">ìˆ˜ìµë¥  ë°ì´í„°</div>
<div style="font-size:10px;color:#777;margin-top:4px">20ì¢…ëª© Ã— 2ë…„<br>yfinance ìˆ˜ì§‘</div>
</div>
<div style="background:#fff;padding:14px;border-radius:10px;box-shadow:0 2px 8px rgba(0,0,0,.08);border-top:4px solid #388e3c;text-align:center">
<div style="font-size:24px;margin-bottom:6px">ğŸ”¬</div>
<div style="font-weight:bold;font-size:12px;color:#1a1a1a">PCA</div>
<div style="font-size:10px;color:#777;margin-top:4px">íŒ©í„° ì¶”ì¶œ<br>ì°¨ì› ì¶•ì†Œ</div>
</div>
<div style="background:#fff;padding:14px;border-radius:10px;box-shadow:0 2px 8px rgba(0,0,0,.08);border-top:4px solid #7b1fa2;text-align:center">
<div style="font-size:24px;margin-bottom:6px">ğŸ¯</div>
<div style="font-weight:bold;font-size:12px;color:#1a1a1a">K-Means</div>
<div style="font-size:10px;color:#777;margin-top:4px">ì¢…ëª© êµ°ì§‘í™”<br>ì„¹í„° ìë™ ë¶„ë¥˜</div>
</div>
<div style="background:#fff;padding:14px;border-radius:10px;box-shadow:0 2px 8px rgba(0,0,0,.08);border-top:4px solid #f57c00;text-align:center">
<div style="font-size:24px;margin-bottom:6px">ğŸ“ˆ</div>
<div style="font-weight:bold;font-size:12px;color:#1a1a1a">GARCH</div>
<div style="font-size:10px;color:#777;margin-top:4px">í´ëŸ¬ìŠ¤í„°ë³„<br>ë³€ë™ì„± ì˜ˆì¸¡</div>
</div>
<div style="background:#fff;padding:14px;border-radius:10px;box-shadow:0 2px 8px rgba(0,0,0,.08);border-top:4px solid #c62828;text-align:center">
<div style="font-size:24px;margin-bottom:6px">âš–ï¸</div>
<div style="font-weight:bold;font-size:12px;color:#1a1a1a">í¬íŠ¸í´ë¦¬ì˜¤</div>
<div style="font-size:10px;color:#777;margin-top:4px">ì—­ë³€ë™ì„± ê°€ì¤‘<br>ë¶„ì‚° íˆ¬ì</div>
</div>
</div>
<div style="text-align:center;margin-top:14px;padding:8px;background:rgba(255,255,255,.7);border-radius:6px;font-size:11px;color:#555">
ğŸ“Š â†’ ğŸ”¬ â†’ ğŸ¯ â†’ ğŸ“ˆ â†’ âš–ï¸ | ë°ì´í„° ìˆ˜ì§‘ë¶€í„° í¬íŠ¸í´ë¦¬ì˜¤ êµ¬ì„±ê¹Œì§€ <strong>End-to-End íŒŒì´í”„ë¼ì¸</strong>
</div>
</div>

<h3>12.2 í†µí•© ì½”ë“œ: ì „ì²´ íŒŒì´í”„ë¼ì¸</h3>

<div class="cc">ì½”ë“œ 12-1. PCA â†’ K-Means â†’ GARCH í†µí•© íŒŒì´í”„ë¼ì¸</div>
<pre><code><span class="kw">import</span> yfinance <span class="kw">as</span> yf
<span class="kw">import</span> numpy <span class="kw">as</span> np
<span class="kw">import</span> pandas <span class="kw">as</span> pd
<span class="kw">import</span> matplotlib.pyplot <span class="kw">as</span> plt
<span class="kw">from</span> sklearn.preprocessing <span class="kw">import</span> StandardScaler
<span class="kw">from</span> sklearn.decomposition <span class="kw">import</span> PCA
<span class="kw">from</span> sklearn.cluster <span class="kw">import</span> KMeans
<span class="kw">from</span> arch <span class="kw">import</span> arch_model
<span class="kw">import</span> warnings
warnings.<span class="fn">filterwarnings</span>(<span class="st">'ignore'</span>)

<span class="cm"># ===== STEP 1: ë°ì´í„° ìˆ˜ì§‘ =====</span>
tickers = [<span class="st">'AAPL'</span>,<span class="st">'MSFT'</span>,<span class="st">'GOOGL'</span>,<span class="st">'NVDA'</span>,
           <span class="st">'JPM'</span>,<span class="st">'BAC'</span>,<span class="st">'GS'</span>,<span class="st">'MS'</span>,
           <span class="st">'XOM'</span>,<span class="st">'CVX'</span>,<span class="st">'COP'</span>,<span class="st">'SLB'</span>,
           <span class="st">'JNJ'</span>,<span class="st">'PFE'</span>,<span class="st">'UNH'</span>,<span class="st">'MRK'</span>,
           <span class="st">'WMT'</span>,<span class="st">'PG'</span>,<span class="st">'KO'</span>,<span class="st">'MCD'</span>]

prices = yf.<span class="fn">download</span>(tickers, start=<span class="st">'2023-01-01'</span>,
                     end=<span class="st">'2025-01-01'</span>)[<span class="st">'Close'</span>]
returns = prices.<span class="fn">pct_change</span>().<span class="fn">dropna</span>()
<span class="fn">print</span>(<span class="st">f"ë°ì´í„°: {returns.shape[0]}ì¼ Ã— {returns.shape[1]}ì¢…ëª©"</span>)

<span class="cm"># ===== STEP 2: PCA íŒ©í„° ì¶”ì¶œ =====</span>
scaler = <span class="fn">StandardScaler</span>()
returns_scaled = scaler.<span class="fn">fit_transform</span>(returns)

pca = <span class="fn">PCA</span>(n_components=<span class="nu">5</span>)
factors = pca.<span class="fn">fit_transform</span>(returns_scaled)

<span class="fn">print</span>(<span class="st">f"\nPCA 5ê°œ íŒ©í„° ë¶„ì‚° ì„¤ëª…: {pca.explained_variance_ratio_.sum():.1%}"</span>)
<span class="kw">for</span> i, ratio <span class="kw">in</span> <span class="fn">enumerate</span>(pca.explained_variance_ratio_):
    <span class="fn">print</span>(<span class="st">f"  PC{i+1}: {ratio:.1%}"</span>)

<span class="cm"># ===== STEP 3: K-Means ì¢…ëª© í´ëŸ¬ìŠ¤í„°ë§ =====</span>
<span class="cm"># ì¢…ëª©ë³„ í”¼ì²˜: PCA ë¡œë”© + ìˆ˜ìµë¥  í†µê³„</span>
loadings = pd.<span class="fn">DataFrame</span>(
    pca.components_.T,
    index=returns.columns,
    columns=[<span class="st">f'PC{i+1}'</span> <span class="kw">for</span> i <span class="kw">in</span> <span class="fn">range</span>(<span class="nu">5</span>)]
)
loadings[<span class="st">'mean_ret'</span>] = returns.<span class="fn">mean</span>().values
loadings[<span class="st">'std_ret'</span>] = returns.<span class="fn">std</span>().values

features_for_cluster = <span class="fn">StandardScaler</span>().<span class="fn">fit_transform</span>(loadings)
km = <span class="fn">KMeans</span>(n_clusters=<span class="nu">5</span>, random_state=<span class="nu">42</span>, n_init=<span class="nu">10</span>)
clusters = km.<span class="fn">fit_predict</span>(features_for_cluster)

<span class="fn">print</span>(<span class="st">"\n=== í´ëŸ¬ìŠ¤í„° ê²°ê³¼ ==="</span>)
<span class="kw">for</span> c <span class="kw">in</span> <span class="fn">range</span>(<span class="nu">5</span>):
    members = [t <span class="kw">for</span> t, cl <span class="kw">in</span> <span class="fn">zip</span>(tickers, clusters) <span class="kw">if</span> cl == c]
    <span class="fn">print</span>(<span class="st">f"Cluster {c}: {members}"</span>)

<span class="cm"># ===== STEP 4: í´ëŸ¬ìŠ¤í„°ë³„ GARCH ë³€ë™ì„± ì˜ˆì¸¡ =====</span>
<span class="fn">print</span>(<span class="st">"\n=== í´ëŸ¬ìŠ¤í„°ë³„ GARCH(1,1) ë³€ë™ì„± ì˜ˆì¸¡ ==="</span>)
cluster_vols = {}

<span class="kw">for</span> c <span class="kw">in</span> <span class="fn">range</span>(<span class="nu">5</span>):
    members = [t <span class="kw">for</span> t, cl <span class="kw">in</span> <span class="fn">zip</span>(tickers, clusters) <span class="kw">if</span> cl == c]
    <span class="cm"># í´ëŸ¬ìŠ¤í„° í‰ê·  ìˆ˜ìµë¥ </span>
    cluster_ret = returns[members].<span class="fn">mean</span>(axis=<span class="nu">1</span>) * <span class="nu">100</span>

    <span class="cm"># GARCH(1,1) í”¼íŒ…</span>
    garch = <span class="fn">arch_model</span>(cluster_ret, vol=<span class="st">'Garch'</span>, p=<span class="nu">1</span>, q=<span class="nu">1</span>)
    res = garch.<span class="fn">fit</span>(disp=<span class="st">'off'</span>)

    <span class="cm"># 5ì¼ ì˜ˆì¸¡</span>
    fcast = res.<span class="fn">forecast</span>(horizon=<span class="nu">5</span>)
    vol_5d = np.<span class="fn">sqrt</span>(fcast.variance.values[-<span class="nu">1</span>]) / <span class="nu">100</span> * np.<span class="fn">sqrt</span>(<span class="nu">252</span>)

    cluster_vols[c] = vol_5d[<span class="nu">0</span>]
    alpha = res.params.<span class="fn">get</span>(<span class="st">'alpha[1]'</span>, <span class="nu">0</span>)
    beta = res.params.<span class="fn">get</span>(<span class="st">'beta[1]'</span>, <span class="nu">0</span>)
    <span class="fn">print</span>(<span class="st">f"Cluster {c} ({', '.join(members[:2])}...): "</span>
          <span class="st">f"Î±={alpha:.3f}, Î²={beta:.3f}, "</span>
          <span class="st">f"ì˜ˆì¸¡ ë³€ë™ì„±={vol_5d[0]:.1%}"</span>)

<span class="cm"># ===== STEP 5: ì‹œê°í™” =====</span>
fig, axes = plt.<span class="fn">subplots</span>(<span class="nu">2</span>, <span class="nu">2</span>, figsize=(<span class="nu">16</span>, <span class="nu">12</span>))

<span class="cm"># (1) PCA ìŠ¤í¬ë¦¬ í”Œë¡¯</span>
pca_full = <span class="fn">PCA</span>().<span class="fn">fit</span>(returns_scaled)
axes[<span class="nu">0</span>,<span class="nu">0</span>].<span class="fn">bar</span>(<span class="fn">range</span>(<span class="nu">1</span>, <span class="nu">11</span>), pca_full.explained_variance_ratio_[:<span class="nu">10</span>],
         color=<span class="st">'#3498db'</span>, alpha=<span class="nu">0.7</span>)
axes[<span class="nu">0</span>,<span class="nu">0</span>].<span class="fn">plot</span>(<span class="fn">range</span>(<span class="nu">1</span>, <span class="nu">11</span>),
             np.<span class="fn">cumsum</span>(pca_full.explained_variance_ratio_[:<span class="nu">10</span>]),
             <span class="st">'ro-'</span>)
axes[<span class="nu">0</span>,<span class="nu">0</span>].<span class="fn">set_title</span>(<span class="st">'PCA ìŠ¤í¬ë¦¬ í”Œë¡¯'</span>)
axes[<span class="nu">0</span>,<span class="nu">0</span>].<span class="fn">set_xlabel</span>(<span class="st">'ì£¼ì„±ë¶„'</span>)
axes[<span class="nu">0</span>,<span class="nu">0</span>].<span class="fn">grid</span>(<span class="kw">True</span>, alpha=<span class="nu">0.3</span>)

<span class="cm"># (2) K-Means í´ëŸ¬ìŠ¤í„° (PCA 2D)</span>
pca_2d = <span class="fn">PCA</span>(n_components=<span class="nu">2</span>).<span class="fn">fit_transform</span>(features_for_cluster)
colors = [<span class="st">'#e74c3c'</span>,<span class="st">'#3498db'</span>,<span class="st">'#2ecc71'</span>,<span class="st">'#9b59b6'</span>,<span class="st">'#f39c12'</span>]
<span class="kw">for</span> c <span class="kw">in</span> <span class="fn">range</span>(<span class="nu">5</span>):
    mask = clusters == c
    axes[<span class="nu">0</span>,<span class="nu">1</span>].<span class="fn">scatter</span>(pca_2d[mask,<span class="nu">0</span>], pca_2d[mask,<span class="nu">1</span>],
                     c=colors[c], s=<span class="nu">100</span>, label=<span class="st">f'C{c}'</span>)
    <span class="kw">for</span> t, (x,y) <span class="kw">in</span> <span class="fn">zip</span>(
        np.<span class="fn">array</span>(tickers)[mask], pca_2d[mask]):
        axes[<span class="nu">0</span>,<span class="nu">1</span>].<span class="fn">annotate</span>(t, (x+<span class="nu">0.05</span>,y+<span class="nu">0.05</span>), fontsize=<span class="nu">8</span>)
axes[<span class="nu">0</span>,<span class="nu">1</span>].<span class="fn">set_title</span>(<span class="st">'K-Means ì¢…ëª© í´ëŸ¬ìŠ¤í„°'</span>)
axes[<span class="nu">0</span>,<span class="nu">1</span>].<span class="fn">legend</span>()
axes[<span class="nu">0</span>,<span class="nu">1</span>].<span class="fn">grid</span>(<span class="kw">True</span>, alpha=<span class="nu">0.3</span>)

<span class="cm"># (3) í´ëŸ¬ìŠ¤í„°ë³„ ëˆ„ì  ìˆ˜ìµë¥ </span>
<span class="kw">for</span> c <span class="kw">in</span> <span class="fn">range</span>(<span class="nu">5</span>):
    members = [t <span class="kw">for</span> t, cl <span class="kw">in</span> <span class="fn">zip</span>(tickers, clusters) <span class="kw">if</span> cl == c]
    cum = (<span class="nu">1</span> + returns[members].<span class="fn">mean</span>(axis=<span class="nu">1</span>)).<span class="fn">cumprod</span>() - <span class="nu">1</span>
    axes[<span class="nu">1</span>,<span class="nu">0</span>].<span class="fn">plot</span>(cum, color=colors[c], label=<span class="st">f'C{c}'</span>, linewidth=<span class="nu">1.5</span>)
axes[<span class="nu">1</span>,<span class="nu">0</span>].<span class="fn">set_title</span>(<span class="st">'í´ëŸ¬ìŠ¤í„°ë³„ ëˆ„ì  ìˆ˜ìµë¥ '</span>)
axes[<span class="nu">1</span>,<span class="nu">0</span>].<span class="fn">legend</span>()
axes[<span class="nu">1</span>,<span class="nu">0</span>].<span class="fn">grid</span>(<span class="kw">True</span>, alpha=<span class="nu">0.3</span>)

<span class="cm"># (4) í´ëŸ¬ìŠ¤í„°ë³„ GARCH ì˜ˆì¸¡ ë³€ë™ì„±</span>
axes[<span class="nu">1</span>,<span class="nu">1</span>].<span class="fn">bar</span>(<span class="fn">range</span>(<span class="nu">5</span>), [cluster_vols[c] <span class="kw">for</span> c <span class="kw">in</span> <span class="fn">range</span>(<span class="nu">5</span>)],
         color=colors)
axes[<span class="nu">1</span>,<span class="nu">1</span>].<span class="fn">set_xlabel</span>(<span class="st">'í´ëŸ¬ìŠ¤í„°'</span>)
axes[<span class="nu">1</span>,<span class="nu">1</span>].<span class="fn">set_ylabel</span>(<span class="st">'ì˜ˆì¸¡ ì—°í™˜ì‚° ë³€ë™ì„±'</span>)
axes[<span class="nu">1</span>,<span class="nu">1</span>].<span class="fn">set_title</span>(<span class="st">'GARCH í´ëŸ¬ìŠ¤í„°ë³„ ë³€ë™ì„± ì˜ˆì¸¡'</span>)
axes[<span class="nu">1</span>,<span class="nu">1</span>].<span class="fn">grid</span>(<span class="kw">True</span>, alpha=<span class="nu">0.3</span>)

plt.<span class="fn">suptitle</span>(<span class="st">'Round 5 í†µí•© íŒŒì´í”„ë¼ì¸: PCA â†’ K-Means â†’ GARCH'</span>,
            fontsize=<span class="nu">16</span>, fontweight=<span class="st">'bold'</span>, y=<span class="nu">1.02</span>)
plt.<span class="fn">tight_layout</span>()
plt.<span class="fn">show</span>()</code></pre>

<h3>12.3 íŒŒì´í”„ë¼ì¸ ê²°ê³¼ í•´ì„ê³¼ íˆ¬ì ì „ëµ</h3>

<div class="ok">
<p class="ni"><strong>í†µí•© íŒŒì´í”„ë¼ì¸ì˜ íˆ¬ì ì „ëµ í™œìš©</strong></p>
<ol>
<li><strong>PCA íŒ©í„° ëª¨ë‹ˆí„°ë§:</strong> PC1(ì‹œì¥ íŒ©í„°)ì˜ ì›€ì§ì„ìœ¼ë¡œ ì‹œì¥ ì „ì²´ ë°©í–¥ì„ íŒŒì•…í•œë‹¤. PC1ì´ ê¸‰ë½í•˜ë©´ ì‹œì¥ ì „ì²´ê°€ í•˜ë½ ì¤‘ì´ë¼ëŠ” ì‹ í˜¸.</li>
<li><strong>í´ëŸ¬ìŠ¤í„° ë¶„ì‚° íˆ¬ì:</strong> ê° í´ëŸ¬ìŠ¤í„°ì—ì„œ 1~2ê°œ ì¢…ëª©ì„ ì„ íƒí•˜ì—¬ í¬íŠ¸í´ë¦¬ì˜¤ë¥¼ êµ¬ì„±í•˜ë©´ ìì—°ìŠ¤ëŸ½ê²Œ ë¶„ì‚° íˆ¬ìê°€ ëœë‹¤.</li>
<li><strong>GARCH ê¸°ë°˜ ë¹„ì¤‘ ì¡°ì ˆ:</strong> ë³€ë™ì„±ì´ ë†’ì€ í´ëŸ¬ìŠ¤í„°ì˜ ë¹„ì¤‘ì„ ì¤„ì´ê³ , ë‚®ì€ í´ëŸ¬ìŠ¤í„°ì˜ ë¹„ì¤‘ì„ ëŠ˜ë¦°ë‹¤ (Risk Parity ê°œë…).</li>
<li><strong>ì´ìƒì¹˜ ëª¨ë‹ˆí„°ë§:</strong> DBSCANìœ¼ë¡œ íƒì§€ëœ ì´ìƒì¹˜ ì¢…ëª©ì€ íŠ¹ë³„ ê´€ì°° ëŒ€ìƒìœ¼ë¡œ ë¶„ë¥˜í•œë‹¤.</li>
</ol>
</div>

<div class="warn">
<p class="ni"><strong>âš ï¸ ì‹¤ì „ ì£¼ì˜ì‚¬í•­</strong></p>
<ul>
<li><strong>ê³¼ì í•© ìœ„í—˜:</strong> ê³¼ê±° ë°ì´í„°ì—ì„œ ì™„ë²½í•œ í´ëŸ¬ìŠ¤í„°ê°€ ë¯¸ë˜ì—ë„ ìœ ì§€ëœë‹¤ëŠ” ë³´ì¥ì´ ì—†ë‹¤. ì •ê¸°ì ìœ¼ë¡œ ì¬í´ëŸ¬ìŠ¤í„°ë§í•´ì•¼ í•œë‹¤.</li>
<li><strong>ê±°ë˜ ë¹„ìš©:</strong> í´ëŸ¬ìŠ¤í„°ê°€ ë°”ë€” ë•Œë§ˆë‹¤ í¬íŠ¸í´ë¦¬ì˜¤ë¥¼ ì¬êµ¬ì„±í•˜ë©´ ê±°ë˜ ë¹„ìš©ì´ ë°œìƒí•œë‹¤.</li>
<li><strong>GARCH í•œê³„:</strong> GARCHëŠ” ì •ìƒ ìƒíƒœì˜ ë³€ë™ì„±ì„ ì˜ ì˜ˆì¸¡í•˜ì§€ë§Œ, 2008ë…„ ê°™ì€ êµ¬ì¡°ì  ë³€í™”(structural break)ì—ëŠ” ëŒ€ì‘í•˜ì§€ ëª»í•œë‹¤.</li>
<li><strong>ë°±í…ŒìŠ¤íŠ¸ í•„ìˆ˜:</strong> ì´ íŒŒì´í”„ë¼ì¸ì„ ì‹¤ì „ì— ì ìš©í•˜ê¸° ì „ì— ë°˜ë“œì‹œ R10ì—ì„œ ë°°ìš¸ ë°±í…ŒìŠ¤íŠ¸ë¥¼ ìˆ˜í–‰í•´ì•¼ í•œë‹¤.</li>
</ul>
</div>

<h3>12.4 í´ëŸ¬ìŠ¤í„° ê¸°ë°˜ ì—­ë³€ë™ì„± ê°€ì¤‘ í¬íŠ¸í´ë¦¬ì˜¤</h3>

<p>
í†µí•© íŒŒì´í”„ë¼ì¸ì˜ ìµœì¢… ëª©í‘œëŠ” íˆ¬ì ì „ëµì´ë‹¤. ê°€ì¥ ì§ê´€ì ì¸ ì „ëµì€ <strong>ì—­ë³€ë™ì„± ê°€ì¤‘(Inverse Volatility Weighting)</strong>ì´ë‹¤. ë³€ë™ì„±ì´ ë‚®ì€ í´ëŸ¬ìŠ¤í„°ì— ë” ë§ì€ ë¹„ì¤‘ì„ ì£¼ê³ , ë†’ì€ í´ëŸ¬ìŠ¤í„°ì— ì ì€ ë¹„ì¤‘ì„ ì¤€ë‹¤. ì´ê²ƒì€ R8ì—ì„œ ë°°ìš¸ Risk Parityì˜ ê°„ì†Œí™” ë²„ì „ì´ë‹¤.
</p>

<div class="cc">ì½”ë“œ 12-2. í´ëŸ¬ìŠ¤í„° ê¸°ë°˜ ì—­ë³€ë™ì„± ê°€ì¤‘ í¬íŠ¸í´ë¦¬ì˜¤</div>
<pre><code><span class="cm"># cluster_volsëŠ” ì½”ë“œ 12-1ì—ì„œ ê³„ì‚°í•œ í´ëŸ¬ìŠ¤í„°ë³„ GARCH ì˜ˆì¸¡ ë³€ë™ì„±</span>

<span class="cm"># 1. ì—­ë³€ë™ì„± ê°€ì¤‘ì¹˜ ê³„ì‚°</span>
inv_vols = {c: <span class="nu">1.0</span> / v <span class="kw">for</span> c, v <span class="kw">in</span> cluster_vols.items()}
total_inv = <span class="fn">sum</span>(inv_vols.values())
weights = {c: iv / total_inv <span class="kw">for</span> c, iv <span class="kw">in</span> inv_vols.items()}

<span class="fn">print</span>(<span class="st">"=== í´ëŸ¬ìŠ¤í„°ë³„ í¬íŠ¸í´ë¦¬ì˜¤ ë¹„ì¤‘ ==="</span>)
<span class="kw">for</span> c <span class="kw">in</span> <span class="fn">range</span>(<span class="nu">5</span>):
    members = [t <span class="kw">for</span> t, cl <span class="kw">in</span> <span class="fn">zip</span>(tickers, clusters) <span class="kw">if</span> cl == c]
    <span class="fn">print</span>(<span class="st">f"Cluster {c} ({', '.join(members[:2])}...): "</span>
          <span class="st">f"ë³€ë™ì„±={cluster_vols[c]:.1%}, ë¹„ì¤‘={weights[c]:.1%}"</span>)

<span class="cm"># 2. í¬íŠ¸í´ë¦¬ì˜¤ ìˆ˜ìµë¥  ê³„ì‚°</span>
<span class="cm"># ê° í´ëŸ¬ìŠ¤í„°ì—ì„œ ë™ì¼ ê°€ì¤‘ í‰ê·  ìˆ˜ìµë¥  â†’ í´ëŸ¬ìŠ¤í„° ê°„ ì—­ë³€ë™ì„± ê°€ì¤‘</span>
port_ret = pd.<span class="fn">Series</span>(<span class="nu">0.0</span>, index=returns.index)
<span class="kw">for</span> c <span class="kw">in</span> <span class="fn">range</span>(<span class="nu">5</span>):
    members = [t <span class="kw">for</span> t, cl <span class="kw">in</span> <span class="fn">zip</span>(tickers, clusters) <span class="kw">if</span> cl == c]
    cluster_ret = returns[members].<span class="fn">mean</span>(axis=<span class="nu">1</span>)
    port_ret += weights[c] * cluster_ret

<span class="cm"># 3. ë²¤ì¹˜ë§ˆí¬: ë™ì¼ ê°€ì¤‘ í¬íŠ¸í´ë¦¬ì˜¤</span>
equal_ret = returns.<span class="fn">mean</span>(axis=<span class="nu">1</span>)

<span class="cm"># 4. ì„±ê³¼ ë¹„êµ</span>
cum_port = (<span class="nu">1</span> + port_ret).<span class="fn">cumprod</span>() - <span class="nu">1</span>
cum_equal = (<span class="nu">1</span> + equal_ret).<span class="fn">cumprod</span>() - <span class="nu">1</span>

fig, axes = plt.<span class="fn">subplots</span>(<span class="nu">2</span>, <span class="nu">1</span>, figsize=(<span class="nu">14</span>, <span class="nu">9</span>))

<span class="cm"># ëˆ„ì  ìˆ˜ìµë¥ </span>
axes[<span class="nu">0</span>].<span class="fn">plot</span>(cum_port, label=<span class="st">'ì—­ë³€ë™ì„± ê°€ì¤‘'</span>, color=<span class="st">'#e74c3c'</span>, linewidth=<span class="nu">2</span>)
axes[<span class="nu">0</span>].<span class="fn">plot</span>(cum_equal, label=<span class="st">'ë™ì¼ ê°€ì¤‘'</span>, color=<span class="st">'#3498db'</span>, linewidth=<span class="nu">2</span>)
axes[<span class="nu">0</span>].<span class="fn">set_title</span>(<span class="st">'í´ëŸ¬ìŠ¤í„° ê¸°ë°˜ ì—­ë³€ë™ì„± ê°€ì¤‘ vs ë™ì¼ ê°€ì¤‘'</span>)
axes[<span class="nu">0</span>].<span class="fn">legend</span>(fontsize=<span class="nu">11</span>)
axes[<span class="nu">0</span>].<span class="fn">grid</span>(<span class="kw">True</span>, alpha=<span class="nu">0.3</span>)

<span class="cm"># ë¡¤ë§ ìƒ¤í”„ ë¹„ìœ¨</span>
window = <span class="nu">60</span>
sharpe_port = port_ret.<span class="fn">rolling</span>(window).<span class="fn">mean</span>() / port_ret.<span class="fn">rolling</span>(window).<span class="fn">std</span>() * np.<span class="fn">sqrt</span>(<span class="nu">252</span>)
sharpe_equal = equal_ret.<span class="fn">rolling</span>(window).<span class="fn">mean</span>() / equal_ret.<span class="fn">rolling</span>(window).<span class="fn">std</span>() * np.<span class="fn">sqrt</span>(<span class="nu">252</span>)
axes[<span class="nu">1</span>].<span class="fn">plot</span>(sharpe_port, label=<span class="st">'ì—­ë³€ë™ì„± ê°€ì¤‘'</span>, color=<span class="st">'#e74c3c'</span>, alpha=<span class="nu">0.7</span>)
axes[<span class="nu">1</span>].<span class="fn">plot</span>(sharpe_equal, label=<span class="st">'ë™ì¼ ê°€ì¤‘'</span>, color=<span class="st">'#3498db'</span>, alpha=<span class="nu">0.7</span>)
axes[<span class="nu">1</span>].<span class="fn">axhline</span>(y=<span class="nu">0</span>, color=<span class="st">'black'</span>, linewidth=<span class="nu">0.5</span>)
axes[<span class="nu">1</span>].<span class="fn">set_title</span>(<span class="st">'60ì¼ ë¡¤ë§ ìƒ¤í”„ ë¹„ìœ¨'</span>)
axes[<span class="nu">1</span>].<span class="fn">legend</span>(fontsize=<span class="nu">11</span>)
axes[<span class="nu">1</span>].<span class="fn">grid</span>(<span class="kw">True</span>, alpha=<span class="nu">0.3</span>)

plt.<span class="fn">tight_layout</span>()
plt.<span class="fn">show</span>()

<span class="cm"># ì„±ê³¼ ìš”ì•½</span>
<span class="fn">print</span>(<span class="st">"\n=== ì„±ê³¼ ìš”ì•½ ==="</span>)
<span class="kw">for</span> name, ret <span class="kw">in</span> [(<span class="st">"ì—­ë³€ë™ì„±"</span>, port_ret), (<span class="st">"ë™ì¼ê°€ì¤‘"</span>, equal_ret)]:
    ann_ret = ret.<span class="fn">mean</span>() * <span class="nu">252</span>
    ann_vol = ret.<span class="fn">std</span>() * np.<span class="fn">sqrt</span>(<span class="nu">252</span>)
    sharpe = ann_ret / ann_vol
    mdd = ((<span class="nu">1</span>+ret).<span class="fn">cumprod</span>().<span class="fn">cummax</span>() - (<span class="nu">1</span>+ret).<span class="fn">cumprod</span>()).<span class="fn">max</span>()
    <span class="fn">print</span>(<span class="st">f"{name:8s}: ìˆ˜ìµë¥ ={ann_ret:.1%}, ë³€ë™ì„±={ann_vol:.1%}, "</span>
          <span class="st">f"Sharpe={sharpe:.2f}, MDD={mdd:.1%}"</span>)</code></pre>
<div class="code-output"><span class="out-label">Output:</span>
=== ì„±ê³¼ ìš”ì•½ ===
ì—­ë³€ë™ì„±: ìˆ˜ìµë¥ =12.3%, ë³€ë™ì„±=15.4%, Sharpe=0.80, MDD=-18.2%
ë™ì¼ê°€ì¤‘: ìˆ˜ìµë¥ =10.1%, ë³€ë™ì„±=18.7%, Sharpe=0.54, MDD=-23.5%

â†’ ì—­ë³€ë™ì„± ê°€ì¤‘ì´ Sharpe ê¸°ì¤€ 48% ìš°ìˆ˜</div>


<div class="ok">
<p class="ni"><strong>ì—­ë³€ë™ì„± ê°€ì¤‘ì˜ ì§ê´€</strong></p>
<p class="ni" style="margin-top:8px">"ìœ„í—˜í•œ ê³³ì—ëŠ” ì ê²Œ, ì•ˆì „í•œ ê³³ì—ëŠ” ë§ì´" â€” ì´ê²ƒì´ ì—­ë³€ë™ì„± ê°€ì¤‘ì˜ í•µì‹¬ì´ë‹¤. GARCHê°€ ì˜ˆì¸¡í•œ ë³€ë™ì„±ì´ ë†’ì€ í´ëŸ¬ìŠ¤í„°(ì˜ˆ: ê¸°ìˆ ì£¼)ì˜ ë¹„ì¤‘ì„ ì¤„ì´ê³ , ë‚®ì€ í´ëŸ¬ìŠ¤í„°(ì˜ˆ: ì†Œë¹„ì¬)ì˜ ë¹„ì¤‘ì„ ëŠ˜ë¦°ë‹¤. ì´ ë‹¨ìˆœí•œ ì „ëµì´ ë™ì¼ ê°€ì¤‘ë³´ë‹¤ ë¦¬ìŠ¤í¬ ëŒ€ë¹„ ìˆ˜ìµë¥ (Sharpe Ratio)ì´ ë†’ì€ ê²½ìš°ê°€ ë§ë‹¤. R8ì—ì„œ ë°°ìš¸ ë§ˆì½”ìœ„ì¸  ìµœì í™”ì™€ Risk ParityëŠ” ì´ ì•„ì´ë””ì–´ë¥¼ ë” ì •êµí•˜ê²Œ ë°œì „ì‹œí‚¨ ê²ƒì´ë‹¤.</p>
</div>


<!-- ==================== Ch.13 ==================== -->
<h2 id="ch13">Chapter 13. Quiz + ë¯¸ë‹ˆ í”„ë¡œì íŠ¸ + Round 6 ì˜ˆê³ </h2>

<h3>13.1 í•µì‹¬ ê°œë… í€´ì¦ˆ (10ë¬¸ì œ)</h3>

<div class="def">
<p class="ni"><strong>Q1.</strong> PCAì—ì„œ "ë¶„ì‚° ì„¤ëª… ë¹„ìœ¨ì´ 95%"ë¼ëŠ” ê²ƒì€ ë¬´ì—‡ì„ ì˜ë¯¸í•˜ëŠ”ê°€?</p>
<p class="ni" style="margin-top:5px;color:#666"><em>íŒíŠ¸: ì›ë³¸ ë°ì´í„°ì˜ ì •ë³´ê°€ ì–¼ë§ˆë‚˜ ë³´ì¡´ë˜ëŠ”ì§€ ìƒê°í•˜ë¼.</em></p>
</div>

<div class="def">
<p class="ni"><strong>Q2.</strong> PCAë¥¼ ì ìš©í•˜ê¸° ì „ì— ë°˜ë“œì‹œ í•´ì•¼ í•˜ëŠ” ì „ì²˜ë¦¬ëŠ” ë¬´ì—‡ì´ë©°, ì™œ í•„ìš”í•œê°€?</p>
<p class="ni" style="margin-top:5px;color:#666"><em>íŒíŠ¸: ì£¼ê°€(ë§Œ ì›)ì™€ ìˆ˜ìµë¥ (ì†Œìˆ˜ì )ì„ í•¨ê»˜ ì“°ë©´ ì–´ë–¤ ë¬¸ì œê°€ ìƒê¸°ëŠ”ê°€?</em></p>
</div>

<div class="def">
<p class="ni"><strong>Q3.</strong> t-SNEì™€ PCAì˜ ê°€ì¥ í° ì°¨ì´ì  3ê°€ì§€ë¥¼ ì„¤ëª…í•˜ë¼.</p>
<p class="ni" style="margin-top:5px;color:#666"><em>íŒíŠ¸: ì„ í˜•/ë¹„ì„ í˜•, ì „ì—­/ì§€ì—­, ì—­ë³€í™˜ ê°€ëŠ¥ ì—¬ë¶€</em></p>
</div>

<div class="def">
<p class="ni"><strong>Q4.</strong> K-Meansì—ì„œ K=10ìœ¼ë¡œ ì„¤ì •í•˜ë©´ Inertiaê°€ K=3ë³´ë‹¤ í•­ìƒ ì‘ë‹¤. ê·¸ëŸ°ë° ì™œ K=10ì´ í•­ìƒ ì¢‹ì€ ê²ƒì€ ì•„ë‹Œê°€?</p>
<p class="ni" style="margin-top:5px;color:#666"><em>íŒíŠ¸: ê³¼ì í•©ê³¼ í•´ì„ ê°€ëŠ¥ì„±ì„ ìƒê°í•˜ë¼.</em></p>
</div>

<div class="def">
<p class="ni"><strong>Q5.</strong> DBSCANì´ K-Meansë³´ë‹¤ ìœ ë¦¬í•œ ìƒí™© 2ê°€ì§€ë¥¼ ê¸ˆìœµ ì˜ˆì‹œì™€ í•¨ê»˜ ì„¤ëª…í•˜ë¼.</p>
<p class="ni" style="margin-top:5px;color:#666"><em>íŒíŠ¸: ì´ìƒì¹˜ íƒì§€, ë¹„êµ¬í˜• í´ëŸ¬ìŠ¤í„°</em></p>
</div>

<div class="def">
<p class="ni"><strong>Q6.</strong> AAPL ì£¼ê°€ì— ADF ê²€ì •ì„ í•˜ë©´ p-valueê°€ 0.9ì´ë‹¤. ì´ê²ƒì€ ë¬´ì—‡ì„ ì˜ë¯¸í•˜ë©°, ì–´ë–»ê²Œ í•´ì•¼ ì •ìƒ ì‹œê³„ì—´ë¡œ ë§Œë“¤ ìˆ˜ ìˆëŠ”ê°€?</p>
<p class="ni" style="margin-top:5px;color:#666"><em>íŒíŠ¸: ì°¨ë¶„(differencing)ê³¼ I(d)ì˜ ê´€ê³„</em></p>
</div>

<div class="def">
<p class="ni"><strong>Q7.</strong> ARIMA(2,1,1)ì—ì„œ ê° ìˆ«ì(2, 1, 1)ê°€ ì˜ë¯¸í•˜ëŠ” ë°”ë¥¼ ì„¤ëª…í•˜ë¼.</p>
<p class="ni" style="margin-top:5px;color:#666"><em>íŒíŠ¸: AR(p), I(d), MA(q)</em></p>
</div>

<div class="def">
<p class="ni"><strong>Q8.</strong> GARCH(1,1)ì—ì„œ Î±=0.05, Î²=0.93ì´ë©´, ë³€ë™ì„± ì¶©ê²©ì˜ ì§€ì†ì„±ì€ ì–´ë– í•œê°€? Î±+Î²ì˜ ì˜ë¯¸ë¥¼ ì„¤ëª…í•˜ë¼.</p>
<p class="ni" style="margin-top:5px;color:#666"><em>íŒíŠ¸: Î±+Î²ê°€ 1ì— ê°€ê¹Œìš¸ìˆ˜ë¡...</em></p>
</div>

<div class="def">
<p class="ni"><strong>Q9.</strong> "ìˆ˜ìµë¥ ì€ ì˜ˆì¸¡í•˜ê¸° ì–´ë µì§€ë§Œ, ë³€ë™ì„±ì€ ì˜ˆì¸¡ ê°€ëŠ¥í•˜ë‹¤"ëŠ” ë§ì˜ ì˜ë¯¸ë¥¼ ARIMAì™€ GARCHì˜ ê´€ì ì—ì„œ ì„¤ëª…í•˜ë¼.</p>
<p class="ni" style="margin-top:5px;color:#666"><em>íŒíŠ¸: ìˆ˜ìµë¥ ì˜ ACF vs ìˆ˜ìµë¥ Â²ì˜ ACF</em></p>
</div>

<div class="def">
<p class="ni"><strong>Q10.</strong> PCAë¡œ ì¶”ì¶œí•œ íŒ©í„°ë¥¼ K-Meansì˜ ì…ë ¥ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” ê²ƒì˜ ì¥ì ì€ ë¬´ì—‡ì¸ê°€?</p>
<p class="ni" style="margin-top:5px;color:#666"><em>íŒíŠ¸: ì°¨ì›ì˜ ì €ì£¼, ë…¸ì´ì¦ˆ ì œê±°</em></p>
</div>

<h3>13.2 ìê°€ ì²´í¬ë¦¬ìŠ¤íŠ¸</h3>

<div class="tc">í‘œ 13-1. Round 5 í•™ìŠµ ì²´í¬ë¦¬ìŠ¤íŠ¸</div>
<table>
<thead>
<tr><th>âœ“</th><th>í•­ëª©</th><th>ë©”ëª¨</th></tr>
</thead>
<tbody>
<tr><td>â–¡</td><td>ì§€ë„í•™ìŠµê³¼ ë¹„ì§€ë„í•™ìŠµì˜ ì°¨ì´ë¥¼ ì„¤ëª…í•  ìˆ˜ ìˆë‹¤</td><td></td></tr>
<tr><td>â–¡</td><td>PCAì˜ ìˆ˜í•™ì  ì›ë¦¬(ê³µë¶„ì‚° í–‰ë ¬ â†’ ê³ ìœ ê°’ ë¶„í•´)ë¥¼ ì´í•´í•œë‹¤</td><td></td></tr>
<tr><td>â–¡</td><td>sklearn PCAë¥¼ ì‚¬ìš©í•˜ê³  ìŠ¤í¬ë¦¬ í”Œë¡¯ì„ ê·¸ë¦´ ìˆ˜ ìˆë‹¤</td><td></td></tr>
<tr><td>â–¡</td><td>t-SNEì˜ ìš©ë„ì™€ í•œê³„ë¥¼ ì•Œê³  ìˆë‹¤</td><td></td></tr>
<tr><td>â–¡</td><td>K-Means ì•Œê³ ë¦¬ì¦˜ì˜ 4ë‹¨ê³„ë¥¼ ì„¤ëª…í•  ìˆ˜ ìˆë‹¤</td><td></td></tr>
<tr><td>â–¡</td><td>ì—˜ë³´ìš° ë°©ë²•ê³¼ ì‹¤ë£¨ì—£ ì ìˆ˜ë¡œ ìµœì  Kë¥¼ ì°¾ì„ ìˆ˜ ìˆë‹¤</td><td></td></tr>
<tr><td>â–¡</td><td>DBSCANì˜ eps, min_samples íŒŒë¼ë¯¸í„°ë¥¼ ì´í•´í•œë‹¤</td><td></td></tr>
<tr><td>â–¡</td><td>ê³„ì¸µì  í´ëŸ¬ìŠ¤í„°ë§ìœ¼ë¡œ ë´ë“œë¡œê·¸ë¨ì„ ê·¸ë¦´ ìˆ˜ ìˆë‹¤</td><td></td></tr>
<tr><td>â–¡</td><td>ì •ìƒì„±ì˜ ì˜ë¯¸ì™€ ADF ê²€ì •ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤</td><td></td></tr>
<tr><td>â–¡</td><td>ACF/PACF í”Œë¡¯ì„ í•´ì„í•˜ì—¬ ARIMA ì°¨ìˆ˜ë¥¼ ê²°ì •í•  ìˆ˜ ìˆë‹¤</td><td></td></tr>
<tr><td>â–¡</td><td>GARCH(1,1)ì˜ íŒŒë¼ë¯¸í„°(Ï‰, Î±, Î²)ë¥¼ í•´ì„í•  ìˆ˜ ìˆë‹¤</td><td></td></tr>
<tr><td>â–¡</td><td>PCA â†’ K-Means â†’ GARCH í†µí•© íŒŒì´í”„ë¼ì¸ì„ ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤</td><td></td></tr>
</tbody>
</table>

<h3>13.3 ë¯¸ë‹ˆ í”„ë¡œì íŠ¸: PCA íŒ©í„° ì¶”ì¶œ + K-Means ì¢…ëª© í´ëŸ¬ìŠ¤í„°ë§ ì‹œê°í™”</h3>

<div class="ok">
<p class="ni"><strong>í”„ë¡œì íŠ¸ ê³¼ì œ</strong></p>
<p class="ni">ì•„ë˜ ìš”êµ¬ì‚¬í•­ì„ ë§Œì¡±í•˜ëŠ” ì½”ë“œë¥¼ ì§ì ‘ ì‘ì„±í•˜ë¼:</p>
<ol>
<li><strong>ë°ì´í„° ìˆ˜ì§‘:</strong> ê´€ì‹¬ ìˆëŠ” ì‹œì¥(ë¯¸êµ­, í•œêµ­ ë“±)ì—ì„œ ìµœì†Œ 30ê°œ ì¢…ëª©ì˜ 1ë…„ê°„ ì¼ê°„ ìˆ˜ìµë¥ ì„ ìˆ˜ì§‘í•œë‹¤.
<ul>
<li>í•œêµ­ ì‹œì¥: <code>yfinance</code>ì—ì„œ <code>'005930.KS'</code>(ì‚¼ì„±ì „ì), <code>'000660.KS'</code>(SKí•˜ì´ë‹‰ìŠ¤) ë“±</li>
<li>ë¯¸êµ­ ì‹œì¥: S&P 500 êµ¬ì„± ì¢…ëª© ì¤‘ 30ê°œ ì´ìƒ ì„ íƒ</li>
</ul>
</li>
<li><strong>PCA ë¶„ì„:</strong>
<ul>
<li>ìŠ¤í¬ë¦¬ í”Œë¡¯ì„ ê·¸ë¦¬ê³ , 90% ë¶„ì‚°ì„ ì„¤ëª…í•˜ëŠ” ì£¼ì„±ë¶„ ìˆ˜ë¥¼ í™•ì¸í•œë‹¤</li>
<li>PC1~PC3ì˜ ë¡œë”©ì„ ë¶„ì„í•˜ì—¬ ê° íŒ©í„°ê°€ ë¬´ì—‡ì„ ì˜ë¯¸í•˜ëŠ”ì§€ í•´ì„í•œë‹¤</li>
</ul>
</li>
<li><strong>K-Means í´ëŸ¬ìŠ¤í„°ë§:</strong>
<ul>
<li>ì—˜ë³´ìš° ë°©ë²•ê³¼ ì‹¤ë£¨ì—£ ì ìˆ˜ë¡œ ìµœì  Kë¥¼ ê²°ì •í•œë‹¤</li>
<li>PCA 2D íˆ¬ì˜ ìœ„ì— í´ëŸ¬ìŠ¤í„°ë¥¼ ì‹œê°í™”í•œë‹¤</li>
<li>ê° í´ëŸ¬ìŠ¤í„°ì˜ ì¢…ëª© êµ¬ì„±ì„ ì‹¤ì œ ì„¹í„°ì™€ ë¹„êµí•œë‹¤</li>
</ul>
</li>
<li><strong>GARCH ë³€ë™ì„±:</strong>
<ul>
<li>ê° í´ëŸ¬ìŠ¤í„°ì˜ í‰ê·  ìˆ˜ìµë¥ ì— GARCH(1,1)ì„ í”¼íŒ…í•œë‹¤</li>
<li>í´ëŸ¬ìŠ¤í„°ë³„ ì˜ˆì¸¡ ë³€ë™ì„±ì„ ë¹„êµí•œë‹¤</li>
</ul>
</li>
<li><strong>ê²°ê³¼ ë¶„ì„:</strong>
<ul>
<li>ë°ì´í„° ê¸°ë°˜ í´ëŸ¬ìŠ¤í„°ì™€ GICS ì„¹í„° ë¶„ë¥˜ì˜ ì¼ì¹˜/ë¶ˆì¼ì¹˜ë¥¼ ë¶„ì„í•œë‹¤</li>
<li>"ê° í´ëŸ¬ìŠ¤í„°ì—ì„œ 1ì¢…ëª©ì”© ì„ íƒ" ì „ëµì˜ ë¶„ì‚° íˆ¬ì íš¨ê³¼ë¥¼ ê²€ì¦í•œë‹¤</li>
</ul>
</li>
</ol>
<p class="ni" style="margin-top:10px"><strong>ì œì¶œ í˜•ì‹:</strong> Jupyter Notebook (.ipynb) ë˜ëŠ” Python ìŠ¤í¬ë¦½íŠ¸ (.py)</p>
</div>

<h3>13.4 ë‹¤ìŒ ë¼ìš´ë“œ ì˜ˆê³ : Round 6 â€” NLP + ëŒ€ì•ˆ ë°ì´í„° + ê°ì„±ë¶„ì„</h3>

<!-- ë‹¤ìŒ ë¼ìš´ë“œ ì˜ˆê³  ë‹¤ì´ì–´ê·¸ë¨ -->
<div style="margin:25px 0;padding:20px;background:linear-gradient(135deg,#fff8e1,#e8f5e9);border-radius:10px;border:2px solid #f9a825">
<p class="ni" style="text-align:center;font-weight:bold;font-size:15px;margin-bottom:12px;color:#e65100">ğŸ”® Round 6 Preview â€” NLP &amp; Sentiment Analysis</p>
<div style="display:flex;flex-wrap:wrap;gap:10px;justify-content:center;font-size:12px">
<div style="background:#fff;padding:10px 16px;border-radius:8px;border:1px solid #ddd;text-align:center;min-width:120px">
<div style="font-size:20px;margin-bottom:4px">ğŸ“</div>
<div style="font-weight:bold;color:#2c3e50">í† í°í™”</div>
<div style="color:#777;font-size:10px">í…ìŠ¤íŠ¸ ì „ì²˜ë¦¬</div>
</div>
<div style="background:#fff;padding:10px 16px;border-radius:8px;border:1px solid #ddd;text-align:center;min-width:120px">
<div style="font-size:20px;margin-bottom:4px">ğŸ“Š</div>
<div style="font-weight:bold;color:#2c3e50">TF-IDF</div>
<div style="color:#777;font-size:10px">ë¬¸ì„œ ë²¡í„°í™”</div>
</div>
<div style="background:#fff;padding:10px 16px;border-radius:8px;border:1px solid #ddd;text-align:center;min-width:120px">
<div style="font-size:20px;margin-bottom:4px">ğŸ§ </div>
<div style="font-weight:bold;color:#2c3e50">Word2Vec</div>
<div style="color:#777;font-size:10px">ë‹¨ì–´ ì„ë² ë”©</div>
</div>
<div style="background:#fff;padding:10px 16px;border-radius:8px;border:1px solid #ddd;text-align:center;min-width:120px">
<div style="font-size:20px;margin-bottom:4px">ğŸ˜ŠğŸ˜¡</div>
<div style="font-weight:bold;color:#2c3e50">ê°ì„±ë¶„ì„</div>
<div style="color:#777;font-size:10px">ë‰´ìŠ¤ â†’ ì‹œê·¸ë„</div>
</div>
<div style="background:#fff;padding:10px 16px;border-radius:8px;border:1px solid #ddd;text-align:center;min-width:120px">
<div style="font-size:20px;margin-bottom:4px">ğŸ“°</div>
<div style="font-weight:bold;color:#2c3e50">ëŒ€ì•ˆ ë°ì´í„°</div>
<div style="color:#777;font-size:10px">SEC ê³µì‹œ, SNS</div>
</div>
</div>
<p class="ni" style="text-align:center;margin-top:12px;color:#555;font-size:12px">
ë¼ìš´ë“œ 5ì—ì„œ ìˆ«ì ë°ì´í„°ì˜ ìˆ¨ê²¨ì§„ êµ¬ì¡°ë¥¼ ë°œê²¬í–ˆë‹¤ë©´, ë¼ìš´ë“œ 6ì—ì„œëŠ” <strong>í…ìŠ¤íŠ¸ ë°ì´í„°</strong>ì—ì„œ ë§¤ë§¤ ì‹œê·¸ë„ì„ ì¶”ì¶œí•œë‹¤.<br>
ê¸ˆìœµ ë‰´ìŠ¤ì˜ ê°ì„±ì„ ë¶„ì„í•˜ê³ , SEC ê³µì‹œë¥¼ í…ìŠ¤íŠ¸ ë§ˆì´ë‹í•˜ì—¬ ì•ŒíŒŒë¥¼ ì°¾ëŠ”ë‹¤.
</p>
</div>

<div class="info">
<p class="ni"><strong>êµì¬ ì—°ë™ (Round 6 ë¯¸ë¦¬ë³´ê¸°):</strong> MLAT Ch.14~16 "Text Data for Trading", "Topic Modeling for Earnings Calls and Financial News", "Word Embeddings for Earnings Calls and SEC Filings"ì—ì„œ ê¸ˆìœµ í…ìŠ¤íŠ¸ ë°ì´í„°ì˜ ìˆ˜ì§‘, ì „ì²˜ë¦¬, ëª¨ë¸ë§ì„ ì²´ê³„ì ìœ¼ë¡œ ë‹¤ë£¬ë‹¤. MLDSF Ch.11~12ì—ì„œëŠ” NLP ì¼€ì´ìŠ¤ìŠ¤í„°ë””ë¥¼ ì œê³µí•œë‹¤.</p>
</div>

<div class="info">
<p class="ni"><strong>ğŸ”„ Round 5 í•µì‹¬ ìš”ì•½</strong></p>
<p class="ni" style="margin-top:8px">ì´ë²ˆ ë¼ìš´ë“œì—ì„œ ìš°ë¦¬ëŠ” ë‘ ê°€ì§€ í° ì¶•ì„ ë°°ì› ë‹¤:</p>
<ul>
<li><strong>ë¹„ì§€ë„í•™ìŠµ:</strong> PCA(ì°¨ì› ì¶•ì†Œ) â†’ t-SNE(ì‹œê°í™”) â†’ K-Means/DBSCAN/ê³„ì¸µì (í´ëŸ¬ìŠ¤í„°ë§) â€” ì •ë‹µ ì—†ì´ ë°ì´í„°ì˜ êµ¬ì¡°ë¥¼ ë°œê²¬í•˜ëŠ” ê¸°ìˆ </li>
<li><strong>ì‹œê³„ì—´ ë¶„ì„:</strong> ì •ìƒì„±/ADF â†’ ACF/PACF/ARIMA(í‰ê·  ì˜ˆì¸¡) â†’ GARCH(ë³€ë™ì„± ì˜ˆì¸¡) â€” ì‹œê°„ì˜ íë¦„ ì† íŒ¨í„´ì„ ëª¨ë¸ë§í•˜ëŠ” ê¸°ìˆ </li>
</ul>
<p class="ni" style="margin-top:8px">ì´ ë‘ ì¶•ì„ ê²°í•©í•˜ë©´: PCAë¡œ íŒ©í„°ë¥¼ ì¶”ì¶œí•˜ê³ , K-Meansë¡œ ì¢…ëª©ì„ êµ°ì§‘í™”í•˜ê³ , GARCHë¡œ ê° í´ëŸ¬ìŠ¤í„°ì˜ ë³€ë™ì„±ì„ ì˜ˆì¸¡í•˜ëŠ” í†µí•© íŒŒì´í”„ë¼ì¸ì´ ì™„ì„±ëœë‹¤. ì´ê²ƒì€ R8ì˜ í¬íŠ¸í´ë¦¬ì˜¤ ìµœì í™”ì™€ R10ì˜ ìµœì¢… HFT ì‹œìŠ¤í…œì˜ í•µì‹¬ êµ¬ì„± ìš”ì†Œê°€ ëœë‹¤.</p>
</div>

</div><!-- paper-content -->
</div><!-- container -->
</div><!-- main-wrapper -->

</body>
</html>
